"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../assertions");
const acmpca = require("../../aws-acmpca");
const acm = require("../../aws-certificatemanager");
const ec2 = require("../../aws-ec2");
const iam = require("../../aws-iam");
const cloudmap = require("../../aws-servicediscovery");
const cdk = require("../../core");
const appmesh = require("../lib");
describe('virtual node', () => {
    describe('When an existing VirtualNode', () => {
        describe('with existing backends, adds new backend', () => {
            test('should add resource with service backends', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const service1 = new appmesh.VirtualService(stack, 'service-1', {
                    virtualServiceName: 'service1.domain.local',
                    virtualServiceProvider: appmesh.VirtualServiceProvider.none(mesh),
                });
                const service2 = new appmesh.VirtualService(stack, 'service-2', {
                    virtualServiceName: 'service2.domain.local',
                    virtualServiceProvider: appmesh.VirtualServiceProvider.none(mesh),
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                    backends: [appmesh.Backend.virtualService(service1)],
                });
                node.addBackend(appmesh.Backend.virtualService(service2));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Backends: [
                            {
                                VirtualService: {
                                    VirtualServiceName: 'service1.domain.local',
                                },
                            },
                            {
                                VirtualService: {
                                    VirtualServiceName: 'service2.domain.local',
                                },
                            },
                        ],
                    },
                    MeshOwner: assertions_1.Match.absent(),
                });
            });
        });
        describe('when a single portmapping is added', () => {
            test('should add the portmapping to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = mesh.addVirtualNode('test-node', {
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                node.addListener(appmesh.VirtualNodeListener.tcp({
                    port: 8081,
                }));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            {
                                PortMapping: {
                                    Port: 8081,
                                    Protocol: 'tcp',
                                },
                            },
                        ],
                    },
                });
            });
        });
        describe('when a listener is added with timeout', () => {
            test('should add the listener timeout to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                    listeners: [appmesh.VirtualNodeListener.grpc({
                            port: 80,
                            timeout: {
                                idle: cdk.Duration.seconds(10),
                                perRequest: cdk.Duration.seconds(10),
                            },
                        })],
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            {
                                PortMapping: {
                                    Port: 80,
                                    Protocol: 'grpc',
                                },
                                Timeout: {
                                    GRPC: {
                                        Idle: {
                                            Unit: 'ms',
                                            Value: 10000,
                                        },
                                        PerRequest: {
                                            Unit: 'ms',
                                            Value: 10000,
                                        },
                                    },
                                },
                            },
                        ],
                    },
                });
            });
        });
        describe('when a listener is added with healthcheck ', () => {
            test('should add a default listener healthcheck to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                    listeners: [appmesh.VirtualNodeListener.http2({
                            port: 80,
                            healthCheck: appmesh.HealthCheck.http2(),
                            timeout: { idle: cdk.Duration.seconds(10) },
                        })],
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            assertions_1.Match.objectLike({
                                HealthCheck: {
                                    HealthyThreshold: 2,
                                    IntervalMillis: 5000,
                                    Port: 80,
                                    Protocol: 'http2',
                                    TimeoutMillis: 2000,
                                    UnhealthyThreshold: 2,
                                },
                                PortMapping: {
                                    Port: 80,
                                    Protocol: 'http2',
                                },
                                Timeout: {
                                    HTTP2: {
                                        Idle: {
                                            Unit: 'ms',
                                            Value: 10000,
                                        },
                                    },
                                },
                            }),
                        ],
                    },
                });
            });
        });
        describe('when a listener is added with healthcheck with user defined props', () => {
            test('should add a listener healthcheck to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                node.addListener(appmesh.VirtualNodeListener.tcp({
                    port: 80,
                    healthCheck: appmesh.HealthCheck.tcp({
                        timeout: cdk.Duration.seconds(3),
                    }),
                    timeout: { idle: cdk.Duration.seconds(10) },
                }));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            assertions_1.Match.objectLike({
                                HealthCheck: {
                                    HealthyThreshold: 2,
                                    IntervalMillis: 5000,
                                    Port: 80,
                                    Protocol: 'tcp',
                                    TimeoutMillis: 3000,
                                    UnhealthyThreshold: 2,
                                },
                                PortMapping: {
                                    Port: 80,
                                    Protocol: 'tcp',
                                },
                                Timeout: {
                                    TCP: {
                                        Idle: {
                                            Unit: 'ms',
                                            Value: 10000,
                                        },
                                    },
                                },
                            }),
                        ],
                    },
                });
            });
        });
        describe('when a listener is added with outlier detection with user defined props', () => {
            test('should add a listener outlier detection to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                node.addListener(appmesh.VirtualNodeListener.tcp({
                    port: 80,
                    outlierDetection: {
                        baseEjectionDuration: cdk.Duration.seconds(10),
                        interval: cdk.Duration.seconds(30),
                        maxEjectionPercent: 50,
                        maxServerErrors: 5,
                    },
                }));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            {
                                OutlierDetection: {
                                    BaseEjectionDuration: {
                                        Unit: 'ms',
                                        Value: 10000,
                                    },
                                    Interval: {
                                        Unit: 'ms',
                                        Value: 30000,
                                    },
                                    MaxEjectionPercent: 50,
                                    MaxServerErrors: 5,
                                },
                                PortMapping: {
                                    Port: 80,
                                    Protocol: 'tcp',
                                },
                            },
                        ],
                    },
                });
            });
        });
        describe('when a default backend is added', () => {
            test('should add a backend default to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const certificateAuthorityArn = 'arn:aws:acm-pca:us-east-1:123456789012:certificate-authority/12345678-1234-1234-1234-123456789012';
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                    backendDefaults: {
                        tlsClientPolicy: {
                            ports: [8080, 8081],
                            validation: {
                                trust: appmesh.TlsValidationTrust.acm([acmpca.CertificateAuthority.fromCertificateAuthorityArn(stack, 'certificate', certificateAuthorityArn)]),
                            },
                        },
                    },
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        BackendDefaults: {
                            ClientPolicy: {
                                TLS: {
                                    Ports: [8080, 8081],
                                    Validation: {
                                        Trust: {
                                            ACM: {
                                                CertificateAuthorityArns: [`${certificateAuthorityArn}`],
                                            },
                                        },
                                    },
                                },
                            },
                        },
                    },
                });
            });
        });
        describe("with client's TLS certificate from SDS", () => {
            test('should add a backend default to the resource with TLS certificate', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                    backendDefaults: {
                        tlsClientPolicy: {
                            mutualTlsCertificate: appmesh.TlsCertificate.sds('secret_certificate'),
                            ports: [8080, 8081],
                            validation: {
                                subjectAlternativeNames: appmesh.SubjectAlternativeNames.matchingExactly('mesh-endpoint.apps.local'),
                                trust: appmesh.TlsValidationTrust.sds('secret_validation'),
                            },
                        },
                    },
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        BackendDefaults: {
                            ClientPolicy: {
                                TLS: {
                                    Certificate: {
                                        SDS: {
                                            SecretName: 'secret_certificate',
                                        },
                                    },
                                    Ports: [8080, 8081],
                                    Validation: {
                                        SubjectAlternativeNames: {
                                            Match: {
                                                Exact: ['mesh-endpoint.apps.local'],
                                            },
                                        },
                                        Trust: {
                                            SDS: {
                                                SecretName: 'secret_validation',
                                            },
                                        },
                                    },
                                },
                            },
                        },
                    },
                });
            });
        });
        describe('when a backend is added', () => {
            test('should add a backend virtual service to the resource', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                const service1 = new appmesh.VirtualService(stack, 'service-1', {
                    virtualServiceName: 'service1.domain.local',
                    virtualServiceProvider: appmesh.VirtualServiceProvider.none(mesh),
                });
                node.addBackend(appmesh.Backend.virtualService(service1, {
                    tlsClientPolicy: {
                        ports: [8080, 8081],
                        validation: {
                            trust: appmesh.TlsValidationTrust.file('path-to-certificate'),
                        },
                    },
                }));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Backends: [
                            {
                                VirtualService: {
                                    VirtualServiceName: 'service1.domain.local',
                                    ClientPolicy: {
                                        TLS: {
                                            Ports: [8080, 8081],
                                            Validation: {
                                                Trust: {
                                                    File: {
                                                        CertificateChain: 'path-to-certificate',
                                                    },
                                                },
                                            },
                                        },
                                    },
                                },
                            },
                        ],
                    },
                });
            });
            test('you can add a Virtual Service as a backend to a Virtual Node which is the provider for that Virtual Service', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                const myVirtualService = new appmesh.VirtualService(stack, 'service-1', {
                    virtualServiceProvider: appmesh.VirtualServiceProvider.virtualNode(node),
                    virtualServiceName: 'service1.domain.local',
                });
                node.addBackend(appmesh.Backend.virtualService(myVirtualService));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Backends: [
                            {
                                VirtualService: {
                                    VirtualServiceName: 'service1.domain.local',
                                },
                            },
                        ],
                    },
                });
            });
            test('you can add a Virtual Service with an automated name as a backend to a Virtual Node which is the provider for that Virtual Service, ', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                const myVirtualService = new appmesh.VirtualService(stack, 'service-1', {
                    virtualServiceProvider: appmesh.VirtualServiceProvider.virtualNode(node),
                });
                node.addBackend(appmesh.Backend.virtualService(myVirtualService));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Backends: [
                            {
                                VirtualService: {
                                    VirtualServiceName: 'service1',
                                },
                            },
                        ],
                    },
                });
            });
        });
        describe('when a grpc listener is added with a TLS certificate from ACM', () => {
            test('the listener should include the TLS configuration', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const cert = new acm.Certificate(stack, 'cert', {
                    domainName: '',
                });
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    listeners: [appmesh.VirtualNodeListener.grpc({
                            port: 80,
                            tls: {
                                mode: appmesh.TlsMode.STRICT,
                                certificate: appmesh.TlsCertificate.acm(cert),
                            },
                        })],
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            assertions_1.Match.objectLike({
                                TLS: {
                                    Mode: appmesh.TlsMode.STRICT,
                                    Certificate: {
                                        ACM: {
                                            CertificateArn: {
                                                Ref: 'cert56CA94EB',
                                            },
                                        },
                                    },
                                },
                            }),
                        ],
                    },
                });
            });
        });
        describe('when an http listener is added with a TLS certificate from file', () => {
            test('the listener should include the TLS configuration', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    listeners: [appmesh.VirtualNodeListener.http({
                            port: 80,
                            tls: {
                                mode: appmesh.TlsMode.STRICT,
                                certificate: appmesh.TlsCertificate.file('path/to/certChain', 'path/to/privateKey'),
                            },
                        })],
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            assertions_1.Match.objectLike({
                                TLS: {
                                    Mode: appmesh.TlsMode.STRICT,
                                    Certificate: {
                                        File: {
                                            CertificateChain: 'path/to/certChain',
                                            PrivateKey: 'path/to/privateKey',
                                        },
                                    },
                                },
                            }),
                        ],
                    },
                });
            });
        });
        describe('when an http2 listener is added with a TLS certificate from SDS', () => {
            test('the listener should include the TLS configuration', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    listeners: [appmesh.VirtualNodeListener.http2({
                            port: 80,
                            tls: {
                                mode: appmesh.TlsMode.STRICT,
                                certificate: appmesh.TlsCertificate.sds('secret_certificate'),
                            },
                        })],
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            assertions_1.Match.objectLike({
                                TLS: {
                                    Mode: appmesh.TlsMode.STRICT,
                                    Certificate: {
                                        SDS: {
                                            SecretName: 'secret_certificate',
                                        },
                                    },
                                },
                            }),
                        ],
                    },
                });
            });
        });
        describe('when an http listener is added with the TLS mode permissive', () => {
            test('the listener should include the TLS configuration', () => {
                // GIVEN
                const stack = new cdk.Stack();
                // WHEN
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    listeners: [appmesh.VirtualNodeListener.http({
                            port: 80,
                            tls: {
                                mode: appmesh.TlsMode.PERMISSIVE,
                                certificate: appmesh.TlsCertificate.file('path/to/certChain', 'path/to/privateKey'),
                            },
                        })],
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        Listeners: [
                            assertions_1.Match.objectLike({
                                TLS: {
                                    Mode: appmesh.TlsMode.PERMISSIVE,
                                    Certificate: {
                                        File: {
                                            CertificateChain: 'path/to/certChain',
                                            PrivateKey: 'path/to/privateKey',
                                        },
                                    },
                                },
                            }),
                        ],
                    },
                });
            });
        });
        test('Can add an http connection pool to listener', () => {
            // GIVEN
            const stack = new cdk.Stack();
            // WHEN
            const mesh = new appmesh.Mesh(stack, 'mesh', {
                meshName: 'test-mesh',
            });
            new appmesh.VirtualNode(stack, 'test-node', {
                mesh,
                listeners: [
                    appmesh.VirtualNodeListener.http({
                        port: 80,
                        connectionPool: {
                            maxConnections: 100,
                            maxPendingRequests: 10,
                        },
                    }),
                ],
                serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
            });
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                Spec: {
                    Listeners: [
                        assertions_1.Match.objectLike({
                            ConnectionPool: {
                                HTTP: {
                                    MaxConnections: 100,
                                    MaxPendingRequests: 10,
                                },
                            },
                        }),
                    ],
                },
            });
        });
        test('Can add an tcp connection pool to listener', () => {
            // GIVEN
            const stack = new cdk.Stack();
            // WHEN
            const mesh = new appmesh.Mesh(stack, 'mesh', {
                meshName: 'test-mesh',
            });
            new appmesh.VirtualNode(stack, 'test-node', {
                mesh,
                listeners: [
                    appmesh.VirtualNodeListener.tcp({
                        port: 80,
                        connectionPool: {
                            maxConnections: 100,
                        },
                    }),
                ],
                serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
            });
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                Spec: {
                    Listeners: assertions_1.Match.arrayWith([
                        assertions_1.Match.objectLike({
                            ConnectionPool: {
                                TCP: {
                                    MaxConnections: 100,
                                },
                            },
                        }),
                    ]),
                },
            });
        });
        test('Can add an grpc connection pool to listener', () => {
            // GIVEN
            const stack = new cdk.Stack();
            // WHEN
            const mesh = new appmesh.Mesh(stack, 'mesh', {
                meshName: 'test-mesh',
            });
            new appmesh.VirtualNode(stack, 'test-node', {
                mesh,
                listeners: [
                    appmesh.VirtualNodeListener.grpc({
                        port: 80,
                        connectionPool: {
                            maxRequests: 10,
                        },
                    }),
                ],
                serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
            });
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                Spec: {
                    Listeners: assertions_1.Match.arrayWith([
                        assertions_1.Match.objectLike({
                            ConnectionPool: {
                                GRPC: {
                                    MaxRequests: 10,
                                },
                            },
                        }),
                    ]),
                },
            });
        });
        test('Can add an http2 connection pool to listener', () => {
            // GIVEN
            const stack = new cdk.Stack();
            // WHEN
            const mesh = new appmesh.Mesh(stack, 'mesh', {
                meshName: 'test-mesh',
            });
            new appmesh.VirtualNode(stack, 'test-node', {
                mesh,
                listeners: [
                    appmesh.VirtualNodeListener.http2({
                        port: 80,
                        connectionPool: {
                            maxRequests: 10,
                        },
                    }),
                ],
                serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
            });
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                Spec: {
                    Listeners: [
                        assertions_1.Match.objectLike({
                            ConnectionPool: {
                                HTTP2: {
                                    MaxRequests: 10,
                                },
                            },
                        }),
                    ],
                },
            });
        });
    });
    test('Can import Virtual Nodes using an ARN', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const meshName = 'testMesh';
        const virtualNodeName = 'test-node';
        const arn = `arn:aws:appmesh:us-east-1:123456789012:mesh/${meshName}/virtualNode/${virtualNodeName}`;
        // WHEN
        const virtualNode = appmesh.VirtualNode.fromVirtualNodeArn(stack, 'importedVirtualNode', arn);
        // THEN
        expect(virtualNode.mesh.meshName).toEqual(meshName);
        expect(virtualNode.virtualNodeName).toEqual(virtualNodeName);
    });
    test('Can import Virtual Nodes using attributes', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const meshName = 'testMesh';
        const virtualNodeName = 'test-node';
        // WHEN
        const virtualNode = appmesh.VirtualNode.fromVirtualNodeAttributes(stack, 'importedVirtualNode', {
            mesh: appmesh.Mesh.fromMeshName(stack, 'Mesh', meshName),
            virtualNodeName: virtualNodeName,
        });
        // THEN
        expect(virtualNode.mesh.meshName).toEqual(meshName);
        expect(virtualNode.virtualNodeName).toEqual(virtualNodeName);
    });
    test('Can grant an identity StreamAggregatedResources for a given VirtualNode', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const mesh = new appmesh.Mesh(stack, 'mesh', {
            meshName: 'test-mesh',
        });
        const node = new appmesh.VirtualNode(stack, 'test-node', {
            mesh,
            listeners: [appmesh.VirtualNodeListener.http({
                    port: 80,
                    tls: {
                        mode: appmesh.TlsMode.PERMISSIVE,
                        certificate: appmesh.TlsCertificate.file('path/to/certChain', 'path/to/privateKey'),
                    },
                })],
            serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
        });
        // WHEN
        const user = new iam.User(stack, 'test');
        node.grantStreamAggregatedResources(user);
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: [
                    {
                        Action: 'appmesh:StreamAggregatedResources',
                        Effect: 'Allow',
                        Resource: {
                            Ref: 'testnode3EE2776E',
                        },
                    },
                ],
            },
        });
    });
    describe('When creating a VirtualNode', () => {
        describe('with shared service mesh', () => {
            test('Mesh Owner is the AWS account ID of the account that shared the mesh with your account', () => {
                // GIVEN
                const app = new cdk.App();
                const meshEnv = { account: '1234567899', region: 'us-west-2' };
                const virtualNodeEnv = { account: '9987654321', region: 'us-west-2' };
                // Creating stack in Account 9987654321
                const stack = new cdk.Stack(app, 'mySharedStack', { env: virtualNodeEnv });
                // Mesh is in Account 1234567899
                const sharedMesh = appmesh.Mesh.fromMeshArn(stack, 'shared-mesh', `arn:aws:appmesh:${meshEnv.region}:${meshEnv.account}:mesh/shared-mesh`);
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh: sharedMesh,
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    MeshOwner: meshEnv.account,
                });
            });
        });
        describe('with DNS service discovery', () => {
            test('with basic configuration and without optional fields', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test'),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        ServiceDiscovery: {
                            DNS: {
                                Hostname: 'test',
                            },
                        },
                    },
                });
            });
            test('should allow set response type', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test', appmesh.DnsResponseType.LOAD_BALANCER),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        ServiceDiscovery: {
                            DNS: {
                                Hostname: 'test',
                                ResponseType: 'LOADBALANCER',
                            },
                        },
                    },
                });
            });
            test('has an IP Preference applied', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.dns('test', appmesh.DnsResponseType.LOAD_BALANCER, appmesh.IpPreference.IPV4_ONLY),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        ServiceDiscovery: {
                            DNS: {
                                Hostname: 'test',
                                ResponseType: 'LOADBALANCER',
                                IpPreference: 'IPv4_ONLY',
                            },
                        },
                    },
                });
            });
        });
        describe('with CloudMap service discovery', () => {
            test('with basic configuration and without optional fields', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const vpc = new ec2.Vpc(stack, 'vpc');
                const namespace = new cloudmap.PrivateDnsNamespace(stack, 'test-namespace', {
                    vpc,
                    name: 'domain.local',
                });
                const service = namespace.createService('Svc');
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.cloudMap(service),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        ServiceDiscovery: {
                            AWSCloudMap: {
                                NamespaceName: 'domain.local',
                                ServiceName: { 'Fn::GetAtt': ['testnamespaceSvcB55702EC', 'Name'] },
                            },
                        },
                    },
                });
            });
            test('has an IP Preference applied', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const vpc = new ec2.Vpc(stack, 'vpc');
                const namespace = new cloudmap.PrivateDnsNamespace(stack, 'test-namespace', {
                    vpc,
                    name: 'domain.local',
                });
                const service = namespace.createService('Svc');
                // WHEN
                new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                    serviceDiscovery: appmesh.ServiceDiscovery.cloudMap(service, undefined, appmesh.IpPreference.IPV4_ONLY),
                });
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::AppMesh::VirtualNode', {
                    Spec: {
                        ServiceDiscovery: {
                            AWSCloudMap: {
                                NamespaceName: 'domain.local',
                                ServiceName: { 'Fn::GetAtt': ['testnamespaceSvcB55702EC', 'Name'] },
                                IpPreference: 'IPv4_ONLY',
                            },
                        },
                    },
                });
            });
        });
        describe('with listener and without service discovery', () => {
            test('should throw an error', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const mesh = new appmesh.Mesh(stack, 'mesh', {
                    meshName: 'test-mesh',
                });
                const node = new appmesh.VirtualNode(stack, 'test-node', {
                    mesh,
                });
                // WHEN + THEN
                expect(() => {
                    new appmesh.VirtualNode(stack, 'test-node-2', {
                        mesh,
                        listeners: [appmesh.VirtualNodeListener.http()],
                    });
                }).toThrow(/Service discovery information is required for a VirtualNode with a listener/);
                expect(() => {
                    mesh.addVirtualNode('test-node-3', {
                        listeners: [appmesh.VirtualNodeListener.http()],
                    });
                }).toThrow(/Service discovery information is required for a VirtualNode with a listener/);
                expect(() => {
                    node.addListener(appmesh.VirtualNodeListener.http());
                }).toThrow(/Service discovery information is required for a VirtualNode with a listener/);
            });
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlydHVhbC1ub2RlLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2aXJ0dWFsLW5vZGUudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlEQUFtRDtBQUNuRCwyQ0FBMkM7QUFDM0Msb0RBQW9EO0FBQ3BELHFDQUFxQztBQUNyQyxxQ0FBcUM7QUFDckMsdURBQXVEO0FBQ3ZELGtDQUFrQztBQUNsQyxrQ0FBa0M7QUFFbEMsUUFBUSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUU7SUFDNUIsUUFBUSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtRQUM1QyxRQUFRLENBQUMsMENBQTBDLEVBQUUsR0FBRyxFQUFFO1lBQ3hELElBQUksQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUU7Z0JBQ3JELFFBQVE7Z0JBQ1IsTUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7Z0JBRTlCLE9BQU87Z0JBQ1AsTUFBTSxJQUFJLEdBQUcsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUU7b0JBQzNDLFFBQVEsRUFBRSxXQUFXO2lCQUN0QixDQUFDLENBQUM7Z0JBRUgsTUFBTSxRQUFRLEdBQUcsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUU7b0JBQzlELGtCQUFrQixFQUFFLHVCQUF1QjtvQkFDM0Msc0JBQXNCLEVBQUUsT0FBTyxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7aUJBQ2xFLENBQUMsQ0FBQztnQkFDSCxNQUFNLFFBQVEsR0FBRyxJQUFJLE9BQU8sQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRTtvQkFDOUQsa0JBQWtCLEVBQUUsdUJBQXVCO29CQUMzQyxzQkFBc0IsRUFBRSxPQUFPLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztpQkFDbEUsQ0FBQyxDQUFDO2dCQUVILE1B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QkFDVixJQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLGFBQWEsRUFBRTt3QkFDNUMsSUFBSTt3QkFDSixTQUFTLEVBQUUsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsSUFBSSxFQUFFLENBQUM7cUJBQ2hELENBQUMsQ0FBQztnQkFDTCxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsNkVBQTZFLENBQUMsQ0FBQztnQkFFMUYsTUFBTSxDQUFDLEdBQUcsRUFBRTtvQkFDVixJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsRUFBRTt3QkFDakMsU0FBUyxFQUFFLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLElBQUksRUFBRSxDQUFDO3FCQUNoRCxDQUFDLENBQUM7Z0JBQ0wsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLDZFQUE2RSxDQUFDLENBQUM7Z0JBRTFGLE1BQU0sQ0FBQyxHQUFHLEVBQUU7b0JBQ1YsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztnQkFDdkQsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLDZFQUE2RSxDQUFDLENBQUM7WUFDNUYsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYXRjaCwgVGVtcGxhdGUgfSBmcm9tICcuLi8uLi9hc3NlcnRpb25zJztcbmltcG9ydCAqIGFzIGFjbXBjYSBmcm9tICcuLi8uLi9hd3MtYWNtcGNhJztcbmltcG9ydCAqIGFzIGFjbSBmcm9tICcuLi8uLi9hd3MtY2VydGlmaWNhdGVtYW5hZ2VyJztcbmltcG9ydCAqIGFzIGVjMiBmcm9tICcuLi8uLi9hd3MtZWMyJztcbmltcG9ydCAqIGFzIGlhbSBmcm9tICcuLi8uLi9hd3MtaWFtJztcbmltcG9ydCAqIGFzIGNsb3VkbWFwIGZyb20gJy4uLy4uL2F3cy1zZXJ2aWNlZGlzY292ZXJ5JztcbmltcG9ydCAqIGFzIGNkayBmcm9tICcuLi8uLi9jb3JlJztcbmltcG9ydCAqIGFzIGFwcG1lc2ggZnJvbSAnLi4vbGliJztcblxuZGVzY3JpYmUoJ3ZpcnR1YWwgbm9kZScsICgpID0+IHtcbiAgZGVzY3JpYmUoJ1doZW4gYW4gZXhpc3RpbmcgVmlydHVhbE5vZGUnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ3dpdGggZXhpc3RpbmcgYmFja2VuZHMsIGFkZHMgbmV3IGJhY2tlbmQnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgYWRkIHJlc291cmNlIHdpdGggc2VydmljZSBiYWNrZW5kcycsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBjb25zdCBtZXNoID0gbmV3IGFwcG1lc2guTWVzaChzdGFjaywgJ21lc2gnLCB7XG4gICAgICAgICAgbWVzaE5hbWU6ICd0ZXN0LW1lc2gnLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBzZXJ2aWNlMSA9IG5ldyBhcHBtZXNoLlZpcnR1YWxTZXJ2aWNlKHN0YWNrLCAnc2VydmljZS0xJywge1xuICAgICAgICAgIHZpcnR1YWxTZXJ2aWNlTmFtZTogJ3NlcnZpY2UxLmRvbWFpbi5sb2NhbCcsXG4gICAgICAgICAgdmlydHVhbFNlcnZpY2VQcm92aWRlcjogYXBwbWVzaC5WaXJ0dWFsU2VydmljZVByb3ZpZGVyLm5vbmUobWVzaCksXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzZXJ2aWNlMiA9IG5ldyBhcHBtZXNoLlZpcnR1YWxTZXJ2aWNlKHN0YWNrLCAnc2VydmljZS0yJywge1xuICAgICAgICAgIHZpcnR1YWxTZXJ2aWNlTmFtZTogJ3NlcnZpY2UyLmRvbWFpbi5sb2NhbCcsXG4gICAgICAgICAgdmlydHVhbFNlcnZpY2VQcm92aWRlcjogYXBwbWVzaC5WaXJ0dWFsU2VydmljZVByb3ZpZGVyLm5vbmUobWVzaCksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG5vZGUgPSBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgICBiYWNrZW5kczogW2FwcG1lc2guQmFja2VuZC52aXJ0dWFsU2VydmljZShzZXJ2aWNlMSldLFxuICAgICAgICB9KTtcblxuICAgICAgICBub2RlLmFkZEJhY2tlbmQoYXBwbWVzaC5CYWNrZW5kLnZpcnR1YWxTZXJ2aWNlKHNlcnZpY2UyKSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBCYWNrZW5kczogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgVmlydHVhbFNlcnZpY2U6IHtcbiAgICAgICAgICAgICAgICAgIFZpcnR1YWxTZXJ2aWNlTmFtZTogJ3NlcnZpY2UxLmRvbWFpbi5sb2NhbCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFZpcnR1YWxTZXJ2aWNlOiB7XG4gICAgICAgICAgICAgICAgICBWaXJ0dWFsU2VydmljZU5hbWU6ICdzZXJ2aWNlMi5kb21haW4ubG9jYWwnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgTWVzaE93bmVyOiBNYXRjaC5hYnNlbnQoKSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3aGVuIGEgc2luZ2xlIHBvcnRtYXBwaW5nIGlzIGFkZGVkJywgKCkgPT4ge1xuICAgICAgdGVzdCgnc2hvdWxkIGFkZCB0aGUgcG9ydG1hcHBpbmcgdG8gdGhlIHJlc291cmNlJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG5vZGUgPSBtZXNoLmFkZFZpcnR1YWxOb2RlKCd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgICB9KTtcblxuICAgICAgICBub2RlLmFkZExpc3RlbmVyKGFwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci50Y3Aoe1xuICAgICAgICAgIHBvcnQ6IDgwODEsXG4gICAgICAgIH0pKTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgUG9ydE1hcHBpbmc6IHtcbiAgICAgICAgICAgICAgICAgIFBvcnQ6IDgwODEsXG4gICAgICAgICAgICAgICAgICBQcm90b2NvbDogJ3RjcCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3aGVuIGEgbGlzdGVuZXIgaXMgYWRkZWQgd2l0aCB0aW1lb3V0JywgKCkgPT4ge1xuICAgICAgdGVzdCgnc2hvdWxkIGFkZCB0aGUgbGlzdGVuZXIgdGltZW91dCB0byB0aGUgcmVzb3VyY2UnLCAoKSA9PiB7XG4gICAgICAgIC8vIEdJVkVOXG4gICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgbWVzaCxcbiAgICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuZG5zKCd0ZXN0JyksXG4gICAgICAgICAgbGlzdGVuZXJzOiBbYXBwbWVzaC5WaXJ0dWFsTm9kZUxpc3RlbmVyLmdycGMoe1xuICAgICAgICAgICAgcG9ydDogODAsXG4gICAgICAgICAgICB0aW1lb3V0OiB7XG4gICAgICAgICAgICAgIGlkbGU6IGNkay5EdXJhdGlvbi5zZWNvbmRzKDEwKSxcbiAgICAgICAgICAgICAgcGVyUmVxdWVzdDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMTApLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KV0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwTWVzaDo6VmlydHVhbE5vZGUnLCB7XG4gICAgICAgICAgU3BlYzoge1xuICAgICAgICAgICAgTGlzdGVuZXJzOiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBQb3J0TWFwcGluZzoge1xuICAgICAgICAgICAgICAgICAgUG9ydDogODAsXG4gICAgICAgICAgICAgICAgICBQcm90b2NvbDogJ2dycGMnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgVGltZW91dDoge1xuICAgICAgICAgICAgICAgICAgR1JQQzoge1xuICAgICAgICAgICAgICAgICAgICBJZGxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgVW5pdDogJ21zJyxcbiAgICAgICAgICAgICAgICAgICAgICBWYWx1ZTogMTAwMDAsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFBlclJlcXVlc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICBVbml0OiAnbXMnLFxuICAgICAgICAgICAgICAgICAgICAgIFZhbHVlOiAxMDAwMCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3aGVuIGEgbGlzdGVuZXIgaXMgYWRkZWQgd2l0aCBoZWFsdGhjaGVjayAnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgYWRkIGEgZGVmYXVsdCBsaXN0ZW5lciBoZWFsdGhjaGVjayB0byB0aGUgcmVzb3VyY2UnLCAoKSA9PiB7XG4gICAgICAgIC8vIEdJVkVOXG4gICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgbWVzaCxcbiAgICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuZG5zKCd0ZXN0JyksXG4gICAgICAgICAgbGlzdGVuZXJzOiBbYXBwbWVzaC5WaXJ0dWFsTm9kZUxpc3RlbmVyLmh0dHAyKHtcbiAgICAgICAgICAgIHBvcnQ6IDgwLFxuICAgICAgICAgICAgaGVhbHRoQ2hlY2s6IGFwcG1lc2guSGVhbHRoQ2hlY2suaHR0cDIoKSxcbiAgICAgICAgICAgIHRpbWVvdXQ6IHsgaWRsZTogY2RrLkR1cmF0aW9uLnNlY29uZHMoMTApIH0sXG4gICAgICAgICAgfSldLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICAgICAgICBIZWFsdGhDaGVjazoge1xuICAgICAgICAgICAgICAgICAgSGVhbHRoeVRocmVzaG9sZDogMixcbiAgICAgICAgICAgICAgICAgIEludGVydmFsTWlsbGlzOiA1MDAwLFxuICAgICAgICAgICAgICAgICAgUG9ydDogODAsXG4gICAgICAgICAgICAgICAgICBQcm90b2NvbDogJ2h0dHAyJyxcbiAgICAgICAgICAgICAgICAgIFRpbWVvdXRNaWxsaXM6IDIwMDAsXG4gICAgICAgICAgICAgICAgICBVbmhlYWx0aHlUaHJlc2hvbGQ6IDIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBQb3J0TWFwcGluZzoge1xuICAgICAgICAgICAgICAgICAgUG9ydDogODAsXG4gICAgICAgICAgICAgICAgICBQcm90b2NvbDogJ2h0dHAyJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFRpbWVvdXQ6IHtcbiAgICAgICAgICAgICAgICAgIEhUVFAyOiB7XG4gICAgICAgICAgICAgICAgICAgIElkbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICBVbml0OiAnbXMnLFxuICAgICAgICAgICAgICAgICAgICAgIFZhbHVlOiAxMDAwMCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2hlbiBhIGxpc3RlbmVyIGlzIGFkZGVkIHdpdGggaGVhbHRoY2hlY2sgd2l0aCB1c2VyIGRlZmluZWQgcHJvcHMnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgYWRkIGEgbGlzdGVuZXIgaGVhbHRoY2hlY2sgdG8gdGhlIHJlc291cmNlJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG5vZGUgPSBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbm9kZS5hZGRMaXN0ZW5lcihhcHBtZXNoLlZpcnR1YWxOb2RlTGlzdGVuZXIudGNwKHtcbiAgICAgICAgICBwb3J0OiA4MCxcbiAgICAgICAgICBoZWFsdGhDaGVjazogYXBwbWVzaC5IZWFsdGhDaGVjay50Y3Aoe1xuICAgICAgICAgICAgdGltZW91dDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMyksXG4gICAgICAgICAgfSksXG4gICAgICAgICAgdGltZW91dDogeyBpZGxlOiBjZGsuRHVyYXRpb24uc2Vjb25kcygxMCkgfSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwTWVzaDo6VmlydHVhbE5vZGUnLCB7XG4gICAgICAgICAgU3BlYzoge1xuICAgICAgICAgICAgTGlzdGVuZXJzOiBbXG4gICAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgICAgICAgIEhlYWx0aENoZWNrOiB7XG4gICAgICAgICAgICAgICAgICBIZWFsdGh5VGhyZXNob2xkOiAyLFxuICAgICAgICAgICAgICAgICAgSW50ZXJ2YWxNaWxsaXM6IDUwMDAsXG4gICAgICAgICAgICAgICAgICBQb3J0OiA4MCxcbiAgICAgICAgICAgICAgICAgIFByb3RvY29sOiAndGNwJyxcbiAgICAgICAgICAgICAgICAgIFRpbWVvdXRNaWxsaXM6IDMwMDAsXG4gICAgICAgICAgICAgICAgICBVbmhlYWx0aHlUaHJlc2hvbGQ6IDIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBQb3J0TWFwcGluZzoge1xuICAgICAgICAgICAgICAgICAgUG9ydDogODAsXG4gICAgICAgICAgICAgICAgICBQcm90b2NvbDogJ3RjcCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBUaW1lb3V0OiB7XG4gICAgICAgICAgICAgICAgICBUQ1A6IHtcbiAgICAgICAgICAgICAgICAgICAgSWRsZToge1xuICAgICAgICAgICAgICAgICAgICAgIFVuaXQ6ICdtcycsXG4gICAgICAgICAgICAgICAgICAgICAgVmFsdWU6IDEwMDAwLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3aGVuIGEgbGlzdGVuZXIgaXMgYWRkZWQgd2l0aCBvdXRsaWVyIGRldGVjdGlvbiB3aXRoIHVzZXIgZGVmaW5lZCBwcm9wcycsICgpID0+IHtcbiAgICAgIHRlc3QoJ3Nob3VsZCBhZGQgYSBsaXN0ZW5lciBvdXRsaWVyIGRldGVjdGlvbiB0byB0aGUgcmVzb3VyY2UnLCAoKSA9PiB7XG4gICAgICAgIC8vIEdJVkVOXG4gICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBhcHBtZXNoLlZpcnR1YWxOb2RlKHN0YWNrLCAndGVzdC1ub2RlJywge1xuICAgICAgICAgIG1lc2gsXG4gICAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgICB9KTtcblxuICAgICAgICBub2RlLmFkZExpc3RlbmVyKGFwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci50Y3Aoe1xuICAgICAgICAgIHBvcnQ6IDgwLFxuICAgICAgICAgIG91dGxpZXJEZXRlY3Rpb246IHtcbiAgICAgICAgICAgIGJhc2VFamVjdGlvbkR1cmF0aW9uOiBjZGsuRHVyYXRpb24uc2Vjb25kcygxMCksXG4gICAgICAgICAgICBpbnRlcnZhbDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMzApLFxuICAgICAgICAgICAgbWF4RWplY3Rpb25QZXJjZW50OiA1MCxcbiAgICAgICAgICAgIG1heFNlcnZlckVycm9yczogNSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBMaXN0ZW5lcnM6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIE91dGxpZXJEZXRlY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgIEJhc2VFamVjdGlvbkR1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIFVuaXQ6ICdtcycsXG4gICAgICAgICAgICAgICAgICAgIFZhbHVlOiAxMDAwMCxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBJbnRlcnZhbDoge1xuICAgICAgICAgICAgICAgICAgICBVbml0OiAnbXMnLFxuICAgICAgICAgICAgICAgICAgICBWYWx1ZTogMzAwMDAsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgTWF4RWplY3Rpb25QZXJjZW50OiA1MCxcbiAgICAgICAgICAgICAgICAgIE1heFNlcnZlckVycm9yczogNSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFBvcnRNYXBwaW5nOiB7XG4gICAgICAgICAgICAgICAgICBQb3J0OiA4MCxcbiAgICAgICAgICAgICAgICAgIFByb3RvY29sOiAndGNwJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3doZW4gYSBkZWZhdWx0IGJhY2tlbmQgaXMgYWRkZWQnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgYWRkIGEgYmFja2VuZCBkZWZhdWx0IHRvIHRoZSByZXNvdXJjZScsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBjb25zdCBtZXNoID0gbmV3IGFwcG1lc2guTWVzaChzdGFjaywgJ21lc2gnLCB7XG4gICAgICAgICAgbWVzaE5hbWU6ICd0ZXN0LW1lc2gnLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjZXJ0aWZpY2F0ZUF1dGhvcml0eUFybiA9ICdhcm46YXdzOmFjbS1wY2E6dXMtZWFzdC0xOjEyMzQ1Njc4OTAxMjpjZXJ0aWZpY2F0ZS1hdXRob3JpdHkvMTIzNDU2NzgtMTIzNC0xMjM0LTEyMzQtMTIzNDU2Nzg5MDEyJztcblxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgICBiYWNrZW5kRGVmYXVsdHM6IHtcbiAgICAgICAgICAgIHRsc0NsaWVudFBvbGljeToge1xuICAgICAgICAgICAgICBwb3J0czogWzgwODAsIDgwODFdLFxuICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgdHJ1c3Q6IGFwcG1lc2guVGxzVmFsaWRhdGlvblRydXN0LmFjbShbYWNtcGNhLkNlcnRpZmljYXRlQXV0aG9yaXR5LmZyb21DZXJ0aWZpY2F0ZUF1dGhvcml0eUFybihzdGFjaywgJ2NlcnRpZmljYXRlJywgY2VydGlmaWNhdGVBdXRob3JpdHlBcm4pXSksXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwTWVzaDo6VmlydHVhbE5vZGUnLCB7XG4gICAgICAgICAgU3BlYzoge1xuICAgICAgICAgICAgQmFja2VuZERlZmF1bHRzOiB7XG4gICAgICAgICAgICAgIENsaWVudFBvbGljeToge1xuICAgICAgICAgICAgICAgIFRMUzoge1xuICAgICAgICAgICAgICAgICAgUG9ydHM6IFs4MDgwLCA4MDgxXSxcbiAgICAgICAgICAgICAgICAgIFZhbGlkYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgVHJ1c3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICBBQ006IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIENlcnRpZmljYXRlQXV0aG9yaXR5QXJuczogW2Ake2NlcnRpZmljYXRlQXV0aG9yaXR5QXJufWBdLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcIndpdGggY2xpZW50J3MgVExTIGNlcnRpZmljYXRlIGZyb20gU0RTXCIsICgpID0+IHtcbiAgICAgIHRlc3QoJ3Nob3VsZCBhZGQgYSBiYWNrZW5kIGRlZmF1bHQgdG8gdGhlIHJlc291cmNlIHdpdGggVExTIGNlcnRpZmljYXRlJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgICBiYWNrZW5kRGVmYXVsdHM6IHtcbiAgICAgICAgICAgIHRsc0NsaWVudFBvbGljeToge1xuICAgICAgICAgICAgICBtdXR1YWxUbHNDZXJ0aWZpY2F0ZTogYXBwbWVzaC5UbHNDZXJ0aWZpY2F0ZS5zZHMoJ3NlY3JldF9jZXJ0aWZpY2F0ZScpLFxuICAgICAgICAgICAgICBwb3J0czogWzgwODAsIDgwODFdLFxuICAgICAgICAgICAgICB2YWxpZGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgc3ViamVjdEFsdGVybmF0aXZlTmFtZXM6IGFwcG1lc2guU3ViamVjdEFsdGVybmF0aXZlTmFtZXMubWF0Y2hpbmdFeGFjdGx5KCdtZXNoLWVuZHBvaW50LmFwcHMubG9jYWwnKSxcbiAgICAgICAgICAgICAgICB0cnVzdDogYXBwbWVzaC5UbHNWYWxpZGF0aW9uVHJ1c3Quc2RzKCdzZWNyZXRfdmFsaWRhdGlvbicpLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIEJhY2tlbmREZWZhdWx0czoge1xuICAgICAgICAgICAgICBDbGllbnRQb2xpY3k6IHtcbiAgICAgICAgICAgICAgICBUTFM6IHtcbiAgICAgICAgICAgICAgICAgIENlcnRpZmljYXRlOiB7XG4gICAgICAgICAgICAgICAgICAgIFNEUzoge1xuICAgICAgICAgICAgICAgICAgICAgIFNlY3JldE5hbWU6ICdzZWNyZXRfY2VydGlmaWNhdGUnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIFBvcnRzOiBbODA4MCwgODA4MV0sXG4gICAgICAgICAgICAgICAgICBWYWxpZGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIFN1YmplY3RBbHRlcm5hdGl2ZU5hbWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgTWF0Y2g6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEV4YWN0OiBbJ21lc2gtZW5kcG9pbnQuYXBwcy5sb2NhbCddLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFRydXN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgU0RTOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBTZWNyZXROYW1lOiAnc2VjcmV0X3ZhbGlkYXRpb24nLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2hlbiBhIGJhY2tlbmQgaXMgYWRkZWQnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCdzaG91bGQgYWRkIGEgYmFja2VuZCB2aXJ0dWFsIHNlcnZpY2UgdG8gdGhlIHJlc291cmNlJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG5vZGUgPSBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3Qgc2VydmljZTEgPSBuZXcgYXBwbWVzaC5WaXJ0dWFsU2VydmljZShzdGFjaywgJ3NlcnZpY2UtMScsIHtcbiAgICAgICAgICB2aXJ0dWFsU2VydmljZU5hbWU6ICdzZXJ2aWNlMS5kb21haW4ubG9jYWwnLFxuICAgICAgICAgIHZpcnR1YWxTZXJ2aWNlUHJvdmlkZXI6IGFwcG1lc2guVmlydHVhbFNlcnZpY2VQcm92aWRlci5ub25lKG1lc2gpLFxuICAgICAgICB9KTtcblxuICAgICAgICBub2RlLmFkZEJhY2tlbmQoYXBwbWVzaC5CYWNrZW5kLnZpcnR1YWxTZXJ2aWNlKHNlcnZpY2UxLCB7XG4gICAgICAgICAgdGxzQ2xpZW50UG9saWN5OiB7XG4gICAgICAgICAgICBwb3J0czogWzgwODAsIDgwODFdLFxuICAgICAgICAgICAgdmFsaWRhdGlvbjoge1xuICAgICAgICAgICAgICB0cnVzdDogYXBwbWVzaC5UbHNWYWxpZGF0aW9uVHJ1c3QuZmlsZSgncGF0aC10by1jZXJ0aWZpY2F0ZScpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBCYWNrZW5kczogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgVmlydHVhbFNlcnZpY2U6IHtcbiAgICAgICAgICAgICAgICAgIFZpcnR1YWxTZXJ2aWNlTmFtZTogJ3NlcnZpY2UxLmRvbWFpbi5sb2NhbCcsXG4gICAgICAgICAgICAgICAgICBDbGllbnRQb2xpY3k6IHtcbiAgICAgICAgICAgICAgICAgICAgVExTOiB7XG4gICAgICAgICAgICAgICAgICAgICAgUG9ydHM6IFs4MDgwLCA4MDgxXSxcbiAgICAgICAgICAgICAgICAgICAgICBWYWxpZGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBUcnVzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBGaWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2VydGlmaWNhdGVDaGFpbjogJ3BhdGgtdG8tY2VydGlmaWNhdGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KCd5b3UgY2FuIGFkZCBhIFZpcnR1YWwgU2VydmljZSBhcyBhIGJhY2tlbmQgdG8gYSBWaXJ0dWFsIE5vZGUgd2hpY2ggaXMgdGhlIHByb3ZpZGVyIGZvciB0aGF0IFZpcnR1YWwgU2VydmljZScsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBjb25zdCBtZXNoID0gbmV3IGFwcG1lc2guTWVzaChzdGFjaywgJ21lc2gnLCB7XG4gICAgICAgICAgbWVzaE5hbWU6ICd0ZXN0LW1lc2gnLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBub2RlID0gbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgbWVzaCxcbiAgICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuZG5zKCd0ZXN0JyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG15VmlydHVhbFNlcnZpY2UgPSBuZXcgYXBwbWVzaC5WaXJ0dWFsU2VydmljZShzdGFjaywgJ3NlcnZpY2UtMScsIHtcbiAgICAgICAgICB2aXJ0dWFsU2VydmljZVByb3ZpZGVyOiBhcHBtZXNoLlZpcnR1YWxTZXJ2aWNlUHJvdmlkZXIudmlydHVhbE5vZGUobm9kZSksXG4gICAgICAgICAgdmlydHVhbFNlcnZpY2VOYW1lOiAnc2VydmljZTEuZG9tYWluLmxvY2FsJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbm9kZS5hZGRCYWNrZW5kKGFwcG1lc2guQmFja2VuZC52aXJ0dWFsU2VydmljZShteVZpcnR1YWxTZXJ2aWNlKSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBCYWNrZW5kczogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgVmlydHVhbFNlcnZpY2U6IHtcbiAgICAgICAgICAgICAgICAgIFZpcnR1YWxTZXJ2aWNlTmFtZTogJ3NlcnZpY2UxLmRvbWFpbi5sb2NhbCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgdGVzdCgneW91IGNhbiBhZGQgYSBWaXJ0dWFsIFNlcnZpY2Ugd2l0aCBhbiBhdXRvbWF0ZWQgbmFtZSBhcyBhIGJhY2tlbmQgdG8gYSBWaXJ0dWFsIE5vZGUgd2hpY2ggaXMgdGhlIHByb3ZpZGVyIGZvciB0aGF0IFZpcnR1YWwgU2VydmljZSwgJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IG5vZGUgPSBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgbXlWaXJ0dWFsU2VydmljZSA9IG5ldyBhcHBtZXNoLlZpcnR1YWxTZXJ2aWNlKHN0YWNrLCAnc2VydmljZS0xJywge1xuICAgICAgICAgIHZpcnR1YWxTZXJ2aWNlUHJvdmlkZXI6IGFwcG1lc2guVmlydHVhbFNlcnZpY2VQcm92aWRlci52aXJ0dWFsTm9kZShub2RlKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbm9kZS5hZGRCYWNrZW5kKGFwcG1lc2guQmFja2VuZC52aXJ0dWFsU2VydmljZShteVZpcnR1YWxTZXJ2aWNlKSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBCYWNrZW5kczogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgVmlydHVhbFNlcnZpY2U6IHtcbiAgICAgICAgICAgICAgICAgIFZpcnR1YWxTZXJ2aWNlTmFtZTogJ3NlcnZpY2UxJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3doZW4gYSBncnBjIGxpc3RlbmVyIGlzIGFkZGVkIHdpdGggYSBUTFMgY2VydGlmaWNhdGUgZnJvbSBBQ00nLCAoKSA9PiB7XG4gICAgICB0ZXN0KCd0aGUgbGlzdGVuZXIgc2hvdWxkIGluY2x1ZGUgdGhlIFRMUyBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGNlcnQgPSBuZXcgYWNtLkNlcnRpZmljYXRlKHN0YWNrLCAnY2VydCcsIHtcbiAgICAgICAgICBkb21haW5OYW1lOiAnJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgbWVzaCxcbiAgICAgICAgICBsaXN0ZW5lcnM6IFthcHBtZXNoLlZpcnR1YWxOb2RlTGlzdGVuZXIuZ3JwYyh7XG4gICAgICAgICAgICBwb3J0OiA4MCxcbiAgICAgICAgICAgIHRsczoge1xuICAgICAgICAgICAgICBtb2RlOiBhcHBtZXNoLlRsc01vZGUuU1RSSUNULFxuICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZTogYXBwbWVzaC5UbHNDZXJ0aWZpY2F0ZS5hY20oY2VydCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgKV0sXG4gICAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICAgICAgICBUTFM6IHtcbiAgICAgICAgICAgICAgICAgIE1vZGU6IGFwcG1lc2guVGxzTW9kZS5TVFJJQ1QsXG4gICAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0ZToge1xuICAgICAgICAgICAgICAgICAgICBBQ006IHtcbiAgICAgICAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0ZUFybjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgUmVmOiAnY2VydDU2Q0E5NEVCJyxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3aGVuIGFuIGh0dHAgbGlzdGVuZXIgaXMgYWRkZWQgd2l0aCBhIFRMUyBjZXJ0aWZpY2F0ZSBmcm9tIGZpbGUnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCd0aGUgbGlzdGVuZXIgc2hvdWxkIGluY2x1ZGUgdGhlIFRMUyBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBhcHBtZXNoLlZpcnR1YWxOb2RlKHN0YWNrLCAndGVzdC1ub2RlJywge1xuICAgICAgICAgIG1lc2gsXG4gICAgICAgICAgbGlzdGVuZXJzOiBbYXBwbWVzaC5WaXJ0dWFsTm9kZUxpc3RlbmVyLmh0dHAoe1xuICAgICAgICAgICAgcG9ydDogODAsXG4gICAgICAgICAgICB0bHM6IHtcbiAgICAgICAgICAgICAgbW9kZTogYXBwbWVzaC5UbHNNb2RlLlNUUklDVCxcbiAgICAgICAgICAgICAgY2VydGlmaWNhdGU6IGFwcG1lc2guVGxzQ2VydGlmaWNhdGUuZmlsZSgncGF0aC90by9jZXJ0Q2hhaW4nLCAncGF0aC90by9wcml2YXRlS2V5JyksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pXSxcbiAgICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuZG5zKCd0ZXN0JyksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwTWVzaDo6VmlydHVhbE5vZGUnLCB7XG4gICAgICAgICAgU3BlYzoge1xuICAgICAgICAgICAgTGlzdGVuZXJzOiBbXG4gICAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgICAgICAgIFRMUzoge1xuICAgICAgICAgICAgICAgICAgTW9kZTogYXBwbWVzaC5UbHNNb2RlLlNUUklDVCxcbiAgICAgICAgICAgICAgICAgIENlcnRpZmljYXRlOiB7XG4gICAgICAgICAgICAgICAgICAgIEZpbGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0ZUNoYWluOiAncGF0aC90by9jZXJ0Q2hhaW4nLFxuICAgICAgICAgICAgICAgICAgICAgIFByaXZhdGVLZXk6ICdwYXRoL3RvL3ByaXZhdGVLZXknLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3aGVuIGFuIGh0dHAyIGxpc3RlbmVyIGlzIGFkZGVkIHdpdGggYSBUTFMgY2VydGlmaWNhdGUgZnJvbSBTRFMnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCd0aGUgbGlzdGVuZXIgc2hvdWxkIGluY2x1ZGUgdGhlIFRMUyBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIGxpc3RlbmVyczogW2FwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci5odHRwMih7XG4gICAgICAgICAgICBwb3J0OiA4MCxcbiAgICAgICAgICAgIHRsczoge1xuICAgICAgICAgICAgICBtb2RlOiBhcHBtZXNoLlRsc01vZGUuU1RSSUNULFxuICAgICAgICAgICAgICBjZXJ0aWZpY2F0ZTogYXBwbWVzaC5UbHNDZXJ0aWZpY2F0ZS5zZHMoJ3NlY3JldF9jZXJ0aWZpY2F0ZScpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KV0sXG4gICAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICAgICAgICBUTFM6IHtcbiAgICAgICAgICAgICAgICAgIE1vZGU6IGFwcG1lc2guVGxzTW9kZS5TVFJJQ1QsXG4gICAgICAgICAgICAgICAgICBDZXJ0aWZpY2F0ZToge1xuICAgICAgICAgICAgICAgICAgICBTRFM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBTZWNyZXROYW1lOiAnc2VjcmV0X2NlcnRpZmljYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2hlbiBhbiBodHRwIGxpc3RlbmVyIGlzIGFkZGVkIHdpdGggdGhlIFRMUyBtb2RlIHBlcm1pc3NpdmUnLCAoKSA9PiB7XG4gICAgICB0ZXN0KCd0aGUgbGlzdGVuZXIgc2hvdWxkIGluY2x1ZGUgdGhlIFRMUyBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBhcHBtZXNoLlZpcnR1YWxOb2RlKHN0YWNrLCAndGVzdC1ub2RlJywge1xuICAgICAgICAgIG1lc2gsXG4gICAgICAgICAgbGlzdGVuZXJzOiBbYXBwbWVzaC5WaXJ0dWFsTm9kZUxpc3RlbmVyLmh0dHAoe1xuICAgICAgICAgICAgcG9ydDogODAsXG4gICAgICAgICAgICB0bHM6IHtcbiAgICAgICAgICAgICAgbW9kZTogYXBwbWVzaC5UbHNNb2RlLlBFUk1JU1NJVkUsXG4gICAgICAgICAgICAgIGNlcnRpZmljYXRlOiBhcHBtZXNoLlRsc0NlcnRpZmljYXRlLmZpbGUoJ3BhdGgvdG8vY2VydENoYWluJywgJ3BhdGgvdG8vcHJpdmF0ZUtleScpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KV0sXG4gICAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICAgICAgICBUTFM6IHtcbiAgICAgICAgICAgICAgICAgIE1vZGU6IGFwcG1lc2guVGxzTW9kZS5QRVJNSVNTSVZFLFxuICAgICAgICAgICAgICAgICAgQ2VydGlmaWNhdGU6IHtcbiAgICAgICAgICAgICAgICAgICAgRmlsZToge1xuICAgICAgICAgICAgICAgICAgICAgIENlcnRpZmljYXRlQ2hhaW46ICdwYXRoL3RvL2NlcnRDaGFpbicsXG4gICAgICAgICAgICAgICAgICAgICAgUHJpdmF0ZUtleTogJ3BhdGgvdG8vcHJpdmF0ZUtleScsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnQ2FuIGFkZCBhbiBodHRwIGNvbm5lY3Rpb24gcG9vbCB0byBsaXN0ZW5lcicsICgpID0+IHtcbiAgICAgIC8vIEdJVkVOXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICB9KTtcblxuICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgIG1lc2gsXG4gICAgICAgIGxpc3RlbmVyczogW1xuICAgICAgICAgIGFwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci5odHRwKHtcbiAgICAgICAgICAgIHBvcnQ6IDgwLFxuICAgICAgICAgICAgY29ubmVjdGlvblBvb2w6IHtcbiAgICAgICAgICAgICAgbWF4Q29ubmVjdGlvbnM6IDEwMCxcbiAgICAgICAgICAgICAgbWF4UGVuZGluZ1JlcXVlc3RzOiAxMCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSksXG4gICAgICAgIF0sXG4gICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgU3BlYzoge1xuICAgICAgICAgIExpc3RlbmVyczogW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgICAgIENvbm5lY3Rpb25Qb29sOiB7XG4gICAgICAgICAgICAgICAgSFRUUDoge1xuICAgICAgICAgICAgICAgICAgTWF4Q29ubmVjdGlvbnM6IDEwMCxcbiAgICAgICAgICAgICAgICAgIE1heFBlbmRpbmdSZXF1ZXN0czogMTAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ0NhbiBhZGQgYW4gdGNwIGNvbm5lY3Rpb24gcG9vbCB0byBsaXN0ZW5lcicsICgpID0+IHtcbiAgICAgIC8vIEdJVkVOXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICB9KTtcblxuICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgIG1lc2gsXG4gICAgICAgIGxpc3RlbmVyczogW1xuICAgICAgICAgIGFwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci50Y3Aoe1xuICAgICAgICAgICAgcG9ydDogODAsXG4gICAgICAgICAgICBjb25uZWN0aW9uUG9vbDoge1xuICAgICAgICAgICAgICBtYXhDb25uZWN0aW9uczogMTAwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSxcbiAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgTGlzdGVuZXJzOiBNYXRjaC5hcnJheVdpdGgoW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgICAgIENvbm5lY3Rpb25Qb29sOiB7XG4gICAgICAgICAgICAgICAgVENQOiB7XG4gICAgICAgICAgICAgICAgICBNYXhDb25uZWN0aW9uczogMTAwLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICBdKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnQ2FuIGFkZCBhbiBncnBjIGNvbm5lY3Rpb24gcG9vbCB0byBsaXN0ZW5lcicsICgpID0+IHtcbiAgICAgIC8vIEdJVkVOXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICBtZXNoTmFtZTogJ3Rlc3QtbWVzaCcsXG4gICAgICB9KTtcblxuICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgIG1lc2gsXG4gICAgICAgIGxpc3RlbmVyczogW1xuICAgICAgICAgIGFwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci5ncnBjKHtcbiAgICAgICAgICAgIHBvcnQ6IDgwLFxuICAgICAgICAgICAgY29ubmVjdGlvblBvb2w6IHtcbiAgICAgICAgICAgICAgbWF4UmVxdWVzdHM6IDEwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSxcbiAgICAgICAgc2VydmljZURpc2NvdmVyeTogYXBwbWVzaC5TZXJ2aWNlRGlzY292ZXJ5LmRucygndGVzdCcpLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgTGlzdGVuZXJzOiBNYXRjaC5hcnJheVdpdGgoW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgICAgIENvbm5lY3Rpb25Qb29sOiB7XG4gICAgICAgICAgICAgICAgR1JQQzoge1xuICAgICAgICAgICAgICAgICAgTWF4UmVxdWVzdHM6IDEwLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICBdKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnQ2FuIGFkZCBhbiBodHRwMiBjb25uZWN0aW9uIHBvb2wgdG8gbGlzdGVuZXInLCAoKSA9PiB7XG4gICAgICAvLyBHSVZFTlxuICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgICAgbWVzaE5hbWU6ICd0ZXN0LW1lc2gnLFxuICAgICAgfSk7XG5cbiAgICAgIG5ldyBhcHBtZXNoLlZpcnR1YWxOb2RlKHN0YWNrLCAndGVzdC1ub2RlJywge1xuICAgICAgICBtZXNoLFxuICAgICAgICBsaXN0ZW5lcnM6IFtcbiAgICAgICAgICBhcHBtZXNoLlZpcnR1YWxOb2RlTGlzdGVuZXIuaHR0cDIoe1xuICAgICAgICAgICAgcG9ydDogODAsXG4gICAgICAgICAgICBjb25uZWN0aW9uUG9vbDoge1xuICAgICAgICAgICAgICBtYXhSZXF1ZXN0czogMTAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICBdLFxuICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuZG5zKCd0ZXN0JyksXG4gICAgICB9KTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwTWVzaDo6VmlydHVhbE5vZGUnLCB7XG4gICAgICAgIFNwZWM6IHtcbiAgICAgICAgICBMaXN0ZW5lcnM6IFtcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgICAgICBDb25uZWN0aW9uUG9vbDoge1xuICAgICAgICAgICAgICAgIEhUVFAyOiB7XG4gICAgICAgICAgICAgICAgICBNYXhSZXF1ZXN0czogMTAsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnQ2FuIGltcG9ydCBWaXJ0dWFsIE5vZGVzIHVzaW5nIGFuIEFSTicsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuXG4gICAgY29uc3QgbWVzaE5hbWUgPSAndGVzdE1lc2gnO1xuICAgIGNvbnN0IHZpcnR1YWxOb2RlTmFtZSA9ICd0ZXN0LW5vZGUnO1xuICAgIGNvbnN0IGFybiA9IGBhcm46YXdzOmFwcG1lc2g6dXMtZWFzdC0xOjEyMzQ1Njc4OTAxMjptZXNoLyR7bWVzaE5hbWV9L3ZpcnR1YWxOb2RlLyR7dmlydHVhbE5vZGVOYW1lfWA7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdmlydHVhbE5vZGUgPSBhcHBtZXNoLlZpcnR1YWxOb2RlLmZyb21WaXJ0dWFsTm9kZUFybihcbiAgICAgIHN0YWNrLCAnaW1wb3J0ZWRWaXJ0dWFsTm9kZScsIGFybik7XG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdCh2aXJ0dWFsTm9kZS5tZXNoLm1lc2hOYW1lKS50b0VxdWFsKG1lc2hOYW1lKTtcbiAgICBleHBlY3QodmlydHVhbE5vZGUudmlydHVhbE5vZGVOYW1lKS50b0VxdWFsKHZpcnR1YWxOb2RlTmFtZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ0NhbiBpbXBvcnQgVmlydHVhbCBOb2RlcyB1c2luZyBhdHRyaWJ1dGVzJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgY29uc3QgbWVzaE5hbWUgPSAndGVzdE1lc2gnO1xuICAgIGNvbnN0IHZpcnR1YWxOb2RlTmFtZSA9ICd0ZXN0LW5vZGUnO1xuICAgIC8vIFdIRU5cbiAgICBjb25zdCB2aXJ0dWFsTm9kZSA9IGFwcG1lc2guVmlydHVhbE5vZGUuZnJvbVZpcnR1YWxOb2RlQXR0cmlidXRlcyhzdGFjaywgJ2ltcG9ydGVkVmlydHVhbE5vZGUnLCB7XG4gICAgICBtZXNoOiBhcHBtZXNoLk1lc2guZnJvbU1lc2hOYW1lKHN0YWNrLCAnTWVzaCcsIG1lc2hOYW1lKSxcbiAgICAgIHZpcnR1YWxOb2RlTmFtZTogdmlydHVhbE5vZGVOYW1lLFxuICAgIH0pO1xuICAgIC8vIFRIRU5cbiAgICBleHBlY3QodmlydHVhbE5vZGUubWVzaC5tZXNoTmFtZSkudG9FcXVhbChtZXNoTmFtZSk7XG4gICAgZXhwZWN0KHZpcnR1YWxOb2RlLnZpcnR1YWxOb2RlTmFtZSkudG9FcXVhbCh2aXJ0dWFsTm9kZU5hbWUpO1xuICB9KTtcblxuICB0ZXN0KCdDYW4gZ3JhbnQgYW4gaWRlbnRpdHkgU3RyZWFtQWdncmVnYXRlZFJlc291cmNlcyBmb3IgYSBnaXZlbiBWaXJ0dWFsTm9kZScsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgIGNvbnN0IG1lc2ggPSBuZXcgYXBwbWVzaC5NZXNoKHN0YWNrLCAnbWVzaCcsIHtcbiAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICB9KTtcbiAgICBjb25zdCBub2RlID0gbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICBtZXNoLFxuICAgICAgbGlzdGVuZXJzOiBbYXBwbWVzaC5WaXJ0dWFsTm9kZUxpc3RlbmVyLmh0dHAoe1xuICAgICAgICBwb3J0OiA4MCxcbiAgICAgICAgdGxzOiB7XG4gICAgICAgICAgbW9kZTogYXBwbWVzaC5UbHNNb2RlLlBFUk1JU1NJVkUsXG4gICAgICAgICAgY2VydGlmaWNhdGU6IGFwcG1lc2guVGxzQ2VydGlmaWNhdGUuZmlsZSgncGF0aC90by9jZXJ0Q2hhaW4nLCAncGF0aC90by9wcml2YXRlS2V5JyksXG4gICAgICAgIH0sXG4gICAgICB9KV0sXG4gICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuZG5zKCd0ZXN0JyksXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlciA9IG5ldyBpYW0uVXNlcihzdGFjaywgJ3Rlc3QnKTtcbiAgICBub2RlLmdyYW50U3RyZWFtQWdncmVnYXRlZFJlc291cmNlcyh1c2VyKTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICAgIFBvbGljeURvY3VtZW50OiB7XG4gICAgICAgIFN0YXRlbWVudDogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIEFjdGlvbjogJ2FwcG1lc2g6U3RyZWFtQWdncmVnYXRlZFJlc291cmNlcycsXG4gICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgICBSZWY6ICd0ZXN0bm9kZTNFRTI3NzZFJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdXaGVuIGNyZWF0aW5nIGEgVmlydHVhbE5vZGUnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ3dpdGggc2hhcmVkIHNlcnZpY2UgbWVzaCcsICgpID0+IHtcbiAgICAgIHRlc3QoJ01lc2ggT3duZXIgaXMgdGhlIEFXUyBhY2NvdW50IElEIG9mIHRoZSBhY2NvdW50IHRoYXQgc2hhcmVkIHRoZSBtZXNoIHdpdGggeW91ciBhY2NvdW50JywgKCkgPT4ge1xuICAgICAgICAvLyBHSVZFTlxuICAgICAgICBjb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xuICAgICAgICBjb25zdCBtZXNoRW52ID0geyBhY2NvdW50OiAnMTIzNDU2Nzg5OScsIHJlZ2lvbjogJ3VzLXdlc3QtMicgfTtcbiAgICAgICAgY29uc3QgdmlydHVhbE5vZGVFbnYgPSB7IGFjY291bnQ6ICc5OTg3NjU0MzIxJywgcmVnaW9uOiAndXMtd2VzdC0yJyB9O1xuXG4gICAgICAgIC8vIENyZWF0aW5nIHN0YWNrIGluIEFjY291bnQgOTk4NzY1NDMyMVxuICAgICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soYXBwLCAnbXlTaGFyZWRTdGFjaycsIHsgZW52OiB2aXJ0dWFsTm9kZUVudiB9KTtcbiAgICAgICAgLy8gTWVzaCBpcyBpbiBBY2NvdW50IDEyMzQ1Njc4OTlcbiAgICAgICAgY29uc3Qgc2hhcmVkTWVzaCA9IGFwcG1lc2guTWVzaC5mcm9tTWVzaEFybihzdGFjaywgJ3NoYXJlZC1tZXNoJyxcbiAgICAgICAgICBgYXJuOmF3czphcHBtZXNoOiR7bWVzaEVudi5yZWdpb259OiR7bWVzaEVudi5hY2NvdW50fTptZXNoL3NoYXJlZC1tZXNoYCk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoOiBzaGFyZWRNZXNoLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIE1lc2hPd25lcjogbWVzaEVudi5hY2NvdW50LFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3dpdGggRE5TIHNlcnZpY2UgZGlzY292ZXJ5JywgKCkgPT4ge1xuICAgICAgdGVzdCgnd2l0aCBiYXNpYyBjb25maWd1cmF0aW9uIGFuZCB3aXRob3V0IG9wdGlvbmFsIGZpZWxkcycsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBTZXJ2aWNlRGlzY292ZXJ5OiB7XG4gICAgICAgICAgICAgIEROUzoge1xuICAgICAgICAgICAgICAgIEhvc3RuYW1lOiAndGVzdCcsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ3Nob3VsZCBhbGxvdyBzZXQgcmVzcG9uc2UgdHlwZScsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnLCBhcHBtZXNoLkRuc1Jlc3BvbnNlVHlwZS5MT0FEX0JBTEFOQ0VSKSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBNZXNoOjpWaXJ0dWFsTm9kZScsIHtcbiAgICAgICAgICBTcGVjOiB7XG4gICAgICAgICAgICBTZXJ2aWNlRGlzY292ZXJ5OiB7XG4gICAgICAgICAgICAgIEROUzoge1xuICAgICAgICAgICAgICAgIEhvc3RuYW1lOiAndGVzdCcsXG4gICAgICAgICAgICAgICAgUmVzcG9uc2VUeXBlOiAnTE9BREJBTEFOQ0VSJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgdGVzdCgnaGFzIGFuIElQIFByZWZlcmVuY2UgYXBwbGllZCcsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBuZXcgYXBwbWVzaC5WaXJ0dWFsTm9kZShzdGFjaywgJ3Rlc3Qtbm9kZScsIHtcbiAgICAgICAgICBtZXNoLFxuICAgICAgICAgIHNlcnZpY2VEaXNjb3Zlcnk6IGFwcG1lc2guU2VydmljZURpc2NvdmVyeS5kbnMoJ3Rlc3QnLCBhcHBtZXNoLkRuc1Jlc3BvbnNlVHlwZS5MT0FEX0JBTEFOQ0VSLCBhcHBtZXNoLklwUHJlZmVyZW5jZS5JUFY0X09OTFkpLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIFNlcnZpY2VEaXNjb3Zlcnk6IHtcbiAgICAgICAgICAgICAgRE5TOiB7XG4gICAgICAgICAgICAgICAgSG9zdG5hbWU6ICd0ZXN0JyxcbiAgICAgICAgICAgICAgICBSZXNwb25zZVR5cGU6ICdMT0FEQkFMQU5DRVInLFxuICAgICAgICAgICAgICAgIElwUHJlZmVyZW5jZTogJ0lQdjRfT05MWScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2l0aCBDbG91ZE1hcCBzZXJ2aWNlIGRpc2NvdmVyeScsICgpID0+IHtcbiAgICAgIHRlc3QoJ3dpdGggYmFzaWMgY29uZmlndXJhdGlvbiBhbmQgd2l0aG91dCBvcHRpb25hbCBmaWVsZHMnLCAoKSA9PiB7XG4gICAgICAgIC8vIEdJVkVOXG4gICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgICBjb25zdCBtZXNoID0gbmV3IGFwcG1lc2guTWVzaChzdGFjaywgJ21lc2gnLCB7XG4gICAgICAgICAgbWVzaE5hbWU6ICd0ZXN0LW1lc2gnLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICd2cGMnKTtcbiAgICAgICAgY29uc3QgbmFtZXNwYWNlID0gbmV3IGNsb3VkbWFwLlByaXZhdGVEbnNOYW1lc3BhY2Uoc3RhY2ssICd0ZXN0LW5hbWVzcGFjZScsIHtcbiAgICAgICAgICB2cGMsXG4gICAgICAgICAgbmFtZTogJ2RvbWFpbi5sb2NhbCcsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gbmFtZXNwYWNlLmNyZWF0ZVNlcnZpY2UoJ1N2YycpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgbWVzaCxcbiAgICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuY2xvdWRNYXAoc2VydmljZSksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRIRU5cbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBwTWVzaDo6VmlydHVhbE5vZGUnLCB7XG4gICAgICAgICAgU3BlYzoge1xuICAgICAgICAgICAgU2VydmljZURpc2NvdmVyeToge1xuICAgICAgICAgICAgICBBV1NDbG91ZE1hcDoge1xuICAgICAgICAgICAgICAgIE5hbWVzcGFjZU5hbWU6ICdkb21haW4ubG9jYWwnLFxuICAgICAgICAgICAgICAgIFNlcnZpY2VOYW1lOiB7ICdGbjo6R2V0QXR0JzogWyd0ZXN0bmFtZXNwYWNlU3ZjQjU1NzAyRUMnLCAnTmFtZSddIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ2hhcyBhbiBJUCBQcmVmZXJlbmNlIGFwcGxpZWQnLCAoKSA9PiB7XG4gICAgICAgIC8vIEdJVkVOXG4gICAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgICBjb25zdCBtZXNoID0gbmV3IGFwcG1lc2guTWVzaChzdGFjaywgJ21lc2gnLCB7XG4gICAgICAgICAgbWVzaE5hbWU6ICd0ZXN0LW1lc2gnLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICd2cGMnKTtcbiAgICAgICAgY29uc3QgbmFtZXNwYWNlID0gbmV3IGNsb3VkbWFwLlByaXZhdGVEbnNOYW1lc3BhY2Uoc3RhY2ssICd0ZXN0LW5hbWVzcGFjZScsIHtcbiAgICAgICAgICB2cGMsXG4gICAgICAgICAgbmFtZTogJ2RvbWFpbi5sb2NhbCcsXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBzZXJ2aWNlID0gbmFtZXNwYWNlLmNyZWF0ZVNlcnZpY2UoJ1N2YycpO1xuXG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUnLCB7XG4gICAgICAgICAgbWVzaCxcbiAgICAgICAgICBzZXJ2aWNlRGlzY292ZXJ5OiBhcHBtZXNoLlNlcnZpY2VEaXNjb3ZlcnkuY2xvdWRNYXAoc2VydmljZSwgdW5kZWZpbmVkLCBhcHBtZXNoLklwUHJlZmVyZW5jZS5JUFY0X09OTFkpLFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUSEVOXG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwcE1lc2g6OlZpcnR1YWxOb2RlJywge1xuICAgICAgICAgIFNwZWM6IHtcbiAgICAgICAgICAgIFNlcnZpY2VEaXNjb3Zlcnk6IHtcbiAgICAgICAgICAgICAgQVdTQ2xvdWRNYXA6IHtcbiAgICAgICAgICAgICAgICBOYW1lc3BhY2VOYW1lOiAnZG9tYWluLmxvY2FsJyxcbiAgICAgICAgICAgICAgICBTZXJ2aWNlTmFtZTogeyAnRm46OkdldEF0dCc6IFsndGVzdG5hbWVzcGFjZVN2Y0I1NTcwMkVDJywgJ05hbWUnXSB9LFxuICAgICAgICAgICAgICAgIElwUHJlZmVyZW5jZTogJ0lQdjRfT05MWScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2l0aCBsaXN0ZW5lciBhbmQgd2l0aG91dCBzZXJ2aWNlIGRpc2NvdmVyeScsICgpID0+IHtcbiAgICAgIHRlc3QoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvcicsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG5cbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBhcHBtZXNoLk1lc2goc3RhY2ssICdtZXNoJywge1xuICAgICAgICAgIG1lc2hOYW1lOiAndGVzdC1tZXNoJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3Qgbm9kZSA9IG5ldyBhcHBtZXNoLlZpcnR1YWxOb2RlKHN0YWNrLCAndGVzdC1ub2RlJywge1xuICAgICAgICAgIG1lc2gsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFdIRU4gKyBUSEVOXG4gICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgbmV3IGFwcG1lc2guVmlydHVhbE5vZGUoc3RhY2ssICd0ZXN0LW5vZGUtMicsIHtcbiAgICAgICAgICAgIG1lc2gsXG4gICAgICAgICAgICBsaXN0ZW5lcnM6IFthcHBtZXNoLlZpcnR1YWxOb2RlTGlzdGVuZXIuaHR0cCgpXSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSkudG9UaHJvdygvU2VydmljZSBkaXNjb3ZlcnkgaW5mb3JtYXRpb24gaXMgcmVxdWlyZWQgZm9yIGEgVmlydHVhbE5vZGUgd2l0aCBhIGxpc3RlbmVyLyk7XG5cbiAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICBtZXNoLmFkZFZpcnR1YWxOb2RlKCd0ZXN0LW5vZGUtMycsIHtcbiAgICAgICAgICAgIGxpc3RlbmVyczogW2FwcG1lc2guVmlydHVhbE5vZGVMaXN0ZW5lci5odHRwKCldLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9KS50b1Rocm93KC9TZXJ2aWNlIGRpc2NvdmVyeSBpbmZvcm1hdGlvbiBpcyByZXF1aXJlZCBmb3IgYSBWaXJ0dWFsTm9kZSB3aXRoIGEgbGlzdGVuZXIvKTtcblxuICAgICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICAgIG5vZGUuYWRkTGlzdGVuZXIoYXBwbWVzaC5WaXJ0dWFsTm9kZUxpc3RlbmVyLmh0dHAoKSk7XG4gICAgICAgIH0pLnRvVGhyb3coL1NlcnZpY2UgZGlzY292ZXJ5IGluZm9ybWF0aW9uIGlzIHJlcXVpcmVkIGZvciBhIFZpcnR1YWxOb2RlIHdpdGggYSBsaXN0ZW5lci8pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=