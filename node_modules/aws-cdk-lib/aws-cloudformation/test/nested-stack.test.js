"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const path = require("path");
const assertions_1 = require("../../assertions");
const s3_assets = require("../../aws-s3-assets");
const sns = require("../../aws-sns");
const cdk_build_tools_1 = require("@aws-cdk/cdk-build-tools");
const core_1 = require("../../core");
const cxapi = require("../../cx-api");
const constructs_1 = require("constructs");
const nested_stack_1 = require("../lib/nested-stack");
/* eslint-disable @aws-cdk/no-core-construct */
/* eslint-disable max-len */
(0, cdk_build_tools_1.describeDeprecated)('NestedStack', () => {
    test('fails if defined as a root', () => {
        // THEN
        expect(() => new nested_stack_1.NestedStack(undefined, 'boom')).toThrow(/Nested stacks cannot be defined as a root construct/);
    });
    test('fails if defined without a parent stack', () => {
        // GIVEN
        const app = new core_1.App();
        const group = new constructs_1.Construct(app, 'group');
        // THEN
        expect(() => new nested_stack_1.NestedStack(app, 'boom')).toThrow(/must be defined within scope of another non-nested stack/);
        expect(() => new nested_stack_1.NestedStack(group, 'bam')).toThrow(/must be defined within scope of another non-nested stack/);
    });
    test('can be defined as a direct child or an indirect child of a Stack', () => {
        // GIVEN
        const parent = new core_1.Stack();
        // THEN
        expect(() => new nested_stack_1.NestedStack(parent, 'direct')).not.toThrow();
        expect(() => new nested_stack_1.NestedStack(new constructs_1.Construct(parent, 'group'), 'indirect')).not.toThrow();
    });
    test('nested stack is not synthesized as a stack artifact into the assembly', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parentStack = new core_1.Stack(app, 'parent-stack');
        new nested_stack_1.NestedStack(parentStack, 'nested-stack');
        // WHEN
        const assembly = app.synth();
        // THEN
        expect(assembly.artifacts.length).toEqual(2);
    });
    test('the template of the nested stack is synthesized into the cloud assembly', () => {
        // GIVEN
        const app = new core_1.App();
        const parent = new core_1.Stack(app, 'parent-stack');
        const nested = new nested_stack_1.NestedStack(parent, 'nested-stack');
        new core_1.CfnResource(nested, 'ResourceInNestedStack', { type: 'AWS::Resource::Nested' });
        // WHEN
        const assembly = app.synth();
        // THEN
        const template = JSON.parse(fs.readFileSync(path.join(assembly.directory, `${core_1.Names.uniqueId(nested)}.nested.template.json`), 'utf-8'));
        expect(template).toEqual({
            Resources: {
                ResourceInNestedStack: {
                    Type: 'AWS::Resource::Nested',
                },
            },
        });
    });
    test('file asset metadata is associated with the parent stack', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parent = new core_1.Stack(app, 'parent-stack');
        const nested = new nested_stack_1.NestedStack(parent, 'nested-stack');
        new core_1.CfnResource(nested, 'ResourceInNestedStack', { type: 'AWS::Resource::Nested' });
        // WHEN
        const assembly = app.synth();
        // THEN
        expect(assembly.getStackByName(parent.stackName).assets).toEqual([{
                path: 'parentstacknestedstack844892C0.nested.template.json',
                id: 'c639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096',
                packaging: 'file',
                sourceHash: 'c639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096',
                s3BucketParameter: 'AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3BucketDA8C3345',
                s3KeyParameter: 'AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3VersionKey09D03EE6',
                artifactHashParameter: 'AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096ArtifactHash8DE450C7',
            }]);
    });
    test('aws::cloudformation::stack is synthesized in the parent scope', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parent = new core_1.Stack(app, 'parent-stack');
        // WHEN
        const nested = new nested_stack_1.NestedStack(parent, 'nested-stack');
        new core_1.CfnResource(nested, 'ResourceInNestedStack', { type: 'AWS::Resource::Nested' });
        // THEN
        const assembly = app.synth();
        // assembly has one stack (the parent)
        expect(assembly.stacks.length).toEqual(1);
        // but this stack has an asset that points to the synthesized template
        expect(assembly.stacks[0].assets[0].path).toEqual('parentstacknestedstack844892C0.nested.template.json');
        // the template includes our resource
        const filePath = path.join(assembly.directory, assembly.stacks[0].assets[0].path);
        expect(JSON.parse(fs.readFileSync(filePath).toString('utf-8'))).toEqual({
            Resources: { ResourceInNestedStack: { Type: 'AWS::Resource::Nested' } },
        });
        // the parent template includes the parameters and the nested stack resource which points to the s3 url
        assertions_1.Template.fromStack(parent).templateMatches({
            Resources: {
                nestedstackNestedStacknestedstackNestedStackResource71CDD241: {
                    Type: 'AWS::CloudFormation::Stack',
                    DeletionPolicy: 'Delete',
                    UpdateReplacePolicy: 'Delete',
                    Properties: {
                        TemplateURL: {
                            'Fn::Join': [
                                '',
                                [
                                    'https://s3.',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    '.',
                                    {
                                        Ref: 'AWS::URLSuffix',
                                    },
                                    '/',
                                    {
                                        Ref: 'AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3BucketDA8C3345',
                                    },
                                    '/',
                                    {
                                        'Fn::Select': [
                                            0,
                                            {
                                                'Fn::Split': [
                                                    '||',
                                                    {
                                                        Ref: 'AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3VersionKey09D03EE6',
                                                    },
                                                ],
                                            },
                                        ],
                                    },
                                    {
                                        'Fn::Select': [
                                            1,
                                            {
                                                'Fn::Split': [
                                                    '||',
                                                    {
                                                        Ref: 'AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3VersionKey09D03EE6',
                                                    },
                                                ],
                                            },
                                        ],
                                    },
                                ],
                            ],
                        },
                    },
                },
            },
            Parameters: {
                AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3BucketDA8C3345: {
                    Type: 'String',
                    Description: 'S3 bucket for asset "c639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096"',
                },
                AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096S3VersionKey09D03EE6: {
                    Type: 'String',
                    Description: 'S3 key for asset version "c639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096"',
                },
                AssetParametersc639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096ArtifactHash8DE450C7: {
                    Type: 'String',
                    Description: 'Artifact hash for asset "c639c0a5e7320758aa22589669ecebc98f185b711300b074f53998c8f9a45096"',
                },
            },
        });
    });
    test('Stack.of()', () => {
        class MyNestedStack extends nested_stack_1.NestedStack {
            constructor(scope, id) {
                super(scope, id);
                const param = new core_1.CfnParameter(this, 'param', { type: 'String' });
                this.stackOfChild = core_1.Stack.of(param);
            }
        }
        const parent = new core_1.Stack();
        const nested = new MyNestedStack(parent, 'nested');
        expect(nested.stackOfChild).toEqual(nested);
        expect(core_1.Stack.of(nested)).toEqual(nested);
    });
    test('references within the nested stack are not reported as cross stack references', () => {
        class MyNestedStack extends nested_stack_1.NestedStack {
            constructor(scope, id) {
                super(scope, id);
                const param = new core_1.CfnParameter(this, 'param', { type: 'String' });
                new core_1.CfnResource(this, 'resource', {
                    type: 'My::Resource',
                    properties: {
                        SomeProp: param.valueAsString,
                    },
                });
            }
        }
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parent = new core_1.Stack(app, 'parent');
        new MyNestedStack(parent, 'nested');
        // references are added during "prepare"
        const assembly = app.synth();
        expect(assembly.stacks.length).toEqual(1);
        expect(assembly.stacks[0].dependencies).toEqual([]);
    });
    test('references to a resource from the parent stack in a nested stack is translated into a cfn parameter', () => {
        // WHEN
        class MyNestedStack extends nested_stack_1.NestedStack {
            constructor(scope, id, resourceFromParent) {
                super(scope, id);
                new core_1.CfnResource(this, 'resource', {
                    type: 'AWS::Child::Resource',
                    properties: {
                        ReferenceToResourceInParentStack: resourceFromParent.ref,
                    },
                });
                new core_1.CfnResource(this, 'resource2', {
                    type: 'My::Resource::2',
                    properties: {
                        Prop1: resourceFromParent.getAtt('Attr'),
                        Prop2: resourceFromParent.ref,
                    },
                });
            }
        }
        const app = new core_1.App();
        const parentStack = new core_1.Stack(app, 'parent');
        const resource = new core_1.CfnResource(parentStack, 'parent-resource', { type: 'AWS::Parent::Resource' });
        const nested = new MyNestedStack(parentStack, 'nested', resource);
        // THEN
        app.synth();
        // nested template should use a parameter to reference the resource from the parent stack
        assertions_1.Template.fromStack(nested).templateMatches({
            Resources: {
                resource: {
                    Type: 'AWS::Child::Resource',
                    Properties: { ReferenceToResourceInParentStack: { Ref: 'referencetoparentparentresourceD56EA8F7Ref' } },
                },
                resource2: {
                    Type: 'My::Resource::2',
                    Properties: {
                        Prop1: { Ref: 'referencetoparentparentresourceD56EA8F7Attr' },
                        Prop2: { Ref: 'referencetoparentparentresourceD56EA8F7Ref' },
                    },
                },
            },
            Parameters: {
                referencetoparentparentresourceD56EA8F7Ref: { Type: 'String' },
                referencetoparentparentresourceD56EA8F7Attr: { Type: 'String' },
            },
        });
        // parent template should pass in the value through the parameter
        assertions_1.Template.fromStack(parentStack).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                referencetoparentparentresourceD56EA8F7Ref: {
                    Ref: 'parentresource',
                },
                referencetoparentparentresourceD56EA8F7Attr: {
                    'Fn::GetAtt': [
                        'parentresource',
                        'Attr',
                    ],
                },
            },
        });
    });
    test('references to a resource in the nested stack in the parent is translated into a cfn output', () => {
        class MyNestedStack extends nested_stack_1.NestedStack {
            constructor(scope, id) {
                super(scope, id);
                this.resourceFromChild = new core_1.CfnResource(this, 'resource', {
                    type: 'AWS::Child::Resource',
                });
            }
        }
        const app = new core_1.App();
        const parentStack = new core_1.Stack(app, 'parent');
        const nested = new MyNestedStack(parentStack, 'nested');
        new core_1.CfnResource(parentStack, 'another-parent-resource', {
            type: 'AWS::Parent::Resource',
            properties: {
                RefToResourceInNestedStack: nested.resourceFromChild.ref,
            },
        });
        // references are added during "prepare"
        app.synth();
        // nested template should use a parameter to reference the resource from the parent stack
        assertions_1.Template.fromStack(nested).templateMatches({
            Resources: {
                resource: { Type: 'AWS::Child::Resource' },
            },
            Outputs: {
                parentnestedresource4D680677Ref: { Value: { Ref: 'resource' } },
            },
        });
        // parent template should pass in the value through the parameter
        assertions_1.Template.fromStack(parentStack).hasResourceProperties('AWS::Parent::Resource', {
            RefToResourceInNestedStack: {
                'Fn::GetAtt': [
                    'nestedNestedStacknestedNestedStackResource3DD143BF',
                    'Outputs.parentnestedresource4D680677Ref',
                ],
            },
        });
    });
    test('nested stack references a resource from another non-nested stack (not the parent)', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const stack1 = new core_1.Stack(app, 'Stack1');
        const stack2 = new core_1.Stack(app, 'Stack2');
        const nestedUnderStack1 = new nested_stack_1.NestedStack(stack1, 'NestedUnderStack1');
        const resourceInStack2 = new core_1.CfnResource(stack2, 'ResourceInStack2', { type: 'MyResource' });
        // WHEN
        new core_1.CfnResource(nestedUnderStack1, 'ResourceInNestedStack1', {
            type: 'Nested::Resource',
            properties: {
                RefToSibling: resourceInStack2.getAtt('MyAttribute'),
            },
        });
        // THEN
        const assembly = app.synth();
        // producing stack should have an export
        assertions_1.Template.fromStack(stack2).templateMatches({
            Resources: {
                ResourceInStack2: { Type: 'MyResource' },
            },
            Outputs: {
                ExportsOutputFnGetAttResourceInStack2MyAttributeC15F1009: {
                    Value: { 'Fn::GetAtt': ['ResourceInStack2', 'MyAttribute'] },
                    Export: { Name: 'Stack2:ExportsOutputFnGetAttResourceInStack2MyAttributeC15F1009' },
                },
            },
        });
        // nested stack uses Fn::ImportValue like normal
        assertions_1.Template.fromStack(nestedUnderStack1).templateMatches({
            Resources: {
                ResourceInNestedStack1: {
                    Type: 'Nested::Resource',
                    Properties: {
                        RefToSibling: {
                            'Fn::ImportValue': 'Stack2:ExportsOutputFnGetAttResourceInStack2MyAttributeC15F1009',
                        },
                    },
                },
            },
        });
        // verify a depedency was established between the parents
        const stack1Artifact = assembly.getStackByName(stack1.stackName);
        const stack2Artifact = assembly.getStackByName(stack2.stackName);
        expect(stack1Artifact.dependencies.length).toEqual(1);
        expect(stack2Artifact.dependencies.length).toEqual(0);
        expect(stack1Artifact.dependencies[0]).toEqual(stack2Artifact);
    });
    test('nested stack within a nested stack references a resource in a sibling top-level stack', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const consumerTopLevel = new core_1.Stack(app, 'ConsumerTopLevel');
        const consumerNested1 = new nested_stack_1.NestedStack(consumerTopLevel, 'ConsumerNested1');
        const consumerNested2 = new nested_stack_1.NestedStack(consumerNested1, 'ConsumerNested2');
        const producerTopLevel = new core_1.Stack(app, 'ProducerTopLevel');
        const producer = new core_1.CfnResource(producerTopLevel, 'Producer', { type: 'Producer' });
        // WHEN
        new core_1.CfnResource(consumerNested2, 'Consumer', {
            type: 'Consumer',
            properties: {
                Ref: producer.ref,
            },
        });
        // THEN
        const manifest = app.synth();
        const consumerDeps = manifest.getStackArtifact(consumerTopLevel.artifactId).dependencies.map(d => d.id);
        expect(consumerDeps).toEqual(['ProducerTopLevel']);
    });
    test('another non-nested stack takes a reference on a resource within the nested stack (the parent exports)', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const stack1 = new core_1.Stack(app, 'Stack1');
        const stack2 = new core_1.Stack(app, 'Stack2');
        const nestedUnderStack1 = new nested_stack_1.NestedStack(stack1, 'NestedUnderStack1');
        const resourceInNestedStack = new core_1.CfnResource(nestedUnderStack1, 'ResourceInNestedStack', { type: 'MyResource' });
        // WHEN
        new core_1.CfnResource(stack2, 'ResourceInStack2', {
            type: 'JustResource',
            properties: {
                RefToSibling: resourceInNestedStack.getAtt('MyAttribute'),
            },
        });
        // THEN
        const assembly = app.synth();
        // nested stack should output this value as if it was referenced by the parent (without the export)
        assertions_1.Template.fromStack(nestedUnderStack1).templateMatches({
            Resources: {
                ResourceInNestedStack: {
                    Type: 'MyResource',
                },
            },
            Outputs: {
                Stack1NestedUnderStack1ResourceInNestedStack6EE9DCD2MyAttribute: {
                    Value: {
                        'Fn::GetAtt': [
                            'ResourceInNestedStack',
                            'MyAttribute',
                        ],
                    },
                },
            },
        });
        // parent stack (stack1) should export this value
        expect(assembly.getStackByName(stack1.stackName).template.Outputs).toEqual({
            ExportsOutputFnGetAttNestedUnderStack1NestedStackNestedUnderStack1NestedStackResourceF616305BOutputsStack1NestedUnderStack1ResourceInNestedStack6EE9DCD2MyAttribute564EECF3: {
                Value: { 'Fn::GetAtt': ['NestedUnderStack1NestedStackNestedUnderStack1NestedStackResourceF616305B', 'Outputs.Stack1NestedUnderStack1ResourceInNestedStack6EE9DCD2MyAttribute'] },
                Export: { Name: 'Stack1:ExportsOutputFnGetAttNestedUnderStack1NestedStackNestedUnderStack1NestedStackResourceF616305BOutputsStack1NestedUnderStack1ResourceInNestedStack6EE9DCD2MyAttribute564EECF3' },
            },
        });
        // consuming stack should use ImportValue to import the value from the parent stack
        assertions_1.Template.fromStack(stack2).templateMatches({
            Resources: {
                ResourceInStack2: {
                    Type: 'JustResource',
                    Properties: {
                        RefToSibling: {
                            'Fn::ImportValue': 'Stack1:ExportsOutputFnGetAttNestedUnderStack1NestedStackNestedUnderStack1NestedStackResourceF616305BOutputsStack1NestedUnderStack1ResourceInNestedStack6EE9DCD2MyAttribute564EECF3',
                        },
                    },
                },
            },
        });
        expect(assembly.stacks.length).toEqual(2);
        const stack1Artifact = assembly.getStackByName(stack1.stackName);
        const stack2Artifact = assembly.getStackByName(stack2.stackName);
        expect(stack1Artifact.dependencies.length).toEqual(0);
        expect(stack2Artifact.dependencies.length).toEqual(1);
        expect(stack2Artifact.dependencies[0]).toEqual(stack1Artifact);
    });
    test('references between sibling nested stacks should output from one and getAtt from the other', () => {
        // GIVEN
        const app = new core_1.App();
        const parent = new core_1.Stack(app, 'Parent');
        const nested1 = new nested_stack_1.NestedStack(parent, 'Nested1');
        const nested2 = new nested_stack_1.NestedStack(parent, 'Nested2');
        const resource1 = new core_1.CfnResource(nested1, 'Resource1', { type: 'Resource1' });
        // WHEN
        new core_1.CfnResource(nested2, 'Resource2', {
            type: 'Resource2',
            properties: {
                RefToResource1: resource1.ref,
            },
        });
        // THEN
        app.synth();
        // producing nested stack
        assertions_1.Template.fromStack(nested1).templateMatches({
            Resources: {
                Resource1: {
                    Type: 'Resource1',
                },
            },
            Outputs: {
                ParentNested1Resource15F3F0657Ref: {
                    Value: {
                        Ref: 'Resource1',
                    },
                },
            },
        });
        // consuming nested stack
        assertions_1.Template.fromStack(nested2).templateMatches({
            Resources: {
                Resource2: {
                    Type: 'Resource2',
                    Properties: {
                        RefToResource1: {
                            Ref: 'referencetoParentNested1NestedStackNested1NestedStackResource9C05342COutputsParentNested1Resource15F3F0657Ref',
                        },
                    },
                },
            },
            Parameters: {
                referencetoParentNested1NestedStackNested1NestedStackResource9C05342COutputsParentNested1Resource15F3F0657Ref: {
                    Type: 'String',
                },
            },
        });
        // parent
        assertions_1.Template.fromStack(parent).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                referencetoParentNested1NestedStackNested1NestedStackResource9C05342COutputsParentNested1Resource15F3F0657Ref: {
                    'Fn::GetAtt': [
                        'Nested1NestedStackNested1NestedStackResourceCD0AD36B',
                        'Outputs.ParentNested1Resource15F3F0657Ref',
                    ],
                },
            },
        });
    });
    test('stackId returns AWS::StackId when referenced from the context of the nested stack', () => {
        // GIVEN
        const parent = new core_1.Stack();
        const nested = new nested_stack_1.NestedStack(parent, 'NestedStack');
        // WHEN
        new core_1.CfnResource(nested, 'NestedResource', {
            type: 'Nested::Resource',
            properties: { MyStackId: nested.stackId },
        });
        // THEN
        assertions_1.Template.fromStack(nested).hasResourceProperties('Nested::Resource', {
            MyStackId: { Ref: 'AWS::StackId' },
        });
    });
    test('stackId returns the REF of the CloudFormation::Stack resource when referenced from the parent stack', () => {
        // GIVEN
        const parent = new core_1.Stack();
        const nested = new nested_stack_1.NestedStack(parent, 'NestedStack');
        // WHEN
        new core_1.CfnResource(parent, 'ParentResource', {
            type: 'Parent::Resource',
            properties: { NestedStackId: nested.stackId },
        });
        // THEN
        assertions_1.Template.fromStack(parent).hasResourceProperties('Parent::Resource', {
            NestedStackId: { Ref: 'NestedStackNestedStackNestedStackNestedStackResourceB70834FD' },
        });
    });
    test('stackName returns AWS::StackName when referenced from the context of the nested stack', () => {
        // GIVEN
        const parent = new core_1.Stack();
        const nested = new nested_stack_1.NestedStack(parent, 'NestedStack');
        // WHEN
        new core_1.CfnResource(nested, 'NestedResource', {
            type: 'Nested::Resource',
            properties: { MyStackName: nested.stackName },
        });
        // THEN
        assertions_1.Template.fromStack(nested).hasResourceProperties('Nested::Resource', {
            MyStackName: { Ref: 'AWS::StackName' },
        });
    });
    test('stackName returns the REF of the CloudFormation::Stack resource when referenced from the parent stack', () => {
        // GIVEN
        const parent = new core_1.Stack();
        const nested = new nested_stack_1.NestedStack(parent, 'NestedStack');
        // WHEN
        new core_1.CfnResource(parent, 'ParentResource', {
            type: 'Parent::Resource',
            properties: { NestedStackName: nested.stackName },
        });
        // THEN
        assertions_1.Template.fromStack(parent).hasResourceProperties('Parent::Resource', {
            NestedStackName: {
                'Fn::Select': [
                    1,
                    {
                        'Fn::Split': [
                            '/',
                            {
                                Ref: 'NestedStackNestedStackNestedStackNestedStackResourceB70834FD',
                            },
                        ],
                    },
                ],
            },
        });
    });
    test('"account", "region" and "environment" are all derived from the parent', () => {
        // GIVEN
        const app = new core_1.App();
        const parent = new core_1.Stack(app, 'ParentStack', { env: { account: '1234account', region: 'us-east-44' } });
        // WHEN
        const nested = new nested_stack_1.NestedStack(parent, 'NestedStack');
        // THEN
        expect(nested.environment).toEqual(parent.environment);
        expect(nested.account).toEqual(parent.account);
        expect(nested.region).toEqual(parent.region);
    });
    test('double-nested stack', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parent = new core_1.Stack(app, 'stack');
        // WHEN
        const nested1 = new nested_stack_1.NestedStack(parent, 'Nested1');
        const nested2 = new nested_stack_1.NestedStack(nested1, 'Nested2');
        new core_1.CfnResource(nested1, 'Resource1', { type: 'Resource::1' });
        new core_1.CfnResource(nested2, 'Resource2', { type: 'Resource::2' });
        // THEN
        const assembly = app.synth();
        // nested2 is a "leaf", so it's just the resource
        assertions_1.Template.fromStack(nested2).templateMatches({
            Resources: {
                Resource2: { Type: 'Resource::2' },
            },
        });
        const middleStackHash = '7c426f7299a739900279ac1ece040397c1913cdf786f5228677b289f4d5e4c48';
        const bucketSuffix = 'C706B101';
        const versionSuffix = '4B193AA5';
        const hashSuffix = 'E28F0693';
        // nested1 wires the nested2 template through parameters, so we expect those
        const nested1Template = assertions_1.Template.fromStack(nested1);
        nested1Template.resourceCountIs('Resource::1', 1);
        const nested2Template = nested1Template.toJSON();
        expect(nested2Template.Parameters).toEqual({
            referencetostackAssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3BucketE8768F5CRef: { Type: 'String' },
            referencetostackAssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3VersionKey49DD83A2Ref: { Type: 'String' },
        });
        // parent stack should have two sets of parameters. one for the first nested stack and the second
        // for the second nested stack, passed in as parameters to the first
        const template = assertions_1.Template.fromStack(parent).toJSON();
        expect(template.Parameters).toEqual({
            AssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3BucketDE3B88D6: { Type: 'String', Description: 'S3 bucket for asset "8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235c"' },
            AssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3VersionKey3A62EFEA: { Type: 'String', Description: 'S3 key for asset version "8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235c"' },
            AssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cArtifactHash7DC546E0: { Type: 'String', Description: 'Artifact hash for asset "8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235c"' },
            [`AssetParameters${middleStackHash}S3Bucket${bucketSuffix}`]: { Type: 'String', Description: `S3 bucket for asset "${middleStackHash}"` },
            [`AssetParameters${middleStackHash}S3VersionKey${versionSuffix}`]: { Type: 'String', Description: `S3 key for asset version "${middleStackHash}"` },
            [`AssetParameters${middleStackHash}ArtifactHash${hashSuffix}`]: { Type: 'String', Description: `Artifact hash for asset "${middleStackHash}"` },
        });
        // proxy asset params to nested stack
        assertions_1.Template.fromStack(parent).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                referencetostackAssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3BucketE8768F5CRef: { Ref: 'AssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3BucketDE3B88D6' },
                referencetostackAssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3VersionKey49DD83A2Ref: { Ref: 'AssetParameters8169c6f8aaeaf5e2e8620f5f895ffe2099202ccb4b6889df48fe0967a894235cS3VersionKey3A62EFEA' },
            },
        });
        // parent stack should have 2 assets
        expect(assembly.getStackByName(parent.stackName).assets.length).toEqual(2);
    });
    test('reference resource in a double nested stack (#15155)', () => {
        // GIVEN
        const app = new core_1.App();
        const producerStack = new core_1.Stack(app, 'Producer');
        const nested2 = new nested_stack_1.NestedStack(new nested_stack_1.NestedStack(producerStack, 'Nested1'), 'Nested2');
        const producerResource = new core_1.CfnResource(nested2, 'Resource', { type: 'MyResource' });
        const consumerStack = new core_1.Stack(app, 'Consumer');
        // WHEN
        new core_1.CfnResource(consumerStack, 'ConsumingResource', {
            type: 'YourResource',
            properties: { RefToResource: producerResource.ref },
        });
        // THEN
        const casm = app.synth(); // before #15155 was fixed this threw an error
        const producerTemplate = casm.getStackArtifact(producerStack.artifactId).template;
        const consumerTemplate = casm.getStackArtifact(consumerStack.artifactId).template;
        // check that the consuming resource references the expected export name
        const outputName = 'ExportsOutputFnGetAttNested1NestedStackNested1NestedStackResourceCD0AD36BOutputsProducerNested1Nested2NestedStackNested2NestedStackResource1E6FA3C3OutputsProducerNested1Nested238A89CC5Ref2E9E52EA';
        const exportName = producerTemplate.Outputs[outputName].Export.Name;
        const importName = consumerTemplate.Resources.ConsumingResource.Properties.RefToResource['Fn::ImportValue'];
        expect(exportName).toEqual(importName);
    });
    test('assets within nested stacks are proxied from the parent', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parent = new core_1.Stack(app, 'ParentStack');
        const nested = new nested_stack_1.NestedStack(parent, 'NestedStack');
        // WHEN
        const asset = new s3_assets.Asset(nested, 'asset', {
            path: path.join(__dirname, 'asset-fixture.txt'),
        });
        new core_1.CfnResource(nested, 'NestedResource', {
            type: 'Nested::Resource',
            properties: {
                AssetBucket: asset.s3BucketName,
                AssetKey: asset.s3ObjectKey,
            },
        });
        // THEN
        const assembly = app.synth();
        const template = assertions_1.Template.fromStack(parent).toJSON();
        // two sets of asset parameters: one for the nested stack itself and one as a proxy for the asset within the stack
        expect(template.Parameters).toEqual({
            AssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281S3BucketC188F637: { Type: 'String', Description: 'S3 bucket for asset "db01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281"' },
            AssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281S3VersionKeyC7F4DBF2: { Type: 'String', Description: 'S3 key for asset version "db01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281"' },
            AssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281ArtifactHash373B14D2: { Type: 'String', Description: 'Artifact hash for asset "db01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281"' },
            AssetParameters46b107d6db798ca46046b8669d057a4debcbdbaaddb6170400748c2f9e4f9d71S3Bucket3C4265E9: { Type: 'String', Description: 'S3 bucket for asset "46b107d6db798ca46046b8669d057a4debcbdbaaddb6170400748c2f9e4f9d71"' },
            AssetParameters46b107d6db798ca46046b8669d057a4debcbdbaaddb6170400748c2f9e4f9d71S3VersionKey8E981535: { Type: 'String', Description: 'S3 key for asset version "46b107d6db798ca46046b8669d057a4debcbdbaaddb6170400748c2f9e4f9d71"' },
            AssetParameters46b107d6db798ca46046b8669d057a4debcbdbaaddb6170400748c2f9e4f9d71ArtifactHash45A28583: { Type: 'String', Description: 'Artifact hash for asset "46b107d6db798ca46046b8669d057a4debcbdbaaddb6170400748c2f9e4f9d71"' },
        });
        // asset proxy parameters are passed to the nested stack
        assertions_1.Template.fromStack(parent).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                referencetoParentStackAssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281S3Bucket82C55B96Ref: { Ref: 'AssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281S3BucketC188F637' },
                referencetoParentStackAssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281S3VersionKeyA43C3CC6Ref: { Ref: 'AssetParametersdb01ee2eb7adc7915e364dc410d861e569543f9be3761d535a68d5c2cc181281S3VersionKeyC7F4DBF2' },
            },
        });
        // parent stack should have 2 assets
        expect(assembly.getStackByName(parent.stackName).assets.length).toEqual(2);
    });
    test('docker image assets are wired through the top-level stack', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const parent = new core_1.Stack(app, 'my-stack');
        const nested = new nested_stack_1.NestedStack(parent, 'nested-stack');
        // WHEN
        const location = nested.synthesizer.addDockerImageAsset({
            directoryName: 'my-image',
            dockerBuildArgs: { key: 'value', boom: 'bam' },
            dockerBuildTarget: 'buildTarget',
            sourceHash: 'hash-of-source',
        });
        // use the asset, so the parameters will be wired.
        new sns.Topic(nested, 'MyTopic', {
            displayName: `image location is ${location.imageUri}`,
        });
        // THEN
        const asm = app.synth();
        expect(asm.getStackArtifact(parent.artifactId).assets).toEqual([
            {
                repositoryName: 'aws-cdk/assets',
                imageTag: 'hash-of-source',
                id: 'hash-of-source',
                packaging: 'container-image',
                path: 'my-image',
                sourceHash: 'hash-of-source',
                buildArgs: { key: 'value', boom: 'bam' },
                target: 'buildTarget',
            },
            {
                path: 'mystacknestedstackFAE12FB5.nested.template.json',
                id: 'fcdaee79eb79f37eca3a9b1cc0cc9ba150e4eea8c5d6d0c343cb6cd9dc68e2e5',
                packaging: 'file',
                sourceHash: 'fcdaee79eb79f37eca3a9b1cc0cc9ba150e4eea8c5d6d0c343cb6cd9dc68e2e5',
                s3BucketParameter: 'AssetParametersfcdaee79eb79f37eca3a9b1cc0cc9ba150e4eea8c5d6d0c343cb6cd9dc68e2e5S3Bucket67A749F8',
                s3KeyParameter: 'AssetParametersfcdaee79eb79f37eca3a9b1cc0cc9ba150e4eea8c5d6d0c343cb6cd9dc68e2e5S3VersionKeyE1E6A8D4',
                artifactHashParameter: 'AssetParametersfcdaee79eb79f37eca3a9b1cc0cc9ba150e4eea8c5d6d0c343cb6cd9dc68e2e5ArtifactHash0AEDBE8A',
            },
        ]);
    });
    test('metadata defined in nested stacks is reported at the parent stack level in the cloud assembly', () => {
        // GIVEN
        const app = new core_1.App({ stackTraces: false });
        const parent = new core_1.Stack(app, 'parent');
        const child = new core_1.Stack(parent, 'child');
        const nested = new nested_stack_1.NestedStack(child, 'nested');
        const resource = new core_1.CfnResource(nested, 'resource', { type: 'foo' });
        // WHEN
        resource.node.addMetadata('foo', 'bar');
        // THEN: the first non-nested stack records the assembly metadata
        const asm = app.synth();
        expect(asm.stacks.length).toEqual(2); // only one stack is defined as an artifact
        expect(asm.getStackByName(parent.stackName).findMetadataByType('foo')).toEqual([]);
        expect(asm.getStackByName(child.stackName).findMetadataByType('foo')).toEqual([
            {
                path: '/parent/child/nested/resource',
                type: 'foo',
                data: 'bar',
            },
        ]);
    });
    test('referencing attributes with period across stacks', () => {
        // GIVEN
        const parent = new core_1.Stack();
        const nested = new nested_stack_1.NestedStack(parent, 'nested');
        const consumed = new core_1.CfnResource(nested, 'resource-in-nested', { type: 'CONSUMED' });
        // WHEN
        new core_1.CfnResource(parent, 'resource-in-parent', {
            type: 'CONSUMER',
            properties: {
                ConsumedAttribute: consumed.getAtt('Consumed.Attribute'),
            },
        });
        // THEN
        assertions_1.Template.fromStack(nested).templateMatches({
            Resources: {
                resourceinnested: {
                    Type: 'CONSUMED',
                },
            },
            Outputs: {
                nestedresourceinnested59B1F01CConsumedAttribute: {
                    Value: {
                        'Fn::GetAtt': [
                            'resourceinnested',
                            'Consumed.Attribute',
                        ],
                    },
                },
            },
        });
        assertions_1.Template.fromStack(parent).hasResourceProperties('CONSUMER', {
            ConsumedAttribute: {
                'Fn::GetAtt': [
                    'nestedNestedStacknestedNestedStackResource3DD143BF',
                    'Outputs.nestedresourceinnested59B1F01CConsumedAttribute',
                ],
            },
        });
    });
    test('missing context in nested stack is reported if the context is not available', () => {
        // GIVEN
        const app = new core_1.App();
        const stack = new core_1.Stack(app, 'ParentStack', { env: { account: '1234account', region: 'us-east-44' } });
        const nestedStack = new nested_stack_1.NestedStack(stack, 'nested');
        const provider = 'availability-zones';
        const expectedKey = core_1.ContextProvider.getKey(nestedStack, {
            provider,
        }).key;
        // WHEN
        core_1.ContextProvider.getValue(nestedStack, {
            provider,
            dummyValue: ['dummy1a', 'dummy1b', 'dummy1c'],
        });
        // THEN: missing context is reported in the cloud assembly
        const asm = app.synth();
        const missing = asm.manifest.missing;
        expect(missing && missing.find(m => {
            return (m.key === expectedKey);
        })).toBeTruthy();
    });
    test('3-level stacks: legacy synthesizer parameters are added to the middle-level stack', () => {
        // GIVEN
        const app = new core_1.App();
        const top = new core_1.Stack(app, 'stack', {
            synthesizer: new core_1.LegacyStackSynthesizer(),
        });
        const middle = new nested_stack_1.NestedStack(top, 'nested1');
        const bottom = new nested_stack_1.NestedStack(middle, 'nested2');
        // WHEN
        new core_1.CfnResource(bottom, 'Something', {
            type: 'BottomLevel',
        });
        // THEN
        const asm = app.synth();
        const middleTemplate = JSON.parse(fs.readFileSync(path.join(asm.directory, middle.templateFile), { encoding: 'utf-8' }));
        const hash = 'bc3c51e4d3545ee0a0069401e5a32c37b66d044b983f12de416ba1576ecaf0a4';
        expect(middleTemplate.Parameters ?? {}).toEqual({
            [`referencetostackAssetParameters${hash}S3BucketD7C30435Ref`]: {
                Type: 'String',
            },
            [`referencetostackAssetParameters${hash}S3VersionKeyB667DBE1Ref`]: {
                Type: 'String',
            },
        });
    });
    test('references to a resource from a deeply nested stack', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const top = new core_1.Stack(app, 'stack');
        const topLevel = new core_1.CfnResource(top, 'toplevel', { type: 'TopLevel' });
        const nested1 = new nested_stack_1.NestedStack(top, 'nested1');
        const nested2 = new nested_stack_1.NestedStack(nested1, 'nested2');
        // WHEN
        new core_1.CfnResource(nested2, 'refToTopLevel', {
            type: 'BottomLevel',
            properties: { RefToTopLevel: topLevel.ref },
        });
        // THEN
        assertions_1.Template.fromStack(top).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                referencetostackAssetParameters842982bd421cce9742ba27151ef12ed699d44d22801f41e8029f63f2358a3f2fS3Bucket5DA5D2E7Ref: {
                    Ref: 'AssetParameters842982bd421cce9742ba27151ef12ed699d44d22801f41e8029f63f2358a3f2fS3BucketDD4D96B5',
                },
                referencetostackAssetParameters842982bd421cce9742ba27151ef12ed699d44d22801f41e8029f63f2358a3f2fS3VersionKey8FBE5C12Ref: {
                    Ref: 'AssetParameters842982bd421cce9742ba27151ef12ed699d44d22801f41e8029f63f2358a3f2fS3VersionKey83E381F3',
                },
                referencetostacktoplevelBB16BF13Ref: {
                    Ref: 'toplevel',
                },
            },
        });
        assertions_1.Template.fromStack(nested1).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                referencetostacktoplevelBB16BF13Ref: {
                    Ref: 'referencetostacktoplevelBB16BF13Ref',
                },
            },
        });
        assertions_1.Template.fromStack(nested2).templateMatches({
            Resources: {
                refToTopLevel: {
                    Type: 'BottomLevel',
                    Properties: {
                        RefToTopLevel: {
                            Ref: 'referencetostacktoplevelBB16BF13Ref',
                        },
                    },
                },
            },
            Parameters: {
                referencetostacktoplevelBB16BF13Ref: {
                    Type: 'String',
                },
            },
        });
    });
    test('bottom nested stack consumes value from a top-level stack through a parameter in a middle nested stack', () => {
        // GIVEN
        const app = new core_1.App({ context: { [cxapi.NEW_STYLE_STACK_SYNTHESIS_CONTEXT]: false } });
        const top = new core_1.Stack(app, 'Grandparent');
        const middle = new nested_stack_1.NestedStack(top, 'Parent');
        const bottom = new nested_stack_1.NestedStack(middle, 'Child');
        const resourceInGrandparent = new core_1.CfnResource(top, 'ResourceInGrandparent', { type: 'ResourceInGrandparent' });
        // WHEN
        new core_1.CfnResource(bottom, 'ResourceInChild', {
            type: 'ResourceInChild',
            properties: {
                RefToGrandparent: resourceInGrandparent.ref,
            },
        });
        // THEN
        // this is the name allocated for the parameter that's propagated through
        // the hierarchy.
        const paramName = 'referencetoGrandparentResourceInGrandparent010E997ARef';
        // child (bottom) references through a parameter.
        assertions_1.Template.fromStack(bottom).templateMatches({
            Resources: {
                ResourceInChild: {
                    Type: 'ResourceInChild',
                    Properties: {
                        RefToGrandparent: { Ref: paramName },
                    },
                },
            },
            Parameters: {
                [paramName]: { Type: 'String' },
            },
        });
        // the parent (middle) sets the value of this parameter to be a reference to another parameter
        assertions_1.Template.fromStack(middle).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                [paramName]: { Ref: paramName },
            },
        });
        // grandparent (top) assigns the actual value to the parameter
        assertions_1.Template.fromStack(top).hasResourceProperties('AWS::CloudFormation::Stack', {
            Parameters: {
                [paramName]: { Ref: 'ResourceInGrandparent' },
                // these are for the asset of the bottom nested stack
                referencetoGrandparentAssetParameters3208f43b793a1dbe28ca02cf31fb975489071beb42c492b22dc3d32decc3b4b7S3Bucket06EEE58DRef: {
                    Ref: 'AssetParameters3208f43b793a1dbe28ca02cf31fb975489071beb42c492b22dc3d32decc3b4b7S3Bucket01877C2E',
                },
                referencetoGrandparentAssetParameters3208f43b793a1dbe28ca02cf31fb975489071beb42c492b22dc3d32decc3b4b7S3VersionKeyD3B04909Ref: {
                    Ref: 'AssetParameters3208f43b793a1dbe28ca02cf31fb975489071beb42c492b22dc3d32decc3b4b7S3VersionKey5765F084',
                },
            },
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmVzdGVkLXN0YWNrLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJuZXN0ZWQtc3RhY2sudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0IsaURBQTRDO0FBQzVDLGlEQUFpRDtBQUNqRCxxQ0FBcUM7QUFDckMsOERBQThEO0FBQzlELHFDQUFtSDtBQUNuSCxzQ0FBc0M7QUFDdEMsMkNBQXVDO0FBQ3ZDLHNEQUFrRDtBQUVsRCwrQ0FBK0M7QUFDL0MsNEJBQTRCO0FBRTVCLElBQUEsb0NBQWtCLEVBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtJQUNyQyxJQUFJLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1FBQ3RDLE9BQU87UUFDUCxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSwwQkFBVyxDQUFDLFNBQWdCLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMscURBQXFELENBQUMsQ0FBQztJQUN6SCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyx5Q0FBeUMsRUFBRSxHQUFHLEVBQUU7UUFDbkQsUUFBUTtRQUNSLE1BQU0sR0FBRyxHQUFHLElBQUksVUFBRyxFQUFFLENBQUM7UUFDdEIsTUFBTSxLQUFLLEdBQUcsSUFBSSxzQkFBUyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUUxQyxPQUFPO1FBQ1AsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksMEJBQVcsQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsMERBQTBELENBQUMsQ0FBQztRQUMvRyxNQUFNLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSwwQkFBVyxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQywwREFBMEQsQ0FBQyxDQUFDO0lBQ2xILENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLGtFQUFr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QUFVLEVBQUU7Z0JBQ1YsQ0FBQyxTQUFTLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUU7YUFDaEM7U0FDRixDQUFDLENBQUM7UUFFSCw4REFBOEQ7UUFDOUQscUJBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUMscUJBQXFCLENBQUMsNEJBQTRCLEVBQUU7WUFDMUUsVUFBVSxFQUFFO2dCQUNWLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsdUJBQXVCLEVBQUU7Z0JBRTdDLHFEQUFxRDtnQkFDckQsd0hBQXdILEVBQUU7b0JBQ3hILEdBQUcsRUFBRSxpR0FBaUc7aUJBQ3ZHO2dCQUNELDRIQUE0SCxFQUFFO29CQUM1SCxHQUFHLEVBQUUscUdBQXFHO2lCQUMzRzthQUNGO1NBQ0YsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBUZW1wbGF0ZSB9IGZyb20gJy4uLy4uL2Fzc2VydGlvbnMnO1xuaW1wb3J0ICogYXMgczNfYXNzZXRzIGZyb20gJy4uLy4uL2F3cy1zMy1hc3NldHMnO1xuaW1wb3J0ICogYXMgc25zIGZyb20gJy4uLy4uL2F3cy1zbnMnO1xuaW1wb3J0IHsgZGVzY3JpYmVEZXByZWNhdGVkIH0gZnJvbSAnQGF3cy1jZGsvY2RrLWJ1aWxkLXRvb2xzJztcbmltcG9ydCB7IEFwcCwgQ2ZuUGFyYW1ldGVyLCBDZm5SZXNvdXJjZSwgQ29udGV4dFByb3ZpZGVyLCBMZWdhY3lTdGFja1N5bnRoZXNpemVyLCBOYW1lcywgU3RhY2sgfSBmcm9tICcuLi8uLi9jb3JlJztcbmltcG9ydCAqIGFzIGN4YXBpIGZyb20gJy4uLy4uL2N4LWFwaSc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcbmltcG9ydCB7IE5lc3RlZFN0YWNrIH0gZnJvbSAnLi4vbGliL25lc3RlZC1zdGFjayc7XG5cbi8qIGVzbGludC1kaXNhYmxlIEBhd3MtY2RrL25vLWNvcmUtY29uc3RydWN0ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBtYXgtbGVuICovXG5cbmRlc2NyaWJlRGVwcmVjYXRlZCgnTmVzdGVkU3RhY2snLCAoKSA9PiB7XG4gIHRlc3QoJ2ZhaWxzIGlmIGRlZmluZWQgYXMgYSByb290JywgKCkgPT4ge1xuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoKCkgPT4gbmV3IE5lc3RlZFN0YWNrKHVuZGVmaW5lZCBhcyBhbnksICdib29tJykpLnRvVGhyb3coL05lc3RlZCBzdGFja3MgY2Fubm90IGJlIGRlZmluZWQgYXMgYSByb290IGNvbnN0cnVjdC8pO1xuICB9KTtcblxuICB0ZXN0KCdmYWlscyBpZiBkZWZpbmVkIHdpdGhvdXQgYSBwYXJlbnQgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3QgZ3JvdXAgPSBuZXcgQ29uc3RydWN0KGFwcCwgJ2dyb3VwJyk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KCgpID0+IG5ldyBOZXN0ZWRTdGFjayhhcHAsICdib29tJykpLnRvVGhyb3coL211c3QgYmUgZGVmaW5lZCB3aXRoaW4gc2NvcGUgb2YgYW5vdGhlciBub24tbmVzdGVkIHN0YWNrLyk7XG4gICAgZXhwZWN0KCgpID0+IG5ldyBOZXN0ZWRTdGFjayhncm91cCwgJ2JhbScpKS50b1Rocm93KC9tdXN0IGJlIGRlZmluZWQgd2l0aGluIHNjb3BlIG9mIGFub3RoZXIgbm9uLW5lc3RlZCBzdGFjay8pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gYmUgZGVmaW5lZCBhcyBhIGRpcmVjdCBjaGlsZCBvciBhbiBpbmRpcmVjdCBjaGlsZCBvZiBhIFN0YWNrJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcGFyZW50ID0gbmV3IFN0YWNrKCk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KCgpID0+IG5ldyBOZXN0ZWRTdGFjayhwYXJlbnQsICdkaXJlY3QnKSkubm90LnRvVGhyb3coKTtcbiAgICBleHBlY3QoKCkgPT4gbmV3IE5lc3RlZFN0YWNrKG5ldyBDb25zdHJ1Y3QocGFyZW50LCAnZ3JvdXAnKSwgJ2luZGlyZWN0JykpLm5vdC50b1Rocm93KCk7XG4gIH0pO1xuXG4gIHRlc3QoJ25lc3RlZCBzdGFjayBpcyBub3Qgc3ludGhlc2l6ZWQgYXMgYSBzdGFjayBhcnRpZmFjdCBpbnRvIHRoZSBhc3NlbWJseScsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoeyBjb250ZXh0OiB7IFtjeGFwaS5ORVdfU1RZTEVfU1RBQ0tfU1lOVEhFU0lTX0NPTlRFWFRdOiBmYWxzZSB9IH0pO1xuICAgIGNvbnN0IHBhcmVudFN0YWNrID0gbmV3IFN0YWNrKGFwcCwgJ3BhcmVudC1zdGFjaycpO1xuICAgIG5ldyBOZXN0ZWRTdGFjayhwYXJlbnRTdGFjaywgJ25lc3RlZC1zdGFjaycpO1xuXG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IGFzc2VtYmx5ID0gYXBwLnN5bnRoKCk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KGFzc2VtYmx5LmFydGlmYWN0cy5sZW5ndGgpLnRvRXF1YWwoMik7XG4gIH0pO1xuXG4gIHRlc3QoJ3RoZSB0ZW1wbGF0ZSBvZiB0aGUgbmVzdGVkIHN0YWNrIGlzIHN5bnRoZXNpemVkIGludG8gdGhlIGNsb3VkIGFzc2VtYmx5JywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICAgIGNvbnN0IHBhcmVudCA9IG5ldyBTdGFjayhhcHAsICdwYXJlbnQtc3RhY2snKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnbmVzdGVkLXN0YWNrJyk7XG4gICAgbmV3IENmblJlc291cmNlKG5lc3RlZCwgJ1Jlc291cmNlSW5OZXN0ZWRTdGFjaycsIHsgdHlwZTogJ0FXUzo6UmVzb3VyY2U6Ok5lc3RlZCcgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgYXNzZW1ibHkgPSBhcHAuc3ludGgoKTtcblxuICAgIC8vIFRIRU5cbiAgICBjb25zdCB0ZW1wbGF0ZSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhdGguam9pbihhc3NlbWJseS5kaXJlY3RvcnksIGAke05hbWVzLnVuaXF1ZUlkKG5lc3RlZCl9Lm5lc3RlZC50ZW1wbGF0ZS5qc29uYCksICd1dGYtOCcpKTtcbiAgICBleHBlY3QodGVtcGxhdGUpLnRvRXF1YWwoe1xuICAgICAgUmVzb3VyY2VzOiB7XG4gICAgICAgIFJlc291cmNlSW5OZXN0ZWRTdGFjazoge1xuICAgICAgICAgIFR5cGU6ICdBV1M6OlJlc291cmNlOjpOZXN0ZWQnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZmlsZSBhc3NldCBtZXRhZGF0YSBpcyBhc3NvY2lhdGVkIHdpdGggdGhlIHBhcmVudCBzdGFjaycsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoeyBjb250ZXh0OiB7IFtjeGFwaS5ORVdfU1RZTEVfU1RBQ0tfU1lOVEhFU0lTX0NPTlRFWFRdOiBmYWxzZSB9IH0pO1xuICAgIGNvbnN0IHBhcmVudCA9IG5ldyBTdGFjayhhcHAsICdwYXJlbnQtc3RhY2snKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnbmVzdGVkLXN0YWNrJyk7XG4gICAgbmV3IENmblJlc291cmNlKG5lc3RlZCwgJ1Jlc291cmNlSW5OZXN0ZWRTdGFjaycsIHsgdHlwZTogJ0FXUzo6UmVzb3VyY2U6Ok5lc3RlZCcgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgYXNzZW1ibHkgPSBhcHAuc3ludGgoKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoYXNzZW1ibHkuZ2V0U3RhY2tCeU5hbWUocGFyZW50LnN0YWNrTmFtZSkuYXNzZXRzKS50b0VxdWFsKFt7XG4gICAgICBwYXRoOiAncGFyZW50c3RhY2tuZXN0ZWRzdGFjazg0NDg5MkMwLm5lc3RlZC50ZW1wbGF0ZS5qc29uJyxcbiAgICAgIGlkOiAnYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NicsXG4gICAgICBwYWNrYWdpbmc6ICdmaWxlJyxcbiAgICAgIHNvdXJjZUhhc2g6ICdjNjM5YzBhNWU3MzIwNzU4YWEyMjU4OTY2OWVjZWJjOThmMTg1YjcxMTMwMGIwNzRmNTM5OThjOGY5YTQ1MDk2JyxcbiAgICAgIHMzQnVja2V0UGFyYW1ldGVyOiAnQXNzZXRQYXJhbWV0ZXJzYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NlMzQnVja2V0REE4QzMzNDUnLFxuICAgICAgczNLZXlQYXJhbWV0ZXI6ICdBc3NldFBhcmFtZXRlcnNjNjM5YzBhNWU3MzIwNzU4YWEyMjU4OTY2OWVjZWJjOThmMTg1YjcxMTMwMGIwNzRmNTM5OThjOGY5YTQ1MDk2UzNWZXJzaW9uS2V5MDlEMDNFRTYnLFxuICAgICAgYXJ0aWZhY3RIYXNoUGFyYW1ldGVyOiAnQXNzZXRQYXJhbWV0ZXJzYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NkFydGlmYWN0SGFzaDhERTQ1MEM3JyxcbiAgICB9XSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2F3czo6Y2xvdWRmb3JtYXRpb246OnN0YWNrIGlzIHN5bnRoZXNpemVkIGluIHRoZSBwYXJlbnQgc2NvcGUnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKHsgY29udGV4dDogeyBbY3hhcGkuTkVXX1NUWUxFX1NUQUNLX1NZTlRIRVNJU19DT05URVhUXTogZmFsc2UgfSB9KTtcbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soYXBwLCAncGFyZW50LXN0YWNrJyk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgbmVzdGVkID0gbmV3IE5lc3RlZFN0YWNrKHBhcmVudCwgJ25lc3RlZC1zdGFjaycpO1xuICAgIG5ldyBDZm5SZXNvdXJjZShuZXN0ZWQsICdSZXNvdXJjZUluTmVzdGVkU3RhY2snLCB7IHR5cGU6ICdBV1M6OlJlc291cmNlOjpOZXN0ZWQnIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGNvbnN0IGFzc2VtYmx5ID0gYXBwLnN5bnRoKCk7XG5cbiAgICAvLyBhc3NlbWJseSBoYXMgb25lIHN0YWNrICh0aGUgcGFyZW50KVxuICAgIGV4cGVjdChhc3NlbWJseS5zdGFja3MubGVuZ3RoKS50b0VxdWFsKDEpO1xuXG4gICAgLy8gYnV0IHRoaXMgc3RhY2sgaGFzIGFuIGFzc2V0IHRoYXQgcG9pbnRzIHRvIHRoZSBzeW50aGVzaXplZCB0ZW1wbGF0ZVxuICAgIGV4cGVjdChhc3NlbWJseS5zdGFja3NbMF0uYXNzZXRzWzBdLnBhdGgpLnRvRXF1YWwoJ3BhcmVudHN0YWNrbmVzdGVkc3RhY2s4NDQ4OTJDMC5uZXN0ZWQudGVtcGxhdGUuanNvbicpO1xuXG4gICAgLy8gdGhlIHRlbXBsYXRlIGluY2x1ZGVzIG91ciByZXNvdXJjZVxuICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5qb2luKGFzc2VtYmx5LmRpcmVjdG9yeSwgYXNzZW1ibHkuc3RhY2tzWzBdLmFzc2V0c1swXS5wYXRoKTtcbiAgICBleHBlY3QoSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgpLnRvU3RyaW5nKCd1dGYtOCcpKSkudG9FcXVhbCh7XG4gICAgICBSZXNvdXJjZXM6IHsgUmVzb3VyY2VJbk5lc3RlZFN0YWNrOiB7IFR5cGU6ICdBV1M6OlJlc291cmNlOjpOZXN0ZWQnIH0gfSxcbiAgICB9KTtcblxuICAgIC8vIHRoZSBwYXJlbnQgdGVtcGxhdGUgaW5jbHVkZXMgdGhlIHBhcmFtZXRlcnMgYW5kIHRoZSBuZXN0ZWQgc3RhY2sgcmVzb3VyY2Ugd2hpY2ggcG9pbnRzIHRvIHRoZSBzMyB1cmxcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50KS50ZW1wbGF0ZU1hdGNoZXMoe1xuICAgICAgUmVzb3VyY2VzOiB7XG4gICAgICAgIG5lc3RlZHN0YWNrTmVzdGVkU3RhY2tuZXN0ZWRzdGFja05lc3RlZFN0YWNrUmVzb3VyY2U3MUNERDI0MToge1xuICAgICAgICAgIFR5cGU6ICdBV1M6OkNsb3VkRm9ybWF0aW9uOjpTdGFjaycsXG4gICAgICAgICAgRGVsZXRpb25Qb2xpY3k6ICdEZWxldGUnLFxuICAgICAgICAgIFVwZGF0ZVJlcGxhY2VQb2xpY3k6ICdEZWxldGUnLFxuICAgICAgICAgIFByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFRlbXBsYXRlVVJMOiB7XG4gICAgICAgICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAnaHR0cHM6Ly9zMy4nLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgJy4nLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlVSTFN1ZmZpeCcsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgJy8nLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBSZWY6ICdBc3NldFBhcmFtZXRlcnNjNjM5YzBhNWU3MzIwNzU4YWEyMjU4OTY2OWVjZWJjOThmMTg1YjcxMTMwMGIwNzRmNTM5OThjOGY5YTQ1MDk2UzNCdWNrZXREQThDMzM0NScsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgJy8nLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAnRm46OlNlbGVjdCc6IFtcbiAgICAgICAgICAgICAgICAgICAgICAwLFxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdGbjo6U3BsaXQnOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICd8fCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZWY6ICdBc3NldFBhcmFtZXRlcnNjNjM5YzBhNWU3MzIwNzU4YWEyMjU4OTY2OWVjZWJjOThmMTg1YjcxMTMwMGIwNzRmNTM5OThjOGY5YTQ1MDk2UzNWZXJzaW9uS2V5MDlEMDNFRTYnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgJ0ZuOjpTZWxlY3QnOiBbXG4gICAgICAgICAgICAgICAgICAgICAgMSxcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnRm46OlNwbGl0JzogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnfHwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVmOiAnQXNzZXRQYXJhbWV0ZXJzYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NlMzVmVyc2lvbktleTA5RDAzRUU2JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIEFzc2V0UGFyYW1ldGVyc2M2MzljMGE1ZTczMjA3NThhYTIyNTg5NjY5ZWNlYmM5OGYxODViNzExMzAwYjA3NGY1Mzk5OGM4ZjlhNDUwOTZTM0J1Y2tldERBOEMzMzQ1OiB7XG4gICAgICAgICAgVHlwZTogJ1N0cmluZycsXG4gICAgICAgICAgRGVzY3JpcHRpb246ICdTMyBidWNrZXQgZm9yIGFzc2V0IFwiYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NlwiJyxcbiAgICAgICAgfSxcbiAgICAgICAgQXNzZXRQYXJhbWV0ZXJzYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NlMzVmVyc2lvbktleTA5RDAzRUU2OiB7XG4gICAgICAgICAgVHlwZTogJ1N0cmluZycsXG4gICAgICAgICAgRGVzY3JpcHRpb246ICdTMyBrZXkgZm9yIGFzc2V0IHZlcnNpb24gXCJjNjM5YzBhNWU3MzIwNzU4YWEyMjU4OTY2OWVjZWJjOThmMTg1YjcxMTMwMGIwNzRmNTM5OThjOGY5YTQ1MDk2XCInLFxuICAgICAgICB9LFxuICAgICAgICBBc3NldFBhcmFtZXRlcnNjNjM5YzBhNWU3MzIwNzU4YWEyMjU4OTY2OWVjZWJjOThmMTg1YjcxMTMwMGIwNzRmNTM5OThjOGY5YTQ1MDk2QXJ0aWZhY3RIYXNoOERFNDUwQzc6IHtcbiAgICAgICAgICBUeXBlOiAnU3RyaW5nJyxcbiAgICAgICAgICBEZXNjcmlwdGlvbjogJ0FydGlmYWN0IGhhc2ggZm9yIGFzc2V0IFwiYzYzOWMwYTVlNzMyMDc1OGFhMjI1ODk2NjllY2ViYzk4ZjE4NWI3MTEzMDBiMDc0ZjUzOTk4YzhmOWE0NTA5NlwiJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1N0YWNrLm9mKCknLCAoKSA9PiB7XG4gICAgY2xhc3MgTXlOZXN0ZWRTdGFjayBleHRlbmRzIE5lc3RlZFN0YWNrIHtcbiAgICAgIHB1YmxpYyByZWFkb25seSBzdGFja09mQ2hpbGQ6IFN0YWNrO1xuXG4gICAgICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICAgICAgY29uc3QgcGFyYW0gPSBuZXcgQ2ZuUGFyYW1ldGVyKHRoaXMsICdwYXJhbScsIHsgdHlwZTogJ1N0cmluZycgfSk7XG4gICAgICAgIHRoaXMuc3RhY2tPZkNoaWxkID0gU3RhY2sub2YocGFyYW0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHBhcmVudCA9IG5ldyBTdGFjaygpO1xuICAgIGNvbnN0IG5lc3RlZCA9IG5ldyBNeU5lc3RlZFN0YWNrKHBhcmVudCwgJ25lc3RlZCcpO1xuXG4gICAgZXhwZWN0KG5lc3RlZC5zdGFja09mQ2hpbGQpLnRvRXF1YWwobmVzdGVkKTtcbiAgICBleHBlY3QoU3RhY2sub2YobmVzdGVkKSkudG9FcXVhbChuZXN0ZWQpO1xuICB9KTtcblxuICB0ZXN0KCdyZWZlcmVuY2VzIHdpdGhpbiB0aGUgbmVzdGVkIHN0YWNrIGFyZSBub3QgcmVwb3J0ZWQgYXMgY3Jvc3Mgc3RhY2sgcmVmZXJlbmNlcycsICgpID0+IHtcbiAgICBjbGFzcyBNeU5lc3RlZFN0YWNrIGV4dGVuZHMgTmVzdGVkU3RhY2sge1xuICAgICAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZykge1xuICAgICAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgICAgIGNvbnN0IHBhcmFtID0gbmV3IENmblBhcmFtZXRlcih0aGlzLCAncGFyYW0nLCB7IHR5cGU6ICdTdHJpbmcnIH0pO1xuICAgICAgICBuZXcgQ2ZuUmVzb3VyY2UodGhpcywgJ3Jlc291cmNlJywge1xuICAgICAgICAgIHR5cGU6ICdNeTo6UmVzb3VyY2UnLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFNvbWVQcm9wOiBwYXJhbS52YWx1ZUFzU3RyaW5nLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoeyBjb250ZXh0OiB7IFtjeGFwaS5ORVdfU1RZTEVfU1RBQ0tfU1lOVEhFU0lTX0NPTlRFWFRdOiBmYWxzZSB9IH0pO1xuICAgIGNvbnN0IHBhcmVudCA9IG5ldyBTdGFjayhhcHAsICdwYXJlbnQnKTtcblxuICAgIG5ldyBNeU5lc3RlZFN0YWNrKHBhcmVudCwgJ25lc3RlZCcpO1xuXG4gICAgLy8gcmVmZXJlbmNlcyBhcmUgYWRkZWQgZHVyaW5nIFwicHJlcGFyZVwiXG4gICAgY29uc3QgYXNzZW1ibHkgPSBhcHAuc3ludGgoKTtcblxuICAgIGV4cGVjdChhc3NlbWJseS5zdGFja3MubGVuZ3RoKS50b0VxdWFsKDEpO1xuICAgIGV4cGVjdChhc3NlbWJseS5zdGFja3NbMF0uZGVwZW5kZW5jaWVzKS50b0VxdWFsKFtdKTtcbiAgfSk7XG5cbiAgdGVzdCgncmVmZXJlbmNlcyB0byBhIHJlc291cmNlIGZyb20gdGhlIHBhcmVudCBzdGFjayBpbiBhIG5lc3RlZCBzdGFjayBpcyB0cmFuc2xhdGVkIGludG8gYSBjZm4gcGFyYW1ldGVyJywgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBjbGFzcyBNeU5lc3RlZFN0YWNrIGV4dGVuZHMgTmVzdGVkU3RhY2sge1xuXG4gICAgICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCByZXNvdXJjZUZyb21QYXJlbnQ6IENmblJlc291cmNlKSB7XG4gICAgICAgIHN1cGVyKHNjb3BlLCBpZCk7XG5cbiAgICAgICAgbmV3IENmblJlc291cmNlKHRoaXMsICdyZXNvdXJjZScsIHtcbiAgICAgICAgICB0eXBlOiAnQVdTOjpDaGlsZDo6UmVzb3VyY2UnLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFJlZmVyZW5jZVRvUmVzb3VyY2VJblBhcmVudFN0YWNrOiByZXNvdXJjZUZyb21QYXJlbnQucmVmLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBDZm5SZXNvdXJjZSh0aGlzLCAncmVzb3VyY2UyJywge1xuICAgICAgICAgIHR5cGU6ICdNeTo6UmVzb3VyY2U6OjInLFxuICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFByb3AxOiByZXNvdXJjZUZyb21QYXJlbnQuZ2V0QXR0KCdBdHRyJyksXG4gICAgICAgICAgICBQcm9wMjogcmVzb3VyY2VGcm9tUGFyZW50LnJlZixcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3QgcGFyZW50U3RhY2sgPSBuZXcgU3RhY2soYXBwLCAncGFyZW50Jyk7XG5cbiAgICBjb25zdCByZXNvdXJjZSA9IG5ldyBDZm5SZXNvdXJjZShwYXJlbnRTdGFjaywgJ3BhcmVudC1yZXNvdXJjZScsIHsgdHlwZTogJ0FXUzo6UGFyZW50OjpSZXNvdXJjZScgfSk7XG5cbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTXlOZXN0ZWRTdGFjayhwYXJlbnRTdGFjaywgJ25lc3RlZCcsIHJlc291cmNlKTtcblxuICAgIC8vIFRIRU5cbiAgICBhcHAuc3ludGgoKTtcblxuICAgIC8vIG5lc3RlZCB0ZW1wbGF0ZSBzaG91bGQgdXNlIGEgcGFyYW1ldGVyIHRvIHJlZmVyZW5jZSB0aGUgcmVzb3VyY2UgZnJvbSB0aGUgcGFyZW50IHN0YWNrXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG5lc3RlZCkudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFJlc291cmNlczpcbiAgICAgIHtcbiAgICAgICAgcmVzb3VyY2U6XG4gICAgICAgIHtcbiAgICAgICAgICBUeXBlOiAnQVdTOjpDaGlsZDo6UmVzb3VyY2UnLFxuICAgICAgICAgIFByb3BlcnRpZXM6XG4gICAgICAgICAgICB7IFJlZmVyZW5jZVRvUmVzb3VyY2VJblBhcmVudFN0YWNrOiB7IFJlZjogJ3JlZmVyZW5jZXRvcGFyZW50cGFyZW50cmVzb3VyY2VENTZFQThGN1JlZicgfSB9LFxuICAgICAgICB9LFxuICAgICAgICByZXNvdXJjZTI6XG4gICAgICAgIHtcbiAgICAgICAgICBUeXBlOiAnTXk6OlJlc291cmNlOjoyJyxcbiAgICAgICAgICBQcm9wZXJ0aWVzOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFByb3AxOiB7IFJlZjogJ3JlZmVyZW5jZXRvcGFyZW50cGFyZW50cmVzb3VyY2VENTZFQThGN0F0dHInIH0sXG4gICAgICAgICAgICBQcm9wMjogeyBSZWY6ICdyZWZlcmVuY2V0b3BhcmVudHBhcmVudHJlc291cmNlRDU2RUE4RjdSZWYnIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBQYXJhbWV0ZXJzOlxuICAgICAge1xuICAgICAgICByZWZlcmVuY2V0b3BhcmVudHBhcmVudHJlc291cmNlRDU2RUE4RjdSZWY6IHsgVHlwZTogJ1N0cmluZycgfSxcbiAgICAgICAgcmVmZXJlbmNldG9wYXJlbnRwYXJlbnRyZXNvdXJjZUQ1NkVBOEY3QXR0cjogeyBUeXBlOiAnU3RyaW5nJyB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIHBhcmVudCB0ZW1wbGF0ZSBzaG91bGQgcGFzcyBpbiB0aGUgdmFsdWUgdGhyb3VnaCB0aGUgcGFyYW1ldGVyXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBhcmVudFN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q2xvdWRGb3JtYXRpb246OlN0YWNrJywge1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICByZWZlcmVuY2V0b3BhcmVudHBhcmVudHJlc291cmNlRDU2RUE4RjdSZWY6IHtcbiAgICAgICAgICBSZWY6ICdwYXJlbnRyZXNvdXJjZScsXG4gICAgICAgIH0sXG4gICAgICAgIHJlZmVyZW5jZXRvcGFyZW50cGFyZW50cmVzb3VyY2VENTZFQThGN0F0dHI6IHtcbiAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICdwYXJlbnRyZXNvdXJjZScsXG4gICAgICAgICAgICAnQXR0cicsXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JlZmVyZW5jZXMgdG8gYSByZXNvdXJjZSBpbiB0aGUgbmVzdGVkIHN0YWNrIGluIHRoZSBwYXJlbnQgaXMgdHJhbnNsYXRlZCBpbnRvIGEgY2ZuIG91dHB1dCcsICgpID0+IHtcbiAgICBjbGFzcyBNeU5lc3RlZFN0YWNrIGV4dGVuZHMgTmVzdGVkU3RhY2sge1xuICAgICAgcHVibGljIHJlYWRvbmx5IHJlc291cmNlRnJvbUNoaWxkOiBDZm5SZXNvdXJjZTtcblxuICAgICAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZykge1xuICAgICAgICBzdXBlcihzY29wZSwgaWQpO1xuXG4gICAgICAgIHRoaXMucmVzb3VyY2VGcm9tQ2hpbGQgPSBuZXcgQ2ZuUmVzb3VyY2UodGhpcywgJ3Jlc291cmNlJywge1xuICAgICAgICAgIHR5cGU6ICdBV1M6OkNoaWxkOjpSZXNvdXJjZScsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbiAgICBjb25zdCBwYXJlbnRTdGFjayA9IG5ldyBTdGFjayhhcHAsICdwYXJlbnQnKTtcblxuICAgIGNvbnN0IG5lc3RlZCA9IG5ldyBNeU5lc3RlZFN0YWNrKHBhcmVudFN0YWNrLCAnbmVzdGVkJyk7XG5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UocGFyZW50U3RhY2ssICdhbm90aGVyLXBhcmVudC1yZXNvdXJjZScsIHtcbiAgICAgIHR5cGU6ICdBV1M6OlBhcmVudDo6UmVzb3VyY2UnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBSZWZUb1Jlc291cmNlSW5OZXN0ZWRTdGFjazogbmVzdGVkLnJlc291cmNlRnJvbUNoaWxkLnJlZixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyByZWZlcmVuY2VzIGFyZSBhZGRlZCBkdXJpbmcgXCJwcmVwYXJlXCJcbiAgICBhcHAuc3ludGgoKTtcblxuICAgIC8vIG5lc3RlZCB0ZW1wbGF0ZSBzaG91bGQgdXNlIGEgcGFyYW1ldGVyIHRvIHJlZmVyZW5jZSB0aGUgcmVzb3VyY2UgZnJvbSB0aGUgcGFyZW50IHN0YWNrXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG5lc3RlZCkudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFJlc291cmNlczoge1xuICAgICAgICByZXNvdXJjZTogeyBUeXBlOiAnQVdTOjpDaGlsZDo6UmVzb3VyY2UnIH0sXG4gICAgICB9LFxuICAgICAgT3V0cHV0czoge1xuICAgICAgICBwYXJlbnRuZXN0ZWRyZXNvdXJjZTRENjgwNjc3UmVmOiB7IFZhbHVlOiB7IFJlZjogJ3Jlc291cmNlJyB9IH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gcGFyZW50IHRlbXBsYXRlIHNob3VsZCBwYXNzIGluIHRoZSB2YWx1ZSB0aHJvdWdoIHRoZSBwYXJhbWV0ZXJcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50U3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpQYXJlbnQ6OlJlc291cmNlJywge1xuICAgICAgUmVmVG9SZXNvdXJjZUluTmVzdGVkU3RhY2s6IHtcbiAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgJ25lc3RlZE5lc3RlZFN0YWNrbmVzdGVkTmVzdGVkU3RhY2tSZXNvdXJjZTNERDE0M0JGJyxcbiAgICAgICAgICAnT3V0cHV0cy5wYXJlbnRuZXN0ZWRyZXNvdXJjZTRENjgwNjc3UmVmJyxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ25lc3RlZCBzdGFjayByZWZlcmVuY2VzIGEgcmVzb3VyY2UgZnJvbSBhbm90aGVyIG5vbi1uZXN0ZWQgc3RhY2sgKG5vdCB0aGUgcGFyZW50KScsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoeyBjb250ZXh0OiB7IFtjeGFwaS5ORVdfU1RZTEVfU1RBQ0tfU1lOVEhFU0lTX0NPTlRFWFRdOiBmYWxzZSB9IH0pO1xuICAgIGNvbnN0IHN0YWNrMSA9IG5ldyBTdGFjayhhcHAsICdTdGFjazEnKTtcbiAgICBjb25zdCBzdGFjazIgPSBuZXcgU3RhY2soYXBwLCAnU3RhY2syJyk7XG4gICAgY29uc3QgbmVzdGVkVW5kZXJTdGFjazEgPSBuZXcgTmVzdGVkU3RhY2soc3RhY2sxLCAnTmVzdGVkVW5kZXJTdGFjazEnKTtcbiAgICBjb25zdCByZXNvdXJjZUluU3RhY2syID0gbmV3IENmblJlc291cmNlKHN0YWNrMiwgJ1Jlc291cmNlSW5TdGFjazInLCB7IHR5cGU6ICdNeVJlc291cmNlJyB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkVW5kZXJTdGFjazEsICdSZXNvdXJjZUluTmVzdGVkU3RhY2sxJywge1xuICAgICAgdHlwZTogJ05lc3RlZDo6UmVzb3VyY2UnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBSZWZUb1NpYmxpbmc6IHJlc291cmNlSW5TdGFjazIuZ2V0QXR0KCdNeUF0dHJpYnV0ZScpLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBjb25zdCBhc3NlbWJseSA9IGFwcC5zeW50aCgpO1xuXG4gICAgLy8gcHJvZHVjaW5nIHN0YWNrIHNob3VsZCBoYXZlIGFuIGV4cG9ydFxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjazIpLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBSZXNvdXJjZXM6IHtcbiAgICAgICAgUmVzb3VyY2VJblN0YWNrMjogeyBUeXBlOiAnTXlSZXNvdXJjZScgfSxcbiAgICAgIH0sXG4gICAgICBPdXRwdXRzOiB7XG4gICAgICAgIEV4cG9ydHNPdXRwdXRGbkdldEF0dFJlc291cmNlSW5TdGFjazJNeUF0dHJpYnV0ZUMxNUYxMDA5OiB7XG4gICAgICAgICAgVmFsdWU6IHsgJ0ZuOjpHZXRBdHQnOiBbJ1Jlc291cmNlSW5TdGFjazInLCAnTXlBdHRyaWJ1dGUnXSB9LFxuICAgICAgICAgIEV4cG9ydDogeyBOYW1lOiAnU3RhY2syOkV4cG9ydHNPdXRwdXRGbkdldEF0dFJlc291cmNlSW5TdGFjazJNeUF0dHJpYnV0ZUMxNUYxMDA5JyB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIG5lc3RlZCBzdGFjayB1c2VzIEZuOjpJbXBvcnRWYWx1ZSBsaWtlIG5vcm1hbFxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhuZXN0ZWRVbmRlclN0YWNrMSkudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFJlc291cmNlczoge1xuICAgICAgICBSZXNvdXJjZUluTmVzdGVkU3RhY2sxOiB7XG4gICAgICAgICAgVHlwZTogJ05lc3RlZDo6UmVzb3VyY2UnLFxuICAgICAgICAgIFByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFJlZlRvU2libGluZzoge1xuICAgICAgICAgICAgICAnRm46OkltcG9ydFZhbHVlJzogJ1N0YWNrMjpFeHBvcnRzT3V0cHV0Rm5HZXRBdHRSZXNvdXJjZUluU3RhY2syTXlBdHRyaWJ1dGVDMTVGMTAwOScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gdmVyaWZ5IGEgZGVwZWRlbmN5IHdhcyBlc3RhYmxpc2hlZCBiZXR3ZWVuIHRoZSBwYXJlbnRzXG4gICAgY29uc3Qgc3RhY2sxQXJ0aWZhY3QgPSBhc3NlbWJseS5nZXRTdGFja0J5TmFtZShzdGFjazEuc3RhY2tOYW1lKTtcbiAgICBjb25zdCBzdGFjazJBcnRpZmFjdCA9IGFzc2VtYmx5LmdldFN0YWNrQnlOYW1lKHN0YWNrMi5zdGFja05hbWUpO1xuICAgIGV4cGVjdChzdGFjazFBcnRpZmFjdC5kZXBlbmRlbmNpZXMubGVuZ3RoKS50b0VxdWFsKDEpO1xuICAgIGV4cGVjdChzdGFjazJBcnRpZmFjdC5kZXBlbmRlbmNpZXMubGVuZ3RoKS50b0VxdWFsKDApO1xuICAgIGV4cGVjdChzdGFjazFBcnRpZmFjdC5kZXBlbmRlbmNpZXNbMF0pLnRvRXF1YWwoc3RhY2syQXJ0aWZhY3QpO1xuICB9KTtcblxuICB0ZXN0KCduZXN0ZWQgc3RhY2sgd2l0aGluIGEgbmVzdGVkIHN0YWNrIHJlZmVyZW5jZXMgYSByZXNvdXJjZSBpbiBhIHNpYmxpbmcgdG9wLWxldmVsIHN0YWNrJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCh7IGNvbnRleHQ6IHsgW2N4YXBpLk5FV19TVFlMRV9TVEFDS19TWU5USEVTSVNfQ09OVEVYVF06IGZhbHNlIH0gfSk7XG4gICAgY29uc3QgY29uc3VtZXJUb3BMZXZlbCA9IG5ldyBTdGFjayhhcHAsICdDb25zdW1lclRvcExldmVsJyk7XG4gICAgY29uc3QgY29uc3VtZXJOZXN0ZWQxID0gbmV3IE5lc3RlZFN0YWNrKGNvbnN1bWVyVG9wTGV2ZWwsICdDb25zdW1lck5lc3RlZDEnKTtcbiAgICBjb25zdCBjb25zdW1lck5lc3RlZDIgPSBuZXcgTmVzdGVkU3RhY2soY29uc3VtZXJOZXN0ZWQxLCAnQ29uc3VtZXJOZXN0ZWQyJyk7XG4gICAgY29uc3QgcHJvZHVjZXJUb3BMZXZlbCA9IG5ldyBTdGFjayhhcHAsICdQcm9kdWNlclRvcExldmVsJyk7XG4gICAgY29uc3QgcHJvZHVjZXIgPSBuZXcgQ2ZuUmVzb3VyY2UocHJvZHVjZXJUb3BMZXZlbCwgJ1Byb2R1Y2VyJywgeyB0eXBlOiAnUHJvZHVjZXInIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIG5ldyBDZm5SZXNvdXJjZShjb25zdW1lck5lc3RlZDIsICdDb25zdW1lcicsIHtcbiAgICAgIHR5cGU6ICdDb25zdW1lcicsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFJlZjogcHJvZHVjZXIucmVmLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBjb25zdCBtYW5pZmVzdCA9IGFwcC5zeW50aCgpO1xuICAgIGNvbnN0IGNvbnN1bWVyRGVwcyA9IG1hbmlmZXN0LmdldFN0YWNrQXJ0aWZhY3QoY29uc3VtZXJUb3BMZXZlbC5hcnRpZmFjdElkKS5kZXBlbmRlbmNpZXMubWFwKGQgPT4gZC5pZCk7XG4gICAgZXhwZWN0KGNvbnN1bWVyRGVwcykudG9FcXVhbChbJ1Byb2R1Y2VyVG9wTGV2ZWwnXSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Fub3RoZXIgbm9uLW5lc3RlZCBzdGFjayB0YWtlcyBhIHJlZmVyZW5jZSBvbiBhIHJlc291cmNlIHdpdGhpbiB0aGUgbmVzdGVkIHN0YWNrICh0aGUgcGFyZW50IGV4cG9ydHMpJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCh7IGNvbnRleHQ6IHsgW2N4YXBpLk5FV19TVFlMRV9TVEFDS19TWU5USEVTSVNfQ09OVEVYVF06IGZhbHNlIH0gfSk7XG4gICAgY29uc3Qgc3RhY2sxID0gbmV3IFN0YWNrKGFwcCwgJ1N0YWNrMScpO1xuICAgIGNvbnN0IHN0YWNrMiA9IG5ldyBTdGFjayhhcHAsICdTdGFjazInKTtcbiAgICBjb25zdCBuZXN0ZWRVbmRlclN0YWNrMSA9IG5ldyBOZXN0ZWRTdGFjayhzdGFjazEsICdOZXN0ZWRVbmRlclN0YWNrMScpO1xuICAgIGNvbnN0IHJlc291cmNlSW5OZXN0ZWRTdGFjayA9IG5ldyBDZm5SZXNvdXJjZShuZXN0ZWRVbmRlclN0YWNrMSwgJ1Jlc291cmNlSW5OZXN0ZWRTdGFjaycsIHsgdHlwZTogJ015UmVzb3VyY2UnIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIG5ldyBDZm5SZXNvdXJjZShzdGFjazIsICdSZXNvdXJjZUluU3RhY2syJywge1xuICAgICAgdHlwZTogJ0p1c3RSZXNvdXJjZScsXG4gICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgIFJlZlRvU2libGluZzogcmVzb3VyY2VJbk5lc3RlZFN0YWNrLmdldEF0dCgnTXlBdHRyaWJ1dGUnKSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgY29uc3QgYXNzZW1ibHkgPSBhcHAuc3ludGgoKTtcblxuICAgIC8vIG5lc3RlZCBzdGFjayBzaG91bGQgb3V0cHV0IHRoaXMgdmFsdWUgYXMgaWYgaXQgd2FzIHJlZmVyZW5jZWQgYnkgdGhlIHBhcmVudCAod2l0aG91dCB0aGUgZXhwb3J0KVxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhuZXN0ZWRVbmRlclN0YWNrMSkudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFJlc291cmNlczoge1xuICAgICAgICBSZXNvdXJjZUluTmVzdGVkU3RhY2s6IHtcbiAgICAgICAgICBUeXBlOiAnTXlSZXNvdXJjZScsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgT3V0cHV0czoge1xuICAgICAgICBTdGFjazFOZXN0ZWRVbmRlclN0YWNrMVJlc291cmNlSW5OZXN0ZWRTdGFjazZFRTlEQ0QyTXlBdHRyaWJ1dGU6IHtcbiAgICAgICAgICBWYWx1ZToge1xuICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgICAgICdSZXNvdXJjZUluTmVzdGVkU3RhY2snLFxuICAgICAgICAgICAgICAnTXlBdHRyaWJ1dGUnLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIHBhcmVudCBzdGFjayAoc3RhY2sxKSBzaG91bGQgZXhwb3J0IHRoaXMgdmFsdWVcbiAgICBleHBlY3QoYXNzZW1ibHkuZ2V0U3RhY2tCeU5hbWUoc3RhY2sxLnN0YWNrTmFtZSkudGVtcGxhdGUuT3V0cHV0cykudG9FcXVhbCh7XG4gICAgICBFeHBvcnRzT3V0cHV0Rm5HZXRBdHROZXN0ZWRVbmRlclN0YWNrMU5lc3RlZFN0YWNrTmVzdGVkVW5kZXJTdGFjazFOZXN0ZWRTdGFja1Jlc291cmNlRjYxNjMwNUJPdXRwdXRzU3RhY2sxTmVzdGVkVW5kZXJTdGFjazFSZXNvdXJjZUluTmVzdGVkU3RhY2s2RUU5RENEMk15QXR0cmlidXRlNTY0RUVDRjM6IHtcbiAgICAgICAgVmFsdWU6IHsgJ0ZuOjpHZXRBdHQnOiBbJ05lc3RlZFVuZGVyU3RhY2sxTmVzdGVkU3RhY2tOZXN0ZWRVbmRlclN0YWNrMU5lc3RlZFN0YWNrUmVzb3VyY2VGNjE2MzA1QicsICdPdXRwdXRzLlN0YWNrMU5lc3RlZFVuZGVyU3RhY2sxUmVzb3VyY2VJbk5lc3RlZFN0YWNrNkVFOURDRDJNeUF0dHJpYnV0ZSddIH0sXG4gICAgICAgIEV4cG9ydDogeyBOYW1lOiAnU3RhY2sxOkV4cG9ydHNPdXRwdXRGbkdldEF0dE5lc3RlZFVuZGVyU3RhY2sxTmVzdGVkU3RhY2tOZXN0ZWRVbmRlclN0YWNrMU5lc3RlZFN0YWNrUmVzb3VyY2VGNjE2MzA1Qk91dHB1dHNTdGFjazFOZXN0ZWRVbmRlclN0YWNrMVJlc291cmNlSW5OZXN0ZWRTdGFjazZFRTlEQ0QyTXlBdHRyaWJ1dGU1NjRFRUNGMycgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBjb25zdW1pbmcgc3RhY2sgc2hvdWxkIHVzZSBJbXBvcnRWYWx1ZSB0byBpbXBvcnQgdGhlIHZhbHVlIGZyb20gdGhlIHBhcmVudCBzdGFja1xuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjazIpLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBSZXNvdXJjZXM6IHtcbiAgICAgICAgUmVzb3VyY2VJblN0YWNrMjoge1xuICAgICAgICAgIFR5cGU6ICdKdXN0UmVzb3VyY2UnLFxuICAgICAgICAgIFByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFJlZlRvU2libGluZzoge1xuICAgICAgICAgICAgICAnRm46OkltcG9ydFZhbHVlJzogJ1N0YWNrMTpFeHBvcnRzT3V0cHV0Rm5HZXRBdHROZXN0ZWRVbmRlclN0YWNrMU5lc3RlZFN0YWNrTmVzdGVkVW5kZXJTdGFjazFOZXN0ZWRTdGFja1Jlc291cmNlRjYxNjMwNUJPdXRwdXRzU3RhY2sxTmVzdGVkVW5kZXJTdGFjazFSZXNvdXJjZUluTmVzdGVkU3RhY2s2RUU5RENEMk15QXR0cmlidXRlNTY0RUVDRjMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGV4cGVjdChhc3NlbWJseS5zdGFja3MubGVuZ3RoKS50b0VxdWFsKDIpO1xuICAgIGNvbnN0IHN0YWNrMUFydGlmYWN0ID0gYXNzZW1ibHkuZ2V0U3RhY2tCeU5hbWUoc3RhY2sxLnN0YWNrTmFtZSk7XG4gICAgY29uc3Qgc3RhY2syQXJ0aWZhY3QgPSBhc3NlbWJseS5nZXRTdGFja0J5TmFtZShzdGFjazIuc3RhY2tOYW1lKTtcbiAgICBleHBlY3Qoc3RhY2sxQXJ0aWZhY3QuZGVwZW5kZW5jaWVzLmxlbmd0aCkudG9FcXVhbCgwKTtcbiAgICBleHBlY3Qoc3RhY2syQXJ0aWZhY3QuZGVwZW5kZW5jaWVzLmxlbmd0aCkudG9FcXVhbCgxKTtcbiAgICBleHBlY3Qoc3RhY2syQXJ0aWZhY3QuZGVwZW5kZW5jaWVzWzBdKS50b0VxdWFsKHN0YWNrMUFydGlmYWN0KTtcbiAgfSk7XG5cbiAgdGVzdCgncmVmZXJlbmNlcyBiZXR3ZWVuIHNpYmxpbmcgbmVzdGVkIHN0YWNrcyBzaG91bGQgb3V0cHV0IGZyb20gb25lIGFuZCBnZXRBdHQgZnJvbSB0aGUgb3RoZXInLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3QgcGFyZW50ID0gbmV3IFN0YWNrKGFwcCwgJ1BhcmVudCcpO1xuICAgIGNvbnN0IG5lc3RlZDEgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnTmVzdGVkMScpO1xuICAgIGNvbnN0IG5lc3RlZDIgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnTmVzdGVkMicpO1xuICAgIGNvbnN0IHJlc291cmNlMSA9IG5ldyBDZm5SZXNvdXJjZShuZXN0ZWQxLCAnUmVzb3VyY2UxJywgeyB0eXBlOiAnUmVzb3VyY2UxJyB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkMiwgJ1Jlc291cmNlMicsIHtcbiAgICAgIHR5cGU6ICdSZXNvdXJjZTInLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICBSZWZUb1Jlc291cmNlMTogcmVzb3VyY2UxLnJlZixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgYXBwLnN5bnRoKCk7XG5cbiAgICAvLyBwcm9kdWNpbmcgbmVzdGVkIHN0YWNrXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG5lc3RlZDEpLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBSZXNvdXJjZXM6IHtcbiAgICAgICAgUmVzb3VyY2UxOiB7XG4gICAgICAgICAgVHlwZTogJ1Jlc291cmNlMScsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgT3V0cHV0czoge1xuICAgICAgICBQYXJlbnROZXN0ZWQxUmVzb3VyY2UxNUYzRjA2NTdSZWY6IHtcbiAgICAgICAgICBWYWx1ZToge1xuICAgICAgICAgICAgUmVmOiAnUmVzb3VyY2UxJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIGNvbnN1bWluZyBuZXN0ZWQgc3RhY2tcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2sobmVzdGVkMikudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFJlc291cmNlczoge1xuICAgICAgICBSZXNvdXJjZTI6IHtcbiAgICAgICAgICBUeXBlOiAnUmVzb3VyY2UyJyxcbiAgICAgICAgICBQcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICBSZWZUb1Jlc291cmNlMToge1xuICAgICAgICAgICAgICBSZWY6ICdyZWZlcmVuY2V0b1BhcmVudE5lc3RlZDFOZXN0ZWRTdGFja05lc3RlZDFOZXN0ZWRTdGFja1Jlc291cmNlOUMwNTM0MkNPdXRwdXRzUGFyZW50TmVzdGVkMVJlc291cmNlMTVGM0YwNjU3UmVmJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIHJlZmVyZW5jZXRvUGFyZW50TmVzdGVkMU5lc3RlZFN0YWNrTmVzdGVkMU5lc3RlZFN0YWNrUmVzb3VyY2U5QzA1MzQyQ091dHB1dHNQYXJlbnROZXN0ZWQxUmVzb3VyY2UxNUYzRjA2NTdSZWY6IHtcbiAgICAgICAgICBUeXBlOiAnU3RyaW5nJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBwYXJlbnRcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50KS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q2xvdWRGb3JtYXRpb246OlN0YWNrJywge1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICByZWZlcmVuY2V0b1BhcmVudE5lc3RlZDFOZXN0ZWRTdGFja05lc3RlZDFOZXN0ZWRTdGFja1Jlc291cmNlOUMwNTM0MkNPdXRwdXRzUGFyZW50TmVzdGVkMVJlc291cmNlMTVGM0YwNjU3UmVmOiB7XG4gICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgICAnTmVzdGVkMU5lc3RlZFN0YWNrTmVzdGVkMU5lc3RlZFN0YWNrUmVzb3VyY2VDRDBBRDM2QicsXG4gICAgICAgICAgICAnT3V0cHV0cy5QYXJlbnROZXN0ZWQxUmVzb3VyY2UxNUYzRjA2NTdSZWYnLFxuICAgICAgICAgIF0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdzdGFja0lkIHJldHVybnMgQVdTOjpTdGFja0lkIHdoZW4gcmVmZXJlbmNlZCBmcm9tIHRoZSBjb250ZXh0IG9mIHRoZSBuZXN0ZWQgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnTmVzdGVkU3RhY2snKTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkLCAnTmVzdGVkUmVzb3VyY2UnLCB7XG4gICAgICB0eXBlOiAnTmVzdGVkOjpSZXNvdXJjZScsXG4gICAgICBwcm9wZXJ0aWVzOiB7IE15U3RhY2tJZDogbmVzdGVkLnN0YWNrSWQgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2sobmVzdGVkKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ05lc3RlZDo6UmVzb3VyY2UnLCB7XG4gICAgICBNeVN0YWNrSWQ6IHsgUmVmOiAnQVdTOjpTdGFja0lkJyB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdzdGFja0lkIHJldHVybnMgdGhlIFJFRiBvZiB0aGUgQ2xvdWRGb3JtYXRpb246OlN0YWNrIHJlc291cmNlIHdoZW4gcmVmZXJlbmNlZCBmcm9tIHRoZSBwYXJlbnQgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnTmVzdGVkU3RhY2snKTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UocGFyZW50LCAnUGFyZW50UmVzb3VyY2UnLCB7XG4gICAgICB0eXBlOiAnUGFyZW50OjpSZXNvdXJjZScsXG4gICAgICBwcm9wZXJ0aWVzOiB7IE5lc3RlZFN0YWNrSWQ6IG5lc3RlZC5zdGFja0lkIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBhcmVudCkuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdQYXJlbnQ6OlJlc291cmNlJywge1xuICAgICAgTmVzdGVkU3RhY2tJZDogeyBSZWY6ICdOZXN0ZWRTdGFja05lc3RlZFN0YWNrTmVzdGVkU3RhY2tOZXN0ZWRTdGFja1Jlc291cmNlQjcwODM0RkQnIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3N0YWNrTmFtZSByZXR1cm5zIEFXUzo6U3RhY2tOYW1lIHdoZW4gcmVmZXJlbmNlZCBmcm9tIHRoZSBjb250ZXh0IG9mIHRoZSBuZXN0ZWQgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnTmVzdGVkU3RhY2snKTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkLCAnTmVzdGVkUmVzb3VyY2UnLCB7XG4gICAgICB0eXBlOiAnTmVzdGVkOjpSZXNvdXJjZScsXG4gICAgICBwcm9wZXJ0aWVzOiB7IE15U3RhY2tOYW1lOiBuZXN0ZWQuc3RhY2tOYW1lIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG5lc3RlZCkuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdOZXN0ZWQ6OlJlc291cmNlJywge1xuICAgICAgTXlTdGFja05hbWU6IHsgUmVmOiAnQVdTOjpTdGFja05hbWUnIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3N0YWNrTmFtZSByZXR1cm5zIHRoZSBSRUYgb2YgdGhlIENsb3VkRm9ybWF0aW9uOjpTdGFjayByZXNvdXJjZSB3aGVuIHJlZmVyZW5jZWQgZnJvbSB0aGUgcGFyZW50IHN0YWNrJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcGFyZW50ID0gbmV3IFN0YWNrKCk7XG4gICAgY29uc3QgbmVzdGVkID0gbmV3IE5lc3RlZFN0YWNrKHBhcmVudCwgJ05lc3RlZFN0YWNrJyk7XG5cbiAgICAvLyBXSEVOXG4gICAgbmV3IENmblJlc291cmNlKHBhcmVudCwgJ1BhcmVudFJlc291cmNlJywge1xuICAgICAgdHlwZTogJ1BhcmVudDo6UmVzb3VyY2UnLFxuICAgICAgcHJvcGVydGllczogeyBOZXN0ZWRTdGFja05hbWU6IG5lc3RlZC5zdGFja05hbWUgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50KS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ1BhcmVudDo6UmVzb3VyY2UnLCB7XG4gICAgICBOZXN0ZWRTdGFja05hbWU6IHtcbiAgICAgICAgJ0ZuOjpTZWxlY3QnOiBbXG4gICAgICAgICAgMSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICAnRm46OlNwbGl0JzogW1xuICAgICAgICAgICAgICAnLycsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBSZWY6ICdOZXN0ZWRTdGFja05lc3RlZFN0YWNrTmVzdGVkU3RhY2tOZXN0ZWRTdGFja1Jlc291cmNlQjcwODM0RkQnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnXCJhY2NvdW50XCIsIFwicmVnaW9uXCIgYW5kIFwiZW52aXJvbm1lbnRcIiBhcmUgYWxsIGRlcml2ZWQgZnJvbSB0aGUgcGFyZW50JywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCgpO1xuICAgIGNvbnN0IHBhcmVudCA9IG5ldyBTdGFjayhhcHAsICdQYXJlbnRTdGFjaycsIHsgZW52OiB7IGFjY291bnQ6ICcxMjM0YWNjb3VudCcsIHJlZ2lvbjogJ3VzLWVhc3QtNDQnIH0gfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgbmVzdGVkID0gbmV3IE5lc3RlZFN0YWNrKHBhcmVudCwgJ05lc3RlZFN0YWNrJyk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KG5lc3RlZC5lbnZpcm9ubWVudCkudG9FcXVhbChwYXJlbnQuZW52aXJvbm1lbnQpO1xuICAgIGV4cGVjdChuZXN0ZWQuYWNjb3VudCkudG9FcXVhbChwYXJlbnQuYWNjb3VudCk7XG4gICAgZXhwZWN0KG5lc3RlZC5yZWdpb24pLnRvRXF1YWwocGFyZW50LnJlZ2lvbik7XG4gIH0pO1xuXG4gIHRlc3QoJ2RvdWJsZS1uZXN0ZWQgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKHsgY29udGV4dDogeyBbY3hhcGkuTkVXX1NUWUxFX1NUQUNLX1NZTlRIRVNJU19DT05URVhUXTogZmFsc2UgfSB9KTtcbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soYXBwLCAnc3RhY2snKTtcblxuICAgIC8vIFdIRU5cbiAgICBjb25zdCBuZXN0ZWQxID0gbmV3IE5lc3RlZFN0YWNrKHBhcmVudCwgJ05lc3RlZDEnKTtcbiAgICBjb25zdCBuZXN0ZWQyID0gbmV3IE5lc3RlZFN0YWNrKG5lc3RlZDEsICdOZXN0ZWQyJyk7XG5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkMSwgJ1Jlc291cmNlMScsIHsgdHlwZTogJ1Jlc291cmNlOjoxJyB9KTtcbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkMiwgJ1Jlc291cmNlMicsIHsgdHlwZTogJ1Jlc291cmNlOjoyJyB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBjb25zdCBhc3NlbWJseSA9IGFwcC5zeW50aCgpO1xuXG4gICAgLy8gbmVzdGVkMiBpcyBhIFwibGVhZlwiLCBzbyBpdCdzIGp1c3QgdGhlIHJlc291cmNlXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG5lc3RlZDIpLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBSZXNvdXJjZXM6IHtcbiAgICAgICAgUmVzb3VyY2UyOiB7IFR5cGU6ICdSZXNvdXJjZTo6MicgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCBtaWRkbGVTdGFja0hhc2ggPSAnN2M0MjZmNzI5OWE3Mzk5MDAyNzlhYzFlY2UwNDAzOTdjMTkxM2NkZjc4NmY1MjI4Njc3YjI4OWY0ZDVlNGM0OCc7XG4gICAgY29uc3QgYnVja2V0U3VmZml4ID0gJ0M3MDZCMTAxJztcbiAgICBjb25zdCB2ZXJzaW9uU3VmZml4ID0gJzRCMTkzQUE1JztcbiAgICBjb25zdCBoYXNoU3VmZml4ID0gJ0UyOEYwNjkzJztcblxuICAgIC8vIG5lc3RlZDEgd2lyZXMgdGhlIG5lc3RlZDIgdGVtcGxhdGUgdGhyb3VnaCBwYXJhbWV0ZXJzLCBzbyB3ZSBleHBlY3QgdGhvc2VcbiAgICBjb25zdCBuZXN0ZWQxVGVtcGxhdGUgPSBUZW1wbGF0ZS5mcm9tU3RhY2sobmVzdGVkMSk7XG4gICAgbmVzdGVkMVRlbXBsYXRlLnJlc291cmNlQ291bnRJcygnUmVzb3VyY2U6OjEnLCAxKTtcbiAgICBjb25zdCBuZXN0ZWQyVGVtcGxhdGUgPSBuZXN0ZWQxVGVtcGxhdGUudG9KU09OKCk7XG4gICAgZXhwZWN0KG5lc3RlZDJUZW1wbGF0ZS5QYXJhbWV0ZXJzKS50b0VxdWFsKHtcbiAgICAgIHJlZmVyZW5jZXRvc3RhY2tBc3NldFBhcmFtZXRlcnM4MTY5YzZmOGFhZWFmNWUyZTg2MjBmNWY4OTVmZmUyMDk5MjAyY2NiNGI2ODg5ZGY0OGZlMDk2N2E4OTQyMzVjUzNCdWNrZXRFODc2OEY1Q1JlZjogeyBUeXBlOiAnU3RyaW5nJyB9LFxuICAgICAgcmVmZXJlbmNldG9zdGFja0Fzc2V0UGFyYW1ldGVyczgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNTM1ZlcnNpb25LZXk0OUREODNBMlJlZjogeyBUeXBlOiAnU3RyaW5nJyB9LFxuICAgIH0pO1xuXG4gICAgLy8gcGFyZW50IHN0YWNrIHNob3VsZCBoYXZlIHR3byBzZXRzIG9mIHBhcmFtZXRlcnMuIG9uZSBmb3IgdGhlIGZpcnN0IG5lc3RlZCBzdGFjayBhbmQgdGhlIHNlY29uZFxuICAgIC8vIGZvciB0aGUgc2Vjb25kIG5lc3RlZCBzdGFjaywgcGFzc2VkIGluIGFzIHBhcmFtZXRlcnMgdG8gdGhlIGZpcnN0XG4gICAgY29uc3QgdGVtcGxhdGUgPSBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50KS50b0pTT04oKTtcbiAgICBleHBlY3QodGVtcGxhdGUuUGFyYW1ldGVycykudG9FcXVhbCh7XG4gICAgICBBc3NldFBhcmFtZXRlcnM4MTY5YzZmOGFhZWFmNWUyZTg2MjBmNWY4OTVmZmUyMDk5MjAyY2NiNGI2ODg5ZGY0OGZlMDk2N2E4OTQyMzVjUzNCdWNrZXRERTNCODhENjogeyBUeXBlOiAnU3RyaW5nJywgRGVzY3JpcHRpb246ICdTMyBidWNrZXQgZm9yIGFzc2V0IFwiODE2OWM2ZjhhYWVhZjVlMmU4NjIwZjVmODk1ZmZlMjA5OTIwMmNjYjRiNjg4OWRmNDhmZTA5NjdhODk0MjM1Y1wiJyB9LFxuICAgICAgQXNzZXRQYXJhbWV0ZXJzODE2OWM2ZjhhYWVhZjVlMmU4NjIwZjVmODk1ZmZlMjA5OTIwMmNjYjRiNjg4OWRmNDhmZTA5NjdhODk0MjM1Y1MzVmVyc2lvbktleTNBNjJFRkVBOiB7IFR5cGU6ICdTdHJpbmcnLCBEZXNjcmlwdGlvbjogJ1MzIGtleSBmb3IgYXNzZXQgdmVyc2lvbiBcIjgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNcIicgfSxcbiAgICAgIEFzc2V0UGFyYW1ldGVyczgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNBcnRpZmFjdEhhc2g3REM1NDZFMDogeyBUeXBlOiAnU3RyaW5nJywgRGVzY3JpcHRpb246ICdBcnRpZmFjdCBoYXNoIGZvciBhc3NldCBcIjgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNcIicgfSxcbiAgICAgIFtgQXNzZXRQYXJhbWV0ZXJzJHttaWRkbGVTdGFja0hhc2h9UzNCdWNrZXQke2J1Y2tldFN1ZmZpeH1gXTogeyBUeXBlOiAnU3RyaW5nJywgRGVzY3JpcHRpb246IGBTMyBidWNrZXQgZm9yIGFzc2V0IFwiJHttaWRkbGVTdGFja0hhc2h9XCJgIH0sXG4gICAgICBbYEFzc2V0UGFyYW1ldGVycyR7bWlkZGxlU3RhY2tIYXNofVMzVmVyc2lvbktleSR7dmVyc2lvblN1ZmZpeH1gXTogeyBUeXBlOiAnU3RyaW5nJywgRGVzY3JpcHRpb246IGBTMyBrZXkgZm9yIGFzc2V0IHZlcnNpb24gXCIke21pZGRsZVN0YWNrSGFzaH1cImAgfSxcbiAgICAgIFtgQXNzZXRQYXJhbWV0ZXJzJHttaWRkbGVTdGFja0hhc2h9QXJ0aWZhY3RIYXNoJHtoYXNoU3VmZml4fWBdOiB7IFR5cGU6ICdTdHJpbmcnLCBEZXNjcmlwdGlvbjogYEFydGlmYWN0IGhhc2ggZm9yIGFzc2V0IFwiJHttaWRkbGVTdGFja0hhc2h9XCJgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBwcm94eSBhc3NldCBwYXJhbXMgdG8gbmVzdGVkIHN0YWNrXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBhcmVudCkuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNsb3VkRm9ybWF0aW9uOjpTdGFjaycsIHtcbiAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgcmVmZXJlbmNldG9zdGFja0Fzc2V0UGFyYW1ldGVyczgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNTM0J1Y2tldEU4NzY4RjVDUmVmOiB7IFJlZjogJ0Fzc2V0UGFyYW1ldGVyczgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNTM0J1Y2tldERFM0I4OEQ2JyB9LFxuICAgICAgICByZWZlcmVuY2V0b3N0YWNrQXNzZXRQYXJhbWV0ZXJzODE2OWM2ZjhhYWVhZjVlMmU4NjIwZjVmODk1ZmZlMjA5OTIwMmNjYjRiNjg4OWRmNDhmZTA5NjdhODk0MjM1Y1MzVmVyc2lvbktleTQ5REQ4M0EyUmVmOiB7IFJlZjogJ0Fzc2V0UGFyYW1ldGVyczgxNjljNmY4YWFlYWY1ZTJlODYyMGY1Zjg5NWZmZTIwOTkyMDJjY2I0YjY4ODlkZjQ4ZmUwOTY3YTg5NDIzNWNTM1ZlcnNpb25LZXkzQTYyRUZFQScgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBwYXJlbnQgc3RhY2sgc2hvdWxkIGhhdmUgMiBhc3NldHNcbiAgICBleHBlY3QoYXNzZW1ibHkuZ2V0U3RhY2tCeU5hbWUocGFyZW50LnN0YWNrTmFtZSkuYXNzZXRzLmxlbmd0aCkudG9FcXVhbCgyKTtcbiAgfSk7XG5cbiAgdGVzdCgncmVmZXJlbmNlIHJlc291cmNlIGluIGEgZG91YmxlIG5lc3RlZCBzdGFjayAoIzE1MTU1KScsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbiAgICBjb25zdCBwcm9kdWNlclN0YWNrID0gbmV3IFN0YWNrKGFwcCwgJ1Byb2R1Y2VyJyk7XG4gICAgY29uc3QgbmVzdGVkMiA9IG5ldyBOZXN0ZWRTdGFjayhuZXcgTmVzdGVkU3RhY2socHJvZHVjZXJTdGFjaywgJ05lc3RlZDEnKSwgJ05lc3RlZDInKTtcbiAgICBjb25zdCBwcm9kdWNlclJlc291cmNlID0gbmV3IENmblJlc291cmNlKG5lc3RlZDIsICdSZXNvdXJjZScsIHsgdHlwZTogJ015UmVzb3VyY2UnIH0pO1xuICAgIGNvbnN0IGNvbnN1bWVyU3RhY2sgPSBuZXcgU3RhY2soYXBwLCAnQ29uc3VtZXInKTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UoY29uc3VtZXJTdGFjaywgJ0NvbnN1bWluZ1Jlc291cmNlJywge1xuICAgICAgdHlwZTogJ1lvdXJSZXNvdXJjZScsXG4gICAgICBwcm9wZXJ0aWVzOiB7IFJlZlRvUmVzb3VyY2U6IHByb2R1Y2VyUmVzb3VyY2UucmVmIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgY29uc3QgY2FzbSA9IGFwcC5zeW50aCgpOyAvLyBiZWZvcmUgIzE1MTU1IHdhcyBmaXhlZCB0aGlzIHRocmV3IGFuIGVycm9yXG5cbiAgICBjb25zdCBwcm9kdWNlclRlbXBsYXRlID0gY2FzbS5nZXRTdGFja0FydGlmYWN0KHByb2R1Y2VyU3RhY2suYXJ0aWZhY3RJZCkudGVtcGxhdGU7XG4gICAgY29uc3QgY29uc3VtZXJUZW1wbGF0ZSA9IGNhc20uZ2V0U3RhY2tBcnRpZmFjdChjb25zdW1lclN0YWNrLmFydGlmYWN0SWQpLnRlbXBsYXRlO1xuXG4gICAgLy8gY2hlY2sgdGhhdCB0aGUgY29uc3VtaW5nIHJlc291cmNlIHJlZmVyZW5jZXMgdGhlIGV4cGVjdGVkIGV4cG9ydCBuYW1lXG4gICAgY29uc3Qgb3V0cHV0TmFtZSA9ICdFeHBvcnRzT3V0cHV0Rm5HZXRBdHROZXN0ZWQxTmVzdGVkU3RhY2tOZXN0ZWQxTmVzdGVkU3RhY2tSZXNvdXJjZUNEMEFEMzZCT3V0cHV0c1Byb2R1Y2VyTmVzdGVkMU5lc3RlZDJOZXN0ZWRTdGFja05lc3RlZDJOZXN0ZWRTdGFja1Jlc291cmNlMUU2RkEzQzNPdXRwdXRzUHJvZHVjZXJOZXN0ZWQxTmVzdGVkMjM4QTg5Q0M1UmVmMkU5RTUyRUEnO1xuICAgIGNvbnN0IGV4cG9ydE5hbWUgPSBwcm9kdWNlclRlbXBsYXRlLk91dHB1dHNbb3V0cHV0TmFtZV0uRXhwb3J0Lk5hbWU7XG4gICAgY29uc3QgaW1wb3J0TmFtZSA9IGNvbnN1bWVyVGVtcGxhdGUuUmVzb3VyY2VzLkNvbnN1bWluZ1Jlc291cmNlLlByb3BlcnRpZXMuUmVmVG9SZXNvdXJjZVsnRm46OkltcG9ydFZhbHVlJ107XG4gICAgZXhwZWN0KGV4cG9ydE5hbWUpLnRvRXF1YWwoaW1wb3J0TmFtZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2Fzc2V0cyB3aXRoaW4gbmVzdGVkIHN0YWNrcyBhcmUgcHJveGllZCBmcm9tIHRoZSBwYXJlbnQnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKHsgY29udGV4dDogeyBbY3hhcGkuTkVXX1NUWUxFX1NUQUNLX1NZTlRIRVNJU19DT05URVhUXTogZmFsc2UgfSB9KTtcbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soYXBwLCAnUGFyZW50U3RhY2snKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnTmVzdGVkU3RhY2snKTtcblxuICAgIC8vIFdIRU5cbiAgICBjb25zdCBhc3NldCA9IG5ldyBzM19hc3NldHMuQXNzZXQobmVzdGVkLCAnYXNzZXQnLCB7XG4gICAgICBwYXRoOiBwYXRoLmpvaW4oX19kaXJuYW1lLCAnYXNzZXQtZml4dHVyZS50eHQnKSxcbiAgICB9KTtcblxuICAgIG5ldyBDZm5SZXNvdXJjZShuZXN0ZWQsICdOZXN0ZWRSZXNvdXJjZScsIHtcbiAgICAgIHR5cGU6ICdOZXN0ZWQ6OlJlc291cmNlJyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgQXNzZXRCdWNrZXQ6IGFzc2V0LnMzQnVja2V0TmFtZSxcbiAgICAgICAgQXNzZXRLZXk6IGFzc2V0LnMzT2JqZWN0S2V5LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBjb25zdCBhc3NlbWJseSA9IGFwcC5zeW50aCgpO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gVGVtcGxhdGUuZnJvbVN0YWNrKHBhcmVudCkudG9KU09OKCk7XG5cbiAgICAvLyB0d28gc2V0cyBvZiBhc3NldCBwYXJhbWV0ZXJzOiBvbmUgZm9yIHRoZSBuZXN0ZWQgc3RhY2sgaXRzZWxmIGFuZCBvbmUgYXMgYSBwcm94eSBmb3IgdGhlIGFzc2V0IHdpdGhpbiB0aGUgc3RhY2tcbiAgICBleHBlY3QodGVtcGxhdGUuUGFyYW1ldGVycykudG9FcXVhbCh7XG4gICAgICBBc3NldFBhcmFtZXRlcnNkYjAxZWUyZWI3YWRjNzkxNWUzNjRkYzQxMGQ4NjFlNTY5NTQzZjliZTM3NjFkNTM1YTY4ZDVjMmNjMTgxMjgxUzNCdWNrZXRDMTg4RjYzNzogeyBUeXBlOiAnU3RyaW5nJywgRGVzY3JpcHRpb246ICdTMyBidWNrZXQgZm9yIGFzc2V0IFwiZGIwMWVlMmViN2FkYzc5MTVlMzY0ZGM0MTBkODYxZTU2OTU0M2Y5YmUzNzYxZDUzNWE2OGQ1YzJjYzE4MTI4MVwiJyB9LFxuICAgICAgQXNzZXRQYXJhbWV0ZXJzZGIwMWVlMmViN2FkYzc5MTVlMzY0ZGM0MTBkODYxZTU2OTU0M2Y5YmUzNzYxZDUzNWE2OGQ1YzJjYzE4MTI4MVMzVmVyc2lvbktleUM3RjREQkYyOiB7IFR5cGU6ICdTdHJpbmcnLCBEZXNjcmlwdGlvbjogJ1MzIGtleSBmb3IgYXNzZXQgdmVyc2lvbiBcImRiMDFlZTJlYjdhZGM3OTE1ZTM2NGRjNDEwZDg2MWU1Njk1NDNmOWJlMzc2MWQ1MzVhNjhkNWMyY2MxODEyODFcIicgfSxcbiAgICAgIEFzc2V0UGFyYW1ldGVyc2RiMDFlZTJlYjdhZGM3OTE1ZTM2NGRjNDEwZDg2MWU1Njk1NDNmOWJlMzc2MWQ1MzVhNjhkNWMyY2MxODEyODFBcnRpZmFjdEhhc2gzNzNCMTREMjogeyBUeXBlOiAnU3RyaW5nJywgRGVzY3JpcHRpb246ICdBcnRpZmFjdCBoYXNoIGZvciBhc3NldCBcImRiMDFlZTJlYjdhZGM3OTE1ZTM2NGRjNDEwZDg2MWU1Njk1NDNmOWJlMzc2MWQ1MzVhNjhkNWMyY2MxODEyODFcIicgfSxcbiAgICAgIEFzc2V0UGFyYW1ldGVyczQ2YjEwN2Q2ZGI3OThjYTQ2MDQ2Yjg2NjlkMDU3YTRkZWJjYmRiYWFkZGI2MTcwNDAwNzQ4YzJmOWU0ZjlkNzFTM0J1Y2tldDNDNDI2NUU5OiB7IFR5cGU6ICdTdHJpbmcnLCBEZXNjcmlwdGlvbjogJ1MzIGJ1Y2tldCBmb3IgYXNzZXQgXCI0NmIxMDdkNmRiNzk4Y2E0NjA0NmI4NjY5ZDA1N2E0ZGViY2JkYmFhZGRiNjE3MDQwMDc0OGMyZjllNGY5ZDcxXCInIH0sXG4gICAgICBBc3NldFBhcmFtZXRlcnM0NmIxMDdkNmRiNzk4Y2E0NjA0NmI4NjY5ZDA1N2E0ZGViY2JkYmFhZGRiNjE3MDQwMDc0OGMyZjllNGY5ZDcxUzNWZXJzaW9uS2V5OEU5ODE1MzU6IHsgVHlwZTogJ1N0cmluZycsIERlc2NyaXB0aW9uOiAnUzMga2V5IGZvciBhc3NldCB2ZXJzaW9uIFwiNDZiMTA3ZDZkYjc5OGNhNDYwNDZiODY2OWQwNTdhNGRlYmNiZGJhYWRkYjYxNzA0MDA3NDhjMmY5ZTRmOWQ3MVwiJyB9LFxuICAgICAgQXNzZXRQYXJhbWV0ZXJzNDZiMTA3ZDZkYjc5OGNhNDYwNDZiODY2OWQwNTdhNGRlYmNiZGJhYWRkYjYxNzA0MDA3NDhjMmY5ZTRmOWQ3MUFydGlmYWN0SGFzaDQ1QTI4NTgzOiB7IFR5cGU6ICdTdHJpbmcnLCBEZXNjcmlwdGlvbjogJ0FydGlmYWN0IGhhc2ggZm9yIGFzc2V0IFwiNDZiMTA3ZDZkYjc5OGNhNDYwNDZiODY2OWQwNTdhNGRlYmNiZGJhYWRkYjYxNzA0MDA3NDhjMmY5ZTRmOWQ3MVwiJyB9LFxuICAgIH0pO1xuXG4gICAgLy8gYXNzZXQgcHJveHkgcGFyYW1ldGVycyBhcmUgcGFzc2VkIHRvIHRoZSBuZXN0ZWQgc3RhY2tcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50KS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q2xvdWRGb3JtYXRpb246OlN0YWNrJywge1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICByZWZlcmVuY2V0b1BhcmVudFN0YWNrQXNzZXRQYXJhbWV0ZXJzZGIwMWVlMmViN2FkYzc5MTVlMzY0ZGM0MTBkODYxZTU2OTU0M2Y5YmUzNzYxZDUzNWE2OGQ1YzJjYzE4MTI4MVMzQnVja2V0ODJDNTVCOTZSZWY6IHsgUmVmOiAnQXNzZXRQYXJhbWV0ZXJzZGIwMWVlMmViN2FkYzc5MTVlMzY0ZGM0MTBkODYxZTU2OTU0M2Y5YmUzNzYxZDUzNWE2OGQ1YzJjYzE4MTI4MVMzQnVja2V0QzE4OEY2MzcnIH0sXG4gICAgICAgIHJlZmVyZW5jZXRvUGFyZW50U3RhY2tBc3NldFBhcmFtZXRlcnNkYjAxZWUyZWI3YWRjNzkxNWUzNjRkYzQxMGQ4NjFlNTY5NTQzZjliZTM3NjFkNTM1YTY4ZDVjMmNjMTgxMjgxUzNWZXJzaW9uS2V5QTQzQzNDQzZSZWY6IHsgUmVmOiAnQXNzZXRQYXJhbWV0ZXJzZGIwMWVlMmViN2FkYzc5MTVlMzY0ZGM0MTBkODYxZTU2OTU0M2Y5YmUzNzYxZDUzNWE2OGQ1YzJjYzE4MTI4MVMzVmVyc2lvbktleUM3RjREQkYyJyB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIHBhcmVudCBzdGFjayBzaG91bGQgaGF2ZSAyIGFzc2V0c1xuICAgIGV4cGVjdChhc3NlbWJseS5nZXRTdGFja0J5TmFtZShwYXJlbnQuc3RhY2tOYW1lKS5hc3NldHMubGVuZ3RoKS50b0VxdWFsKDIpO1xuICB9KTtcblxuICB0ZXN0KCdkb2NrZXIgaW1hZ2UgYXNzZXRzIGFyZSB3aXJlZCB0aHJvdWdoIHRoZSB0b3AtbGV2ZWwgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKHsgY29udGV4dDogeyBbY3hhcGkuTkVXX1NUWUxFX1NUQUNLX1NZTlRIRVNJU19DT05URVhUXTogZmFsc2UgfSB9KTtcbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soYXBwLCAnbXktc3RhY2snKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2socGFyZW50LCAnbmVzdGVkLXN0YWNrJyk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgbG9jYXRpb24gPSBuZXN0ZWQuc3ludGhlc2l6ZXIuYWRkRG9ja2VySW1hZ2VBc3NldCh7XG4gICAgICBkaXJlY3RvcnlOYW1lOiAnbXktaW1hZ2UnLFxuICAgICAgZG9ja2VyQnVpbGRBcmdzOiB7IGtleTogJ3ZhbHVlJywgYm9vbTogJ2JhbScgfSxcbiAgICAgIGRvY2tlckJ1aWxkVGFyZ2V0OiAnYnVpbGRUYXJnZXQnLFxuICAgICAgc291cmNlSGFzaDogJ2hhc2gtb2Ytc291cmNlJyxcbiAgICB9KTtcblxuICAgIC8vIHVzZSB0aGUgYXNzZXQsIHNvIHRoZSBwYXJhbWV0ZXJzIHdpbGwgYmUgd2lyZWQuXG4gICAgbmV3IHNucy5Ub3BpYyhuZXN0ZWQsICdNeVRvcGljJywge1xuICAgICAgZGlzcGxheU5hbWU6IGBpbWFnZSBsb2NhdGlvbiBpcyAke2xvY2F0aW9uLmltYWdlVXJpfWAsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgY29uc3QgYXNtID0gYXBwLnN5bnRoKCk7XG4gICAgZXhwZWN0KGFzbS5nZXRTdGFja0FydGlmYWN0KHBhcmVudC5hcnRpZmFjdElkKS5hc3NldHMpLnRvRXF1YWwoW1xuICAgICAge1xuICAgICAgICByZXBvc2l0b3J5TmFtZTogJ2F3cy1jZGsvYXNzZXRzJyxcbiAgICAgICAgaW1hZ2VUYWc6ICdoYXNoLW9mLXNvdXJjZScsXG4gICAgICAgIGlkOiAnaGFzaC1vZi1zb3VyY2UnLFxuICAgICAgICBwYWNrYWdpbmc6ICdjb250YWluZXItaW1hZ2UnLFxuICAgICAgICBwYXRoOiAnbXktaW1hZ2UnLFxuICAgICAgICBzb3VyY2VIYXNoOiAnaGFzaC1vZi1zb3VyY2UnLFxuICAgICAgICBidWlsZEFyZ3M6IHsga2V5OiAndmFsdWUnLCBib29tOiAnYmFtJyB9LFxuICAgICAgICB0YXJnZXQ6ICdidWlsZFRhcmdldCcsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBwYXRoOiAnbXlzdGFja25lc3RlZHN0YWNrRkFFMTJGQjUubmVzdGVkLnRlbXBsYXRlLmpzb24nLFxuICAgICAgICBpZDogJ2ZjZGFlZTc5ZWI3OWYzN2VjYTNhOWIxY2MwY2M5YmExNTBlNGVlYThjNWQ2ZDBjMzQzY2I2Y2Q5ZGM2OGUyZTUnLFxuICAgICAgICBwYWNrYWdpbmc6ICdmaWxlJyxcbiAgICAgICAgc291cmNlSGFzaDogJ2ZjZGFlZTc5ZWI3OWYzN2VjYTNhOWIxY2MwY2M5YmExNTBlNGVlYThjNWQ2ZDBjMzQzY2I2Y2Q5ZGM2OGUyZTUnLFxuICAgICAgICBzM0J1Y2tldFBhcmFtZXRlcjogJ0Fzc2V0UGFyYW1ldGVyc2ZjZGFlZTc5ZWI3OWYzN2VjYTNhOWIxY2MwY2M5YmExNTBlNGVlYThjNWQ2ZDBjMzQzY2I2Y2Q5ZGM2OGUyZTVTM0J1Y2tldDY3QTc0OUY4JyxcbiAgICAgICAgczNLZXlQYXJhbWV0ZXI6ICdBc3NldFBhcmFtZXRlcnNmY2RhZWU3OWViNzlmMzdlY2EzYTliMWNjMGNjOWJhMTUwZTRlZWE4YzVkNmQwYzM0M2NiNmNkOWRjNjhlMmU1UzNWZXJzaW9uS2V5RTFFNkE4RDQnLFxuICAgICAgICBhcnRpZmFjdEhhc2hQYXJhbWV0ZXI6ICdBc3NldFBhcmFtZXRlcnNmY2RhZWU3OWViNzlmMzdlY2EzYTliMWNjMGNjOWJhMTUwZTRlZWE4YzVkNmQwYzM0M2NiNmNkOWRjNjhlMmU1QXJ0aWZhY3RIYXNoMEFFREJFOEEnLFxuICAgICAgfSxcbiAgICBdKTtcbiAgfSk7XG5cbiAgdGVzdCgnbWV0YWRhdGEgZGVmaW5lZCBpbiBuZXN0ZWQgc3RhY2tzIGlzIHJlcG9ydGVkIGF0IHRoZSBwYXJlbnQgc3RhY2sgbGV2ZWwgaW4gdGhlIGNsb3VkIGFzc2VtYmx5JywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCh7IHN0YWNrVHJhY2VzOiBmYWxzZSB9KTtcbiAgICBjb25zdCBwYXJlbnQgPSBuZXcgU3RhY2soYXBwLCAncGFyZW50Jyk7XG4gICAgY29uc3QgY2hpbGQgPSBuZXcgU3RhY2socGFyZW50LCAnY2hpbGQnKTtcbiAgICBjb25zdCBuZXN0ZWQgPSBuZXcgTmVzdGVkU3RhY2soY2hpbGQsICduZXN0ZWQnKTtcbiAgICBjb25zdCByZXNvdXJjZSA9IG5ldyBDZm5SZXNvdXJjZShuZXN0ZWQsICdyZXNvdXJjZScsIHsgdHlwZTogJ2ZvbycgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgcmVzb3VyY2Uubm9kZS5hZGRNZXRhZGF0YSgnZm9vJywgJ2JhcicpO1xuXG4gICAgLy8gVEhFTjogdGhlIGZpcnN0IG5vbi1uZXN0ZWQgc3RhY2sgcmVjb3JkcyB0aGUgYXNzZW1ibHkgbWV0YWRhdGFcbiAgICBjb25zdCBhc20gPSBhcHAuc3ludGgoKTtcbiAgICBleHBlY3QoYXNtLnN0YWNrcy5sZW5ndGgpLnRvRXF1YWwoMik7IC8vIG9ubHkgb25lIHN0YWNrIGlzIGRlZmluZWQgYXMgYW4gYXJ0aWZhY3RcbiAgICBleHBlY3QoYXNtLmdldFN0YWNrQnlOYW1lKHBhcmVudC5zdGFja05hbWUpLmZpbmRNZXRhZGF0YUJ5VHlwZSgnZm9vJykpLnRvRXF1YWwoW10pO1xuICAgIGV4cGVjdChhc20uZ2V0U3RhY2tCeU5hbWUoY2hpbGQuc3RhY2tOYW1lKS5maW5kTWV0YWRhdGFCeVR5cGUoJ2ZvbycpKS50b0VxdWFsKFtcbiAgICAgIHtcbiAgICAgICAgcGF0aDogJy9wYXJlbnQvY2hpbGQvbmVzdGVkL3Jlc291cmNlJyxcbiAgICAgICAgdHlwZTogJ2ZvbycsXG4gICAgICAgIGRhdGE6ICdiYXInLFxuICAgICAgfSxcbiAgICBdKTtcbiAgfSk7XG5cbiAgdGVzdCgncmVmZXJlbmNpbmcgYXR0cmlidXRlcyB3aXRoIHBlcmlvZCBhY3Jvc3Mgc3RhY2tzJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgcGFyZW50ID0gbmV3IFN0YWNrKCk7XG4gICAgY29uc3QgbmVzdGVkID0gbmV3IE5lc3RlZFN0YWNrKHBhcmVudCwgJ25lc3RlZCcpO1xuICAgIGNvbnN0IGNvbnN1bWVkID0gbmV3IENmblJlc291cmNlKG5lc3RlZCwgJ3Jlc291cmNlLWluLW5lc3RlZCcsIHsgdHlwZTogJ0NPTlNVTUVEJyB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UocGFyZW50LCAncmVzb3VyY2UtaW4tcGFyZW50Jywge1xuICAgICAgdHlwZTogJ0NPTlNVTUVSJyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgQ29uc3VtZWRBdHRyaWJ1dGU6IGNvbnN1bWVkLmdldEF0dCgnQ29uc3VtZWQuQXR0cmlidXRlJyksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhuZXN0ZWQpLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBSZXNvdXJjZXM6IHtcbiAgICAgICAgcmVzb3VyY2Vpbm5lc3RlZDoge1xuICAgICAgICAgIFR5cGU6ICdDT05TVU1FRCcsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgT3V0cHV0czoge1xuICAgICAgICBuZXN0ZWRyZXNvdXJjZWlubmVzdGVkNTlCMUYwMUNDb25zdW1lZEF0dHJpYnV0ZToge1xuICAgICAgICAgIFZhbHVlOiB7XG4gICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgJ3Jlc291cmNlaW5uZXN0ZWQnLFxuICAgICAgICAgICAgICAnQ29uc3VtZWQuQXR0cmlidXRlJyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGFyZW50KS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0NPTlNVTUVSJywge1xuICAgICAgQ29uc3VtZWRBdHRyaWJ1dGU6IHtcbiAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgJ25lc3RlZE5lc3RlZFN0YWNrbmVzdGVkTmVzdGVkU3RhY2tSZXNvdXJjZTNERDE0M0JGJyxcbiAgICAgICAgICAnT3V0cHV0cy5uZXN0ZWRyZXNvdXJjZWlubmVzdGVkNTlCMUYwMUNDb25zdW1lZEF0dHJpYnV0ZScsXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdtaXNzaW5nIGNvbnRleHQgaW4gbmVzdGVkIHN0YWNrIGlzIHJlcG9ydGVkIGlmIHRoZSBjb250ZXh0IGlzIG5vdCBhdmFpbGFibGUnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgU3RhY2soYXBwLCAnUGFyZW50U3RhY2snLCB7IGVudjogeyBhY2NvdW50OiAnMTIzNGFjY291bnQnLCByZWdpb246ICd1cy1lYXN0LTQ0JyB9IH0pO1xuICAgIGNvbnN0IG5lc3RlZFN0YWNrID0gbmV3IE5lc3RlZFN0YWNrKHN0YWNrLCAnbmVzdGVkJyk7XG4gICAgY29uc3QgcHJvdmlkZXIgPSAnYXZhaWxhYmlsaXR5LXpvbmVzJztcbiAgICBjb25zdCBleHBlY3RlZEtleSA9IENvbnRleHRQcm92aWRlci5nZXRLZXkobmVzdGVkU3RhY2ssIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgIH0pLmtleTtcblxuICAgIC8vIFdIRU5cbiAgICBDb250ZXh0UHJvdmlkZXIuZ2V0VmFsdWUobmVzdGVkU3RhY2ssIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgZHVtbXlWYWx1ZTogWydkdW1teTFhJywgJ2R1bW15MWInLCAnZHVtbXkxYyddLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTjogbWlzc2luZyBjb250ZXh0IGlzIHJlcG9ydGVkIGluIHRoZSBjbG91ZCBhc3NlbWJseVxuICAgIGNvbnN0IGFzbSA9IGFwcC5zeW50aCgpO1xuICAgIGNvbnN0IG1pc3NpbmcgPSBhc20ubWFuaWZlc3QubWlzc2luZztcblxuICAgIGV4cGVjdChtaXNzaW5nICYmIG1pc3NpbmcuZmluZChtID0+IHtcbiAgICAgIHJldHVybiAobS5rZXkgPT09IGV4cGVjdGVkS2V5KTtcbiAgICB9KSkudG9CZVRydXRoeSgpO1xuICB9KTtcblxuICB0ZXN0KCczLWxldmVsIHN0YWNrczogbGVnYWN5IHN5bnRoZXNpemVyIHBhcmFtZXRlcnMgYXJlIGFkZGVkIHRvIHRoZSBtaWRkbGUtbGV2ZWwgc3RhY2snLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKCk7XG4gICAgY29uc3QgdG9wID0gbmV3IFN0YWNrKGFwcCwgJ3N0YWNrJywge1xuICAgICAgc3ludGhlc2l6ZXI6IG5ldyBMZWdhY3lTdGFja1N5bnRoZXNpemVyKCksXG4gICAgfSk7XG4gICAgY29uc3QgbWlkZGxlID0gbmV3IE5lc3RlZFN0YWNrKHRvcCwgJ25lc3RlZDEnKTtcbiAgICBjb25zdCBib3R0b20gPSBuZXcgTmVzdGVkU3RhY2sobWlkZGxlLCAnbmVzdGVkMicpO1xuXG4gICAgLy8gV0hFTlxuICAgIG5ldyBDZm5SZXNvdXJjZShib3R0b20sICdTb21ldGhpbmcnLCB7XG4gICAgICB0eXBlOiAnQm90dG9tTGV2ZWwnLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGNvbnN0IGFzbSA9IGFwcC5zeW50aCgpO1xuICAgIGNvbnN0IG1pZGRsZVRlbXBsYXRlID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGFzbS5kaXJlY3RvcnksIG1pZGRsZS50ZW1wbGF0ZUZpbGUpLCB7IGVuY29kaW5nOiAndXRmLTgnIH0pKTtcblxuICAgIGNvbnN0IGhhc2ggPSAnYmMzYzUxZTRkMzU0NWVlMGEwMDY5NDAxZTVhMzJjMzdiNjZkMDQ0Yjk4M2YxMmRlNDE2YmExNTc2ZWNhZjBhNCc7XG4gICAgZXhwZWN0KG1pZGRsZVRlbXBsYXRlLlBhcmFtZXRlcnMgPz8ge30pLnRvRXF1YWwoe1xuICAgICAgW2ByZWZlcmVuY2V0b3N0YWNrQXNzZXRQYXJhbWV0ZXJzJHtoYXNofVMzQnVja2V0RDdDMzA0MzVSZWZgXToge1xuICAgICAgICBUeXBlOiAnU3RyaW5nJyxcbiAgICAgIH0sXG4gICAgICBbYHJlZmVyZW5jZXRvc3RhY2tBc3NldFBhcmFtZXRlcnMke2hhc2h9UzNWZXJzaW9uS2V5QjY2N0RCRTFSZWZgXToge1xuICAgICAgICBUeXBlOiAnU3RyaW5nJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JlZmVyZW5jZXMgdG8gYSByZXNvdXJjZSBmcm9tIGEgZGVlcGx5IG5lc3RlZCBzdGFjaycsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IGFwcCA9IG5ldyBBcHAoeyBjb250ZXh0OiB7IFtjeGFwaS5ORVdfU1RZTEVfU1RBQ0tfU1lOVEhFU0lTX0NPTlRFWFRdOiBmYWxzZSB9IH0pO1xuICAgIGNvbnN0IHRvcCA9IG5ldyBTdGFjayhhcHAsICdzdGFjaycpO1xuICAgIGNvbnN0IHRvcExldmVsID0gbmV3IENmblJlc291cmNlKHRvcCwgJ3RvcGxldmVsJywgeyB0eXBlOiAnVG9wTGV2ZWwnIH0pO1xuICAgIGNvbnN0IG5lc3RlZDEgPSBuZXcgTmVzdGVkU3RhY2sodG9wLCAnbmVzdGVkMScpO1xuICAgIGNvbnN0IG5lc3RlZDIgPSBuZXcgTmVzdGVkU3RhY2sobmVzdGVkMSwgJ25lc3RlZDInKTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgQ2ZuUmVzb3VyY2UobmVzdGVkMiwgJ3JlZlRvVG9wTGV2ZWwnLCB7XG4gICAgICB0eXBlOiAnQm90dG9tTGV2ZWwnLFxuICAgICAgcHJvcGVydGllczogeyBSZWZUb1RvcExldmVsOiB0b3BMZXZlbC5yZWYgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2sodG9wKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q2xvdWRGb3JtYXRpb246OlN0YWNrJywge1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICByZWZlcmVuY2V0b3N0YWNrQXNzZXRQYXJhbWV0ZXJzODQyOTgyYmQ0MjFjY2U5NzQyYmEyNzE1MWVmMTJlZDY5OWQ0NGQyMjgwMWY0MWU4MDI5ZjYzZjIzNThhM2YyZlMzQnVja2V0NURBNUQyRTdSZWY6IHtcbiAgICAgICAgICBSZWY6ICdBc3NldFBhcmFtZXRlcnM4NDI5ODJiZDQyMWNjZTk3NDJiYTI3MTUxZWYxMmVkNjk5ZDQ0ZDIyODAxZjQxZTgwMjlmNjNmMjM1OGEzZjJmUzNCdWNrZXRERDREOTZCNScsXG4gICAgICAgIH0sXG4gICAgICAgIHJlZmVyZW5jZXRvc3RhY2tBc3NldFBhcmFtZXRlcnM4NDI5ODJiZDQyMWNjZTk3NDJiYTI3MTUxZWYxMmVkNjk5ZDQ0ZDIyODAxZjQxZTgwMjlmNjNmMjM1OGEzZjJmUzNWZXJzaW9uS2V5OEZCRTVDMTJSZWY6IHtcbiAgICAgICAgICBSZWY6ICdBc3NldFBhcmFtZXRlcnM4NDI5ODJiZDQyMWNjZTk3NDJiYTI3MTUxZWYxMmVkNjk5ZDQ0ZDIyODAxZjQxZTgwMjlmNjNmMjM1OGEzZjJmUzNWZXJzaW9uS2V5ODNFMzgxRjMnLFxuICAgICAgICB9LFxuICAgICAgICByZWZlcmVuY2V0b3N0YWNrdG9wbGV2ZWxCQjE2QkYxM1JlZjoge1xuICAgICAgICAgIFJlZjogJ3RvcGxldmVsJyxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2sobmVzdGVkMSkuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNsb3VkRm9ybWF0aW9uOjpTdGFjaycsIHtcbiAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgcmVmZXJlbmNldG9zdGFja3RvcGxldmVsQkIxNkJGMTNSZWY6IHtcbiAgICAgICAgICBSZWY6ICdyZWZlcmVuY2V0b3N0YWNrdG9wbGV2ZWxCQjE2QkYxM1JlZicsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG5lc3RlZDIpLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBSZXNvdXJjZXM6IHtcbiAgICAgICAgcmVmVG9Ub3BMZXZlbDoge1xuICAgICAgICAgIFR5cGU6ICdCb3R0b21MZXZlbCcsXG4gICAgICAgICAgUHJvcGVydGllczoge1xuICAgICAgICAgICAgUmVmVG9Ub3BMZXZlbDoge1xuICAgICAgICAgICAgICBSZWY6ICdyZWZlcmVuY2V0b3N0YWNrdG9wbGV2ZWxCQjE2QkYxM1JlZicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICByZWZlcmVuY2V0b3N0YWNrdG9wbGV2ZWxCQjE2QkYxM1JlZjoge1xuICAgICAgICAgIFR5cGU6ICdTdHJpbmcnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnYm90dG9tIG5lc3RlZCBzdGFjayBjb25zdW1lcyB2YWx1ZSBmcm9tIGEgdG9wLWxldmVsIHN0YWNrIHRocm91Z2ggYSBwYXJhbWV0ZXIgaW4gYSBtaWRkbGUgbmVzdGVkIHN0YWNrJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgYXBwID0gbmV3IEFwcCh7IGNvbnRleHQ6IHsgW2N4YXBpLk5FV19TVFlMRV9TVEFDS19TWU5USEVTSVNfQ09OVEVYVF06IGZhbHNlIH0gfSk7XG4gICAgY29uc3QgdG9wID0gbmV3IFN0YWNrKGFwcCwgJ0dyYW5kcGFyZW50Jyk7XG4gICAgY29uc3QgbWlkZGxlID0gbmV3IE5lc3RlZFN0YWNrKHRvcCwgJ1BhcmVudCcpO1xuICAgIGNvbnN0IGJvdHRvbSA9IG5ldyBOZXN0ZWRTdGFjayhtaWRkbGUsICdDaGlsZCcpO1xuICAgIGNvbnN0IHJlc291cmNlSW5HcmFuZHBhcmVudCA9IG5ldyBDZm5SZXNvdXJjZSh0b3AsICdSZXNvdXJjZUluR3JhbmRwYXJlbnQnLCB7IHR5cGU6ICdSZXNvdXJjZUluR3JhbmRwYXJlbnQnIH0pO1xuXG4gICAgLy8gV0hFTlxuICAgIG5ldyBDZm5SZXNvdXJjZShib3R0b20sICdSZXNvdXJjZUluQ2hpbGQnLCB7XG4gICAgICB0eXBlOiAnUmVzb3VyY2VJbkNoaWxkJyxcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgUmVmVG9HcmFuZHBhcmVudDogcmVzb3VyY2VJbkdyYW5kcGFyZW50LnJlZixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG5cbiAgICAvLyB0aGlzIGlzIHRoZSBuYW1lIGFsbG9jYXRlZCBmb3IgdGhlIHBhcmFtZXRlciB0aGF0J3MgcHJvcGFnYXRlZCB0aHJvdWdoXG4gICAgLy8gdGhlIGhpZXJhcmNoeS5cbiAgICBjb25zdCBwYXJhbU5hbWUgPSAncmVmZXJlbmNldG9HcmFuZHBhcmVudFJlc291cmNlSW5HcmFuZHBhcmVudDAxMEU5OTdBUmVmJztcblxuICAgIC8vIGNoaWxkIChib3R0b20pIHJlZmVyZW5jZXMgdGhyb3VnaCBhIHBhcmFtZXRlci5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soYm90dG9tKS50ZW1wbGF0ZU1hdGNoZXMoe1xuICAgICAgUmVzb3VyY2VzOiB7XG4gICAgICAgIFJlc291cmNlSW5DaGlsZDoge1xuICAgICAgICAgIFR5cGU6ICdSZXNvdXJjZUluQ2hpbGQnLFxuICAgICAgICAgIFByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgIFJlZlRvR3JhbmRwYXJlbnQ6IHsgUmVmOiBwYXJhbU5hbWUgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgW3BhcmFtTmFtZV06IHsgVHlwZTogJ1N0cmluZycgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyB0aGUgcGFyZW50IChtaWRkbGUpIHNldHMgdGhlIHZhbHVlIG9mIHRoaXMgcGFyYW1ldGVyIHRvIGJlIGEgcmVmZXJlbmNlIHRvIGFub3RoZXIgcGFyYW1ldGVyXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKG1pZGRsZSkuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNsb3VkRm9ybWF0aW9uOjpTdGFjaycsIHtcbiAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgW3BhcmFtTmFtZV06IHsgUmVmOiBwYXJhbU5hbWUgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBncmFuZHBhcmVudCAodG9wKSBhc3NpZ25zIHRoZSBhY3R1YWwgdmFsdWUgdG8gdGhlIHBhcmFtZXRlclxuICAgIFRlbXBsYXRlLmZyb21TdGFjayh0b3ApLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDbG91ZEZvcm1hdGlvbjo6U3RhY2snLCB7XG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIFtwYXJhbU5hbWVdOiB7IFJlZjogJ1Jlc291cmNlSW5HcmFuZHBhcmVudCcgfSxcblxuICAgICAgICAvLyB0aGVzZSBhcmUgZm9yIHRoZSBhc3NldCBvZiB0aGUgYm90dG9tIG5lc3RlZCBzdGFja1xuICAgICAgICByZWZlcmVuY2V0b0dyYW5kcGFyZW50QXNzZXRQYXJhbWV0ZXJzMzIwOGY0M2I3OTNhMWRiZTI4Y2EwMmNmMzFmYjk3NTQ4OTA3MWJlYjQyYzQ5MmIyMmRjM2QzMmRlY2MzYjRiN1MzQnVja2V0MDZFRUU1OERSZWY6IHtcbiAgICAgICAgICBSZWY6ICdBc3NldFBhcmFtZXRlcnMzMjA4ZjQzYjc5M2ExZGJlMjhjYTAyY2YzMWZiOTc1NDg5MDcxYmViNDJjNDkyYjIyZGMzZDMyZGVjYzNiNGI3UzNCdWNrZXQwMTg3N0MyRScsXG4gICAgICAgIH0sXG4gICAgICAgIHJlZmVyZW5jZXRvR3JhbmRwYXJlbnRBc3NldFBhcmFtZXRlcnMzMjA4ZjQzYjc5M2ExZGJlMjhjYTAyY2YzMWZiOTc1NDg5MDcxYmViNDJjNDkyYjIyZGMzZDMyZGVjYzNiNGI3UzNWZXJzaW9uS2V5RDNCMDQ5MDlSZWY6IHtcbiAgICAgICAgICBSZWY6ICdBc3NldFBhcmFtZXRlcnMzMjA4ZjQzYjc5M2ExZGJlMjhjYTAyY2YzMWZiOTc1NDg5MDcxYmViNDJjNDkyYjIyZGMzZDMyZGVjYzNiNGI3UzNWZXJzaW9uS2V5NTc2NUYwODQnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==