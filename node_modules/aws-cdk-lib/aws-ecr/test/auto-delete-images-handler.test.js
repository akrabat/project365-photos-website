"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const mockECRClient = {
    listImages: jest.fn().mockReturnThis(),
    batchDeleteImage: jest.fn().mockReturnThis(),
    describeRepositories: jest.fn().mockReturnThis(),
    listTagsForResource: jest.fn().mockReturnThis(),
    promise: jest.fn(),
};
const auto_delete_images_handler_1 = require("../lib/auto-delete-images-handler");
jest.mock('aws-sdk', () => {
    return { ECR: jest.fn(() => mockECRClient) };
});
beforeEach(() => {
    mockECRClient.listImages.mockReturnThis();
    mockECRClient.batchDeleteImage.mockReturnThis();
    mockECRClient.listTagsForResource.mockReturnThis();
    mockECRClient.describeRepositories.mockReturnThis();
    givenTaggedForDeletion();
});
afterEach(() => {
    jest.resetAllMocks();
});
test('does nothing on create event', async () => {
    // GIVEN
    const event = {
        RequestType: 'Create',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    // WHEN
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(0);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(0);
});
test('does nothing on update event when everything remains the same', async () => {
    // GIVEN
    const event = {
        RequestType: 'Update',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
        OldResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    // WHEN
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(0);
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(0);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(0);
});
test('does nothing on update event when the repository name remains the same but the service token changes', async () => {
    // GIVEN
    const event = {
        RequestType: 'Update',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
        OldResourceProperties: {
            ServiceToken: 'Bar',
            RespositoryName: 'MyRepo',
        },
    };
    // WHEN
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(0);
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(0);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(0);
});
test('does nothing on update event when the new resource properties are absent', async () => {
    // GIVEN
    const event = {
        RequestType: 'Update',
        OldResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    // WHEN
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(0);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(0);
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(0);
});
test('does nothing on update event when the old resource properties are absent', async () => {
    // GIVEN
    const event = {
        RequestType: 'Update',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    // WHEN
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(0);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(0);
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(0);
});
test('deletes all objects when the name changes on update event', async () => {
    // GIVEN
    mockAwsPromise(mockECRClient.describeRepositories, {
        repositories: [
            { repositoryArn: 'RepositoryArn', respositoryName: 'MyRepo' },
        ],
    });
    mockAwsPromise(mockECRClient.listImages, {
        imageIds: [
            { imageDigest: 'ImageDigest1', imageTag: 'ImageTag1' },
            { imageDigest: 'ImageDigest2', imageTag: 'ImageTag2' },
        ],
    });
    const event = {
        RequestType: 'Update',
        OldResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo-renamed',
        },
    };
    // WHEN
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(1);
    expect(mockECRClient.listImages).toHaveBeenCalledWith({ repositoryName: 'MyRepo' });
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(1);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledWith({
        repositoryName: 'MyRepo',
        imageIds: [
            { imageDigest: 'ImageDigest1', imageTag: 'ImageTag1' },
            { imageDigest: 'ImageDigest2', imageTag: 'ImageTag2' },
        ],
    });
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(1);
});
test('deletes no images on delete event when repository has no images', async () => {
    // GIVEN
    mockECRClient.promise.mockResolvedValue({ imageIds: [] }); // listedImages() call
    // WHEN
    const event = {
        RequestType: 'Delete',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(1);
    expect(mockECRClient.listImages).toHaveBeenCalledWith({ repositoryName: 'MyRepo' });
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(0);
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(1);
});
test('deletes all images on delete event', async () => {
    mockECRClient.promise.mockResolvedValue({
        imageIds: [
            {
                imageTag: 'tag1',
                imageDigest: 'sha256-1',
            },
            {
                imageTag: 'tag2',
                imageDigest: 'sha256-2',
            },
        ],
    });
    // WHEN
    const event = {
        RequestType: 'Delete',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(1);
    expect(mockECRClient.listImages).toHaveBeenCalledWith({ repositoryName: 'MyRepo' });
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(1);
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledWith({
        repositoryName: 'MyRepo',
        imageIds: [
            {
                imageTag: 'tag1',
                imageDigest: 'sha256-1',
            },
            {
                imageTag: 'tag2',
                imageDigest: 'sha256-2',
            },
        ],
    });
});
test('does not empty repository if it is not tagged', async () => {
    // GIVEN
    givenNotTaggedForDeletion();
    mockECRClient.promise.mockResolvedValue({
        imageIds: [
            {
                imageTag: 'tag1',
                imageDigest: 'sha256-1',
            },
            {
                imageTag: 'tag2',
                imageDigest: 'sha256-2',
            },
        ],
    });
    // WHEN
    const event = {
        RequestType: 'Delete',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.batchDeleteImage).not.toHaveBeenCalled();
});
test('delete event where repo has many images does recurse appropriately', async () => {
    // GIVEN
    mockAwsPromise(mockECRClient.describeRepositories, {
        repositories: [
            { repositoryArn: 'RepositoryArn', respositoryName: 'MyRepo' },
        ],
    });
    mockECRClient.promise // listedImages() call
        .mockResolvedValueOnce({
        imageIds: [
            {
                imageTag: 'tag1',
                imageDigest: 'sha256-1',
            },
            {
                imageTag: 'tag2',
                imageDigest: 'sha256-2',
            },
        ],
        nextToken: 'token1',
    })
        .mockResolvedValueOnce(undefined) // batchDeleteImage() call
        .mockResolvedValueOnce({
        imageIds: [
            {
                imageTag: 'tag3',
                imageDigest: 'sha256-3',
            },
            {
                imageTag: 'tag4',
                imageDigest: 'sha256-4',
            },
        ],
    });
    // WHEN
    const event = {
        RequestType: 'Delete',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    await invokeHandler(event);
    // THEN
    expect(mockECRClient.describeRepositories).toHaveBeenCalledTimes(1);
    expect(mockECRClient.listImages).toHaveBeenCalledTimes(2);
    expect(mockECRClient.listImages).toHaveBeenCalledWith({ repositoryName: 'MyRepo' });
    expect(mockECRClient.batchDeleteImage).toHaveBeenCalledTimes(2);
    expect(mockECRClient.batchDeleteImage).toHaveBeenNthCalledWith(1, {
        repositoryName: 'MyRepo',
        imageIds: [
            {
                imageTag: 'tag1',
                imageDigest: 'sha256-1',
            },
            {
                imageTag: 'tag2',
                imageDigest: 'sha256-2',
            },
        ],
    });
    expect(mockECRClient.batchDeleteImage).toHaveBeenNthCalledWith(2, {
        repositoryName: 'MyRepo',
        imageIds: [
            {
                imageTag: 'tag3',
                imageDigest: 'sha256-3',
            },
            {
                imageTag: 'tag4',
                imageDigest: 'sha256-4',
            },
        ],
    });
});
test('does nothing when the repository does not exist', async () => {
    // GIVEN
    mockECRClient.promise.mockRejectedValue({ name: 'RepositoryNotFoundException' });
    mockAwsPromise(mockECRClient.describeRepositories, {
        repositories: [
            { repositoryArn: 'RepositoryArn', respositoryName: 'MyRepo' },
        ],
    });
    // WHEN
    const event = {
        RequestType: 'Delete',
        ResourceProperties: {
            ServiceToken: 'Foo',
            RepositoryName: 'MyRepo',
        },
    };
    await invokeHandler(event);
    expect(mockECRClient.batchDeleteImage).not.toHaveBeenCalled();
});
// helper function to get around TypeScript expecting a complete event object,
// even though our tests only need some of the fields
async function invokeHandler(event) {
    return (0, auto_delete_images_handler_1.handler)(event);
}
function mockAwsPromise(fn, value, when = 'always') {
    (when === 'always' ? fn.mockReturnValue : fn.mockReturnValueOnce).call(fn, {
        promise: () => value,
    });
}
function givenTaggedForDeletion() {
    mockAwsPromise(mockECRClient.listTagsForResource, {
        tags: [
            {
                Key: 'aws-cdk:auto-delete-images',
                Value: 'true',
            },
        ],
    });
}
function givenNotTaggedForDeletion() {
    mockAwsPromise(mockECRClient.listTagsForResource, {
        tags: [],
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0by1kZWxldGUtaW1hZ2VzLWhhbmRsZXIudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImF1dG8tZGVsZXRlLWltYWdlcy1oYW5kbGVyLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLGFBQWEsR0FBRztJQUNwQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGNBQWMsRUFBRTtJQUN0QyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsY0FBYyxFQUFFO0lBQzVDLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxjQUFjLEVBQUU7SUFDaEQsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGNBQWMsRUFBRTtJQUMvQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUNuQixDQUFDO0FBRUYsa0ZBQTREO0FBRTVELElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtJQUN4QixPQUFPLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQztBQUMvQyxDQUFDLENBQUMsQ0FBQztBQUVILFVBQVUsQ0FBQyxHQUFHLEVBQUU7SUFDZCxhQUFhLENBQUMsVUFBVSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQzFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUNoRCxhQUFhLENBQUMsbUJBQW1CLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDbkQsYUFBYSxDQUFDLG9CQUFvQixDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3BELHNCQUFzQixFQUFFLENBQUM7QUFDM0IsQ0FBQyxDQUFDLENBQUM7QUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO0lBQ2IsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0FBQ3ZCLENBQUMsQ0FBQyxDQUFDO0FB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TCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9ja0VDUkNsaWVudCA9IHtcbiAgbGlzdEltYWdlczogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gIGJhdGNoRGVsZXRlSW1hZ2U6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBkZXNjcmliZVJlcG9zaXRvcmllczogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gIGxpc3RUYWdzRm9yUmVzb3VyY2U6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICBwcm9taXNlOiBqZXN0LmZuKCksXG59O1xuXG5pbXBvcnQgeyBoYW5kbGVyIH0gZnJvbSAnLi4vbGliL2F1dG8tZGVsZXRlLWltYWdlcy1oYW5kbGVyJztcblxuamVzdC5tb2NrKCdhd3Mtc2RrJywgKCkgPT4ge1xuICByZXR1cm4geyBFQ1I6IGplc3QuZm4oKCkgPT4gbW9ja0VDUkNsaWVudCkgfTtcbn0pO1xuXG5iZWZvcmVFYWNoKCgpID0+IHtcbiAgbW9ja0VDUkNsaWVudC5saXN0SW1hZ2VzLm1vY2tSZXR1cm5UaGlzKCk7XG4gIG1vY2tFQ1JDbGllbnQuYmF0Y2hEZWxldGVJbWFnZS5tb2NrUmV0dXJuVGhpcygpO1xuICBtb2NrRUNSQ2xpZW50Lmxpc3RUYWdzRm9yUmVzb3VyY2UubW9ja1JldHVyblRoaXMoKTtcbiAgbW9ja0VDUkNsaWVudC5kZXNjcmliZVJlcG9zaXRvcmllcy5tb2NrUmV0dXJuVGhpcygpO1xuICBnaXZlblRhZ2dlZEZvckRlbGV0aW9uKCk7XG59KTtcblxuYWZ0ZXJFYWNoKCgpID0+IHtcbiAgamVzdC5yZXNldEFsbE1vY2tzKCk7XG59KTtcblxudGVzdCgnZG9lcyBub3RoaW5nIG9uIGNyZWF0ZSBldmVudCcsIGFzeW5jICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3QgZXZlbnQ6IFBhcnRpYWw8QVdTTGFtYmRhLkNsb3VkRm9ybWF0aW9uQ3VzdG9tUmVzb3VyY2VDcmVhdGVFdmVudD4gPSB7XG4gICAgUmVxdWVzdFR5cGU6ICdDcmVhdGUnLFxuICAgIFJlc291cmNlUHJvcGVydGllczoge1xuICAgICAgU2VydmljZVRva2VuOiAnRm9vJyxcbiAgICAgIFJlcG9zaXRvcnlOYW1lOiAnTXlSZXBvJyxcbiAgICB9LFxuICB9O1xuXG4gIC8vIFdIRU5cbiAgYXdhaXQgaW52b2tlSGFuZGxlcihldmVudCk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3QobW9ja0VDUkNsaWVudC5saXN0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbn0pO1xuXG50ZXN0KCdkb2VzIG5vdGhpbmcgb24gdXBkYXRlIGV2ZW50IHdoZW4gZXZlcnl0aGluZyByZW1haW5zIHRoZSBzYW1lJywgYXN5bmMgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBldmVudDogUGFydGlhbDxBV1NMYW1iZGEuQ2xvdWRGb3JtYXRpb25DdXN0b21SZXNvdXJjZVVwZGF0ZUV2ZW50PiA9IHtcbiAgICBSZXF1ZXN0VHlwZTogJ1VwZGF0ZScsXG4gICAgUmVzb3VyY2VQcm9wZXJ0aWVzOiB7XG4gICAgICBTZXJ2aWNlVG9rZW46ICdGb28nLFxuICAgICAgUmVwb3NpdG9yeU5hbWU6ICdNeVJlcG8nLFxuICAgIH0sXG4gICAgT2xkUmVzb3VyY2VQcm9wZXJ0aWVzOiB7XG4gICAgICBTZXJ2aWNlVG9rZW46ICdGb28nLFxuICAgICAgUmVwb3NpdG9yeU5hbWU6ICdNeVJlcG8nLFxuICAgIH0sXG4gIH07XG5cbiAgLy8gV0hFTlxuICBhd2FpdCBpbnZva2VIYW5kbGVyKGV2ZW50KTtcblxuICAvLyBUSEVOXG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmRlc2NyaWJlUmVwb3NpdG9yaWVzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50Lmxpc3RJbWFnZXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQuYmF0Y2hEZWxldGVJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApO1xufSk7XG5cbnRlc3QoJ2RvZXMgbm90aGluZyBvbiB1cGRhdGUgZXZlbnQgd2hlbiB0aGUgcmVwb3NpdG9yeSBuYW1lIHJlbWFpbnMgdGhlIHNhbWUgYnV0IHRoZSBzZXJ2aWNlIHRva2VuIGNoYW5nZXMnLCBhc3luYyAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IGV2ZW50OiBQYXJ0aWFsPEFXU0xhbWJkYS5DbG91ZEZvcm1hdGlvbkN1c3RvbVJlc291cmNlVXBkYXRlRXZlbnQ+ID0ge1xuICAgIFJlcXVlc3RUeXBlOiAnVXBkYXRlJyxcbiAgICBSZXNvdXJjZVByb3BlcnRpZXM6IHtcbiAgICAgIFNlcnZpY2VUb2tlbjogJ0ZvbycsXG4gICAgICBSZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgfSxcbiAgICBPbGRSZXNvdXJjZVByb3BlcnRpZXM6IHtcbiAgICAgIFNlcnZpY2VUb2tlbjogJ0JhcicsXG4gICAgICBSZXNwb3NpdG9yeU5hbWU6ICdNeVJlcG8nLFxuICAgIH0sXG4gIH07XG5cbiAgLy8gV0hFTlxuICBhd2FpdCBpbnZva2VIYW5kbGVyKGV2ZW50KTtcblxuICAvLyBUSEVOXG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmRlc2NyaWJlUmVwb3NpdG9yaWVzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50Lmxpc3RJbWFnZXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQuYmF0Y2hEZWxldGVJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApO1xufSk7XG5cbnRlc3QoJ2RvZXMgbm90aGluZyBvbiB1cGRhdGUgZXZlbnQgd2hlbiB0aGUgbmV3IHJlc291cmNlIHByb3BlcnRpZXMgYXJlIGFic2VudCcsIGFzeW5jICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3QgZXZlbnQ6IFBhcnRpYWw8QVdTTGFtYmRhLkNsb3VkRm9ybWF0aW9uQ3VzdG9tUmVzb3VyY2VVcGRhdGVFdmVudD4gPSB7XG4gICAgUmVxdWVzdFR5cGU6ICdVcGRhdGUnLFxuICAgIE9sZFJlc291cmNlUHJvcGVydGllczoge1xuICAgICAgU2VydmljZVRva2VuOiAnRm9vJyxcbiAgICAgIFJlcG9zaXRvcnlOYW1lOiAnTXlSZXBvJyxcbiAgICB9LFxuICB9O1xuXG4gIC8vIFdIRU5cbiAgYXdhaXQgaW52b2tlSGFuZGxlcihldmVudCk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3QobW9ja0VDUkNsaWVudC5saXN0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQuZGVzY3JpYmVSZXBvc2l0b3JpZXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygwKTtcbn0pO1xuXG50ZXN0KCdkb2VzIG5vdGhpbmcgb24gdXBkYXRlIGV2ZW50IHdoZW4gdGhlIG9sZCByZXNvdXJjZSBwcm9wZXJ0aWVzIGFyZSBhYnNlbnQnLCBhc3luYyAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IGV2ZW50OiBQYXJ0aWFsPEFXU0xhbWJkYS5DbG91ZEZvcm1hdGlvbkN1c3RvbVJlc291cmNlVXBkYXRlRXZlbnQ+ID0ge1xuICAgIFJlcXVlc3RUeXBlOiAnVXBkYXRlJyxcbiAgICBSZXNvdXJjZVByb3BlcnRpZXM6IHtcbiAgICAgIFNlcnZpY2VUb2tlbjogJ0ZvbycsXG4gICAgICBSZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgfSxcbiAgfTtcblxuICAvLyBXSEVOXG4gIGF3YWl0IGludm9rZUhhbmRsZXIoZXZlbnQpO1xuXG4gIC8vIFRIRU5cbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQubGlzdEltYWdlcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5iYXRjaERlbGV0ZUltYWdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmRlc2NyaWJlUmVwb3NpdG9yaWVzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMCk7XG59KTtcblxudGVzdCgnZGVsZXRlcyBhbGwgb2JqZWN0cyB3aGVuIHRoZSBuYW1lIGNoYW5nZXMgb24gdXBkYXRlIGV2ZW50JywgYXN5bmMgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBtb2NrQXdzUHJvbWlzZShtb2NrRUNSQ2xpZW50LmRlc2NyaWJlUmVwb3NpdG9yaWVzLCB7XG4gICAgcmVwb3NpdG9yaWVzOiBbXG4gICAgICB7IHJlcG9zaXRvcnlBcm46ICdSZXBvc2l0b3J5QXJuJywgcmVzcG9zaXRvcnlOYW1lOiAnTXlSZXBvJyB9LFxuICAgIF0sXG4gIH0pO1xuXG4gIG1vY2tBd3NQcm9taXNlKG1vY2tFQ1JDbGllbnQubGlzdEltYWdlcywge1xuICAgIGltYWdlSWRzOiBbXG4gICAgICB7IGltYWdlRGlnZXN0OiAnSW1hZ2VEaWdlc3QxJywgaW1hZ2VUYWc6ICdJbWFnZVRhZzEnIH0sXG4gICAgICB7IGltYWdlRGlnZXN0OiAnSW1hZ2VEaWdlc3QyJywgaW1hZ2VUYWc6ICdJbWFnZVRhZzInIH0sXG4gICAgXSxcbiAgfSk7XG5cbiAgY29uc3QgZXZlbnQ6IFBhcnRpYWw8QVdTTGFtYmRhLkNsb3VkRm9ybWF0aW9uQ3VzdG9tUmVzb3VyY2VVcGRhdGVFdmVudD4gPSB7XG4gICAgUmVxdWVzdFR5cGU6ICdVcGRhdGUnLFxuICAgIE9sZFJlc291cmNlUHJvcGVydGllczoge1xuICAgICAgU2VydmljZVRva2VuOiAnRm9vJyxcbiAgICAgIFJlcG9zaXRvcnlOYW1lOiAnTXlSZXBvJyxcbiAgICB9LFxuICAgIFJlc291cmNlUHJvcGVydGllczoge1xuICAgICAgU2VydmljZVRva2VuOiAnRm9vJyxcbiAgICAgIFJlcG9zaXRvcnlOYW1lOiAnTXlSZXBvLXJlbmFtZWQnLFxuICAgIH0sXG4gIH07XG5cbiAgLy8gV0hFTlxuICBhd2FpdCBpbnZva2VIYW5kbGVyKGV2ZW50KTtcblxuICAvLyBUSEVOXG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50Lmxpc3RJbWFnZXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQubGlzdEltYWdlcykudG9IYXZlQmVlbkNhbGxlZFdpdGgoeyByZXBvc2l0b3J5TmFtZTogJ015UmVwbycgfSk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQuYmF0Y2hEZWxldGVJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgIHJlcG9zaXRvcnlOYW1lOiAnTXlSZXBvJyxcbiAgICBpbWFnZUlkczogW1xuICAgICAgeyBpbWFnZURpZ2VzdDogJ0ltYWdlRGlnZXN0MScsIGltYWdlVGFnOiAnSW1hZ2VUYWcxJyB9LFxuICAgICAgeyBpbWFnZURpZ2VzdDogJ0ltYWdlRGlnZXN0MicsIGltYWdlVGFnOiAnSW1hZ2VUYWcyJyB9LFxuICAgIF0sXG4gIH0pO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5kZXNjcmliZVJlcG9zaXRvcmllcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xufSk7XG5cbnRlc3QoJ2RlbGV0ZXMgbm8gaW1hZ2VzIG9uIGRlbGV0ZSBldmVudCB3aGVuIHJlcG9zaXRvcnkgaGFzIG5vIGltYWdlcycsIGFzeW5jICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgbW9ja0VDUkNsaWVudC5wcm9taXNlLm1vY2tSZXNvbHZlZFZhbHVlKHsgaW1hZ2VJZHM6IFtdIH0pOyAvLyBsaXN0ZWRJbWFnZXMoKSBjYWxsXG5cbiAgLy8gV0hFTlxuICBjb25zdCBldmVudDogUGFydGlhbDxBV1NMYW1iZGEuQ2xvdWRGb3JtYXRpb25DdXN0b21SZXNvdXJjZURlbGV0ZUV2ZW50PiA9IHtcbiAgICBSZXF1ZXN0VHlwZTogJ0RlbGV0ZScsXG4gICAgUmVzb3VyY2VQcm9wZXJ0aWVzOiB7XG4gICAgICBTZXJ2aWNlVG9rZW46ICdGb28nLFxuICAgICAgUmVwb3NpdG9yeU5hbWU6ICdNeVJlcG8nLFxuICAgIH0sXG4gIH07XG4gIGF3YWl0IGludm9rZUhhbmRsZXIoZXZlbnQpO1xuXG4gIC8vIFRIRU5cbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQubGlzdEltYWdlcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5saXN0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7IHJlcG9zaXRvcnlOYW1lOiAnTXlSZXBvJyB9KTtcbiAgZXhwZWN0KG1vY2tFQ1JDbGllbnQuYmF0Y2hEZWxldGVJbWFnZSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDApO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5kZXNjcmliZVJlcG9zaXRvcmllcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xufSk7XG5cbnRlc3QoJ2RlbGV0ZXMgYWxsIGltYWdlcyBvbiBkZWxldGUgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gIG1vY2tFQ1JDbGllbnQucHJvbWlzZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IC8vIGxpc3RlZEltYWdlcygpIGNhbGxcbiAgICBpbWFnZUlkczogW1xuICAgICAge1xuICAgICAgICBpbWFnZVRhZzogJ3RhZzEnLFxuICAgICAgICBpbWFnZURpZ2VzdDogJ3NoYTI1Ni0xJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGltYWdlVGFnOiAndGFnMicsXG4gICAgICAgIGltYWdlRGlnZXN0OiAnc2hhMjU2LTInLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcblxuICAvLyBXSEVOXG4gIGNvbnN0IGV2ZW50OiBQYXJ0aWFsPEFXU0xhbWJkYS5DbG91ZEZvcm1hdGlvbkN1c3RvbVJlc291cmNlRGVsZXRlRXZlbnQ+ID0ge1xuICAgIFJlcXVlc3RUeXBlOiAnRGVsZXRlJyxcbiAgICBSZXNvdXJjZVByb3BlcnRpZXM6IHtcbiAgICAgIFNlcnZpY2VUb2tlbjogJ0ZvbycsXG4gICAgICBSZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgfSxcbiAgfTtcbiAgYXdhaXQgaW52b2tlSGFuZGxlcihldmVudCk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3QobW9ja0VDUkNsaWVudC5saXN0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50Lmxpc3RJbWFnZXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgcmVwb3NpdG9yeU5hbWU6ICdNeVJlcG8nIH0pO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5iYXRjaERlbGV0ZUltYWdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICByZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgaW1hZ2VJZHM6IFtcbiAgICAgIHtcbiAgICAgICAgaW1hZ2VUYWc6ICd0YWcxJyxcbiAgICAgICAgaW1hZ2VEaWdlc3Q6ICdzaGEyNTYtMScsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpbWFnZVRhZzogJ3RhZzInLFxuICAgICAgICBpbWFnZURpZ2VzdDogJ3NoYTI1Ni0yJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSk7XG59KTtcblxudGVzdCgnZG9lcyBub3QgZW1wdHkgcmVwb3NpdG9yeSBpZiBpdCBpcyBub3QgdGFnZ2VkJywgYXN5bmMgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBnaXZlbk5vdFRhZ2dlZEZvckRlbGV0aW9uKCk7XG4gIG1vY2tFQ1JDbGllbnQucHJvbWlzZS5tb2NrUmVzb2x2ZWRWYWx1ZSh7IC8vIGxpc3RlZEltYWdlcygpIGNhbGxcbiAgICBpbWFnZUlkczogW1xuICAgICAge1xuICAgICAgICBpbWFnZVRhZzogJ3RhZzEnLFxuICAgICAgICBpbWFnZURpZ2VzdDogJ3NoYTI1Ni0xJyxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGltYWdlVGFnOiAndGFnMicsXG4gICAgICAgIGltYWdlRGlnZXN0OiAnc2hhMjU2LTInLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcblxuICAvLyBXSEVOXG4gIGNvbnN0IGV2ZW50OiBQYXJ0aWFsPEFXU0xhbWJkYS5DbG91ZEZvcm1hdGlvbkN1c3RvbVJlc291cmNlRGVsZXRlRXZlbnQ+ID0ge1xuICAgIFJlcXVlc3RUeXBlOiAnRGVsZXRlJyxcbiAgICBSZXNvdXJjZVByb3BlcnRpZXM6IHtcbiAgICAgIFNlcnZpY2VUb2tlbjogJ0ZvbycsXG4gICAgICBSZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgfSxcbiAgfTtcbiAgYXdhaXQgaW52b2tlSGFuZGxlcihldmVudCk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3QobW9ja0VDUkNsaWVudC5iYXRjaERlbGV0ZUltYWdlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xufSk7XG5cbnRlc3QoJ2RlbGV0ZSBldmVudCB3aGVyZSByZXBvIGhhcyBtYW55IGltYWdlcyBkb2VzIHJlY3Vyc2UgYXBwcm9wcmlhdGVseScsIGFzeW5jICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgbW9ja0F3c1Byb21pc2UobW9ja0VDUkNsaWVudC5kZXNjcmliZVJlcG9zaXRvcmllcywge1xuICAgIHJlcG9zaXRvcmllczogW1xuICAgICAgeyByZXBvc2l0b3J5QXJuOiAnUmVwb3NpdG9yeUFybicsIHJlc3Bvc2l0b3J5TmFtZTogJ015UmVwbycgfSxcbiAgICBdLFxuICB9KTtcblxuICBtb2NrRUNSQ2xpZW50LnByb21pc2UgLy8gbGlzdGVkSW1hZ2VzKCkgY2FsbFxuICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgaW1hZ2VJZHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGltYWdlVGFnOiAndGFnMScsXG4gICAgICAgICAgaW1hZ2VEaWdlc3Q6ICdzaGEyNTYtMScsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpbWFnZVRhZzogJ3RhZzInLFxuICAgICAgICAgIGltYWdlRGlnZXN0OiAnc2hhMjU2LTInLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIG5leHRUb2tlbjogJ3Rva2VuMScsXG4gICAgfSlcbiAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHVuZGVmaW5lZCkgLy8gYmF0Y2hEZWxldGVJbWFnZSgpIGNhbGxcbiAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHsgLy8gbGlzdGVkSW1hZ2VzKCkgY2FsbFxuICAgICAgaW1hZ2VJZHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGltYWdlVGFnOiAndGFnMycsXG4gICAgICAgICAgaW1hZ2VEaWdlc3Q6ICdzaGEyNTYtMycsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpbWFnZVRhZzogJ3RhZzQnLFxuICAgICAgICAgIGltYWdlRGlnZXN0OiAnc2hhMjU2LTQnLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAvLyBXSEVOXG4gIGNvbnN0IGV2ZW50OiBQYXJ0aWFsPEFXU0xhbWJkYS5DbG91ZEZvcm1hdGlvbkN1c3RvbVJlc291cmNlRGVsZXRlRXZlbnQ+ID0ge1xuICAgIFJlcXVlc3RUeXBlOiAnRGVsZXRlJyxcbiAgICBSZXNvdXJjZVByb3BlcnRpZXM6IHtcbiAgICAgIFNlcnZpY2VUb2tlbjogJ0ZvbycsXG4gICAgICBSZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgfSxcbiAgfTtcbiAgYXdhaXQgaW52b2tlSGFuZGxlcihldmVudCk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3QobW9ja0VDUkNsaWVudC5kZXNjcmliZVJlcG9zaXRvcmllcykudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5saXN0SW1hZ2VzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50Lmxpc3RJbWFnZXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHsgcmVwb3NpdG9yeU5hbWU6ICdNeVJlcG8nIH0pO1xuICBleHBlY3QobW9ja0VDUkNsaWVudC5iYXRjaERlbGV0ZUltYWdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMik7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLnRvSGF2ZUJlZW5OdGhDYWxsZWRXaXRoKDEsIHtcbiAgICByZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgaW1hZ2VJZHM6IFtcbiAgICAgIHtcbiAgICAgICAgaW1hZ2VUYWc6ICd0YWcxJyxcbiAgICAgICAgaW1hZ2VEaWdlc3Q6ICdzaGEyNTYtMScsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpbWFnZVRhZzogJ3RhZzInLFxuICAgICAgICBpbWFnZURpZ2VzdDogJ3NoYTI1Ni0yJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSk7XG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLnRvSGF2ZUJlZW5OdGhDYWxsZWRXaXRoKDIsIHtcbiAgICByZXBvc2l0b3J5TmFtZTogJ015UmVwbycsXG4gICAgaW1hZ2VJZHM6IFtcbiAgICAgIHtcbiAgICAgICAgaW1hZ2VUYWc6ICd0YWczJyxcbiAgICAgICAgaW1hZ2VEaWdlc3Q6ICdzaGEyNTYtMycsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpbWFnZVRhZzogJ3RhZzQnLFxuICAgICAgICBpbWFnZURpZ2VzdDogJ3NoYTI1Ni00JyxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSk7XG59KTtcblxudGVzdCgnZG9lcyBub3RoaW5nIHdoZW4gdGhlIHJlcG9zaXRvcnkgZG9lcyBub3QgZXhpc3QnLCBhc3luYyAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIG1vY2tFQ1JDbGllbnQucHJvbWlzZS5tb2NrUmVqZWN0ZWRWYWx1ZSh7IG5hbWU6ICdSZXBvc2l0b3J5Tm90Rm91bmRFeGNlcHRpb24nIH0pO1xuXG4gIG1vY2tBd3NQcm9taXNlKG1vY2tFQ1JDbGllbnQuZGVzY3JpYmVSZXBvc2l0b3JpZXMsIHtcbiAgICByZXBvc2l0b3JpZXM6IFtcbiAgICAgIHsgcmVwb3NpdG9yeUFybjogJ1JlcG9zaXRvcnlBcm4nLCByZXNwb3NpdG9yeU5hbWU6ICdNeVJlcG8nIH0sXG4gICAgXSxcbiAgfSk7XG5cbiAgLy8gV0hFTlxuICBjb25zdCBldmVudDogUGFydGlhbDxBV1NMYW1iZGEuQ2xvdWRGb3JtYXRpb25DdXN0b21SZXNvdXJjZURlbGV0ZUV2ZW50PiA9IHtcbiAgICBSZXF1ZXN0VHlwZTogJ0RlbGV0ZScsXG4gICAgUmVzb3VyY2VQcm9wZXJ0aWVzOiB7XG4gICAgICBTZXJ2aWNlVG9rZW46ICdGb28nLFxuICAgICAgUmVwb3NpdG9yeU5hbWU6ICdNeVJlcG8nLFxuICAgIH0sXG4gIH07XG4gIGF3YWl0IGludm9rZUhhbmRsZXIoZXZlbnQpO1xuXG4gIGV4cGVjdChtb2NrRUNSQ2xpZW50LmJhdGNoRGVsZXRlSW1hZ2UpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG59KTtcblxuLy8gaGVscGVyIGZ1bmN0aW9uIHRvIGdldCBhcm91bmQgVHlwZVNjcmlwdCBleHBlY3RpbmcgYSBjb21wbGV0ZSBldmVudCBvYmplY3QsXG4vLyBldmVuIHRob3VnaCBvdXIgdGVzdHMgb25seSBuZWVkIHNvbWUgb2YgdGhlIGZpZWxkc1xuYXN5bmMgZnVuY3Rpb24gaW52b2tlSGFuZGxlcihldmVudDogUGFydGlhbDxBV1NMYW1iZGEuQ2xvdWRGb3JtYXRpb25DdXN0b21SZXNvdXJjZUV2ZW50Pikge1xuICByZXR1cm4gaGFuZGxlcihldmVudCBhcyBBV1NMYW1iZGEuQ2xvdWRGb3JtYXRpb25DdXN0b21SZXNvdXJjZUV2ZW50KTtcbn1cblxuZnVuY3Rpb24gbW9ja0F3c1Byb21pc2U8QT4oZm46IGplc3QuTW9jazxhbnksIGFueT4sIHZhbHVlOiBBLCB3aGVuOiAnb25jZScgfCAnYWx3YXlzJyA9ICdhbHdheXMnKSB7XG4gICh3aGVuID09PSAnYWx3YXlzJyA/IGZuLm1vY2tSZXR1cm5WYWx1ZSA6IGZuLm1vY2tSZXR1cm5WYWx1ZU9uY2UpLmNhbGwoZm4sIHtcbiAgICBwcm9taXNlOiAoKSA9PiB2YWx1ZSxcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGdpdmVuVGFnZ2VkRm9yRGVsZXRpb24oKSB7XG4gIG1vY2tBd3NQcm9taXNlKG1vY2tFQ1JDbGllbnQubGlzdFRhZ3NGb3JSZXNvdXJjZSwge1xuICAgIHRhZ3M6IFtcbiAgICAgIHtcbiAgICAgICAgS2V5OiAnYXdzLWNkazphdXRvLWRlbGV0ZS1pbWFnZXMnLFxuICAgICAgICBWYWx1ZTogJ3RydWUnLFxuICAgICAgfSxcbiAgICBdLFxuXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBnaXZlbk5vdFRhZ2dlZEZvckRlbGV0aW9uKCkge1xuICBtb2NrQXdzUHJvbWlzZShtb2NrRUNSQ2xpZW50Lmxpc3RUYWdzRm9yUmVzb3VyY2UsIHtcbiAgICB0YWdzOiBbXSxcbiAgfSk7XG59Il19