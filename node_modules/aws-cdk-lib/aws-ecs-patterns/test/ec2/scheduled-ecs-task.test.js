"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../../assertions");
const aws_autoscaling_1 = require("../../../aws-autoscaling");
const ec2 = require("../../../aws-ec2");
const aws_ec2_1 = require("../../../aws-ec2");
const ecs = require("../../../aws-ecs");
const aws_ecs_1 = require("../../../aws-ecs");
const events = require("../../../aws-events");
const cdk = require("../../../core");
const lib_1 = require("../../lib");
test('Can create a scheduled Ec2 Task - with only required props', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryLimitMiB: 512,
        },
        schedule: events.Schedule.expression('rate(1 minute)'),
    });
    // THEN
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Events::Rule', {
        State: 'ENABLED',
        Targets: [
            {
                Arn: { 'Fn::GetAtt': ['EcsCluster97242B84', 'Arn'] },
                EcsParameters: {
                    TaskCount: 1,
                    TaskDefinitionArn: { Ref: 'ScheduledEc2TaskScheduledTaskDef56328BA4' },
                },
                Id: 'Target0',
                Input: '{}',
                RoleArn: { 'Fn::GetAtt': ['ScheduledEc2TaskScheduledTaskDefEventsRole64113C5F', 'Arn'] },
            },
        ],
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            {
                Essential: true,
                Image: 'henk',
                LogConfiguration: {
                    LogDriver: 'awslogs',
                    Options: {
                        'awslogs-group': {
                            Ref: 'ScheduledEc2TaskScheduledTaskDefScheduledContainerLogGroupA85E11E6',
                        },
                        'awslogs-stream-prefix': 'ScheduledEc2Task',
                        'awslogs-region': {
                            Ref: 'AWS::Region',
                        },
                    },
                },
                Memory: 512,
                Name: 'ScheduledContainer',
            },
        ],
    });
});
test('Can create a scheduled Ec2 Task - with optional props', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        enabled: false,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryLimitMiB: 512,
            cpu: 2,
            environment: { TRIGGER: 'CloudWatch Events' },
        },
        desiredTaskCount: 2,
        schedule: events.Schedule.expression('rate(1 minute)'),
        ruleName: 'sample-scheduled-task-rule',
    });
    // THEN
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Events::Rule', {
        Name: 'sample-scheduled-task-rule',
        State: 'DISABLED',
        Targets: [
            {
                Arn: { 'Fn::GetAtt': ['EcsCluster97242B84', 'Arn'] },
                EcsParameters: {
                    TaskCount: 2,
                    TaskDefinitionArn: { Ref: 'ScheduledEc2TaskScheduledTaskDef56328BA4' },
                },
                Id: 'Target0',
                Input: '{}',
                RoleArn: { 'Fn::GetAtt': ['ScheduledEc2TaskScheduledTaskDefEventsRole64113C5F', 'Arn'] },
            },
        ],
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            {
                Cpu: 2,
                Environment: [
                    {
                        Name: 'TRIGGER',
                        Value: 'CloudWatch Events',
                    },
                ],
                Essential: true,
                Image: 'henk',
                LogConfiguration: {
                    LogDriver: 'awslogs',
                    Options: {
                        'awslogs-group': {
                            Ref: 'ScheduledEc2TaskScheduledTaskDefScheduledContainerLogGroupA85E11E6',
                        },
                        'awslogs-stream-prefix': 'ScheduledEc2Task',
                        'awslogs-region': {
                            Ref: 'AWS::Region',
                        },
                    },
                },
                Memory: 512,
                Name: 'ScheduledContainer',
            },
        ],
    });
});
test('Scheduled ECS Task - with securityGroups defined', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    const taskDefinition = new ecs.Ec2TaskDefinition(stack, 'Ec2TaskDef', {
        networkMode: ecs.NetworkMode.AWS_VPC,
    });
    const sg = new ec2.SecurityGroup(stack, 'MySG', { vpc });
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskDefinitionOptions: {
            taskDefinition,
        },
        schedule: events.Schedule.expression('rate(1 minute)'),
        securityGroups: [sg],
    });
    // THEN
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Events::Rule', {
        Targets: [
            {
                Arn: { 'Fn::GetAtt': ['EcsCluster97242B84', 'Arn'] },
                EcsParameters: {
                    LaunchType: 'EC2',
                    NetworkConfiguration: {
                        AwsVpcConfiguration: {
                            AssignPublicIp: 'DISABLED',
                            SecurityGroups: [{
                                    'Fn::GetAtt': [
                                        'MySG94FE69A8',
                                        'GroupId',
                                    ],
                                }],
                            Subnets: [
                                {
                                    Ref: 'VpcPrivateSubnet1Subnet536B997A',
                                },
                            ],
                        },
                    },
                    TaskCount: 1,
                    TaskDefinitionArn: { Ref: 'Ec2TaskDef0226F28C' },
                },
                Id: 'Target0',
                Input: '{}',
                RoleArn: { 'Fn::GetAtt': ['Ec2TaskDefEventsRoleA0756175', 'Arn'] },
            },
        ],
    });
});
test('Scheduled Ec2 Task - with MemoryReservation defined', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryReservationMiB: 512,
        },
        schedule: events.Schedule.expression('rate(1 minute)'),
    });
    // THEN
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            {
                Essential: true,
                Image: 'henk',
                LogConfiguration: {
                    LogDriver: 'awslogs',
                    Options: {
                        'awslogs-group': {
                            Ref: 'ScheduledEc2TaskScheduledTaskDefScheduledContainerLogGroupA85E11E6',
                        },
                        'awslogs-stream-prefix': 'ScheduledEc2Task',
                        'awslogs-region': {
                            Ref: 'AWS::Region',
                        },
                    },
                },
                MemoryReservation: 512,
                Name: 'ScheduledContainer',
            },
        ],
    });
});
test('Scheduled Ec2 Task - with Command defined', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryReservationMiB: 512,
            command: ['-c', '4', 'amazon.com'],
        },
        schedule: events.Schedule.expression('rate(1 minute)'),
    });
    // THEN
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            {
                Command: [
                    '-c',
                    '4',
                    'amazon.com',
                ],
                Essential: true,
                Image: 'henk',
                LogConfiguration: {
                    LogDriver: 'awslogs',
                    Options: {
                        'awslogs-group': {
                            Ref: 'ScheduledEc2TaskScheduledTaskDefScheduledContainerLogGroupA85E11E6',
                        },
                        'awslogs-stream-prefix': 'ScheduledEc2Task',
                        'awslogs-region': {
                            Ref: 'AWS::Region',
                        },
                    },
                },
                MemoryReservation: 512,
                Name: 'ScheduledContainer',
            },
        ],
    });
});
test('throws if desiredTaskCount is 0', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    // THEN
    expect(() => new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryLimitMiB: 512,
        },
        schedule: events.Schedule.expression('rate(1 minute)'),
        desiredTaskCount: 0,
    })).toThrow(/You must specify a desiredTaskCount greater than 0/);
});
test('Scheduled Ec2 Task - exposes ECS Task', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    const scheduledEc2Task = new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryLimitMiB: 512,
        },
        schedule: events.Schedule.expression('rate(1 minute)'),
    });
    // THEN
    expect(scheduledEc2Task.task).toBeDefined();
});
test('Scheduled Ec2 Task shows warning when minute is not defined in cron', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryLimitMiB: 512,
        },
        schedule: events.Schedule.cron({}),
    });
    // THEN
    assertions_1.Annotations.fromStack(stack).hasWarning('/Default', "cron: If you don't pass 'minute', by default the event runs every minute. Pass 'minute: '*'' if that's what you intend, or 'minute: 0' to run once per hour instead.");
});
test('Scheduled Ec2 Task shows no warning when minute is * in cron', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 1 });
    const cluster = new ecs.Cluster(stack, 'EcsCluster', { vpc });
    new lib_1.ScheduledEc2Task(stack, 'ScheduledEc2Task', {
        cluster,
        scheduledEc2TaskImageOptions: {
            image: ecs.ContainerImage.fromRegistry('henk'),
            memoryLimitMiB: 512,
        },
        schedule: events.Schedule.cron({ minute: '*' }),
    });
    // THEN
    assertions_1.Annotations.fromStack(stack).hasNoWarning('/Default', assertions_1.Match.anyValue());
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NoZWR1bGVkLWVjcy10YXNrLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzY2hlZHVsZWQtZWNzLXRhc2sudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG9EQUFtRTtBQUNuRSw4REFBNEQ7QUFDNUQsd0NBQXdDO0FBQ3hDLDhDQUFnRDtBQUNoRCx3Q0FBd0M7QUFDeEMsOENBQXVEO0FBQ3ZELDhDQUE4QztBQUM5QyxxQ0FBcUM7QUFDckMsbUNBQTZDO0FBRTdDLElBQUksQ0FBQyw0REFBNEQsRUFBRSxHQUFHLEVBQUU7SUFDdEUsUUFBUTtJQUNSLE1BQU0sS0FBSyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQzlCLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDckQsTUFBTSxPQUFPLEdBQUcsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxZQUFZLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBRTlELE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLDZCQUFtQixDQUFDLEtBQUssRUFBRSxpQ0FBaUMsRUFBRTtRQUMvRixnQkFBZ0IsRUFBRSxJQUFJLGtDQUFnQixDQUFDLEtBQUssRUFBRSx5QkFBeUIsRUFBRTtZQUN2RSxHQUFHO1lBQ0gsWUFBWSxFQUFFLElBQUksR0FBRyxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUM7WUFDOUMsWUFBWSxFQUFFLHNCQUFZLENBQUMsaUJBQWlCLEVBQUU7U0FDL0MsQ0FBQztLQUNILENBQUMsQ0FBQyxDQUFDO0lBRUosSUFBSSxzQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsa0JBQWtCLEVBQUU7UUFDOUMsT0FBTztRQUNQLDRCQUE0QixFQUFFO1lBQzVCLEtBQUssRUFBRSxHQUFHLENBQUMsY0FBYyxDQUFD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LEVBQUUsQ0FBQyxDQUFDO0lBRTlELElBQUksc0JBQWdCLENBQUMsS0FBSyxFQUFFLGtCQUFrQixFQUFFO1FBQzlDLE9BQU87UUFDUCw0QkFBNEIsRUFBRTtZQUM1QixLQUFLLEVBQUUsR0FBRyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDO1lBQzlDLGNBQWMsRUFBRSxHQUFHO1NBQ3BCO1FBQ0QsUUFBUSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDO0tBQ2hELENBQUMsQ0FBQztJQUVILE9BQU87SUFDUCx3QkFBVyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLENBQUMsVUFBVSxFQUFFLGtCQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztBQUMxRSxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFubm90YXRpb25zLCBNYXRjaCwgVGVtcGxhdGUgfSBmcm9tICcuLi8uLi8uLi9hc3NlcnRpb25zJztcbmltcG9ydCB7IEF1dG9TY2FsaW5nR3JvdXAgfSBmcm9tICcuLi8uLi8uLi9hd3MtYXV0b3NjYWxpbmcnO1xuaW1wb3J0ICogYXMgZWMyIGZyb20gJy4uLy4uLy4uL2F3cy1lYzInO1xuaW1wb3J0IHsgTWFjaGluZUltYWdlIH0gZnJvbSAnLi4vLi4vLi4vYXdzLWVjMic7XG5pbXBvcnQgKiBhcyBlY3MgZnJvbSAnLi4vLi4vLi4vYXdzLWVjcyc7XG5pbXBvcnQgeyBBc2dDYXBhY2l0eVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vLi4vYXdzLWVjcyc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi4vLi4vLi4vYXdzLWV2ZW50cyc7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnLi4vLi4vLi4vY29yZSc7XG5pbXBvcnQgeyBTY2hlZHVsZWRFYzJUYXNrIH0gZnJvbSAnLi4vLi4vbGliJztcblxudGVzdCgnQ2FuIGNyZWF0ZSBhIHNjaGVkdWxlZCBFYzIgVGFzayAtIHdpdGggb25seSByZXF1aXJlZCBwcm9wcycsICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gIGNvbnN0IHZwYyA9IG5ldyBlYzIuVnBjKHN0YWNrLCAnVnBjJywgeyBtYXhBenM6IDEgfSk7XG4gIGNvbnN0IGNsdXN0ZXIgPSBuZXcgZWNzLkNsdXN0ZXIoc3RhY2ssICdFY3NDbHVzdGVyJywgeyB2cGMgfSk7XG5cbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcblxuICBuZXcgU2NoZWR1bGVkRWMyVGFzayhzdGFjaywgJ1NjaGVkdWxlZEVjMlRhc2snLCB7XG4gICAgY2x1c3RlcixcbiAgICBzY2hlZHVsZWRFYzJUYXNrSW1hZ2VPcHRpb25zOiB7XG4gICAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgnaGVuaycpLFxuICAgICAgbWVtb3J5TGltaXRNaUI6IDUxMixcbiAgICB9LFxuICAgIHNjaGVkdWxlOiBldmVudHMuU2NoZWR1bGUuZXhwcmVzc2lvbigncmF0ZSgxIG1pbnV0ZSknKSxcbiAgfSk7XG5cbiAgLy8gVEhFTlxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpFdmVudHM6OlJ1bGUnLCB7XG4gICAgU3RhdGU6ICdFTkFCTEVEJyxcbiAgICBUYXJnZXRzOiBbXG4gICAgICB7XG4gICAgICAgIEFybjogeyAnRm46OkdldEF0dCc6IFsnRWNzQ2x1c3Rlcjk3MjQyQjg0JywgJ0FybiddIH0sXG4gICAgICAgIEVjc1BhcmFtZXRlcnM6IHtcbiAgICAgICAgICBUYXNrQ291bnQ6IDEsXG4gICAgICAgICAgVGFza0RlZmluaXRpb25Bcm46IHsgUmVmOiAnU2NoZWR1bGVkRWMyVGFza1NjaGVkdWxlZFRhc2tEZWY1NjMyOEJBNCcgfSxcbiAgICAgICAgfSxcbiAgICAgICAgSWQ6ICdUYXJnZXQwJyxcbiAgICAgICAgSW5wdXQ6ICd7fScsXG4gICAgICAgIFJvbGVBcm46IHsgJ0ZuOjpHZXRBdHQnOiBbJ1NjaGVkdWxlZEVjMlRhc2tTY2hlZHVsZWRUYXNrRGVmRXZlbnRzUm9sZTY0MTEzQzVGJywgJ0FybiddIH0sXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkVDUzo6VGFza0RlZmluaXRpb24nLCB7XG4gICAgQ29udGFpbmVyRGVmaW5pdGlvbnM6IFtcbiAgICAgIHtcbiAgICAgICAgRXNzZW50aWFsOiB0cnVlLFxuICAgICAgICBJbWFnZTogJ2hlbmsnLFxuICAgICAgICBMb2dDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgTG9nRHJpdmVyOiAnYXdzbG9ncycsXG4gICAgICAgICAgT3B0aW9uczoge1xuICAgICAgICAgICAgJ2F3c2xvZ3MtZ3JvdXAnOiB7XG4gICAgICAgICAgICAgIFJlZjogJ1NjaGVkdWxlZEVjMlRhc2tTY2hlZHVsZWRUYXNrRGVmU2NoZWR1bGVkQ29udGFpbmVyTG9nR3JvdXBBODVFMTFFNicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ2F3c2xvZ3Mtc3RyZWFtLXByZWZpeCc6ICdTY2hlZHVsZWRFYzJUYXNrJyxcbiAgICAgICAgICAgICdhd3Nsb2dzLXJlZ2lvbic6IHtcbiAgICAgICAgICAgICAgUmVmOiAnQVdTOjpSZWdpb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBNZW1vcnk6IDUxMixcbiAgICAgICAgTmFtZTogJ1NjaGVkdWxlZENvbnRhaW5lcicsXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xufSk7XG5cbnRlc3QoJ0NhbiBjcmVhdGUgYSBzY2hlZHVsZWQgRWMyIFRhc2sgLSB3aXRoIG9wdGlvbmFsIHByb3BzJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWcGMnLCB7IG1heEF6czogMSB9KTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0Vjc0NsdXN0ZXInLCB7IHZwYyB9KTtcblxuICBjbHVzdGVyLmFkZEFzZ0NhcGFjaXR5UHJvdmlkZXIobmV3IEFzZ0NhcGFjaXR5UHJvdmlkZXIoc3RhY2ssICdEZWZhdWx0QXV0b1NjYWxpbmdHcm91cFByb3ZpZGVyJywge1xuICAgIGF1dG9TY2FsaW5nR3JvdXA6IG5ldyBBdXRvU2NhbGluZ0dyb3VwKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXAnLCB7XG4gICAgICB2cGMsXG4gICAgICBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0Mi5taWNybycpLFxuICAgICAgbWFjaGluZUltYWdlOiBNYWNoaW5lSW1hZ2UubGF0ZXN0QW1hem9uTGludXgoKSxcbiAgICB9KSxcbiAgfSkpO1xuXG4gIG5ldyBTY2hlZHVsZWRFYzJUYXNrKHN0YWNrLCAnU2NoZWR1bGVkRWMyVGFzaycsIHtcbiAgICBjbHVzdGVyLFxuICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIHNjaGVkdWxlZEVjMlRhc2tJbWFnZU9wdGlvbnM6IHtcbiAgICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCdoZW5rJyksXG4gICAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgICAgY3B1OiAyLFxuICAgICAgZW52aXJvbm1lbnQ6IHsgVFJJR0dFUjogJ0Nsb3VkV2F0Y2ggRXZlbnRzJyB9LFxuICAgIH0sXG4gICAgZGVzaXJlZFRhc2tDb3VudDogMixcbiAgICBzY2hlZHVsZTogZXZlbnRzLlNjaGVkdWxlLmV4cHJlc3Npb24oJ3JhdGUoMSBtaW51dGUpJyksXG4gICAgcnVsZU5hbWU6ICdzYW1wbGUtc2NoZWR1bGVkLXRhc2stcnVsZScsXG4gIH0pO1xuXG4gIC8vIFRIRU5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RXZlbnRzOjpSdWxlJywge1xuICAgIE5hbWU6ICdzYW1wbGUtc2NoZWR1bGVkLXRhc2stcnVsZScsXG4gICAgU3RhdGU6ICdESVNBQkxFRCcsXG4gICAgVGFyZ2V0czogW1xuICAgICAge1xuICAgICAgICBBcm46IHsgJ0ZuOjpHZXRBdHQnOiBbJ0Vjc0NsdXN0ZXI5NzI0MkI4NCcsICdBcm4nXSB9LFxuICAgICAgICBFY3NQYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgVGFza0NvdW50OiAyLFxuICAgICAgICAgIFRhc2tEZWZpbml0aW9uQXJuOiB7IFJlZjogJ1NjaGVkdWxlZEVjMlRhc2tTY2hlZHVsZWRUYXNrRGVmNTYzMjhCQTQnIH0sXG4gICAgICAgIH0sXG4gICAgICAgIElkOiAnVGFyZ2V0MCcsXG4gICAgICAgIElucHV0OiAne30nLFxuICAgICAgICBSb2xlQXJuOiB7ICdGbjo6R2V0QXR0JzogWydTY2hlZHVsZWRFYzJUYXNrU2NoZWR1bGVkVGFza0RlZkV2ZW50c1JvbGU2NDExM0M1RicsICdBcm4nXSB9LFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpFQ1M6OlRhc2tEZWZpbml0aW9uJywge1xuICAgIENvbnRhaW5lckRlZmluaXRpb25zOiBbXG4gICAgICB7XG4gICAgICAgIENwdTogMixcbiAgICAgICAgRW52aXJvbm1lbnQ6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBOYW1lOiAnVFJJR0dFUicsXG4gICAgICAgICAgICBWYWx1ZTogJ0Nsb3VkV2F0Y2ggRXZlbnRzJyxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBFc3NlbnRpYWw6IHRydWUsXG4gICAgICAgIEltYWdlOiAnaGVuaycsXG4gICAgICAgIExvZ0NvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICBMb2dEcml2ZXI6ICdhd3Nsb2dzJyxcbiAgICAgICAgICBPcHRpb25zOiB7XG4gICAgICAgICAgICAnYXdzbG9ncy1ncm91cCc6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2NoZWR1bGVkRWMyVGFza1NjaGVkdWxlZFRhc2tEZWZTY2hlZHVsZWRDb250YWluZXJMb2dHcm91cEE4NUUxMUU2JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnYXdzbG9ncy1zdHJlYW0tcHJlZml4JzogJ1NjaGVkdWxlZEVjMlRhc2snLFxuICAgICAgICAgICAgJ2F3c2xvZ3MtcmVnaW9uJzoge1xuICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIE1lbW9yeTogNTEyLFxuICAgICAgICBOYW1lOiAnU2NoZWR1bGVkQ29udGFpbmVyJyxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSk7XG59KTtcblxudGVzdCgnU2NoZWR1bGVkIEVDUyBUYXNrIC0gd2l0aCBzZWN1cml0eUdyb3VwcyBkZWZpbmVkJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWcGMnLCB7IG1heEF6czogMSB9KTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0Vjc0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY29uc3QgdGFza0RlZmluaXRpb24gPSBuZXcgZWNzLkVjMlRhc2tEZWZpbml0aW9uKHN0YWNrLCAnRWMyVGFza0RlZicsIHtcbiAgICBuZXR3b3JrTW9kZTogZWNzLk5ldHdvcmtNb2RlLkFXU19WUEMsXG4gIH0pO1xuICBjb25zdCBzZyA9IG5ldyBlYzIuU2VjdXJpdHlHcm91cChzdGFjaywgJ015U0cnLCB7IHZwYyB9KTtcblxuICBuZXcgU2NoZWR1bGVkRWMyVGFzayhzdGFjaywgJ1NjaGVkdWxlZEVjMlRhc2snLCB7XG4gICAgY2x1c3RlcixcbiAgICBzY2hlZHVsZWRFYzJUYXNrRGVmaW5pdGlvbk9wdGlvbnM6IHtcbiAgICAgIHRhc2tEZWZpbml0aW9uLFxuICAgIH0sXG4gICAgc2NoZWR1bGU6IGV2ZW50cy5TY2hlZHVsZS5leHByZXNzaW9uKCdyYXRlKDEgbWludXRlKScpLFxuICAgIHNlY3VyaXR5R3JvdXBzOiBbc2ddLFxuICB9KTtcblxuICAvLyBUSEVOXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkV2ZW50czo6UnVsZScsIHtcbiAgICBUYXJnZXRzOiBbXG4gICAgICB7XG4gICAgICAgIEFybjogeyAnRm46OkdldEF0dCc6IFsnRWNzQ2x1c3Rlcjk3MjQyQjg0JywgJ0FybiddIH0sXG4gICAgICAgIEVjc1BhcmFtZXRlcnM6IHtcbiAgICAgICAgICBMYXVuY2hUeXBlOiAnRUMyJyxcbiAgICAgICAgICBOZXR3b3JrQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgQXdzVnBjQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICBBc3NpZ25QdWJsaWNJcDogJ0RJU0FCTEVEJyxcbiAgICAgICAgICAgICAgU2VjdXJpdHlHcm91cHM6IFt7XG4gICAgICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgICAgICAgICAnTXlTRzk0RkU2OUE4JyxcbiAgICAgICAgICAgICAgICAgICdHcm91cElkJyxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgU3VibmV0czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFJlZjogJ1ZwY1ByaXZhdGVTdWJuZXQxU3VibmV0NTM2Qjk5N0EnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgVGFza0NvdW50OiAxLFxuICAgICAgICAgIFRhc2tEZWZpbml0aW9uQXJuOiB7IFJlZjogJ0VjMlRhc2tEZWYwMjI2RjI4QycgfSxcbiAgICAgICAgfSxcbiAgICAgICAgSWQ6ICdUYXJnZXQwJyxcbiAgICAgICAgSW5wdXQ6ICd7fScsXG4gICAgICAgIFJvbGVBcm46IHsgJ0ZuOjpHZXRBdHQnOiBbJ0VjMlRhc2tEZWZFdmVudHNSb2xlQTA3NTYxNzUnLCAnQXJuJ10gfSxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSk7XG59KTtcblxudGVzdCgnU2NoZWR1bGVkIEVjMiBUYXNrIC0gd2l0aCBNZW1vcnlSZXNlcnZhdGlvbiBkZWZpbmVkJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWcGMnLCB7IG1heEF6czogMSB9KTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0Vjc0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcblxuICBuZXcgU2NoZWR1bGVkRWMyVGFzayhzdGFjaywgJ1NjaGVkdWxlZEVjMlRhc2snLCB7XG4gICAgY2x1c3RlcixcbiAgICBzY2hlZHVsZWRFYzJUYXNrSW1hZ2VPcHRpb25zOiB7XG4gICAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgnaGVuaycpLFxuICAgICAgbWVtb3J5UmVzZXJ2YXRpb25NaUI6IDUxMixcbiAgICB9LFxuICAgIHNjaGVkdWxlOiBldmVudHMuU2NoZWR1bGUuZXhwcmVzc2lvbigncmF0ZSgxIG1pbnV0ZSknKSxcbiAgfSk7XG5cbiAgLy8gVEhFTlxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpFQ1M6OlRhc2tEZWZpbml0aW9uJywge1xuICAgIENvbnRhaW5lckRlZmluaXRpb25zOiBbXG4gICAgICB7XG4gICAgICAgIEVzc2VudGlhbDogdHJ1ZSxcbiAgICAgICAgSW1hZ2U6ICdoZW5rJyxcbiAgICAgICAgTG9nQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgIExvZ0RyaXZlcjogJ2F3c2xvZ3MnLFxuICAgICAgICAgIE9wdGlvbnM6IHtcbiAgICAgICAgICAgICdhd3Nsb2dzLWdyb3VwJzoge1xuICAgICAgICAgICAgICBSZWY6ICdTY2hlZHVsZWRFYzJUYXNrU2NoZWR1bGVkVGFza0RlZlNjaGVkdWxlZENvbnRhaW5lckxvZ0dyb3VwQTg1RTExRTYnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdhd3Nsb2dzLXN0cmVhbS1wcmVmaXgnOiAnU2NoZWR1bGVkRWMyVGFzaycsXG4gICAgICAgICAgICAnYXdzbG9ncy1yZWdpb24nOiB7XG4gICAgICAgICAgICAgIFJlZjogJ0FXUzo6UmVnaW9uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgTWVtb3J5UmVzZXJ2YXRpb246IDUxMixcbiAgICAgICAgTmFtZTogJ1NjaGVkdWxlZENvbnRhaW5lcicsXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xufSk7XG5cbnRlc3QoJ1NjaGVkdWxlZCBFYzIgVGFzayAtIHdpdGggQ29tbWFuZCBkZWZpbmVkJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWcGMnLCB7IG1heEF6czogMSB9KTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0Vjc0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcblxuICBuZXcgU2NoZWR1bGVkRWMyVGFzayhzdGFjaywgJ1NjaGVkdWxlZEVjMlRhc2snLCB7XG4gICAgY2x1c3RlcixcbiAgICBzY2hlZHVsZWRFYzJUYXNrSW1hZ2VPcHRpb25zOiB7XG4gICAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgnaGVuaycpLFxuICAgICAgbWVtb3J5UmVzZXJ2YXRpb25NaUI6IDUxMixcbiAgICAgIGNvbW1hbmQ6IFsnLWMnLCAnNCcsICdhbWF6b24uY29tJ10sXG4gICAgfSxcbiAgICBzY2hlZHVsZTogZXZlbnRzLlNjaGVkdWxlLmV4cHJlc3Npb24oJ3JhdGUoMSBtaW51dGUpJyksXG4gIH0pO1xuXG4gIC8vIFRIRU5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RUNTOjpUYXNrRGVmaW5pdGlvbicsIHtcbiAgICBDb250YWluZXJEZWZpbml0aW9uczogW1xuICAgICAge1xuICAgICAgICBDb21tYW5kOiBbXG4gICAgICAgICAgJy1jJyxcbiAgICAgICAgICAnNCcsXG4gICAgICAgICAgJ2FtYXpvbi5jb20nLFxuICAgICAgICBdLFxuICAgICAgICBFc3NlbnRpYWw6IHRydWUsXG4gICAgICAgIEltYWdlOiAnaGVuaycsXG4gICAgICAgIExvZ0NvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICBMb2dEcml2ZXI6ICdhd3Nsb2dzJyxcbiAgICAgICAgICBPcHRpb25zOiB7XG4gICAgICAgICAgICAnYXdzbG9ncy1ncm91cCc6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2NoZWR1bGVkRWMyVGFza1NjaGVkdWxlZFRhc2tEZWZTY2hlZHVsZWRDb250YWluZXJMb2dHcm91cEE4NUUxMUU2JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnYXdzbG9ncy1zdHJlYW0tcHJlZml4JzogJ1NjaGVkdWxlZEVjMlRhc2snLFxuICAgICAgICAgICAgJ2F3c2xvZ3MtcmVnaW9uJzoge1xuICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIE1lbW9yeVJlc2VydmF0aW9uOiA1MTIsXG4gICAgICAgIE5hbWU6ICdTY2hlZHVsZWRDb250YWluZXInLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcbn0pO1xuXG50ZXN0KCd0aHJvd3MgaWYgZGVzaXJlZFRhc2tDb3VudCBpcyAwJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWcGMnLCB7IG1heEF6czogMSB9KTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0Vjc0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcblxuICAvLyBUSEVOXG4gIGV4cGVjdCgoKSA9PlxuICAgIG5ldyBTY2hlZHVsZWRFYzJUYXNrKHN0YWNrLCAnU2NoZWR1bGVkRWMyVGFzaycsIHtcbiAgICAgIGNsdXN0ZXIsXG4gICAgICBzY2hlZHVsZWRFYzJUYXNrSW1hZ2VPcHRpb25zOiB7XG4gICAgICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCdoZW5rJyksXG4gICAgICAgIG1lbW9yeUxpbWl0TWlCOiA1MTIsXG4gICAgICB9LFxuICAgICAgc2NoZWR1bGU6IGV2ZW50cy5TY2hlZHVsZS5leHByZXNzaW9uKCdyYXRlKDEgbWludXRlKScpLFxuICAgICAgZGVzaXJlZFRhc2tDb3VudDogMCxcbiAgICB9KSxcbiAgKS50b1Rocm93KC9Zb3UgbXVzdCBzcGVjaWZ5IGEgZGVzaXJlZFRhc2tDb3VudCBncmVhdGVyIHRoYW4gMC8pO1xufSk7XG5cbnRlc3QoJ1NjaGVkdWxlZCBFYzIgVGFzayAtIGV4cG9zZXMgRUNTIFRhc2snLCAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICBjb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZwYycsIHsgbWF4QXpzOiAxIH0pO1xuICBjb25zdCBjbHVzdGVyID0gbmV3IGVjcy5DbHVzdGVyKHN0YWNrLCAnRWNzQ2x1c3RlcicsIHsgdnBjIH0pO1xuXG4gIGNvbnN0IHNjaGVkdWxlZEVjMlRhc2sgPSBuZXcgU2NoZWR1bGVkRWMyVGFzayhzdGFjaywgJ1NjaGVkdWxlZEVjMlRhc2snLCB7XG4gICAgY2x1c3RlcixcbiAgICBzY2hlZHVsZWRFYzJUYXNrSW1hZ2VPcHRpb25zOiB7XG4gICAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgnaGVuaycpLFxuICAgICAgbWVtb3J5TGltaXRNaUI6IDUxMixcbiAgICB9LFxuICAgIHNjaGVkdWxlOiBldmVudHMuU2NoZWR1bGUuZXhwcmVzc2lvbigncmF0ZSgxIG1pbnV0ZSknKSxcbiAgfSk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3Qoc2NoZWR1bGVkRWMyVGFzay50YXNrKS50b0JlRGVmaW5lZCgpO1xufSk7XG5cbnRlc3QoJ1NjaGVkdWxlZCBFYzIgVGFzayBzaG93cyB3YXJuaW5nIHdoZW4gbWludXRlIGlzIG5vdCBkZWZpbmVkIGluIGNyb24nLCAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICBjb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZwYycsIHsgbWF4QXpzOiAxIH0pO1xuICBjb25zdCBjbHVzdGVyID0gbmV3IGVjcy5DbHVzdGVyKHN0YWNrLCAnRWNzQ2x1c3RlcicsIHsgdnBjIH0pO1xuXG4gIG5ldyBTY2hlZHVsZWRFYzJUYXNrKHN0YWNrLCAnU2NoZWR1bGVkRWMyVGFzaycsIHtcbiAgICBjbHVzdGVyLFxuICAgIHNjaGVkdWxlZEVjMlRhc2tJbWFnZU9wdGlvbnM6IHtcbiAgICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCdoZW5rJyksXG4gICAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIH0sXG4gICAgc2NoZWR1bGU6IGV2ZW50cy5TY2hlZHVsZS5jcm9uKHt9KSxcbiAgfSk7XG5cbiAgLy8gVEhFTlxuICBBbm5vdGF0aW9ucy5mcm9tU3RhY2soc3RhY2spLmhhc1dhcm5pbmcoJy9EZWZhdWx0JywgXCJjcm9uOiBJZiB5b3UgZG9uJ3QgcGFzcyAnbWludXRlJywgYnkgZGVmYXVsdCB0aGUgZXZlbnQgcnVucyBldmVyeSBtaW51dGUuIFBhc3MgJ21pbnV0ZTogJyonJyBpZiB0aGF0J3Mgd2hhdCB5b3UgaW50ZW5kLCBvciAnbWludXRlOiAwJyB0byBydW4gb25jZSBwZXIgaG91ciBpbnN0ZWFkLlwiKTtcbn0pO1xuXG50ZXN0KCdTY2hlZHVsZWQgRWMyIFRhc2sgc2hvd3Mgbm8gd2FybmluZyB3aGVuIG1pbnV0ZSBpcyAqIGluIGNyb24nLCAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICBjb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZwYycsIHsgbWF4QXpzOiAxIH0pO1xuICBjb25zdCBjbHVzdGVyID0gbmV3IGVjcy5DbHVzdGVyKHN0YWNrLCAnRWNzQ2x1c3RlcicsIHsgdnBjIH0pO1xuXG4gIG5ldyBTY2hlZHVsZWRFYzJUYXNrKHN0YWNrLCAnU2NoZWR1bGVkRWMyVGFzaycsIHtcbiAgICBjbHVzdGVyLFxuICAgIHNjaGVkdWxlZEVjMlRhc2tJbWFnZU9wdGlvbnM6IHtcbiAgICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCdoZW5rJyksXG4gICAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIH0sXG4gICAgc2NoZWR1bGU6IGV2ZW50cy5TY2hlZHVsZS5jcm9uKHsgbWludXRlOiAnKicgfSksXG4gIH0pO1xuXG4gIC8vIFRIRU5cbiAgQW5ub3RhdGlvbnMuZnJvbVN0YWNrKHN0YWNrKS5oYXNOb1dhcm5pbmcoJy9EZWZhdWx0JywgTWF0Y2guYW55VmFsdWUoKSk7XG59KTtcbiJdfQ==