"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../../assertions");
const aws_autoscaling_1 = require("../../../aws-autoscaling");
const ec2 = require("../../../aws-ec2");
const aws_ec2_1 = require("../../../aws-ec2");
const ecs = require("../../../aws-ecs");
const aws_ecs_1 = require("../../../aws-ecs");
const sqs = require("../../../aws-sqs");
const aws_sqs_1 = require("../../../aws-sqs");
const cdk_build_tools_1 = require("@aws-cdk/cdk-build-tools");
const cdk = require("../../../core");
const ecsPatterns = require("../../lib");
test('test fargate queue worker service construct - with only required props', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
    });
    // THEN - QueueWorker is of FARGATE launch type, an SQS queue is created and all default properties are set.
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        LaunchType: 'FARGATE',
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        RedrivePolicy: {
            deadLetterTargetArn: {
                'Fn::GetAtt': [
                    'ServiceEcsProcessingDeadLetterQueue4A89196E',
                    'Arn',
                ],
            },
            maxReceiveCount: 3,
        },
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        MessageRetentionPeriod: 1209600,
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
        PolicyDocument: {
            Statement: [
                {
                    Action: [
                        'sqs:ReceiveMessage',
                        'sqs:ChangeMessageVisibility',
                        'sqs:GetQueueUrl',
                        'sqs:DeleteMessage',
                        'sqs:GetQueueAttributes',
                    ],
                    Effect: 'Allow',
                    Resource: {
                        'Fn::GetAtt': [
                            'ServiceEcsProcessingQueueC266885C',
                            'Arn',
                        ],
                    },
                },
            ],
            Version: '2012-10-17',
        },
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            assertions_1.Match.objectLike({
                Environment: [
                    {
                        Name: 'QUEUE_NAME',
                        Value: {
                            'Fn::GetAtt': [
                                'ServiceEcsProcessingQueueC266885C',
                                'QueueName',
                            ],
                        },
                    },
                ],
                LogConfiguration: {
                    LogDriver: 'awslogs',
                    Options: {
                        'awslogs-group': {
                            Ref: 'ServiceQueueProcessingTaskDefQueueProcessingContainerLogGroupD52338D1',
                        },
                        'awslogs-stream-prefix': 'Service',
                        'awslogs-region': {
                            Ref: 'AWS::Region',
                        },
                    },
                },
                Image: 'test',
            }),
        ],
        Family: 'ServiceQueueProcessingTaskDef83DB34F1',
    });
});
test('test fargate queue worker service construct - with remove default desiredCount feature flag', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
    });
    // THEN - QueueWorker is of FARGATE launch type, and desiredCount is not defined on the FargateService.
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        DesiredCount: assertions_1.Match.absent(),
        LaunchType: 'FARGATE',
    });
});
test('test fargate queue worker service construct - with optional props for queues', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
        maxReceiveCount: 42,
        retentionPeriod: cdk.Duration.days(7),
        visibilityTimeout: cdk.Duration.minutes(5),
    });
    // THEN - QueueWorker is of FARGATE launch type, an SQS queue is created and all default properties are set.
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        LaunchType: 'FARGATE',
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        RedrivePolicy: {
            deadLetterTargetArn: {
                'Fn::GetAtt': [
                    'ServiceEcsProcessingDeadLetterQueue4A89196E',
                    'Arn',
                ],
            },
            maxReceiveCount: 42,
        },
        VisibilityTimeout: 300,
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        MessageRetentionPeriod: 604800,
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
        PolicyDocument: {
            Statement: [
                {
                    Action: [
                        'sqs:ReceiveMessage',
                        'sqs:ChangeMessageVisibility',
                        'sqs:GetQueueUrl',
                        'sqs:DeleteMessage',
                        'sqs:GetQueueAttributes',
                    ],
                    Effect: 'Allow',
                    Resource: {
                        'Fn::GetAtt': [
                            'ServiceEcsProcessingQueueC266885C',
                            'Arn',
                        ],
                    },
                },
            ],
            Version: '2012-10-17',
        },
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            assertions_1.Match.objectLike({
                Environment: [
                    {
                        Name: 'QUEUE_NAME',
                        Value: {
                            'Fn::GetAtt': [
                                'ServiceEcsProcessingQueueC266885C',
                                'QueueName',
                            ],
                        },
                    },
                ],
                LogConfiguration: {
                    LogDriver: 'awslogs',
                    Options: {
                        'awslogs-group': {
                            Ref: 'ServiceQueueProcessingTaskDefQueueProcessingContainerLogGroupD52338D1',
                        },
                        'awslogs-stream-prefix': 'Service',
                        'awslogs-region': {
                            Ref: 'AWS::Region',
                        },
                    },
                },
                Image: 'test',
            }),
        ],
        Family: 'ServiceQueueProcessingTaskDef83DB34F1',
    });
});
test('test Fargate queue worker service construct - with ECS Exec', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
        enableExecuteCommand: true,
    });
    // THEN
    // ECS Exec
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
        PolicyDocument: {
            Statement: [
                {
                    Action: [
                        'ssmmessages:CreateControlChannel',
                        'ssmmessages:CreateDataChannel',
                        'ssmmessages:OpenControlChannel',
                        'ssmmessages:OpenDataChannel',
                    ],
                    Effect: 'Allow',
                    Resource: '*',
                },
                {
                    Action: 'logs:DescribeLogGroups',
                    Effect: 'Allow',
                    Resource: '*',
                },
                {
                    Action: [
                        'logs:CreateLogStream',
                        'logs:DescribeLogStreams',
                        'logs:PutLogEvents',
                    ],
                    Effect: 'Allow',
                    Resource: '*',
                },
                {
                    Action: [
                        'sqs:ReceiveMessage',
                        'sqs:ChangeMessageVisibility',
                        'sqs:GetQueueUrl',
                        'sqs:DeleteMessage',
                        'sqs:GetQueueAttributes',
                    ],
                    Effect: 'Allow',
                    Resource: {
                        'Fn::GetAtt': [
                            'ServiceEcsProcessingQueueC266885C',
                            'Arn',
                        ],
                    },
                },
            ],
            Version: '2012-10-17',
        },
        PolicyName: 'ServiceQueueProcessingTaskDefTaskRoleDefaultPolicy11D50174',
        Roles: [
            {
                Ref: 'ServiceQueueProcessingTaskDefTaskRoleBDE5D3C6',
            },
        ],
    });
});
test('test Fargate queue worker service construct - without desiredCount specified', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    const queue = new sqs.Queue(stack, 'fargate-test-queue', {
        queueName: 'fargate-test-sqs-queue',
    });
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
        command: ['-c', '4', 'amazon.com'],
        enableLogging: false,
        environment: {
            TEST_ENVIRONMENT_VARIABLE1: 'test environment variable 1 value',
            TEST_ENVIRONMENT_VARIABLE2: 'test environment variable 2 value',
        },
        queue,
        maxScalingCapacity: 5,
        minScalingCapacity: 2,
        minHealthyPercent: 60,
        maxHealthyPercent: 150,
        serviceName: 'fargate-test-service',
        family: 'fargate-task-family',
        platformVersion: ecs.FargatePlatformVersion.VERSION1_4,
        deploymentController: {
            type: ecs.DeploymentControllerType.CODE_DEPLOY,
        },
    });
    // THEN - QueueWorker is of FARGATE launch type, an SQS queue is created and all optional properties are set.
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        DeploymentConfiguration: {
            MinimumHealthyPercent: 60,
            MaximumPercent: 150,
        },
        LaunchType: 'FARGATE',
        ServiceName: 'fargate-test-service',
        PlatformVersion: ecs.FargatePlatformVersion.VERSION1_4,
        DeploymentController: {
            Type: 'CODE_DEPLOY',
        },
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ApplicationAutoScaling::ScalableTarget', {
        MaxCapacity: 5,
        MinCapacity: 2,
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', { QueueName: 'fargate-test-sqs-queue' });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            assertions_1.Match.objectLike({
                Command: [
                    '-c',
                    '4',
                    'amazon.com',
                ],
                Environment: [
                    {
                        Name: 'TEST_ENVIRONMENT_VARIABLE1',
                        Value: 'test environment variable 1 value',
                    },
                    {
                        Name: 'TEST_ENVIRONMENT_VARIABLE2',
                        Value: 'test environment variable 2 value',
                    },
                    {
                        Name: 'QUEUE_NAME',
                        Value: {
                            'Fn::GetAtt': [
                                'fargatetestqueue28B43841',
                                'QueueName',
                            ],
                        },
                    },
                ],
                Image: 'test',
            }),
        ],
        Family: 'fargate-task-family',
    });
});
(0, cdk_build_tools_1.testDeprecated)('test Fargate queue worker service construct - with optional props', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    const queue = new sqs.Queue(stack, 'fargate-test-queue', {
        queueName: 'fargate-test-sqs-queue',
    });
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
        command: ['-c', '4', 'amazon.com'],
        enableLogging: false,
        environment: {
            TEST_ENVIRONMENT_VARIABLE1: 'test environment variable 1 value',
            TEST_ENVIRONMENT_VARIABLE2: 'test environment variable 2 value',
        },
        queue,
        maxScalingCapacity: 5,
        minHealthyPercent: 60,
        maxHealthyPercent: 150,
        serviceName: 'fargate-test-service',
        family: 'fargate-task-family',
        platformVersion: ecs.FargatePlatformVersion.VERSION1_4,
        circuitBreaker: { rollback: true },
    });
    // THEN - QueueWorker is of FARGATE launch type, an SQS queue is created and all optional properties are set.
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        DeploymentConfiguration: {
            MinimumHealthyPercent: 60,
            MaximumPercent: 150,
            DeploymentCircuitBreaker: {
                Enable: true,
                Rollback: true,
            },
        },
        LaunchType: 'FARGATE',
        ServiceName: 'fargate-test-service',
        PlatformVersion: ecs.FargatePlatformVersion.VERSION1_4,
        DeploymentController: {
            Type: 'ECS',
        },
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', { QueueName: 'fargate-test-sqs-queue' });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            assertions_1.Match.objectLike({
                Command: [
                    '-c',
                    '4',
                    'amazon.com',
                ],
                Environment: [
                    {
                        Name: 'TEST_ENVIRONMENT_VARIABLE1',
                        Value: 'test environment variable 1 value',
                    },
                    {
                        Name: 'TEST_ENVIRONMENT_VARIABLE2',
                        Value: 'test environment variable 2 value',
                    },
                    {
                        Name: 'QUEUE_NAME',
                        Value: {
                            'Fn::GetAtt': [
                                'fargatetestqueue28B43841',
                                'QueueName',
                            ],
                        },
                    },
                ],
                Image: 'test',
            }),
        ],
        Family: 'fargate-task-family',
    });
});
test('can set custom containerName', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    const cluster = new ecs.Cluster(stack, 'Cluster', { vpc });
    cluster.addAsgCapacityProvider(new aws_ecs_1.AsgCapacityProvider(stack, 'DefaultAutoScalingGroupProvider', {
        autoScalingGroup: new aws_autoscaling_1.AutoScalingGroup(stack, 'DefaultAutoScalingGroup', {
            vpc,
            instanceType: new ec2.InstanceType('t2.micro'),
            machineImage: aws_ec2_1.MachineImage.latestAmazonLinux(),
        }),
    }));
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        containerName: 'my-container',
        image: ecs.ContainerImage.fromRegistry('test'),
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::TaskDefinition', {
        ContainerDefinitions: [
            assertions_1.Match.objectLike({
                Name: 'my-container',
            }),
        ],
    });
});
test('can set custom networking options', () => {
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC', {
        subnetConfiguration: [
            {
                cidrMask: 24,
                name: 'Public',
                subnetType: ec2.SubnetType.PUBLIC,
            },
            {
                cidrMask: 24,
                name: 'Isolated',
                subnetType: ec2.SubnetType.PRIVATE_ISOLATED,
            },
        ],
    });
    const securityGroup = new ec2.SecurityGroup(stack, 'MyCustomSG', {
        vpc,
    });
    // WHEN - SecurityGroups and taskSubnets selection is defined
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        vpc,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
        securityGroups: [securityGroup],
        taskSubnets: { subnetType: ec2.SubnetType.PRIVATE_ISOLATED },
    });
    // THEN - NetworkConfiguration is created with the specific security groups and selected subnets
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        LaunchType: 'FARGATE',
        NetworkConfiguration: {
            AwsvpcConfiguration: {
                AssignPublicIp: 'DISABLED',
                SecurityGroups: [
                    {
                        'Fn::GetAtt': [
                            'MyCustomSGDE27C661',
                            'GroupId',
                        ],
                    },
                ],
                Subnets: [
                    {
                        Ref: 'VPCIsolatedSubnet1SubnetEBD00FC6',
                    },
                    {
                        Ref: 'VPCIsolatedSubnet2Subnet4B1C8CAA',
                    },
                ],
            },
        },
    });
});
test('can set use public IP', () => {
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'VPC');
    // WHEN - Assign Public IP is set to True
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        vpc,
        memoryLimitMiB: 512,
        image: ecs.ContainerImage.fromRegistry('test'),
        assignPublicIp: true,
    });
    // THEN - The Subnets defaults to Public and AssignPublicIp settings change to ENABLED
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        LaunchType: 'FARGATE',
        NetworkConfiguration: {
            AwsvpcConfiguration: {
                AssignPublicIp: 'ENABLED',
                SecurityGroups: [
                    {
                        'Fn::GetAtt': [
                            'ServiceQueueProcessingFargateServiceSecurityGroup6E981512',
                            'GroupId',
                        ],
                    },
                ],
                Subnets: [
                    {
                        Ref: 'VPCPublicSubnet1SubnetB4246D30',
                    },
                    {
                        Ref: 'VPCPublicSubnet2Subnet74179F39',
                    },
                ],
            },
        },
    });
});
test('can set capacity provider strategies', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const vpc = new ec2.Vpc(stack, 'MyVpc', {});
    const cluster = new ecs.Cluster(stack, 'EcsCluster', {
        vpc,
    });
    cluster.enableFargateCapacityProviders();
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        cluster,
        image: ecs.ContainerImage.fromRegistry('test'),
        capacityProviderStrategies: [
            {
                capacityProvider: 'FARGATE_SPOT',
                weight: 2,
            },
            {
                capacityProvider: 'FARGATE',
                weight: 1,
            },
        ],
    });
    // THEN
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::ECS::Service', {
        LaunchType: assertions_1.Match.absent(),
        CapacityProviderStrategy: [
            {
                CapacityProvider: 'FARGATE_SPOT',
                Weight: 2,
            },
            {
                CapacityProvider: 'FARGATE',
                Weight: 1,
            },
        ],
    });
});
it('can set queue props by queue construct', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const queue = new aws_sqs_1.Queue(stack, 'Queue', {
        queueName: 'custom-queue',
        visibilityTimeout: cdk.Duration.seconds(200),
        deadLetterQueue: {
            queue: new aws_sqs_1.Queue(stack, 'DeadLetterQueue', {
                queueName: 'custom-dead-letter-queue',
                retentionPeriod: cdk.Duration.seconds(100),
            }),
            maxReceiveCount: 10,
        },
    });
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        image: ecs.ContainerImage.fromRegistry('test'),
        queue: queue,
    });
    // Queue
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        QueueName: 'custom-queue',
        VisibilityTimeout: 200,
        RedrivePolicy: {
            maxReceiveCount: 10,
        },
    });
    // DLQ
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        QueueName: 'custom-dead-letter-queue',
        MessageRetentionPeriod: 100,
    });
});
it('can set queue props by QueueProcessingServiceBaseProps', () => {
    // GIVEN
    const stack = new cdk.Stack();
    // WHEN
    new ecsPatterns.QueueProcessingFargateService(stack, 'Service', {
        image: ecs.ContainerImage.fromRegistry('test'),
        retentionPeriod: cdk.Duration.seconds(100),
        visibilityTimeout: cdk.Duration.seconds(200),
        maxReceiveCount: 10,
    });
    // Queue
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        QueueName: assertions_1.Match.absent(),
        VisibilityTimeout: 200,
        RedrivePolicy: {
            maxReceiveCount: 10,
        },
    });
    // DLQ
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SQS::Queue', {
        QueueName: assertions_1.Match.absent(),
        MessageRetentionPeriod: 100,
    });
});
it('throws validation errors of the specific queue prop, when setting queue and queue related props at same time', () => {
    // GIVEN
    const stack = new cdk.Stack();
    const queue = new aws_sqs_1.Queue(stack, 'Queue');
    // Setting all retentionPeriod, visibilityTimeout and maxReceiveCount
    expect(() => {
        new ecsPatterns.QueueProcessingFargateService(stack, 'Service1', {
            image: ecs.ContainerImage.fromRegistry('test'),
            queue: queue,
            retentionPeriod: cdk.Duration.seconds(100),
            visibilityTimeout: cdk.Duration.seconds(200),
            maxReceiveCount: 10,
        });
    }).toThrow(new Error('retentionPeriod, visibilityTimeout, maxReceiveCount can be set only when queue is not set. Specify them in the QueueProps of the queue'));
    // Setting only visibilityTimeout
    expect(() => {
        new ecsPatterns.QueueProcessingFargateService(stack, 'Service2', {
            image: ecs.ContainerImage.fromRegistry('test'),
            queue: queue,
            visibilityTimeout: cdk.Duration.seconds(200),
        });
    }).toThrow(new Error('visibilityTimeout can be set only when queue is not set. Specify them in the QueueProps of the queue'));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVldWUtcHJvY2Vzc2luZy1mYXJnYXRlLXNlcnZpY2UudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInF1ZXVlLXByb2Nlc3NpbmctZmFyZ2F0ZS1zZXJ2aWNlLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxvREFBc0Q7QUFDdEQsOERBQTREO0FBQzVELHdDQUF3QztBQUN4Qyw4Q0FBZ0Q7QUFDaEQsd0NBQXdDO0FBQ3hDLDhDQUF1RDtBQUN2RCx3Q0FBd0M7QUFDeEMsOENBQXlDO0FBQ3pDLDhEQUEwRDtBQUMxRCxxQ0FBcUM7QUFDckMseUNBQXlDO0FBRXpDLElBQUksQ0FBQyx3RUFBd0UsRUFBRSxHQUFHLEVBQUU7SUFDbEYsUUFBUTtJQUNSLE1BQU0sS0FBSyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQzlCLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDdEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxHQUFHLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQzNELE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQyxJQUFJLDZCQUFtQixDQUFDLEtBQUssRUFBRSxpQ0FBaUMsRUFBRTtRQUMvRixnQkFBZ0IsRUFBRSxJQUFJLGtDQUFnQixDQUFDLEtBQUssRUFBRSx5QkFBeUIsRUFBRTtZQUN2RSxHQUFHO1lBQ0gsWUFBWSxFQUFFLElBQUksR0FBRyxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUM7WUFDOUMsWUFBWSxFQUFFLHNCQUFZLENBQUMsaUJBQWlCLEVBQUU7U0FDL0MsQ0FBQztLQUNILENBQUMsQ0FBQyxDQUFDO0lBRUosT0FBTztJQUNQLElBQUksV0FBVyxDQUFDLDZCQUE2QixDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUU7UUFDOUQsT0FBTztRQUNQLGNBQWMs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QU8sQ0FBQyxJQUFJLEtBQUssQ0FBQyx3SUFBd0ksQ0FBQyxDQUFDLENBQUM7SUFFaEssaUNBQWlDO0lBQ2pDLE1BQU0sQ0FBQyxHQUFHLEVBQUU7UUFDVixJQUFJLFdBQVcsQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLEVBQUUsVUFBVSxFQUFFO1lBQy9ELEtBQUssRUFBRSxHQUFHLENBQUMsY0FBYyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUM7WUFDOUMsS0FBSyxFQUFFLEtBQUs7WUFDWixpQkFBaUIsRUFBRSxHQUFHLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUM7U0FDN0MsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksS0FBSyxDQUFDLHNHQUFzRyxDQUFDLENBQUMsQ0FBQztBQUNoSSxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1hdGNoLCBUZW1wbGF0ZSB9IGZyb20gJy4uLy4uLy4uL2Fzc2VydGlvbnMnO1xuaW1wb3J0IHsgQXV0b1NjYWxpbmdHcm91cCB9IGZyb20gJy4uLy4uLy4uL2F3cy1hdXRvc2NhbGluZyc7XG5pbXBvcnQgKiBhcyBlYzIgZnJvbSAnLi4vLi4vLi4vYXdzLWVjMic7XG5pbXBvcnQgeyBNYWNoaW5lSW1hZ2UgfSBmcm9tICcuLi8uLi8uLi9hd3MtZWMyJztcbmltcG9ydCAqIGFzIGVjcyBmcm9tICcuLi8uLi8uLi9hd3MtZWNzJztcbmltcG9ydCB7IEFzZ0NhcGFjaXR5UHJvdmlkZXIgfSBmcm9tICcuLi8uLi8uLi9hd3MtZWNzJztcbmltcG9ydCAqIGFzIHNxcyBmcm9tICcuLi8uLi8uLi9hd3Mtc3FzJztcbmltcG9ydCB7IFF1ZXVlIH0gZnJvbSAnLi4vLi4vLi4vYXdzLXNxcyc7XG5pbXBvcnQgeyB0ZXN0RGVwcmVjYXRlZCB9IGZyb20gJ0Bhd3MtY2RrL2Nkay1idWlsZC10b29scyc7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnLi4vLi4vLi4vY29yZSc7XG5pbXBvcnQgKiBhcyBlY3NQYXR0ZXJucyBmcm9tICcuLi8uLi9saWInO1xuXG50ZXN0KCd0ZXN0IGZhcmdhdGUgcXVldWUgd29ya2VyIHNlcnZpY2UgY29uc3RydWN0IC0gd2l0aCBvbmx5IHJlcXVpcmVkIHByb3BzJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWUEMnKTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcblxuICAvLyBXSEVOXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgY2x1c3RlcixcbiAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCd0ZXN0JyksXG4gIH0pO1xuXG4gIC8vIFRIRU4gLSBRdWV1ZVdvcmtlciBpcyBvZiBGQVJHQVRFIGxhdW5jaCB0eXBlLCBhbiBTUVMgcXVldWUgaXMgY3JlYXRlZCBhbmQgYWxsIGRlZmF1bHQgcHJvcGVydGllcyBhcmUgc2V0LlxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpFQ1M6OlNlcnZpY2UnLCB7XG4gICAgTGF1bmNoVHlwZTogJ0ZBUkdBVEUnLFxuICB9KTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpTUVM6OlF1ZXVlJywge1xuICAgIFJlZHJpdmVQb2xpY3k6IHtcbiAgICAgIGRlYWRMZXR0ZXJUYXJnZXRBcm46IHtcbiAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgJ1NlcnZpY2VFY3NQcm9jZXNzaW5nRGVhZExldHRlclF1ZXVlNEE4OTE5NkUnLFxuICAgICAgICAgICdBcm4nLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgIG1heFJlY2VpdmVDb3VudDogMyxcbiAgICB9LFxuICB9KTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpTUVM6OlF1ZXVlJywge1xuICAgIE1lc3NhZ2VSZXRlbnRpb25QZXJpb2Q6IDEyMDk2MDAsXG4gIH0pO1xuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgIFBvbGljeURvY3VtZW50OiB7XG4gICAgICBTdGF0ZW1lbnQ6IFtcbiAgICAgICAge1xuICAgICAgICAgIEFjdGlvbjogW1xuICAgICAgICAgICAgJ3NxczpSZWNlaXZlTWVzc2FnZScsXG4gICAgICAgICAgICAnc3FzOkNoYW5nZU1lc3NhZ2VWaXNpYmlsaXR5JyxcbiAgICAgICAgICAgICdzcXM6R2V0UXVldWVVcmwnLFxuICAgICAgICAgICAgJ3NxczpEZWxldGVNZXNzYWdlJyxcbiAgICAgICAgICAgICdzcXM6R2V0UXVldWVBdHRyaWJ1dGVzJyxcbiAgICAgICAgICBdLFxuICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgICAgICdTZXJ2aWNlRWNzUHJvY2Vzc2luZ1F1ZXVlQzI2Njg4NUMnLFxuICAgICAgICAgICAgICAnQXJuJyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBWZXJzaW9uOiAnMjAxMi0xMC0xNycsXG4gICAgfSxcbiAgfSk7XG5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RUNTOjpUYXNrRGVmaW5pdGlvbicsIHtcbiAgICBDb250YWluZXJEZWZpbml0aW9uczogW1xuICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgIEVudmlyb25tZW50OiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgTmFtZTogJ1FVRVVFX05BTUUnLFxuICAgICAgICAgICAgVmFsdWU6IHtcbiAgICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgICAgICAgJ1NlcnZpY2VFY3NQcm9jZXNzaW5nUXVldWVDMjY2ODg1QycsXG4gICAgICAgICAgICAgICAgJ1F1ZXVlTmFtZScsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIExvZ0NvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICBMb2dEcml2ZXI6ICdhd3Nsb2dzJyxcbiAgICAgICAgICBPcHRpb25zOiB7XG4gICAgICAgICAgICAnYXdzbG9ncy1ncm91cCc6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2VydmljZVF1ZXVlUHJvY2Vzc2luZ1Rhc2tEZWZRdWV1ZVByb2Nlc3NpbmdDb250YWluZXJMb2dHcm91cEQ1MjMzOEQxJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnYXdzbG9ncy1zdHJlYW0tcHJlZml4JzogJ1NlcnZpY2UnLFxuICAgICAgICAgICAgJ2F3c2xvZ3MtcmVnaW9uJzoge1xuICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIEltYWdlOiAndGVzdCcsXG4gICAgICB9KSxcbiAgICBdLFxuICAgIEZhbWlseTogJ1NlcnZpY2VRdWV1ZVByb2Nlc3NpbmdUYXNrRGVmODNEQjM0RjEnLFxuICB9KTtcbn0pO1xuXG50ZXN0KCd0ZXN0IGZhcmdhdGUgcXVldWUgd29ya2VyIHNlcnZpY2UgY29uc3RydWN0IC0gd2l0aCByZW1vdmUgZGVmYXVsdCBkZXNpcmVkQ291bnQgZmVhdHVyZSBmbGFnJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWUEMnKTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0NsdXN0ZXInLCB7IHZwYyB9KTtcblxuICAvLyBXSEVOXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgY2x1c3RlcixcbiAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCd0ZXN0JyksXG4gIH0pO1xuXG4gIC8vIFRIRU4gLSBRdWV1ZVdvcmtlciBpcyBvZiBGQVJHQVRFIGxhdW5jaCB0eXBlLCBhbmQgZGVzaXJlZENvdW50IGlzIG5vdCBkZWZpbmVkIG9uIHRoZSBGYXJnYXRlU2VydmljZS5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RUNTOjpTZXJ2aWNlJywge1xuICAgIERlc2lyZWRDb3VudDogTWF0Y2guYWJzZW50KCksXG4gICAgTGF1bmNoVHlwZTogJ0ZBUkdBVEUnLFxuICB9KTtcbn0pO1xuXG50ZXN0KCd0ZXN0IGZhcmdhdGUgcXVldWUgd29ya2VyIHNlcnZpY2UgY29uc3RydWN0IC0gd2l0aCBvcHRpb25hbCBwcm9wcyBmb3IgcXVldWVzJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWUEMnKTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcblxuICAvLyBXSEVOXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgY2x1c3RlcixcbiAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCd0ZXN0JyksXG4gICAgbWF4UmVjZWl2ZUNvdW50OiA0MixcbiAgICByZXRlbnRpb25QZXJpb2Q6IGNkay5EdXJhdGlvbi5kYXlzKDcpLFxuICAgIHZpc2liaWxpdHlUaW1lb3V0OiBjZGsuRHVyYXRpb24ubWludXRlcyg1KSxcbiAgfSk7XG5cbiAgLy8gVEhFTiAtIFF1ZXVlV29ya2VyIGlzIG9mIEZBUkdBVEUgbGF1bmNoIHR5cGUsIGFuIFNRUyBxdWV1ZSBpcyBjcmVhdGVkIGFuZCBhbGwgZGVmYXVsdCBwcm9wZXJ0aWVzIGFyZSBzZXQuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkVDUzo6U2VydmljZScsIHtcbiAgICBMYXVuY2hUeXBlOiAnRkFSR0FURScsXG4gIH0pO1xuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlNRUzo6UXVldWUnLCB7XG4gICAgUmVkcml2ZVBvbGljeToge1xuICAgICAgZGVhZExldHRlclRhcmdldEFybjoge1xuICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAnU2VydmljZUVjc1Byb2Nlc3NpbmdEZWFkTGV0dGVyUXVldWU0QTg5MTk2RScsXG4gICAgICAgICAgJ0FybicsXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICAgbWF4UmVjZWl2ZUNvdW50OiA0MixcbiAgICB9LFxuICAgIFZpc2liaWxpdHlUaW1lb3V0OiAzMDAsXG4gIH0pO1xuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlNRUzo6UXVldWUnLCB7XG4gICAgTWVzc2FnZVJldGVudGlvblBlcmlvZDogNjA0ODAwLFxuICB9KTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgU3RhdGVtZW50OiBbXG4gICAgICAgIHtcbiAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICdzcXM6UmVjZWl2ZU1lc3NhZ2UnLFxuICAgICAgICAgICAgJ3NxczpDaGFuZ2VNZXNzYWdlVmlzaWJpbGl0eScsXG4gICAgICAgICAgICAnc3FzOkdldFF1ZXVlVXJsJyxcbiAgICAgICAgICAgICdzcXM6RGVsZXRlTWVzc2FnZScsXG4gICAgICAgICAgICAnc3FzOkdldFF1ZXVlQXR0cmlidXRlcycsXG4gICAgICAgICAgXSxcbiAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICdGbjo6R2V0QXR0JzogW1xuICAgICAgICAgICAgICAnU2VydmljZUVjc1Byb2Nlc3NpbmdRdWV1ZUMyNjY4ODVDJyxcbiAgICAgICAgICAgICAgJ0FybicsXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgVmVyc2lvbjogJzIwMTItMTAtMTcnLFxuICAgIH0sXG4gIH0pO1xuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkVDUzo6VGFza0RlZmluaXRpb24nLCB7XG4gICAgQ29udGFpbmVyRGVmaW5pdGlvbnM6IFtcbiAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICBFbnZpcm9ubWVudDogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIE5hbWU6ICdRVUVVRV9OQU1FJyxcbiAgICAgICAgICAgIFZhbHVlOiB7XG4gICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogW1xuICAgICAgICAgICAgICAgICdTZXJ2aWNlRWNzUHJvY2Vzc2luZ1F1ZXVlQzI2Njg4NUMnLFxuICAgICAgICAgICAgICAgICdRdWV1ZU5hbWUnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBMb2dDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgTG9nRHJpdmVyOiAnYXdzbG9ncycsXG4gICAgICAgICAgT3B0aW9uczoge1xuICAgICAgICAgICAgJ2F3c2xvZ3MtZ3JvdXAnOiB7XG4gICAgICAgICAgICAgIFJlZjogJ1NlcnZpY2VRdWV1ZVByb2Nlc3NpbmdUYXNrRGVmUXVldWVQcm9jZXNzaW5nQ29udGFpbmVyTG9nR3JvdXBENTIzMzhEMScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ2F3c2xvZ3Mtc3RyZWFtLXByZWZpeCc6ICdTZXJ2aWNlJyxcbiAgICAgICAgICAgICdhd3Nsb2dzLXJlZ2lvbic6IHtcbiAgICAgICAgICAgICAgUmVmOiAnQVdTOjpSZWdpb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBJbWFnZTogJ3Rlc3QnLFxuICAgICAgfSksXG4gICAgXSxcbiAgICBGYW1pbHk6ICdTZXJ2aWNlUXVldWVQcm9jZXNzaW5nVGFza0RlZjgzREIzNEYxJyxcbiAgfSk7XG59KTtcblxudGVzdCgndGVzdCBGYXJnYXRlIHF1ZXVlIHdvcmtlciBzZXJ2aWNlIGNvbnN0cnVjdCAtIHdpdGggRUNTIEV4ZWMnLCAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICBjb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZQQycpO1xuICBjb25zdCBjbHVzdGVyID0gbmV3IGVjcy5DbHVzdGVyKHN0YWNrLCAnQ2x1c3RlcicsIHsgdnBjIH0pO1xuXG4gIC8vIFdIRU5cbiAgbmV3IGVjc1BhdHRlcm5zLlF1ZXVlUHJvY2Vzc2luZ0ZhcmdhdGVTZXJ2aWNlKHN0YWNrLCAnU2VydmljZScsIHtcbiAgICBjbHVzdGVyLFxuICAgIG1lbW9yeUxpbWl0TWlCOiA1MTIsXG4gICAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tUmVnaXN0cnkoJ3Rlc3QnKSxcbiAgICBlbmFibGVFeGVjdXRlQ29tbWFuZDogdHJ1ZSxcbiAgfSk7XG5cbiAgLy8gVEhFTlxuICAvLyBFQ1MgRXhlY1xuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgU3RhdGVtZW50OiBbXG4gICAgICAgIHtcbiAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICdzc21tZXNzYWdlczpDcmVhdGVDb250cm9sQ2hhbm5lbCcsXG4gICAgICAgICAgICAnc3NtbWVzc2FnZXM6Q3JlYXRlRGF0YUNoYW5uZWwnLFxuICAgICAgICAgICAgJ3NzbW1lc3NhZ2VzOk9wZW5Db250cm9sQ2hhbm5lbCcsXG4gICAgICAgICAgICAnc3NtbWVzc2FnZXM6T3BlbkRhdGFDaGFubmVsJyxcbiAgICAgICAgICBdLFxuICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICBSZXNvdXJjZTogJyonLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgQWN0aW9uOiAnbG9nczpEZXNjcmliZUxvZ0dyb3VwcycsXG4gICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgIFJlc291cmNlOiAnKicsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICdsb2dzOkNyZWF0ZUxvZ1N0cmVhbScsXG4gICAgICAgICAgICAnbG9nczpEZXNjcmliZUxvZ1N0cmVhbXMnLFxuICAgICAgICAgICAgJ2xvZ3M6UHV0TG9nRXZlbnRzJyxcbiAgICAgICAgICBdLFxuICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICBSZXNvdXJjZTogJyonLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgQWN0aW9uOiBbXG4gICAgICAgICAgICAnc3FzOlJlY2VpdmVNZXNzYWdlJyxcbiAgICAgICAgICAgICdzcXM6Q2hhbmdlTWVzc2FnZVZpc2liaWxpdHknLFxuICAgICAgICAgICAgJ3NxczpHZXRRdWV1ZVVybCcsXG4gICAgICAgICAgICAnc3FzOkRlbGV0ZU1lc3NhZ2UnLFxuICAgICAgICAgICAgJ3NxczpHZXRRdWV1ZUF0dHJpYnV0ZXMnLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgJ1NlcnZpY2VFY3NQcm9jZXNzaW5nUXVldWVDMjY2ODg1QycsXG4gICAgICAgICAgICAgICdBcm4nLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIFZlcnNpb246ICcyMDEyLTEwLTE3JyxcbiAgICB9LFxuICAgIFBvbGljeU5hbWU6ICdTZXJ2aWNlUXVldWVQcm9jZXNzaW5nVGFza0RlZlRhc2tSb2xlRGVmYXVsdFBvbGljeTExRDUwMTc0JyxcbiAgICBSb2xlczogW1xuICAgICAge1xuICAgICAgICBSZWY6ICdTZXJ2aWNlUXVldWVQcm9jZXNzaW5nVGFza0RlZlRhc2tSb2xlQkRFNUQzQzYnLFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcbn0pO1xuXG50ZXN0KCd0ZXN0IEZhcmdhdGUgcXVldWUgd29ya2VyIHNlcnZpY2UgY29uc3RydWN0IC0gd2l0aG91dCBkZXNpcmVkQ291bnQgc3BlY2lmaWVkJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWUEMnKTtcbiAgY29uc3QgY2x1c3RlciA9IG5ldyBlY3MuQ2x1c3RlcihzdGFjaywgJ0NsdXN0ZXInLCB7IHZwYyB9KTtcbiAgY2x1c3Rlci5hZGRBc2dDYXBhY2l0eVByb3ZpZGVyKG5ldyBBc2dDYXBhY2l0eVByb3ZpZGVyKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXBQcm92aWRlcicsIHtcbiAgICBhdXRvU2NhbGluZ0dyb3VwOiBuZXcgQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwJywge1xuICAgICAgdnBjLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZSgndDIubWljcm8nKSxcbiAgICAgIG1hY2hpbmVJbWFnZTogTWFjaGluZUltYWdlLmxhdGVzdEFtYXpvbkxpbnV4KCksXG4gICAgfSksXG4gIH0pKTtcbiAgY29uc3QgcXVldWUgPSBuZXcgc3FzLlF1ZXVlKHN0YWNrLCAnZmFyZ2F0ZS10ZXN0LXF1ZXVlJywge1xuICAgIHF1ZXVlTmFtZTogJ2ZhcmdhdGUtdGVzdC1zcXMtcXVldWUnLFxuICB9KTtcblxuICAvLyBXSEVOXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgY2x1c3RlcixcbiAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCd0ZXN0JyksXG4gICAgY29tbWFuZDogWyctYycsICc0JywgJ2FtYXpvbi5jb20nXSxcbiAgICBlbmFibGVMb2dnaW5nOiBmYWxzZSxcbiAgICBlbnZpcm9ubWVudDoge1xuICAgICAgVEVTVF9FTlZJUk9OTUVOVF9WQVJJQUJMRTE6ICd0ZXN0IGVudmlyb25tZW50IHZhcmlhYmxlIDEgdmFsdWUnLFxuICAgICAgVEVTVF9FTlZJUk9OTUVOVF9WQVJJQUJMRTI6ICd0ZXN0IGVudmlyb25tZW50IHZhcmlhYmxlIDIgdmFsdWUnLFxuICAgIH0sXG4gICAgcXVldWUsXG4gICAgbWF4U2NhbGluZ0NhcGFjaXR5OiA1LFxuICAgIG1pblNjYWxpbmdDYXBhY2l0eTogMixcbiAgICBtaW5IZWFsdGh5UGVyY2VudDogNjAsXG4gICAgbWF4SGVhbHRoeVBlcmNlbnQ6IDE1MCxcbiAgICBzZXJ2aWNlTmFtZTogJ2ZhcmdhdGUtdGVzdC1zZXJ2aWNlJyxcbiAgICBmYW1pbHk6ICdmYXJnYXRlLXRhc2stZmFtaWx5JyxcbiAgICBwbGF0Zm9ybVZlcnNpb246IGVjcy5GYXJnYXRlUGxhdGZvcm1WZXJzaW9uLlZFUlNJT04xXzQsXG4gICAgZGVwbG95bWVudENvbnRyb2xsZXI6IHtcbiAgICAgIHR5cGU6IGVjcy5EZXBsb3ltZW50Q29udHJvbGxlclR5cGUuQ09ERV9ERVBMT1ksXG4gICAgfSxcbiAgfSk7XG5cbiAgLy8gVEhFTiAtIFF1ZXVlV29ya2VyIGlzIG9mIEZBUkdBVEUgbGF1bmNoIHR5cGUsIGFuIFNRUyBxdWV1ZSBpcyBjcmVhdGVkIGFuZCBhbGwgb3B0aW9uYWwgcHJvcGVydGllcyBhcmUgc2V0LlxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpFQ1M6OlNlcnZpY2UnLCB7XG4gICAgRGVwbG95bWVudENvbmZpZ3VyYXRpb246IHtcbiAgICAgIE1pbmltdW1IZWFsdGh5UGVyY2VudDogNjAsXG4gICAgICBNYXhpbXVtUGVyY2VudDogMTUwLFxuICAgIH0sXG4gICAgTGF1bmNoVHlwZTogJ0ZBUkdBVEUnLFxuICAgIFNlcnZpY2VOYW1lOiAnZmFyZ2F0ZS10ZXN0LXNlcnZpY2UnLFxuICAgIFBsYXRmb3JtVmVyc2lvbjogZWNzLkZhcmdhdGVQbGF0Zm9ybVZlcnNpb24uVkVSU0lPTjFfNCxcbiAgICBEZXBsb3ltZW50Q29udHJvbGxlcjoge1xuICAgICAgVHlwZTogJ0NPREVfREVQTE9ZJyxcbiAgICB9LFxuICB9KTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcHBsaWNhdGlvbkF1dG9TY2FsaW5nOjpTY2FsYWJsZVRhcmdldCcsIHtcbiAgICBNYXhDYXBhY2l0eTogNSxcbiAgICBNaW5DYXBhY2l0eTogMixcbiAgfSk7XG5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6U1FTOjpRdWV1ZScsIHsgUXVldWVOYW1lOiAnZmFyZ2F0ZS10ZXN0LXNxcy1xdWV1ZScgfSk7XG5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RUNTOjpUYXNrRGVmaW5pdGlvbicsIHtcbiAgICBDb250YWluZXJEZWZpbml0aW9uczogW1xuICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgIENvbW1hbmQ6IFtcbiAgICAgICAgICAnLWMnLFxuICAgICAgICAgICc0JyxcbiAgICAgICAgICAnYW1hem9uLmNvbScsXG4gICAgICAgIF0sXG4gICAgICAgIEVudmlyb25tZW50OiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgTmFtZTogJ1RFU1RfRU5WSVJPTk1FTlRfVkFSSUFCTEUxJyxcbiAgICAgICAgICAgIFZhbHVlOiAndGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZSAxIHZhbHVlJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIE5hbWU6ICdURVNUX0VOVklST05NRU5UX1ZBUklBQkxFMicsXG4gICAgICAgICAgICBWYWx1ZTogJ3Rlc3QgZW52aXJvbm1lbnQgdmFyaWFibGUgMiB2YWx1ZScsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBOYW1lOiAnUVVFVUVfTkFNRScsXG4gICAgICAgICAgICBWYWx1ZToge1xuICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgICAnZmFyZ2F0ZXRlc3RxdWV1ZTI4QjQzODQxJyxcbiAgICAgICAgICAgICAgICAnUXVldWVOYW1lJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgSW1hZ2U6ICd0ZXN0JyxcbiAgICAgIH0pLFxuICAgIF0sXG4gICAgRmFtaWx5OiAnZmFyZ2F0ZS10YXNrLWZhbWlseScsXG4gIH0pO1xufSk7XG5cbnRlc3REZXByZWNhdGVkKCd0ZXN0IEZhcmdhdGUgcXVldWUgd29ya2VyIHNlcnZpY2UgY29uc3RydWN0IC0gd2l0aCBvcHRpb25hbCBwcm9wcycsICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gIGNvbnN0IHZwYyA9IG5ldyBlYzIuVnBjKHN0YWNrLCAnVlBDJyk7XG4gIGNvbnN0IGNsdXN0ZXIgPSBuZXcgZWNzLkNsdXN0ZXIoc3RhY2ssICdDbHVzdGVyJywgeyB2cGMgfSk7XG4gIGNsdXN0ZXIuYWRkQXNnQ2FwYWNpdHlQcm92aWRlcihuZXcgQXNnQ2FwYWNpdHlQcm92aWRlcihzdGFjaywgJ0RlZmF1bHRBdXRvU2NhbGluZ0dyb3VwUHJvdmlkZXInLCB7XG4gICAgYXV0b1NjYWxpbmdHcm91cDogbmV3IEF1dG9TY2FsaW5nR3JvdXAoc3RhY2ssICdEZWZhdWx0QXV0b1NjYWxpbmdHcm91cCcsIHtcbiAgICAgIHZwYyxcbiAgICAgIGluc3RhbmNlVHlwZTogbmV3IGVjMi5JbnN0YW5jZVR5cGUoJ3QyLm1pY3JvJyksXG4gICAgICBtYWNoaW5lSW1hZ2U6IE1hY2hpbmVJbWFnZS5sYXRlc3RBbWF6b25MaW51eCgpLFxuICAgIH0pLFxuICB9KSk7XG4gIGNvbnN0IHF1ZXVlID0gbmV3IHNxcy5RdWV1ZShzdGFjaywgJ2ZhcmdhdGUtdGVzdC1xdWV1ZScsIHtcbiAgICBxdWV1ZU5hbWU6ICdmYXJnYXRlLXRlc3Qtc3FzLXF1ZXVlJyxcbiAgfSk7XG5cbiAgLy8gV0hFTlxuICBuZXcgZWNzUGF0dGVybnMuUXVldWVQcm9jZXNzaW5nRmFyZ2F0ZVNlcnZpY2Uoc3RhY2ssICdTZXJ2aWNlJywge1xuICAgIGNsdXN0ZXIsXG4gICAgbWVtb3J5TGltaXRNaUI6IDUxMixcbiAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgndGVzdCcpLFxuICAgIGNvbW1hbmQ6IFsnLWMnLCAnNCcsICdhbWF6b24uY29tJ10sXG4gICAgZW5hYmxlTG9nZ2luZzogZmFsc2UsXG4gICAgZW52aXJvbm1lbnQ6IHtcbiAgICAgIFRFU1RfRU5WSVJPTk1FTlRfVkFSSUFCTEUxOiAndGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZSAxIHZhbHVlJyxcbiAgICAgIFRFU1RfRU5WSVJPTk1FTlRfVkFSSUFCTEUyOiAndGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZSAyIHZhbHVlJyxcbiAgICB9LFxuICAgIHF1ZXVlLFxuICAgIG1heFNjYWxpbmdDYXBhY2l0eTogNSxcbiAgICBtaW5IZWFsdGh5UGVyY2VudDogNjAsXG4gICAgbWF4SGVhbHRoeVBlcmNlbnQ6IDE1MCxcbiAgICBzZXJ2aWNlTmFtZTogJ2ZhcmdhdGUtdGVzdC1zZXJ2aWNlJyxcbiAgICBmYW1pbHk6ICdmYXJnYXRlLXRhc2stZmFtaWx5JyxcbiAgICBwbGF0Zm9ybVZlcnNpb246IGVjcy5GYXJnYXRlUGxhdGZvcm1WZXJzaW9uLlZFUlNJT04xXzQsXG4gICAgY2lyY3VpdEJyZWFrZXI6IHsgcm9sbGJhY2s6IHRydWUgfSxcbiAgfSk7XG5cbiAgLy8gVEhFTiAtIFF1ZXVlV29ya2VyIGlzIG9mIEZBUkdBVEUgbGF1bmNoIHR5cGUsIGFuIFNRUyBxdWV1ZSBpcyBjcmVhdGVkIGFuZCBhbGwgb3B0aW9uYWwgcHJvcGVydGllcyBhcmUgc2V0LlxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpFQ1M6OlNlcnZpY2UnLCB7XG4gICAgRGVwbG95bWVudENvbmZpZ3VyYXRpb246IHtcbiAgICAgIE1pbmltdW1IZWFsdGh5UGVyY2VudDogNjAsXG4gICAgICBNYXhpbXVtUGVyY2VudDogMTUwLFxuICAgICAgRGVwbG95bWVudENpcmN1aXRCcmVha2VyOiB7XG4gICAgICAgIEVuYWJsZTogdHJ1ZSxcbiAgICAgICAgUm9sbGJhY2s6IHRydWUsXG4gICAgICB9LFxuICAgIH0sXG4gICAgTGF1bmNoVHlwZTogJ0ZBUkdBVEUnLFxuICAgIFNlcnZpY2VOYW1lOiAnZmFyZ2F0ZS10ZXN0LXNlcnZpY2UnLFxuICAgIFBsYXRmb3JtVmVyc2lvbjogZWNzLkZhcmdhdGVQbGF0Zm9ybVZlcnNpb24uVkVSU0lPTjFfNCxcbiAgICBEZXBsb3ltZW50Q29udHJvbGxlcjoge1xuICAgICAgVHlwZTogJ0VDUycsXG4gICAgfSxcbiAgfSk7XG5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6U1FTOjpRdWV1ZScsIHsgUXVldWVOYW1lOiAnZmFyZ2F0ZS10ZXN0LXNxcy1xdWV1ZScgfSk7XG5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RUNTOjpUYXNrRGVmaW5pdGlvbicsIHtcbiAgICBDb250YWluZXJEZWZpbml0aW9uczogW1xuICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgIENvbW1hbmQ6IFtcbiAgICAgICAgICAnLWMnLFxuICAgICAgICAgICc0JyxcbiAgICAgICAgICAnYW1hem9uLmNvbScsXG4gICAgICAgIF0sXG4gICAgICAgIEVudmlyb25tZW50OiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgTmFtZTogJ1RFU1RfRU5WSVJPTk1FTlRfVkFSSUFCTEUxJyxcbiAgICAgICAgICAgIFZhbHVlOiAndGVzdCBlbnZpcm9ubWVudCB2YXJpYWJsZSAxIHZhbHVlJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIE5hbWU6ICdURVNUX0VOVklST05NRU5UX1ZBUklBQkxFMicsXG4gICAgICAgICAgICBWYWx1ZTogJ3Rlc3QgZW52aXJvbm1lbnQgdmFyaWFibGUgMiB2YWx1ZScsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBOYW1lOiAnUVVFVUVfTkFNRScsXG4gICAgICAgICAgICBWYWx1ZToge1xuICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgICAnZmFyZ2F0ZXRlc3RxdWV1ZTI4QjQzODQxJyxcbiAgICAgICAgICAgICAgICAnUXVldWVOYW1lJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgSW1hZ2U6ICd0ZXN0JyxcbiAgICAgIH0pLFxuICAgIF0sXG4gICAgRmFtaWx5OiAnZmFyZ2F0ZS10YXNrLWZhbWlseScsXG4gIH0pO1xufSk7XG5cbnRlc3QoJ2NhbiBzZXQgY3VzdG9tIGNvbnRhaW5lck5hbWUnLCAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICBjb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZQQycpO1xuICBjb25zdCBjbHVzdGVyID0gbmV3IGVjcy5DbHVzdGVyKHN0YWNrLCAnQ2x1c3RlcicsIHsgdnBjIH0pO1xuICBjbHVzdGVyLmFkZEFzZ0NhcGFjaXR5UHJvdmlkZXIobmV3IEFzZ0NhcGFjaXR5UHJvdmlkZXIoc3RhY2ssICdEZWZhdWx0QXV0b1NjYWxpbmdHcm91cFByb3ZpZGVyJywge1xuICAgIGF1dG9TY2FsaW5nR3JvdXA6IG5ldyBBdXRvU2NhbGluZ0dyb3VwKHN0YWNrLCAnRGVmYXVsdEF1dG9TY2FsaW5nR3JvdXAnLCB7XG4gICAgICB2cGMsXG4gICAgICBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCd0Mi5taWNybycpLFxuICAgICAgbWFjaGluZUltYWdlOiBNYWNoaW5lSW1hZ2UubGF0ZXN0QW1hem9uTGludXgoKSxcbiAgICB9KSxcbiAgfSkpO1xuXG4gIC8vIFdIRU5cbiAgbmV3IGVjc1BhdHRlcm5zLlF1ZXVlUHJvY2Vzc2luZ0ZhcmdhdGVTZXJ2aWNlKHN0YWNrLCAnU2VydmljZScsIHtcbiAgICBjbHVzdGVyLFxuICAgIGNvbnRhaW5lck5hbWU6ICdteS1jb250YWluZXInLFxuICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCd0ZXN0JyksXG4gIH0pO1xuXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkVDUzo6VGFza0RlZmluaXRpb24nLCB7XG4gICAgQ29udGFpbmVyRGVmaW5pdGlvbnM6IFtcbiAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICBOYW1lOiAnbXktY29udGFpbmVyJyxcbiAgICAgIH0pLFxuICAgIF0sXG4gIH0pO1xufSk7XG5cbnRlc3QoJ2NhbiBzZXQgY3VzdG9tIG5ldHdvcmtpbmcgb3B0aW9ucycsICgpID0+IHtcbiAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gIGNvbnN0IHZwYyA9IG5ldyBlYzIuVnBjKHN0YWNrLCAnVlBDJywge1xuICAgIHN1Ym5ldENvbmZpZ3VyYXRpb246IFtcbiAgICAgIHtcbiAgICAgICAgY2lkck1hc2s6IDI0LFxuICAgICAgICBuYW1lOiAnUHVibGljJyxcbiAgICAgICAgc3VibmV0VHlwZTogZWMyLlN1Ym5ldFR5cGUuUFVCTElDLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2lkck1hc2s6IDI0LFxuICAgICAgICBuYW1lOiAnSXNvbGF0ZWQnLFxuICAgICAgICBzdWJuZXRUeXBlOiBlYzIuU3VibmV0VHlwZS5QUklWQVRFX0lTT0xBVEVELFxuICAgICAgfSxcbiAgICBdLFxuICB9KTtcbiAgY29uc3Qgc2VjdXJpdHlHcm91cCA9IG5ldyBlYzIuU2VjdXJpdHlHcm91cChzdGFjaywgJ015Q3VzdG9tU0cnLCB7XG4gICAgdnBjLFxuICB9KTtcblxuICAvLyBXSEVOIC0gU2VjdXJpdHlHcm91cHMgYW5kIHRhc2tTdWJuZXRzIHNlbGVjdGlvbiBpcyBkZWZpbmVkXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgdnBjLFxuICAgIG1lbW9yeUxpbWl0TWlCOiA1MTIsXG4gICAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tUmVnaXN0cnkoJ3Rlc3QnKSxcbiAgICBzZWN1cml0eUdyb3VwczogW3NlY3VyaXR5R3JvdXBdLFxuICAgIHRhc2tTdWJuZXRzOiB7IHN1Ym5ldFR5cGU6IGVjMi5TdWJuZXRUeXBlLlBSSVZBVEVfSVNPTEFURUQgfSxcbiAgfSk7XG5cbiAgLy8gVEhFTiAtIE5ldHdvcmtDb25maWd1cmF0aW9uIGlzIGNyZWF0ZWQgd2l0aCB0aGUgc3BlY2lmaWMgc2VjdXJpdHkgZ3JvdXBzIGFuZCBzZWxlY3RlZCBzdWJuZXRzXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkVDUzo6U2VydmljZScsIHtcbiAgICBMYXVuY2hUeXBlOiAnRkFSR0FURScsXG4gICAgTmV0d29ya0NvbmZpZ3VyYXRpb246IHtcbiAgICAgIEF3c3ZwY0NvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgQXNzaWduUHVibGljSXA6ICdESVNBQkxFRCcsXG4gICAgICAgIFNlY3VyaXR5R3JvdXBzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICAgICAgICdNeUN1c3RvbVNHREUyN0M2NjEnLFxuICAgICAgICAgICAgICAnR3JvdXBJZCcsXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIFN1Ym5ldHM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBSZWY6ICdWUENJc29sYXRlZFN1Ym5ldDFTdWJuZXRFQkQwMEZDNicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBSZWY6ICdWUENJc29sYXRlZFN1Ym5ldDJTdWJuZXQ0QjFDOENBQScsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfSk7XG59KTtcblxudGVzdCgnY2FuIHNldCB1c2UgcHVibGljIElQJywgKCkgPT4ge1xuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgY29uc3QgdnBjID0gbmV3IGVjMi5WcGMoc3RhY2ssICdWUEMnKTtcblxuICAvLyBXSEVOIC0gQXNzaWduIFB1YmxpYyBJUCBpcyBzZXQgdG8gVHJ1ZVxuICBuZXcgZWNzUGF0dGVybnMuUXVldWVQcm9jZXNzaW5nRmFyZ2F0ZVNlcnZpY2Uoc3RhY2ssICdTZXJ2aWNlJywge1xuICAgIHZwYyxcbiAgICBtZW1vcnlMaW1pdE1pQjogNTEyLFxuICAgIGltYWdlOiBlY3MuQ29udGFpbmVySW1hZ2UuZnJvbVJlZ2lzdHJ5KCd0ZXN0JyksXG4gICAgYXNzaWduUHVibGljSXA6IHRydWUsXG4gIH0pO1xuXG4gIC8vIFRIRU4gLSBUaGUgU3VibmV0cyBkZWZhdWx0cyB0byBQdWJsaWMgYW5kIEFzc2lnblB1YmxpY0lwIHNldHRpbmdzIGNoYW5nZSB0byBFTkFCTEVEXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkVDUzo6U2VydmljZScsIHtcbiAgICBMYXVuY2hUeXBlOiAnRkFSR0FURScsXG4gICAgTmV0d29ya0NvbmZpZ3VyYXRpb246IHtcbiAgICAgIEF3c3ZwY0NvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgQXNzaWduUHVibGljSXA6ICdFTkFCTEVEJyxcbiAgICAgICAgU2VjdXJpdHlHcm91cHM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgJ1NlcnZpY2VRdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZVNlY3VyaXR5R3JvdXA2RTk4MTUxMicsXG4gICAgICAgICAgICAgICdHcm91cElkJyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgU3VibmV0czogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFJlZjogJ1ZQQ1B1YmxpY1N1Ym5ldDFTdWJuZXRCNDI0NkQzMCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBSZWY6ICdWUENQdWJsaWNTdWJuZXQyU3VibmV0NzQxNzlGMzknLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0sXG4gIH0pO1xufSk7XG5cbnRlc3QoJ2NhbiBzZXQgY2FwYWNpdHkgcHJvdmlkZXIgc3RyYXRlZ2llcycsICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gIGNvbnN0IHZwYyA9IG5ldyBlYzIuVnBjKHN0YWNrLCAnTXlWcGMnLCB7fSk7XG4gIGNvbnN0IGNsdXN0ZXIgPSBuZXcgZWNzLkNsdXN0ZXIoc3RhY2ssICdFY3NDbHVzdGVyJywge1xuICAgIHZwYyxcbiAgfSk7XG4gIGNsdXN0ZXIuZW5hYmxlRmFyZ2F0ZUNhcGFjaXR5UHJvdmlkZXJzKCk7XG5cbiAgLy8gV0hFTlxuICBuZXcgZWNzUGF0dGVybnMuUXVldWVQcm9jZXNzaW5nRmFyZ2F0ZVNlcnZpY2Uoc3RhY2ssICdTZXJ2aWNlJywge1xuICAgIGNsdXN0ZXIsXG4gICAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tUmVnaXN0cnkoJ3Rlc3QnKSxcbiAgICBjYXBhY2l0eVByb3ZpZGVyU3RyYXRlZ2llczogW1xuICAgICAge1xuICAgICAgICBjYXBhY2l0eVByb3ZpZGVyOiAnRkFSR0FURV9TUE9UJyxcbiAgICAgICAgd2VpZ2h0OiAyLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY2FwYWNpdHlQcm92aWRlcjogJ0ZBUkdBVEUnLFxuICAgICAgICB3ZWlnaHQ6IDEsXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xuXG4gIC8vIFRIRU5cbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RUNTOjpTZXJ2aWNlJywge1xuICAgIExhdW5jaFR5cGU6IE1hdGNoLmFic2VudCgpLFxuICAgIENhcGFjaXR5UHJvdmlkZXJTdHJhdGVneTogW1xuICAgICAge1xuICAgICAgICBDYXBhY2l0eVByb3ZpZGVyOiAnRkFSR0FURV9TUE9UJyxcbiAgICAgICAgV2VpZ2h0OiAyLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgQ2FwYWNpdHlQcm92aWRlcjogJ0ZBUkdBVEUnLFxuICAgICAgICBXZWlnaHQ6IDEsXG4gICAgICB9LFxuICAgIF0sXG4gIH0pO1xufSk7XG5cbml0KCdjYW4gc2V0IHF1ZXVlIHByb3BzIGJ5IHF1ZXVlIGNvbnN0cnVjdCcsICgpID0+IHtcbiAgLy8gR0lWRU5cbiAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gIGNvbnN0IHF1ZXVlID0gbmV3IFF1ZXVlKHN0YWNrLCAnUXVldWUnLCB7XG4gICAgcXVldWVOYW1lOiAnY3VzdG9tLXF1ZXVlJyxcbiAgICB2aXNpYmlsaXR5VGltZW91dDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMjAwKSxcbiAgICBkZWFkTGV0dGVyUXVldWU6IHtcbiAgICAgIHF1ZXVlOiBuZXcgUXVldWUoc3RhY2ssICdEZWFkTGV0dGVyUXVldWUnLCB7XG4gICAgICAgIHF1ZXVlTmFtZTogJ2N1c3RvbS1kZWFkLWxldHRlci1xdWV1ZScsXG4gICAgICAgIHJldGVudGlvblBlcmlvZDogY2RrLkR1cmF0aW9uLnNlY29uZHMoMTAwKSxcbiAgICAgIH0pLFxuICAgICAgbWF4UmVjZWl2ZUNvdW50OiAxMCxcbiAgICB9LFxuICB9KTtcblxuICAvLyBXSEVOXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tUmVnaXN0cnkoJ3Rlc3QnKSxcbiAgICBxdWV1ZTogcXVldWUsXG4gIH0pO1xuXG4gIC8vIFF1ZXVlXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlNRUzo6UXVldWUnLCB7XG4gICAgUXVldWVOYW1lOiAnY3VzdG9tLXF1ZXVlJyxcbiAgICBWaXNpYmlsaXR5VGltZW91dDogMjAwLFxuICAgIFJlZHJpdmVQb2xpY3k6IHtcbiAgICAgIG1heFJlY2VpdmVDb3VudDogMTAsXG4gICAgfSxcbiAgfSk7XG4gIC8vIERMUVxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpTUVM6OlF1ZXVlJywge1xuICAgIFF1ZXVlTmFtZTogJ2N1c3RvbS1kZWFkLWxldHRlci1xdWV1ZScsXG4gICAgTWVzc2FnZVJldGVudGlvblBlcmlvZDogMTAwLFxuICB9KTtcbn0pO1xuXG5pdCgnY2FuIHNldCBxdWV1ZSBwcm9wcyBieSBRdWV1ZVByb2Nlc3NpbmdTZXJ2aWNlQmFzZVByb3BzJywgKCkgPT4ge1xuICAvLyBHSVZFTlxuICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcblxuICAvLyBXSEVOXG4gIG5ldyBlY3NQYXR0ZXJucy5RdWV1ZVByb2Nlc3NpbmdGYXJnYXRlU2VydmljZShzdGFjaywgJ1NlcnZpY2UnLCB7XG4gICAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tUmVnaXN0cnkoJ3Rlc3QnKSxcbiAgICByZXRlbnRpb25QZXJpb2Q6IGNkay5EdXJhdGlvbi5zZWNvbmRzKDEwMCksXG4gICAgdmlzaWJpbGl0eVRpbWVvdXQ6IGNkay5EdXJhdGlvbi5zZWNvbmRzKDIwMCksXG4gICAgbWF4UmVjZWl2ZUNvdW50OiAxMCxcbiAgfSk7XG5cbiAgLy8gUXVldWVcbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6U1FTOjpRdWV1ZScsIHtcbiAgICBRdWV1ZU5hbWU6IE1hdGNoLmFic2VudCgpLFxuICAgIFZpc2liaWxpdHlUaW1lb3V0OiAyMDAsXG4gICAgUmVkcml2ZVBvbGljeToge1xuICAgICAgbWF4UmVjZWl2ZUNvdW50OiAxMCxcbiAgICB9LFxuICB9KTtcbiAgLy8gRExRXG4gIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlNRUzo6UXVldWUnLCB7XG4gICAgUXVldWVOYW1lOiBNYXRjaC5hYnNlbnQoKSxcbiAgICBNZXNzYWdlUmV0ZW50aW9uUGVyaW9kOiAxMDAsXG4gIH0pO1xufSk7XG5cbml0KCd0aHJvd3MgdmFsaWRhdGlvbiBlcnJvcnMgb2YgdGhlIHNwZWNpZmljIHF1ZXVlIHByb3AsIHdoZW4gc2V0dGluZyBxdWV1ZSBhbmQgcXVldWUgcmVsYXRlZCBwcm9wcyBhdCBzYW1lIHRpbWUnLCAoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICBjb25zdCBxdWV1ZSA9IG5ldyBRdWV1ZShzdGFjaywgJ1F1ZXVlJyk7XG5cbiAgLy8gU2V0dGluZyBhbGwgcmV0ZW50aW9uUGVyaW9kLCB2aXNpYmlsaXR5VGltZW91dCBhbmQgbWF4UmVjZWl2ZUNvdW50XG4gIGV4cGVjdCgoKSA9PiB7XG4gICAgbmV3IGVjc1BhdHRlcm5zLlF1ZXVlUHJvY2Vzc2luZ0ZhcmdhdGVTZXJ2aWNlKHN0YWNrLCAnU2VydmljZTEnLCB7XG4gICAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgndGVzdCcpLFxuICAgICAgcXVldWU6IHF1ZXVlLFxuICAgICAgcmV0ZW50aW9uUGVyaW9kOiBjZGsuRHVyYXRpb24uc2Vjb25kcygxMDApLFxuICAgICAgdmlzaWJpbGl0eVRpbWVvdXQ6IGNkay5EdXJhdGlvbi5zZWNvbmRzKDIwMCksXG4gICAgICBtYXhSZWNlaXZlQ291bnQ6IDEwLFxuICAgIH0pO1xuICB9KS50b1Rocm93KG5ldyBFcnJvcigncmV0ZW50aW9uUGVyaW9kLCB2aXNpYmlsaXR5VGltZW91dCwgbWF4UmVjZWl2ZUNvdW50IGNhbiBiZSBzZXQgb25seSB3aGVuIHF1ZXVlIGlzIG5vdCBzZXQuIFNwZWNpZnkgdGhlbSBpbiB0aGUgUXVldWVQcm9wcyBvZiB0aGUgcXVldWUnKSk7XG5cbiAgLy8gU2V0dGluZyBvbmx5IHZpc2liaWxpdHlUaW1lb3V0XG4gIGV4cGVjdCgoKSA9PiB7XG4gICAgbmV3IGVjc1BhdHRlcm5zLlF1ZXVlUHJvY2Vzc2luZ0ZhcmdhdGVTZXJ2aWNlKHN0YWNrLCAnU2VydmljZTInLCB7XG4gICAgICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgndGVzdCcpLFxuICAgICAgcXVldWU6IHF1ZXVlLFxuICAgICAgdmlzaWJpbGl0eVRpbWVvdXQ6IGNkay5EdXJhdGlvbi5zZWNvbmRzKDIwMCksXG4gICAgfSk7XG4gIH0pLnRvVGhyb3cobmV3IEVycm9yKCd2aXNpYmlsaXR5VGltZW91dCBjYW4gYmUgc2V0IG9ubHkgd2hlbiBxdWV1ZSBpcyBub3Qgc2V0LiBTcGVjaWZ5IHRoZW0gaW4gdGhlIFF1ZXVlUHJvcHMgb2YgdGhlIHF1ZXVlJykpO1xufSk7XG4iXX0=