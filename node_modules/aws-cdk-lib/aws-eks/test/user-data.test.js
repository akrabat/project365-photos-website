"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const autoscaling = require("../../aws-autoscaling");
const ec2 = require("../../aws-ec2");
const core_1 = require("../../core");
const cluster_1 = require("../lib/cluster");
const user_data_1 = require("../lib/user-data");
/* eslint-disable max-len */
describe('user data', () => {
    test('default user data', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg));
        // THEN
        expect(userData).toEqual([
            'set -o xtrace',
            {
                'Fn::Join': [
                    '',
                    [
                        '/etc/eks/bootstrap.sh ',
                        { Ref: 'clusterC5B25D0D' },
                        ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                        { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                        "' --b64-cluster-ca '",
                        {
                            'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                        },
                        "' --use-max-pods true",
                    ],
                ],
            },
            '/opt/aws/bin/cfn-signal --exit-code $? --stack my-stack --resource ASG46ED3070 --region us-west-33',
        ]);
    });
    test('imported cluster without clusterEndpoint', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        const importedCluster = cluster_1.Cluster.fromClusterAttributes(stack, 'ImportedCluster', {
            clusterName: cluster.clusterName,
            openIdConnectProvider: cluster.openIdConnectProvider,
            clusterCertificateAuthorityData: cluster.clusterCertificateAuthorityData,
        });
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(importedCluster, asg));
        // THEN
        expect(userData).toEqual([
            'set -o xtrace',
            {
                'Fn::Join': [
                    '',
                    [
                        '/etc/eks/bootstrap.sh ',
                        { Ref: 'clusterC5B25D0D' },
                        ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --use-max-pods true',
                    ],
                ],
            },
            '/opt/aws/bin/cfn-signal --exit-code $? --stack my-stack --resource ASG46ED3070 --region us-west-33',
        ]);
    });
    test('imported cluster without clusterCertificateAuthorityData', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        const importedCluster = cluster_1.Cluster.fromClusterAttributes(stack, 'ImportedCluster', {
            clusterName: cluster.clusterName,
            openIdConnectProvider: cluster.openIdConnectProvider,
            clusterEndpoint: cluster.clusterEndpoint,
        });
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(importedCluster, asg));
        // THEN
        expect(userData).toEqual([
            'set -o xtrace',
            {
                'Fn::Join': [
                    '',
                    [
                        '/etc/eks/bootstrap.sh ',
                        { Ref: 'clusterC5B25D0D' },
                        ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --use-max-pods true',
                    ],
                ],
            },
            '/opt/aws/bin/cfn-signal --exit-code $? --stack my-stack --resource ASG46ED3070 --region us-west-33',
        ]);
    });
    test('--use-max-pods=true', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            useMaxPods: true,
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true",
                ],
            ],
        });
    });
    test('--use-max-pods=false', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            useMaxPods: false,
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods false",
                ],
            ],
        });
    });
    test('--aws-api-retry-attempts', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            awsApiRetryAttempts: 123,
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true --aws-api-retry-attempts 123",
                ],
            ],
        });
    });
    test('--dns-cluster-ip', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            dnsClusterIp: '192.0.2.53',
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true --dns-cluster-ip 192.0.2.53",
                ],
            ],
        });
    });
    test('--docker-config-json', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            dockerConfigJson: '{"docker":123}',
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    '\' --use-max-pods true --docker-config-json \'{"docker":123}\'',
                ],
            ],
        });
    });
    test('--enable-docker-bridge=true', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            enableDockerBridge: true,
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true --enable-docker-bridge true",
                ],
            ],
        });
    });
    test('--enable-docker-bridge=false', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            enableDockerBridge: false,
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true",
                ],
            ],
        });
    });
    test('--kubelet-extra-args', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            kubeletExtraArgs: '--extra-args-for --kubelet',
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand  --extra-args-for --kubelet" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true",
                ],
            ],
        });
    });
    test('arbitrary additional bootstrap arguments can be passed through "additionalArgs"', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures();
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            additionalArgs: '--apiserver-endpoint 1111 --foo-bar',
        }));
        // THEN
        // NB: duplicated --apiserver-endpoint is fine.  Last wins.
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=OnDemand" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true --apiserver-endpoint 1111 --foo-bar",
                ],
            ],
        });
    });
    test('if asg has spot instances, the correct label and taint is used', () => {
        // GIVEN
        const { asg, stack, cluster } = newFixtures(true);
        // WHEN
        const userData = stack.resolve((0, user_data_1.renderAmazonLinuxUserData)(cluster, asg, {
            kubeletExtraArgs: '--node-labels X=y',
        }));
        // THEN
        expect(userData[1]).toEqual({
            'Fn::Join': [
                '',
                [
                    '/etc/eks/bootstrap.sh ',
                    { Ref: 'clusterC5B25D0D' },
                    ' --kubelet-extra-args "--node-labels lifecycle=Ec2Spot --register-with-taints=spotInstance=true:PreferNoSchedule --node-labels X=y" --apiserver-endpoint \'',
                    { 'Fn::GetAtt': ['clusterC5B25D0D', 'Endpoint'] },
                    "' --b64-cluster-ca '",
                    {
                        'Fn::GetAtt': ['clusterC5B25D0D', 'CertificateAuthorityData'],
                    },
                    "' --use-max-pods true",
                ],
            ],
        });
    });
});
function newFixtures(spot = false) {
    const app = new core_1.App();
    const stack = new core_1.Stack(app, 'my-stack', { env: { region: 'us-west-33' } });
    const vpc = new ec2.Vpc(stack, 'vpc');
    const cluster = new cluster_1.Cluster(stack, 'cluster', {
        version: cluster_1.KubernetesVersion.V1_21,
        clusterName: 'my-cluster-name',
        vpc,
    });
    const asg = new autoscaling.AutoScalingGroup(stack, 'ASG', {
        instanceType: new ec2.InstanceType('m4.xlarge'),
        machineImage: new ec2.AmazonLinuxImage(),
        spotPrice: spot ? '0.01' : undefined,
        vpc,
    });
    return { stack, vpc, cluster, asg };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlci1kYXRhLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ1c2VyLWRhdGEudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHFEQUFxRDtBQUNyRCxxQ0FBcUM7QUFDckMscUNBQXdDO0FBQ3hDLDRDQUE0RDtBQUM1RCxnREFBNkQ7QUFFN0QsNEJBQTRCO0FBRTVCLFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO0lBQ3pCLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFDN0IsUUFBUTtRQUNSLE1BQU0sRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxHQUFHLFdBQVcsRUFBRSxDQUFDO1FBRTlDLE9BQU87UUFDUCxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUEscUNBQXlCLEVBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFeEUsT0FBTztRQUNQLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxPQUFPLENBQUM7WUFDdkIsZUFBZTtZQUNmO2dCQUNFLFVBQVUsRUFBRTtvQkFDVixFQUFFO29CQUNGO3dCQUNFLHdCQUF3Qjt3QkFDeEIsRUFBRSxHQUFHLEVBQUUsaUJBQWlCLEVBQUU7d0JBQzFCLGtGQUFrRjt3QkFDbEYsRUFBRSxZQUFZLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSxVQUFVLENBQUMsRUFBRTt3QkFDakQsc0JBQXNCO3dCQUN0Qjs0QkFDRSxZQUFZLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSwwQkFBMEIsQ0FBQzt5QkFDOUQ7d0JBQ0QsdUJBQXVCO3FCQUN4QjtpQkFDRjthQUNGO1lBQ0Qsb0dBQW9HO1NBQ3JHLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDBDQUEwQyxFQUFFLEdBQUcsRUFBRTtRQUNwRCxRQUFRO1FBQ1IsTUFBTSxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLEdB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LEVBQUUsVUFBVSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM1RSxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ3RDLE1BQU0sT0FBTyxHQUFHLElBQUksaUJBQU8sQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFO1FBQzVDLE9BQU8sRUFBRSwyQkFBaUIsQ0FBQyxLQUFLO1FBQ2hDLFdBQVcsRUFBRSxpQkFBaUI7UUFDOUIsR0FBRztLQUNKLENBQUMsQ0FBQztJQUNILE1BQU0sR0FBRyxHQUFHLElBQUksV0FBVyxDQUFDLGdCQUFnQixDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUU7UUFDekQsWUFBWSxFQUFFLElBQUksR0FBRyxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUM7UUFDL0MsWUFBWSxFQUFFLElBQUksR0FBRyxDQUFDLGdCQUFnQixFQUFFO1FBQ3hDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsU0FBUztRQUNwQyxHQUFHO0tBQ0osQ0FBQyxDQUFDO0lBRUgsT0FBTyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDO0FBQ3RDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBhdXRvc2NhbGluZyBmcm9tICcuLi8uLi9hd3MtYXV0b3NjYWxpbmcnO1xuaW1wb3J0ICogYXMgZWMyIGZyb20gJy4uLy4uL2F3cy1lYzInO1xuaW1wb3J0IHsgQXBwLCBTdGFjayB9IGZyb20gJy4uLy4uL2NvcmUnO1xuaW1wb3J0IHsgQ2x1c3RlciwgS3ViZXJuZXRlc1ZlcnNpb24gfSBmcm9tICcuLi9saWIvY2x1c3Rlcic7XG5pbXBvcnQgeyByZW5kZXJBbWF6b25MaW51eFVzZXJEYXRhIH0gZnJvbSAnLi4vbGliL3VzZXItZGF0YSc7XG5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1sZW4gKi9cblxuZGVzY3JpYmUoJ3VzZXIgZGF0YScsICgpID0+IHtcbiAgdGVzdCgnZGVmYXVsdCB1c2VyIGRhdGEnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnKSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KHVzZXJEYXRhKS50b0VxdWFsKFtcbiAgICAgICdzZXQgLW8geHRyYWNlJyxcbiAgICAgIHtcbiAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICcnLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgICcvZXRjL2Vrcy9ib290c3RyYXAuc2ggJyxcbiAgICAgICAgICAgIHsgUmVmOiAnY2x1c3RlckM1QjI1RDBEJyB9LFxuICAgICAgICAgICAgJyAtLWt1YmVsZXQtZXh0cmEtYXJncyBcIi0tbm9kZS1sYWJlbHMgbGlmZWN5Y2xlPU9uRGVtYW5kXCIgLS1hcGlzZXJ2ZXItZW5kcG9pbnQgXFwnJyxcbiAgICAgICAgICAgIHsgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdFbmRwb2ludCddIH0sXG4gICAgICAgICAgICBcIicgLS1iNjQtY2x1c3Rlci1jYSAnXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnQ2VydGlmaWNhdGVBdXRob3JpdHlEYXRhJ10sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCInIC0tdXNlLW1heC1wb2RzIHRydWVcIixcbiAgICAgICAgICBdLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgICcvb3B0L2F3cy9iaW4vY2ZuLXNpZ25hbCAtLWV4aXQtY29kZSAkPyAtLXN0YWNrIG15LXN0YWNrIC0tcmVzb3VyY2UgQVNHNDZFRDMwNzAgLS1yZWdpb24gdXMtd2VzdC0zMycsXG4gICAgXSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2ltcG9ydGVkIGNsdXN0ZXIgd2l0aG91dCBjbHVzdGVyRW5kcG9pbnQnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICBjb25zdCBpbXBvcnRlZENsdXN0ZXIgPSBDbHVzdGVyLmZyb21DbHVzdGVyQXR0cmlidXRlcyhzdGFjaywgJ0ltcG9ydGVkQ2x1c3RlcicsIHtcbiAgICAgIGNsdXN0ZXJOYW1lOiBjbHVzdGVyLmNsdXN0ZXJOYW1lLFxuICAgICAgb3BlbklkQ29ubmVjdFByb3ZpZGVyOiBjbHVzdGVyLm9wZW5JZENvbm5lY3RQcm92aWRlcixcbiAgICAgIGNsdXN0ZXJDZXJ0aWZpY2F0ZUF1dGhvcml0eURhdGE6IGNsdXN0ZXIuY2x1c3RlckNlcnRpZmljYXRlQXV0aG9yaXR5RGF0YSxcbiAgICB9KTtcblxuICAgIC8vIFdIRU5cbiAgICBjb25zdCB1c2VyRGF0YSA9IHN0YWNrLnJlc29sdmUocmVuZGVyQW1hem9uTGludXhVc2VyRGF0YShpbXBvcnRlZENsdXN0ZXIsIGFzZykpO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdCh1c2VyRGF0YSkudG9FcXVhbChbXG4gICAgICAnc2V0IC1vIHh0cmFjZScsXG4gICAgICB7XG4gICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAnJyxcbiAgICAgICAgICBbXG4gICAgICAgICAgICAnL2V0Yy9la3MvYm9vdHN0cmFwLnNoICcsXG4gICAgICAgICAgICB7IFJlZjogJ2NsdXN0ZXJDNUIyNUQwRCcgfSxcbiAgICAgICAgICAgICcgLS1rdWJlbGV0LWV4dHJhLWFyZ3MgXCItLW5vZGUtbGFiZWxzIGxpZmVjeWNsZT1PbkRlbWFuZFwiIC0tdXNlLW1heC1wb2RzIHRydWUnLFxuICAgICAgICAgIF0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICAgJy9vcHQvYXdzL2Jpbi9jZm4tc2lnbmFsIC0tZXhpdC1jb2RlICQ/IC0tc3RhY2sgbXktc3RhY2sgLS1yZXNvdXJjZSBBU0c0NkVEMzA3MCAtLXJlZ2lvbiB1cy13ZXN0LTMzJyxcbiAgICBdKTtcbiAgfSk7XG5cbiAgdGVzdCgnaW1wb3J0ZWQgY2x1c3RlciB3aXRob3V0IGNsdXN0ZXJDZXJ0aWZpY2F0ZUF1dGhvcml0eURhdGEnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICBjb25zdCBpbXBvcnRlZENsdXN0ZXIgPSBDbHVzdGVyLmZyb21DbHVzdGVyQXR0cmlidXRlcyhzdGFjaywgJ0ltcG9ydGVkQ2x1c3RlcicsIHtcbiAgICAgIGNsdXN0ZXJOYW1lOiBjbHVzdGVyLmNsdXN0ZXJOYW1lLFxuICAgICAgb3BlbklkQ29ubmVjdFByb3ZpZGVyOiBjbHVzdGVyLm9wZW5JZENvbm5lY3RQcm92aWRlcixcbiAgICAgIGNsdXN0ZXJFbmRwb2ludDogY2x1c3Rlci5jbHVzdGVyRW5kcG9pbnQsXG4gICAgfSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoaW1wb3J0ZWRDbHVzdGVyLCBhc2cpKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QodXNlckRhdGEpLnRvRXF1YWwoW1xuICAgICAgJ3NldCAtbyB4dHJhY2UnLFxuICAgICAge1xuICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgJycsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgJy9ldGMvZWtzL2Jvb3RzdHJhcC5zaCAnLFxuICAgICAgICAgICAgeyBSZWY6ICdjbHVzdGVyQzVCMjVEMEQnIH0sXG4gICAgICAgICAgICAnIC0ta3ViZWxldC1leHRyYS1hcmdzIFwiLS1ub2RlLWxhYmVscyBsaWZlY3ljbGU9T25EZW1hbmRcIiAtLXVzZS1tYXgtcG9kcyB0cnVlJyxcbiAgICAgICAgICBdLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICAgICcvb3B0L2F3cy9iaW4vY2ZuLXNpZ25hbCAtLWV4aXQtY29kZSAkPyAtLXN0YWNrIG15LXN0YWNrIC0tcmVzb3VyY2UgQVNHNDZFRDMwNzAgLS1yZWdpb24gdXMtd2VzdC0zMycsXG4gICAgXSk7XG4gIH0pO1xuXG4gIHRlc3QoJy0tdXNlLW1heC1wb2RzPXRydWUnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICB1c2VNYXhQb2RzOiB0cnVlLFxuICAgIH0pKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoXG4gICAgICB1c2VyRGF0YVsxXSxcbiAgICApLnRvRXF1YWwoe1xuICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAnJyxcbiAgICAgICAgW1xuICAgICAgICAgICcvZXRjL2Vrcy9ib290c3RyYXAuc2ggJyxcbiAgICAgICAgICB7IFJlZjogJ2NsdXN0ZXJDNUIyNUQwRCcgfSxcbiAgICAgICAgICAnIC0ta3ViZWxldC1leHRyYS1hcmdzIFwiLS1ub2RlLWxhYmVscyBsaWZlY3ljbGU9T25EZW1hbmRcIiAtLWFwaXNlcnZlci1lbmRwb2ludCBcXCcnLFxuICAgICAgICAgIHsgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdFbmRwb2ludCddIH0sXG4gICAgICAgICAgXCInIC0tYjY0LWNsdXN0ZXItY2EgJ1wiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnQ2VydGlmaWNhdGVBdXRob3JpdHlEYXRhJ10sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIicgLS11c2UtbWF4LXBvZHMgdHJ1ZVwiLFxuICAgICAgICBdLFxuICAgICAgXSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnLS11c2UtbWF4LXBvZHM9ZmFsc2UnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICB1c2VNYXhQb2RzOiBmYWxzZSxcbiAgICB9KSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KFxuICAgICAgdXNlckRhdGFbMV0sXG4gICAgKS50b0VxdWFsKFxuICAgICAge1xuICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgJycsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgJy9ldGMvZWtzL2Jvb3RzdHJhcC5zaCAnLFxuICAgICAgICAgICAgeyBSZWY6ICdjbHVzdGVyQzVCMjVEMEQnIH0sXG4gICAgICAgICAgICAnIC0ta3ViZWxldC1leHRyYS1hcmdzIFwiLS1ub2RlLWxhYmVscyBsaWZlY3ljbGU9T25EZW1hbmRcIiAtLWFwaXNlcnZlci1lbmRwb2ludCBcXCcnLFxuICAgICAgICAgICAgeyAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0VuZHBvaW50J10gfSxcbiAgICAgICAgICAgIFwiJyAtLWI2NC1jbHVzdGVyLWNhICdcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdDZXJ0aWZpY2F0ZUF1dGhvcml0eURhdGEnXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcIicgLS11c2UtbWF4LXBvZHMgZmFsc2VcIixcbiAgICAgICAgICBdLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCctLWF3cy1hcGktcmV0cnktYXR0ZW1wdHMnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICBhd3NBcGlSZXRyeUF0dGVtcHRzOiAxMjMsXG4gICAgfSkpO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChcbiAgICAgIHVzZXJEYXRhWzFdLFxuICAgICkudG9FcXVhbChcbiAgICAgIHtcbiAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICcnLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgICcvZXRjL2Vrcy9ib290c3RyYXAuc2ggJyxcbiAgICAgICAgICAgIHsgUmVmOiAnY2x1c3RlckM1QjI1RDBEJyB9LFxuICAgICAgICAgICAgJyAtLWt1YmVsZXQtZXh0cmEtYXJncyBcIi0tbm9kZS1sYWJlbHMgbGlmZWN5Y2xlPU9uRGVtYW5kXCIgLS1hcGlzZXJ2ZXItZW5kcG9pbnQgXFwnJyxcbiAgICAgICAgICAgIHsgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdFbmRwb2ludCddIH0sXG4gICAgICAgICAgICBcIicgLS1iNjQtY2x1c3Rlci1jYSAnXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnQ2VydGlmaWNhdGVBdXRob3JpdHlEYXRhJ10sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCInIC0tdXNlLW1heC1wb2RzIHRydWUgLS1hd3MtYXBpLXJldHJ5LWF0dGVtcHRzIDEyM1wiLFxuICAgICAgICAgIF0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJy0tZG5zLWNsdXN0ZXItaXAnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICBkbnNDbHVzdGVySXA6ICcxOTIuMC4yLjUzJyxcbiAgICB9KSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KFxuICAgICAgdXNlckRhdGFbMV0sXG4gICAgKS50b0VxdWFsKFxuICAgICAge1xuICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgJycsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgJy9ldGMvZWtzL2Jvb3RzdHJhcC5zaCAnLFxuICAgICAgICAgICAgeyBSZWY6ICdjbHVzdGVyQzVCMjVEMEQnIH0sXG4gICAgICAgICAgICAnIC0ta3ViZWxldC1leHRyYS1hcmdzIFwiLS1ub2RlLWxhYmVscyBsaWZlY3ljbGU9T25EZW1hbmRcIiAtLWFwaXNlcnZlci1lbmRwb2ludCBcXCcnLFxuICAgICAgICAgICAgeyAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0VuZHBvaW50J10gfSxcbiAgICAgICAgICAgIFwiJyAtLWI2NC1jbHVzdGVyLWNhICdcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdDZXJ0aWZpY2F0ZUF1dGhvcml0eURhdGEnXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcIicgLS11c2UtbWF4LXBvZHMgdHJ1ZSAtLWRucy1jbHVzdGVyLWlwIDE5Mi4wLjIuNTNcIixcbiAgICAgICAgICBdLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCctLWRvY2tlci1jb25maWctanNvbicsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHsgYXNnLCBzdGFjaywgY2x1c3RlciB9ID0gbmV3Rml4dHVyZXMoKTtcblxuICAgIC8vIFdIRU5cbiAgICBjb25zdCB1c2VyRGF0YSA9IHN0YWNrLnJlc29sdmUocmVuZGVyQW1hem9uTGludXhVc2VyRGF0YShjbHVzdGVyLCBhc2csIHtcbiAgICAgIGRvY2tlckNvbmZpZ0pzb246ICd7XCJkb2NrZXJcIjoxMjN9JyxcbiAgICB9KSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KFxuICAgICAgdXNlckRhdGFbMV0sXG4gICAgKS50b0VxdWFsKFxuICAgICAge1xuICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgJycsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgJy9ldGMvZWtzL2Jvb3RzdHJhcC5zaCAnLFxuICAgICAgICAgICAgeyBSZWY6ICdjbHVzdGVyQzVCMjVEMEQnIH0sXG4gICAgICAgICAgICAnIC0ta3ViZWxldC1leHRyYS1hcmdzIFwiLS1ub2RlLWxhYmVscyBsaWZlY3ljbGU9T25EZW1hbmRcIiAtLWFwaXNlcnZlci1lbmRwb2ludCBcXCcnLFxuICAgICAgICAgICAgeyAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0VuZHBvaW50J10gfSxcbiAgICAgICAgICAgIFwiJyAtLWI2NC1jbHVzdGVyLWNhICdcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdDZXJ0aWZpY2F0ZUF1dGhvcml0eURhdGEnXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnXFwnIC0tdXNlLW1heC1wb2RzIHRydWUgLS1kb2NrZXItY29uZmlnLWpzb24gXFwne1wiZG9ja2VyXCI6MTIzfVxcJycsXG4gICAgICAgICAgXSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnLS1lbmFibGUtZG9ja2VyLWJyaWRnZT10cnVlJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3QgeyBhc2csIHN0YWNrLCBjbHVzdGVyIH0gPSBuZXdGaXh0dXJlcygpO1xuXG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHVzZXJEYXRhID0gc3RhY2sucmVzb2x2ZShyZW5kZXJBbWF6b25MaW51eFVzZXJEYXRhKGNsdXN0ZXIsIGFzZywge1xuICAgICAgZW5hYmxlRG9ja2VyQnJpZGdlOiB0cnVlLFxuICAgIH0pKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoXG4gICAgICB1c2VyRGF0YVsxXSxcbiAgICApLnRvRXF1YWwoXG4gICAgICB7XG4gICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAnJyxcbiAgICAgICAgICBbXG4gICAgICAgICAgICAnL2V0Yy9la3MvYm9vdHN0cmFwLnNoICcsXG4gICAgICAgICAgICB7IFJlZjogJ2NsdXN0ZXJDNUIyNUQwRCcgfSxcbiAgICAgICAgICAgICcgLS1rdWJlbGV0LWV4dHJhLWFyZ3MgXCItLW5vZGUtbGFiZWxzIGxpZmVjeWNsZT1PbkRlbWFuZFwiIC0tYXBpc2VydmVyLWVuZHBvaW50IFxcJycsXG4gICAgICAgICAgICB7ICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnRW5kcG9pbnQnXSB9LFxuICAgICAgICAgICAgXCInIC0tYjY0LWNsdXN0ZXItY2EgJ1wiLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0NlcnRpZmljYXRlQXV0aG9yaXR5RGF0YSddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiJyAtLXVzZS1tYXgtcG9kcyB0cnVlIC0tZW5hYmxlLWRvY2tlci1icmlkZ2UgdHJ1ZVwiLFxuICAgICAgICAgIF0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJy0tZW5hYmxlLWRvY2tlci1icmlkZ2U9ZmFsc2UnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICBlbmFibGVEb2NrZXJCcmlkZ2U6IGZhbHNlLFxuICAgIH0pKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoXG4gICAgICB1c2VyRGF0YVsxXSxcbiAgICApLnRvRXF1YWwoXG4gICAgICB7XG4gICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAnJyxcbiAgICAgICAgICBbXG4gICAgICAgICAgICAnL2V0Yy9la3MvYm9vdHN0cmFwLnNoICcsXG4gICAgICAgICAgICB7IFJlZjogJ2NsdXN0ZXJDNUIyNUQwRCcgfSxcbiAgICAgICAgICAgICcgLS1rdWJlbGV0LWV4dHJhLWFyZ3MgXCItLW5vZGUtbGFiZWxzIGxpZmVjeWNsZT1PbkRlbWFuZFwiIC0tYXBpc2VydmVyLWVuZHBvaW50IFxcJycsXG4gICAgICAgICAgICB7ICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnRW5kcG9pbnQnXSB9LFxuICAgICAgICAgICAgXCInIC0tYjY0LWNsdXN0ZXItY2EgJ1wiLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0NlcnRpZmljYXRlQXV0aG9yaXR5RGF0YSddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiJyAtLXVzZS1tYXgtcG9kcyB0cnVlXCIsXG4gICAgICAgICAgXSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnLS1rdWJlbGV0LWV4dHJhLWFyZ3MnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCB7IGFzZywgc3RhY2ssIGNsdXN0ZXIgfSA9IG5ld0ZpeHR1cmVzKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICBrdWJlbGV0RXh0cmFBcmdzOiAnLS1leHRyYS1hcmdzLWZvciAtLWt1YmVsZXQnLFxuICAgIH0pKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoXG4gICAgICB1c2VyRGF0YVsxXSxcbiAgICApLnRvRXF1YWwoXG4gICAgICB7XG4gICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAnJyxcbiAgICAgICAgICBbXG4gICAgICAgICAgICAnL2V0Yy9la3MvYm9vdHN0cmFwLnNoICcsXG4gICAgICAgICAgICB7IFJlZjogJ2NsdXN0ZXJDNUIyNUQwRCcgfSxcbiAgICAgICAgICAgICcgLS1rdWJlbGV0LWV4dHJhLWFyZ3MgXCItLW5vZGUtbGFiZWxzIGxpZmVjeWNsZT1PbkRlbWFuZCAgLS1leHRyYS1hcmdzLWZvciAtLWt1YmVsZXRcIiAtLWFwaXNlcnZlci1lbmRwb2ludCBcXCcnLFxuICAgICAgICAgICAgeyAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0VuZHBvaW50J10gfSxcbiAgICAgICAgICAgIFwiJyAtLWI2NC1jbHVzdGVyLWNhICdcIixcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdDZXJ0aWZpY2F0ZUF1dGhvcml0eURhdGEnXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcIicgLS11c2UtbWF4LXBvZHMgdHJ1ZVwiLFxuICAgICAgICAgIF0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FyYml0cmFyeSBhZGRpdGlvbmFsIGJvb3RzdHJhcCBhcmd1bWVudHMgY2FuIGJlIHBhc3NlZCB0aHJvdWdoIFwiYWRkaXRpb25hbEFyZ3NcIicsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHsgYXNnLCBzdGFjaywgY2x1c3RlciB9ID0gbmV3Rml4dHVyZXMoKTtcblxuICAgIC8vIFdIRU5cbiAgICBjb25zdCB1c2VyRGF0YSA9IHN0YWNrLnJlc29sdmUocmVuZGVyQW1hem9uTGludXhVc2VyRGF0YShjbHVzdGVyLCBhc2csIHtcbiAgICAgIGFkZGl0aW9uYWxBcmdzOiAnLS1hcGlzZXJ2ZXItZW5kcG9pbnQgMTExMSAtLWZvby1iYXInLFxuICAgIH0pKTtcblxuICAgIC8vIFRIRU5cbiAgICAvLyBOQjogZHVwbGljYXRlZCAtLWFwaXNlcnZlci1lbmRwb2ludCBpcyBmaW5lLiAgTGFzdCB3aW5zLlxuICAgIGV4cGVjdChcbiAgICAgIHVzZXJEYXRhWzFdLFxuICAgICkudG9FcXVhbChcbiAgICAgIHtcbiAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICcnLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgICcvZXRjL2Vrcy9ib290c3RyYXAuc2ggJyxcbiAgICAgICAgICAgIHsgUmVmOiAnY2x1c3RlckM1QjI1RDBEJyB9LFxuICAgICAgICAgICAgJyAtLWt1YmVsZXQtZXh0cmEtYXJncyBcIi0tbm9kZS1sYWJlbHMgbGlmZWN5Y2xlPU9uRGVtYW5kXCIgLS1hcGlzZXJ2ZXItZW5kcG9pbnQgXFwnJyxcbiAgICAgICAgICAgIHsgJ0ZuOjpHZXRBdHQnOiBbJ2NsdXN0ZXJDNUIyNUQwRCcsICdFbmRwb2ludCddIH0sXG4gICAgICAgICAgICBcIicgLS1iNjQtY2x1c3Rlci1jYSAnXCIsXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnQ2VydGlmaWNhdGVBdXRob3JpdHlEYXRhJ10sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCInIC0tdXNlLW1heC1wb2RzIHRydWUgLS1hcGlzZXJ2ZXItZW5kcG9pbnQgMTExMSAtLWZvby1iYXJcIixcbiAgICAgICAgICBdLFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdpZiBhc2cgaGFzIHNwb3QgaW5zdGFuY2VzLCB0aGUgY29ycmVjdCBsYWJlbCBhbmQgdGFpbnQgaXMgdXNlZCcsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHsgYXNnLCBzdGFjaywgY2x1c3RlciB9ID0gbmV3Rml4dHVyZXModHJ1ZSk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdXNlckRhdGEgPSBzdGFjay5yZXNvbHZlKHJlbmRlckFtYXpvbkxpbnV4VXNlckRhdGEoY2x1c3RlciwgYXNnLCB7XG4gICAgICBrdWJlbGV0RXh0cmFBcmdzOiAnLS1ub2RlLWxhYmVscyBYPXknLFxuICAgIH0pKTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3QoXG4gICAgICB1c2VyRGF0YVsxXSxcbiAgICApLnRvRXF1YWwoXG4gICAgICB7XG4gICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAnJyxcbiAgICAgICAgICBbXG4gICAgICAgICAgICAnL2V0Yy9la3MvYm9vdHN0cmFwLnNoICcsXG4gICAgICAgICAgICB7IFJlZjogJ2NsdXN0ZXJDNUIyNUQwRCcgfSxcbiAgICAgICAgICAgICcgLS1rdWJlbGV0LWV4dHJhLWFyZ3MgXCItLW5vZGUtbGFiZWxzIGxpZmVjeWNsZT1FYzJTcG90IC0tcmVnaXN0ZXItd2l0aC10YWludHM9c3BvdEluc3RhbmNlPXRydWU6UHJlZmVyTm9TY2hlZHVsZSAtLW5vZGUtbGFiZWxzIFg9eVwiIC0tYXBpc2VydmVyLWVuZHBvaW50IFxcJycsXG4gICAgICAgICAgICB7ICdGbjo6R2V0QXR0JzogWydjbHVzdGVyQzVCMjVEMEQnLCAnRW5kcG9pbnQnXSB9LFxuICAgICAgICAgICAgXCInIC0tYjY0LWNsdXN0ZXItY2EgJ1wiLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFsnY2x1c3RlckM1QjI1RDBEJywgJ0NlcnRpZmljYXRlQXV0aG9yaXR5RGF0YSddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiJyAtLXVzZS1tYXgtcG9kcyB0cnVlXCIsXG4gICAgICAgICAgXSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgKTtcbiAgfSk7XG59KTtcblxuZnVuY3Rpb24gbmV3Rml4dHVyZXMoc3BvdCA9IGZhbHNlKSB7XG4gIGNvbnN0IGFwcCA9IG5ldyBBcHAoKTtcbiAgY29uc3Qgc3RhY2sgPSBuZXcgU3RhY2soYXBwLCAnbXktc3RhY2snLCB7IGVudjogeyByZWdpb246ICd1cy13ZXN0LTMzJyB9IH0pO1xuICBjb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ3ZwYycpO1xuICBjb25zdCBjbHVzdGVyID0gbmV3IENsdXN0ZXIoc3RhY2ssICdjbHVzdGVyJywge1xuICAgIHZlcnNpb246IEt1YmVybmV0ZXNWZXJzaW9uLlYxXzIxLFxuICAgIGNsdXN0ZXJOYW1lOiAnbXktY2x1c3Rlci1uYW1lJyxcbiAgICB2cGMsXG4gIH0pO1xuICBjb25zdCBhc2cgPSBuZXcgYXV0b3NjYWxpbmcuQXV0b1NjYWxpbmdHcm91cChzdGFjaywgJ0FTRycsIHtcbiAgICBpbnN0YW5jZVR5cGU6IG5ldyBlYzIuSW5zdGFuY2VUeXBlKCdtNC54bGFyZ2UnKSxcbiAgICBtYWNoaW5lSW1hZ2U6IG5ldyBlYzIuQW1hem9uTGludXhJbWFnZSgpLFxuICAgIHNwb3RQcmljZTogc3BvdCA/ICcwLjAxJyA6IHVuZGVmaW5lZCxcbiAgICB2cGMsXG4gIH0pO1xuXG4gIHJldHVybiB7IHN0YWNrLCB2cGMsIGNsdXN0ZXIsIGFzZyB9O1xufVxuIl19