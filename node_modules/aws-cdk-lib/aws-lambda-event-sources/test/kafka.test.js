"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../assertions");
const aws_ec2_1 = require("../../aws-ec2");
const lambda = require("../../aws-lambda");
const aws_secretsmanager_1 = require("../../aws-secretsmanager");
const cdk = require("../../core");
const test_function_1 = require("./test-function");
const sources = require("../lib");
describe('KafkaEventSource', () => {
    describe('msk', () => {
        test('default', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const clusterArn = 'some-arn';
            const kafkaTopic = 'some-topic';
            // WHEN
            fn.addEventSource(new sources.ManagedKafkaEventSource({
                clusterArn,
                topic: kafkaTopic,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
            }));
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
                PolicyDocument: {
                    Statement: [
                        {
                            Action: [
                                'kafka:DescribeCluster',
                                'kafka:GetBootstrapBrokers',
                                'kafka:ListScramSecrets',
                            ],
                            Effect: 'Allow',
                            Resource: clusterArn,
                        },
                    ],
                    Version: '2012-10-17',
                },
                PolicyName: 'FnServiceRoleDefaultPolicyC6A839BF',
                Roles: [
                    {
                        Ref: 'FnServiceRoleB9001A96',
                    },
                ],
            });
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                EventSourceArn: clusterArn,
                FunctionName: {
                    Ref: 'Fn9270CBC0',
                },
                BatchSize: 100,
                StartingPosition: 'TRIM_HORIZON',
                Topics: [
                    kafkaTopic,
                ],
            });
        });
        test('with secret', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const clusterArn = 'some-arn';
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            // WHEN
            fn.addEventSource(new sources.ManagedKafkaEventSource({
                clusterArn,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
            }));
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
                PolicyDocument: {
                    Statement: [
                        {
                            Action: [
                                'secretsmanager:GetSecretValue',
                                'secretsmanager:DescribeSecret',
                            ],
                            Effect: 'Allow',
                            Resource: {
                                Ref: 'SecretA720EF05',
                            },
                        },
                        {
                            Action: [
                                'kafka:DescribeCluster',
                                'kafka:GetBootstrapBrokers',
                                'kafka:ListScramSecrets',
                            ],
                            Effect: 'Allow',
                            Resource: clusterArn,
                        },
                    ],
                    Version: '2012-10-17',
                },
                PolicyName: 'FnServiceRoleDefaultPolicyC6A839BF',
                Roles: [
                    {
                        Ref: 'FnServiceRoleB9001A96',
                    },
                ],
            });
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                EventSourceArn: clusterArn,
                FunctionName: {
                    Ref: 'Fn9270CBC0',
                },
                BatchSize: 100,
                StartingPosition: 'TRIM_HORIZON',
                Topics: [
                    kafkaTopic,
                ],
                SourceAccessConfigurations: [
                    {
                        Type: 'SASL_SCRAM_512_AUTH',
                        URI: {
                            Ref: 'SecretA720EF05',
                        },
                    },
                ],
            });
        });
    });
    describe('self-managed kafka', () => {
        test('default', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            const bootstrapServers = ['kafka-broker:9092'];
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
            }));
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
                PolicyDocument: {
                    Statement: [
                        {
                            Action: [
                                'secretsmanager:GetSecretValue',
                                'secretsmanager:DescribeSecret',
                            ],
                            Effect: 'Allow',
                            Resource: {
                                Ref: 'SecretA720EF05',
                            },
                        },
                    ],
                    Version: '2012-10-17',
                },
                PolicyName: 'FnServiceRoleDefaultPolicyC6A839BF',
                Roles: [
                    {
                        Ref: 'FnServiceRoleB9001A96',
                    },
                ],
            });
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                FunctionName: {
                    Ref: 'Fn9270CBC0',
                },
                BatchSize: 100,
                SelfManagedEventSource: {
                    Endpoints: {
                        KafkaBootstrapServers: bootstrapServers,
                    },
                },
                StartingPosition: 'TRIM_HORIZON',
                Topics: [
                    kafkaTopic,
                ],
                SourceAccessConfigurations: [
                    {
                        Type: 'SASL_SCRAM_512_AUTH',
                        URI: {
                            Ref: 'SecretA720EF05',
                        },
                    },
                ],
            });
        });
        test('without vpc, secret must be set', () => {
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const bootstrapServers = ['kafka-broker:9092'];
            expect(() => {
                fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                    bootstrapServers: bootstrapServers,
                    topic: kafkaTopic,
                    startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                }));
            }).toThrow(/secret must be set/);
        });
        describe('vpc', () => {
            test('correctly rendered in the stack', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const fn = new test_function_1.TestFunction(stack, 'Fn');
                const kafkaTopic = 'some-topic';
                const bootstrapServers = ['kafka-broker:9092'];
                const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
                const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
                // WHEN
                fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                    bootstrapServers: bootstrapServers,
                    topic: kafkaTopic,
                    startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                    vpc: vpc,
                    vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                    securityGroup: sg,
                }));
                // THEN
                assertions_1.Template.fromStack(stack).resourceCountIs('AWS::IAM::Policy', 0);
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                    FunctionName: {
                        Ref: 'Fn9270CBC0',
                    },
                    BatchSize: 100,
                    SelfManagedEventSource: {
                        Endpoints: {
                            KafkaBootstrapServers: bootstrapServers,
                        },
                    },
                    StartingPosition: 'TRIM_HORIZON',
                    Topics: [
                        kafkaTopic,
                    ],
                    SourceAccessConfigurations: [
                        {
                            Type: 'VPC_SECURITY_GROUP',
                            URI: 'sg-0123456789',
                        },
                        {
                            Type: 'VPC_SUBNET',
                            URI: {
                                Ref: 'VpcPrivateSubnet1Subnet536B997A',
                            },
                        },
                        {
                            Type: 'VPC_SUBNET',
                            URI: {
                                Ref: 'VpcPrivateSubnet2Subnet3788AAA1',
                            },
                        },
                    ],
                });
            });
            test('with secret', () => {
                // GIVEN
                const stack = new cdk.Stack();
                const fn = new test_function_1.TestFunction(stack, 'Fn');
                const kafkaTopic = 'some-topic';
                const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
                const bootstrapServers = ['kafka-broker:9092'];
                const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
                const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
                // WHEN
                fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                    bootstrapServers: bootstrapServers,
                    topic: kafkaTopic,
                    secret: secret,
                    startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                    vpc: vpc,
                    vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                    securityGroup: sg,
                }));
                // THEN
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
                    PolicyDocument: {
                        Statement: [
                            {
                                Action: [
                                    'secretsmanager:GetSecretValue',
                                    'secretsmanager:DescribeSecret',
                                ],
                                Effect: 'Allow',
                                Resource: {
                                    Ref: 'SecretA720EF05',
                                },
                            },
                        ],
                        Version: '2012-10-17',
                    },
                    PolicyName: 'FnServiceRoleDefaultPolicyC6A839BF',
                    Roles: [
                        {
                            Ref: 'FnServiceRoleB9001A96',
                        },
                    ],
                });
                assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                    FunctionName: {
                        Ref: 'Fn9270CBC0',
                    },
                    BatchSize: 100,
                    SelfManagedEventSource: {
                        Endpoints: {
                            KafkaBootstrapServers: bootstrapServers,
                        },
                    },
                    StartingPosition: 'TRIM_HORIZON',
                    Topics: [
                        kafkaTopic,
                    ],
                    SourceAccessConfigurations: [
                        {
                            Type: 'SASL_SCRAM_512_AUTH',
                            URI: {
                                Ref: 'SecretA720EF05',
                            },
                        },
                        {
                            Type: 'VPC_SECURITY_GROUP',
                            URI: 'sg-0123456789',
                        },
                        {
                            Type: 'VPC_SUBNET',
                            URI: {
                                Ref: 'VpcPrivateSubnet1Subnet536B997A',
                            },
                        },
                        {
                            Type: 'VPC_SUBNET',
                            URI: {
                                Ref: 'VpcPrivateSubnet2Subnet3788AAA1',
                            },
                        },
                    ],
                });
            });
            test('setting vpc requires vpcSubnets to be set', () => {
                const stack = new cdk.Stack();
                const fn = new test_function_1.TestFunction(stack, 'Fn');
                const kafkaTopic = 'some-topic';
                const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
                const bootstrapServers = ['kafka-broker:9092'];
                const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
                expect(() => {
                    fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                        bootstrapServers: bootstrapServers,
                        topic: kafkaTopic,
                        secret: secret,
                        startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                        vpc: vpc,
                        securityGroup: aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789'),
                    }));
                }).toThrow(/vpcSubnets must be set/);
            });
            test('setting vpc requires securityGroup to be set', () => {
                const stack = new cdk.Stack();
                const fn = new test_function_1.TestFunction(stack, 'Fn');
                const kafkaTopic = 'some-topic';
                const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
                const bootstrapServers = ['kafka-broker:9092'];
                const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
                expect(() => {
                    fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                        bootstrapServers: bootstrapServers,
                        topic: kafkaTopic,
                        secret: secret,
                        startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                        vpc: vpc,
                        vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                    }));
                }).toThrow(/securityGroup must be set/);
            });
        });
        test('using SCRAM-SHA-256', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            const bootstrapServers = ['kafka-broker:9092'];
            const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
            const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                vpc: vpc,
                vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                securityGroup: sg,
                authenticationMethod: sources.AuthenticationMethod.SASL_SCRAM_256_AUTH,
            }));
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SourceAccessConfigurations: assertions_1.Match.arrayWith([
                    {
                        Type: 'SASL_SCRAM_256_AUTH',
                        URI: {
                            Ref: 'SecretA720EF05',
                        },
                    },
                ]),
            });
        });
        test('using BASIC_AUTH', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            const bootstrapServers = ['kafka-broker:9092'];
            const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
            const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                vpc: vpc,
                vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                securityGroup: sg,
                authenticationMethod: sources.AuthenticationMethod.BASIC_AUTH,
            }));
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SourceAccessConfigurations: assertions_1.Match.arrayWith([
                    {
                        Type: 'BASIC_AUTH',
                        URI: {
                            Ref: 'SecretA720EF05',
                        },
                    },
                ]),
            });
        });
        test('using CLIENT_CERTIFICATE_TLS_AUTH', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            const bootstrapServers = ['kafka-broker:9092'];
            const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
            const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                vpc: vpc,
                vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                securityGroup: sg,
                authenticationMethod: sources.AuthenticationMethod.CLIENT_CERTIFICATE_TLS_AUTH,
            }));
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SourceAccessConfigurations: assertions_1.Match.arrayWith([
                    {
                        Type: 'CLIENT_CERTIFICATE_TLS_AUTH',
                        URI: {
                            Ref: 'SecretA720EF05',
                        },
                    },
                ]),
            });
        });
        test('using CLIENT_CERTIFICATE_TLS_AUTH with rootCA', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            const rootCACertificate = new aws_secretsmanager_1.Secret(stack, 'RootCASecret', { secretName: 'AmazonMSK_KafkaSecret_Root_CA' });
            const bootstrapServers = ['kafka-broker:9092'];
            const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
            const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                vpc: vpc,
                vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                securityGroup: sg,
                authenticationMethod: sources.AuthenticationMethod.CLIENT_CERTIFICATE_TLS_AUTH,
                rootCACertificate: rootCACertificate,
            }));
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SourceAccessConfigurations: assertions_1.Match.arrayWith([
                    {
                        Type: 'CLIENT_CERTIFICATE_TLS_AUTH',
                        URI: {
                            Ref: 'SecretA720EF05',
                        },
                    },
                    {
                        Type: 'SERVER_ROOT_CA_CERTIFICATE',
                        URI: {
                            Ref: 'RootCASecret21632BB9',
                        },
                    },
                ]),
            });
        });
        test('with rootCA', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const rootCACertificate = new aws_secretsmanager_1.Secret(stack, 'RootCASecret', { secretName: 'AmazonMSK_KafkaSecret_Root_CA' });
            const bootstrapServers = ['kafka-broker:9092'];
            const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
            const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                vpc: vpc,
                vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                securityGroup: sg,
                rootCACertificate: rootCACertificate,
            }));
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SourceAccessConfigurations: assertions_1.Match.arrayWith([
                    {
                        Type: 'SERVER_ROOT_CA_CERTIFICATE',
                        URI: {
                            Ref: 'RootCASecret21632BB9',
                        },
                    },
                ]),
            });
        });
        test('rootCACertificate can be ISecret', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const mockRootCACertificateSecretArn = 'arn:aws:secretsmanager:us-east-1:012345678901:secret:mock';
            const rootCACertificate = aws_secretsmanager_1.Secret.fromSecretPartialArn(stack, 'RootCASecret', mockRootCACertificateSecretArn);
            const bootstrapServers = ['kafka-broker:9092'];
            const sg = aws_ec2_1.SecurityGroup.fromSecurityGroupId(stack, 'SecurityGroup', 'sg-0123456789');
            const vpc = new aws_ec2_1.Vpc(stack, 'Vpc');
            // WHEN
            fn.addEventSource(new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                vpc: vpc,
                vpcSubnets: { subnetType: aws_ec2_1.SubnetType.PRIVATE_WITH_EGRESS },
                securityGroup: sg,
                rootCACertificate: rootCACertificate,
            }));
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SourceAccessConfigurations: assertions_1.Match.arrayWith([
                    {
                        Type: 'SERVER_ROOT_CA_CERTIFICATE',
                        URI: mockRootCACertificateSecretArn,
                    },
                ]),
            });
        });
        test('consumerGroupId can be set for SelfManagedKafkaEventSource', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const kafkaTopic = 'some-topic';
            const secret = new aws_secretsmanager_1.Secret(stack, 'Secret', { secretName: 'AmazonMSK_KafkaSecret' });
            const bootstrapServers = ['kafka-broker:9092'];
            const consumerGroupId = 'my-consumer-group-id';
            const eventSourceMapping = new sources.SelfManagedKafkaEventSource({
                bootstrapServers: bootstrapServers,
                topic: kafkaTopic,
                secret: secret,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                consumerGroupId: consumerGroupId,
            });
            // WHEN
            fn.addEventSource(eventSourceMapping);
            // THEN
            const template = assertions_1.Template.fromStack(stack);
            template.hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                SelfManagedKafkaEventSourceConfig: { ConsumerGroupId: consumerGroupId },
            });
        });
        test('consumerGroupId can be set for ManagedKafkaEventSource', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const clusterArn = 'some-arn';
            const kafkaTopic = 'some-topic';
            const consumerGroupId = 'my-consumer-group-id';
            const mskEventMapping = new sources.ManagedKafkaEventSource({
                clusterArn,
                topic: kafkaTopic,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
                consumerGroupId,
            });
            // WHEN
            fn.addEventSource(mskEventMapping);
            expect(mskEventMapping.eventSourceMappingId).toBeDefined();
            const template = assertions_1.Template.fromStack(stack);
            template.hasResourceProperties('AWS::Lambda::EventSourceMapping', {
                AmazonManagedKafkaEventSourceConfig: { ConsumerGroupId: consumerGroupId },
            });
        });
        test('ManagedKafkaEventSource name conforms to construct id rules', () => {
            // GIVEN
            const stack = new cdk.Stack();
            const fn = new test_function_1.TestFunction(stack, 'Fn');
            const clusterArn = 'some-arn';
            const kafkaTopic = 'some-topic';
            const mskEventMapping = new sources.ManagedKafkaEventSource({
                clusterArn,
                topic: kafkaTopic,
                startingPosition: lambda.StartingPosition.TRIM_HORIZON,
            });
            // WHEN
            fn.addEventSource(mskEventMapping);
            expect(mskEventMapping.eventSourceMappingId).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2Fma2EudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImthZmthLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBbUQ7QUFDbkQsMkNBQStEO0FBQy9ELDJDQUEyQztBQUMzQyxpRUFBa0Q7QUFDbEQsa0NBQWtDO0FBQ2xDLG1EQUErQztBQUMvQyxrQ0FBa0M7QUFFbEMsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxRQUFRLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRTtRQUNuQixJQUFJLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtZQUNuQixRQUFRO1lBQ1IsTUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDOUIsTUFBTSxFQUFFLEdBQUcsSUFBSSw0QkFBWSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztZQUN6QyxNQUFNLFVBQVUsR0FBRyxVQUFVLENBQUM7WUFDOUIsTUFBTSxVQUFVLEdBQUcsWUFBWSxDQUFDO1lBRWhDLE9BQU87WUFDUCxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksT0FBTyxDQUFDLHVCQUF1QixDQUNuRDtnQkFDRSxVQUFVO2dCQUNWLEtBQUssRUFBRSxVQUFVO2dCQUNqQixnQkFBZ0IsRUFBRSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsWUFBWTthQUN2RCxDQUFDLENBQUMsQ0FBQztZQUVOLE9BQU87WUFDUCxxQkFBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxrQkFBa0IsRUFBRTtnQkFDbEUsY0FBYyxFQUFFO29CQUNkLFNBQVMsRUFBRTt3QkFDVDs0QkFDRSxNQUFNLEVBQUU7Z0NBQ04sdUJBQXVCO2dDQUN2QiwyQkFBMkI7Z0NBQzNCLHdCQUF3Qjs2QkFDekI7NEJBQ0QsTUFBTSxFQUFFLE9BQU87NEJBQ2YsUUFBUSxFQUFFLFVBQVU7eUJBQ3JCO3FCQUNGO29CQUNELE9BQU8sRUFB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SUFBSSw0QkFBWSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztZQUN6QyxNQUFNLFVBQVUsR0FBRyxVQUFVLENBQUM7WUFDOUIsTUFBTSxVQUFVLEdBQUcsWUFBWSxDQUFDO1lBRWhDLE1BQU0sZUFBZSxHQUFHLElBQUksT0FBTyxDQUFDLHVCQUF1QixDQUN6RDtnQkFDRSxVQUFVO2dCQUNWLEtBQUssRUFBRSxVQUFVO2dCQUNqQixnQkFBZ0IsRUFBRSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsWUFBWTthQUN2RCxDQUFDLENBQUM7WUFFTCxPQUFPO1lBQ1AsRUFBRSxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsZUFBZSxDQUFDLG9CQUFvQixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDN0QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVGVtcGxhdGUsIE1hdGNoIH0gZnJvbSAnLi4vLi4vYXNzZXJ0aW9ucyc7XG5pbXBvcnQgeyBTZWN1cml0eUdyb3VwLCBTdWJuZXRUeXBlLCBWcGMgfSBmcm9tICcuLi8uLi9hd3MtZWMyJztcbmltcG9ydCAqIGFzIGxhbWJkYSBmcm9tICcuLi8uLi9hd3MtbGFtYmRhJztcbmltcG9ydCB7IFNlY3JldCB9IGZyb20gJy4uLy4uL2F3cy1zZWNyZXRzbWFuYWdlcic7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnLi4vLi4vY29yZSc7XG5pbXBvcnQgeyBUZXN0RnVuY3Rpb24gfSBmcm9tICcuL3Rlc3QtZnVuY3Rpb24nO1xuaW1wb3J0ICogYXMgc291cmNlcyBmcm9tICcuLi9saWInO1xuXG5kZXNjcmliZSgnS2Fma2FFdmVudFNvdXJjZScsICgpID0+IHtcbiAgZGVzY3JpYmUoJ21zaycsICgpID0+IHtcbiAgICB0ZXN0KCdkZWZhdWx0JywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGNsdXN0ZXJBcm4gPSAnc29tZS1hcm4nO1xuICAgICAgY29uc3Qga2Fma2FUb3BpYyA9ICdzb21lLXRvcGljJztcblxuICAgICAgLy8gV0hFTlxuICAgICAgZm4uYWRkRXZlbnRTb3VyY2UobmV3IHNvdXJjZXMuTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgIHtcbiAgICAgICAgICBjbHVzdGVyQXJuLFxuICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgfSkpO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICAgICAgUG9saWN5RG9jdW1lbnQ6IHtcbiAgICAgICAgICBTdGF0ZW1lbnQ6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgQWN0aW9uOiBbXG4gICAgICAgICAgICAgICAgJ2thZmthOkRlc2NyaWJlQ2x1c3RlcicsXG4gICAgICAgICAgICAgICAgJ2thZmthOkdldEJvb3RzdHJhcEJyb2tlcnMnLFxuICAgICAgICAgICAgICAgICdrYWZrYTpMaXN0U2NyYW1TZWNyZXRzJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgICBSZXNvdXJjZTogY2x1c3RlckFybixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgICBWZXJzaW9uOiAnMjAxMi0xMC0xNycsXG4gICAgICAgIH0sXG4gICAgICAgIFBvbGljeU5hbWU6ICdGblNlcnZpY2VSb2xlRGVmYXVsdFBvbGljeUM2QTgzOUJGJyxcbiAgICAgICAgUm9sZXM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBSZWY6ICdGblNlcnZpY2VSb2xlQjkwMDFBOTYnLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9KTtcblxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpFdmVudFNvdXJjZU1hcHBpbmcnLCB7XG4gICAgICAgIEV2ZW50U291cmNlQXJuOiBjbHVzdGVyQXJuLFxuICAgICAgICBGdW5jdGlvbk5hbWU6IHtcbiAgICAgICAgICBSZWY6ICdGbjkyNzBDQkMwJyxcbiAgICAgICAgfSxcbiAgICAgICAgQmF0Y2hTaXplOiAxMDAsXG4gICAgICAgIFN0YXJ0aW5nUG9zaXRpb246ICdUUklNX0hPUklaT04nLFxuICAgICAgICBUb3BpY3M6IFtcbiAgICAgICAgICBrYWZrYVRvcGljLFxuICAgICAgICBdLFxuICAgICAgfSk7XG5cblxuICAgIH0pO1xuICAgIHRlc3QoJ3dpdGggc2VjcmV0JywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGNsdXN0ZXJBcm4gPSAnc29tZS1hcm4nO1xuICAgICAgY29uc3Qga2Fma2FUb3BpYyA9ICdzb21lLXRvcGljJztcbiAgICAgIGNvbnN0IHNlY3JldCA9IG5ldyBTZWNyZXQoc3RhY2ssICdTZWNyZXQnLCB7IHNlY3JldE5hbWU6ICdBbWF6b25NU0tfS2Fma2FTZWNyZXQnIH0pO1xuXG4gICAgICAvLyBXSEVOXG4gICAgICBmbi5hZGRFdmVudFNvdXJjZShuZXcgc291cmNlcy5NYW5hZ2VkS2Fma2FFdmVudFNvdXJjZShcbiAgICAgICAge1xuICAgICAgICAgIGNsdXN0ZXJBcm4sXG4gICAgICAgICAgdG9waWM6IGthZmthVG9waWMsXG4gICAgICAgICAgc2VjcmV0OiBzZWNyZXQsXG4gICAgICAgICAgc3RhcnRpbmdQb3NpdGlvbjogbGFtYmRhLlN0YXJ0aW5nUG9zaXRpb24uVFJJTV9IT1JJWk9OLFxuICAgICAgICB9KSk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICAgIFN0YXRlbWVudDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICAgICAnc2VjcmV0c21hbmFnZXI6R2V0U2VjcmV0VmFsdWUnLFxuICAgICAgICAgICAgICAgICdzZWNyZXRzbWFuYWdlcjpEZXNjcmliZVNlY3JldCcsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICBSZWY6ICdTZWNyZXRBNzIwRUYwNScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICAgICAna2Fma2E6RGVzY3JpYmVDbHVzdGVyJyxcbiAgICAgICAgICAgICAgICAna2Fma2E6R2V0Qm9vdHN0cmFwQnJva2VycycsXG4gICAgICAgICAgICAgICAgJ2thZmthOkxpc3RTY3JhbVNlY3JldHMnLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICAgIFJlc291cmNlOiBjbHVzdGVyQXJuLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIFZlcnNpb246ICcyMDEyLTEwLTE3JyxcbiAgICAgICAgfSxcbiAgICAgICAgUG9saWN5TmFtZTogJ0ZuU2VydmljZVJvbGVEZWZhdWx0UG9saWN5QzZBODM5QkYnLFxuICAgICAgICBSb2xlczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFJlZjogJ0ZuU2VydmljZVJvbGVCOTAwMUE5NicsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuXG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpMYW1iZGE6OkV2ZW50U291cmNlTWFwcGluZycsIHtcbiAgICAgICAgRXZlbnRTb3VyY2VBcm46IGNsdXN0ZXJBcm4sXG4gICAgICAgIEZ1bmN0aW9uTmFtZToge1xuICAgICAgICAgIFJlZjogJ0ZuOTI3MENCQzAnLFxuICAgICAgICB9LFxuICAgICAgICBCYXRjaFNpemU6IDEwMCxcbiAgICAgICAgU3RhcnRpbmdQb3NpdGlvbjogJ1RSSU1fSE9SSVpPTicsXG4gICAgICAgIFRvcGljczogW1xuICAgICAgICAgIGthZmthVG9waWMsXG4gICAgICAgIF0sXG4gICAgICAgIFNvdXJjZUFjY2Vzc0NvbmZpZ3VyYXRpb25zOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgVHlwZTogJ1NBU0xfU0NSQU1fNTEyX0FVVEgnLFxuICAgICAgICAgICAgVVJJOiB7XG4gICAgICAgICAgICAgIFJlZjogJ1NlY3JldEE3MjBFRjA1JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuXG5cbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NlbGYtbWFuYWdlZCBrYWZrYScsICgpID0+IHtcbiAgICB0ZXN0KCdkZWZhdWx0JywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICBjb25zdCBzZWNyZXQgPSBuZXcgU2VjcmV0KHN0YWNrLCAnU2VjcmV0JywgeyBzZWNyZXROYW1lOiAnQW1hem9uTVNLX0thZmthU2VjcmV0JyB9KTtcbiAgICAgIGNvbnN0IGJvb3RzdHJhcFNlcnZlcnMgPSBbJ2thZmthLWJyb2tlcjo5MDkyJ107XG5cbiAgICAgIC8vIFdIRU5cbiAgICAgIGZuLmFkZEV2ZW50U291cmNlKG5ldyBzb3VyY2VzLlNlbGZNYW5hZ2VkS2Fma2FFdmVudFNvdXJjZShcbiAgICAgICAge1xuICAgICAgICAgIGJvb3RzdHJhcFNlcnZlcnM6IGJvb3RzdHJhcFNlcnZlcnMsXG4gICAgICAgICAgdG9waWM6IGthZmthVG9waWMsXG4gICAgICAgICAgc2VjcmV0OiBzZWNyZXQsXG4gICAgICAgICAgc3RhcnRpbmdQb3NpdGlvbjogbGFtYmRhLlN0YXJ0aW5nUG9zaXRpb24uVFJJTV9IT1JJWk9OLFxuICAgICAgICB9KSk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICAgIFN0YXRlbWVudDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICAgICAnc2VjcmV0c21hbmFnZXI6R2V0U2VjcmV0VmFsdWUnLFxuICAgICAgICAgICAgICAgICdzZWNyZXRzbWFuYWdlcjpEZXNjcmliZVNlY3JldCcsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICBSZWY6ICdTZWNyZXRBNzIwRUYwNScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgVmVyc2lvbjogJzIwMTItMTAtMTcnLFxuICAgICAgICB9LFxuICAgICAgICBQb2xpY3lOYW1lOiAnRm5TZXJ2aWNlUm9sZURlZmF1bHRQb2xpY3lDNkE4MzlCRicsXG4gICAgICAgIFJvbGVzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgUmVmOiAnRm5TZXJ2aWNlUm9sZUI5MDAxQTk2JyxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSk7XG5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RXZlbnRTb3VyY2VNYXBwaW5nJywge1xuICAgICAgICBGdW5jdGlvbk5hbWU6IHtcbiAgICAgICAgICBSZWY6ICdGbjkyNzBDQkMwJyxcbiAgICAgICAgfSxcbiAgICAgICAgQmF0Y2hTaXplOiAxMDAsXG4gICAgICAgIFNlbGZNYW5hZ2VkRXZlbnRTb3VyY2U6IHtcbiAgICAgICAgICBFbmRwb2ludHM6IHtcbiAgICAgICAgICAgIEthZmthQm9vdHN0cmFwU2VydmVyczogYm9vdHN0cmFwU2VydmVycyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBTdGFydGluZ1Bvc2l0aW9uOiAnVFJJTV9IT1JJWk9OJyxcbiAgICAgICAgVG9waWNzOiBbXG4gICAgICAgICAga2Fma2FUb3BpYyxcbiAgICAgICAgXSxcbiAgICAgICAgU291cmNlQWNjZXNzQ29uZmlndXJhdGlvbnM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBUeXBlOiAnU0FTTF9TQ1JBTV81MTJfQVVUSCcsXG4gICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2VjcmV0QTcyMEVGMDUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSk7XG5cblxuICAgIH0pO1xuICAgIHRlc3QoJ3dpdGhvdXQgdnBjLCBzZWNyZXQgbXVzdCBiZSBzZXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICBjb25zdCBrYWZrYVRvcGljID0gJ3NvbWUtdG9waWMnO1xuICAgICAgY29uc3QgYm9vdHN0cmFwU2VydmVycyA9IFsna2Fma2EtYnJva2VyOjkwOTInXTtcblxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgZm4uYWRkRXZlbnRTb3VyY2UobmV3IHNvdXJjZXMuU2VsZk1hbmFnZWRLYWZrYUV2ZW50U291cmNlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGJvb3RzdHJhcFNlcnZlcnM6IGJvb3RzdHJhcFNlcnZlcnMsXG4gICAgICAgICAgICB0b3BpYzoga2Fma2FUb3BpYyxcbiAgICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgICB9KSk7XG4gICAgICB9KS50b1Rocm93KC9zZWNyZXQgbXVzdCBiZSBzZXQvKTtcblxuXG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgndnBjJywgKCkgPT4ge1xuICAgICAgdGVzdCgnY29ycmVjdGx5IHJlbmRlcmVkIGluIHRoZSBzdGFjaycsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICAgIGNvbnN0IGJvb3RzdHJhcFNlcnZlcnMgPSBbJ2thZmthLWJyb2tlcjo5MDkyJ107XG4gICAgICAgIGNvbnN0IHNnID0gU2VjdXJpdHlHcm91cC5mcm9tU2VjdXJpdHlHcm91cElkKHN0YWNrLCAnU2VjdXJpdHlHcm91cCcsICdzZy0wMTIzNDU2Nzg5Jyk7XG4gICAgICAgIGNvbnN0IHZwYyA9IG5ldyBWcGMoc3RhY2ssICdWcGMnKTtcblxuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGZuLmFkZEV2ZW50U291cmNlKG5ldyBzb3VyY2VzLlNlbGZNYW5hZ2VkS2Fma2FFdmVudFNvdXJjZShcbiAgICAgICAgICB7XG4gICAgICAgICAgICBib290c3RyYXBTZXJ2ZXJzOiBib290c3RyYXBTZXJ2ZXJzLFxuICAgICAgICAgICAgdG9waWM6IGthZmthVG9waWMsXG4gICAgICAgICAgICBzdGFydGluZ1Bvc2l0aW9uOiBsYW1iZGEuU3RhcnRpbmdQb3NpdGlvbi5UUklNX0hPUklaT04sXG4gICAgICAgICAgICB2cGM6IHZwYyxcbiAgICAgICAgICAgIHZwY1N1Ym5ldHM6IHsgc3VibmV0VHlwZTogU3VibmV0VHlwZS5QUklWQVRFX1dJVEhfRUdSRVNTIH0sXG4gICAgICAgICAgICBzZWN1cml0eUdyb3VwOiBzZyxcbiAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnJlc291cmNlQ291bnRJcygnQVdTOjpJQU06OlBvbGljeScsIDApO1xuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpMYW1iZGE6OkV2ZW50U291cmNlTWFwcGluZycsIHtcbiAgICAgICAgICBGdW5jdGlvbk5hbWU6IHtcbiAgICAgICAgICAgIFJlZjogJ0ZuOTI3MENCQzAnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgQmF0Y2hTaXplOiAxMDAsXG4gICAgICAgICAgU2VsZk1hbmFnZWRFdmVudFNvdXJjZToge1xuICAgICAgICAgICAgRW5kcG9pbnRzOiB7XG4gICAgICAgICAgICAgIEthZmthQm9vdHN0cmFwU2VydmVyczogYm9vdHN0cmFwU2VydmVycyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBTdGFydGluZ1Bvc2l0aW9uOiAnVFJJTV9IT1JJWk9OJyxcbiAgICAgICAgICBUb3BpY3M6IFtcbiAgICAgICAgICAgIGthZmthVG9waWMsXG4gICAgICAgICAgXSxcbiAgICAgICAgICBTb3VyY2VBY2Nlc3NDb25maWd1cmF0aW9uczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBUeXBlOiAnVlBDX1NFQ1VSSVRZX0dST1VQJyxcbiAgICAgICAgICAgICAgVVJJOiAnc2ctMDEyMzQ1Njc4OScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBUeXBlOiAnVlBDX1NVQk5FVCcsXG4gICAgICAgICAgICAgIFVSSToge1xuICAgICAgICAgICAgICAgIFJlZjogJ1ZwY1ByaXZhdGVTdWJuZXQxU3VibmV0NTM2Qjk5N0EnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgVHlwZTogJ1ZQQ19TVUJORVQnLFxuICAgICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgICBSZWY6ICdWcGNQcml2YXRlU3VibmV0MlN1Ym5ldDM3ODhBQUExJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cblxuICAgICAgfSk7XG4gICAgICB0ZXN0KCd3aXRoIHNlY3JldCcsICgpID0+IHtcbiAgICAgICAgLy8gR0lWRU5cbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICAgIGNvbnN0IHNlY3JldCA9IG5ldyBTZWNyZXQoc3RhY2ssICdTZWNyZXQnLCB7IHNlY3JldE5hbWU6ICdBbWF6b25NU0tfS2Fma2FTZWNyZXQnIH0pO1xuICAgICAgICBjb25zdCBib290c3RyYXBTZXJ2ZXJzID0gWydrYWZrYS1icm9rZXI6OTA5MiddO1xuICAgICAgICBjb25zdCBzZyA9IFNlY3VyaXR5R3JvdXAuZnJvbVNlY3VyaXR5R3JvdXBJZChzdGFjaywgJ1NlY3VyaXR5R3JvdXAnLCAnc2ctMDEyMzQ1Njc4OScpO1xuICAgICAgICBjb25zdCB2cGMgPSBuZXcgVnBjKHN0YWNrLCAnVnBjJyk7XG5cbiAgICAgICAgLy8gV0hFTlxuICAgICAgICBmbi5hZGRFdmVudFNvdXJjZShuZXcgc291cmNlcy5TZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgICAge1xuICAgICAgICAgICAgYm9vdHN0cmFwU2VydmVyczogYm9vdHN0cmFwU2VydmVycyxcbiAgICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgICAgc2VjcmV0OiBzZWNyZXQsXG4gICAgICAgICAgICBzdGFydGluZ1Bvc2l0aW9uOiBsYW1iZGEuU3RhcnRpbmdQb3NpdGlvbi5UUklNX0hPUklaT04sXG4gICAgICAgICAgICB2cGM6IHZwYyxcbiAgICAgICAgICAgIHZwY1N1Ym5ldHM6IHsgc3VibmV0VHlwZTogU3VibmV0VHlwZS5QUklWQVRFX1dJVEhfRUdSRVNTIH0sXG4gICAgICAgICAgICBzZWN1cml0eUdyb3VwOiBzZyxcbiAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gVEhFTlxuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICAgICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICAgICAgU3RhdGVtZW50OiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICAgICAgICdzZWNyZXRzbWFuYWdlcjpHZXRTZWNyZXRWYWx1ZScsXG4gICAgICAgICAgICAgICAgICAnc2VjcmV0c21hbmFnZXI6RGVzY3JpYmVTZWNyZXQnLFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAgICAgICBSZWY6ICdTZWNyZXRBNzIwRUYwNScsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBWZXJzaW9uOiAnMjAxMi0xMC0xNycsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBQb2xpY3lOYW1lOiAnRm5TZXJ2aWNlUm9sZURlZmF1bHRQb2xpY3lDNkE4MzlCRicsXG4gICAgICAgICAgUm9sZXM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgUmVmOiAnRm5TZXJ2aWNlUm9sZUI5MDAxQTk2JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpFdmVudFNvdXJjZU1hcHBpbmcnLCB7XG4gICAgICAgICAgRnVuY3Rpb25OYW1lOiB7XG4gICAgICAgICAgICBSZWY6ICdGbjkyNzBDQkMwJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIEJhdGNoU2l6ZTogMTAwLFxuICAgICAgICAgIFNlbGZNYW5hZ2VkRXZlbnRTb3VyY2U6IHtcbiAgICAgICAgICAgIEVuZHBvaW50czoge1xuICAgICAgICAgICAgICBLYWZrYUJvb3RzdHJhcFNlcnZlcnM6IGJvb3RzdHJhcFNlcnZlcnMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgU3RhcnRpbmdQb3NpdGlvbjogJ1RSSU1fSE9SSVpPTicsXG4gICAgICAgICAgVG9waWNzOiBbXG4gICAgICAgICAgICBrYWZrYVRvcGljLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgU291cmNlQWNjZXNzQ29uZmlndXJhdGlvbnM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgVHlwZTogJ1NBU0xfU0NSQU1fNTEyX0FVVEgnLFxuICAgICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgICBSZWY6ICdTZWNyZXRBNzIwRUYwNScsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBUeXBlOiAnVlBDX1NFQ1VSSVRZX0dST1VQJyxcbiAgICAgICAgICAgICAgVVJJOiAnc2ctMDEyMzQ1Njc4OScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBUeXBlOiAnVlBDX1NVQk5FVCcsXG4gICAgICAgICAgICAgIFVSSToge1xuICAgICAgICAgICAgICAgIFJlZjogJ1ZwY1ByaXZhdGVTdWJuZXQxU3VibmV0NTM2Qjk5N0EnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgVHlwZTogJ1ZQQ19TVUJORVQnLFxuICAgICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgICBSZWY6ICdWcGNQcml2YXRlU3VibmV0MlN1Ym5ldDM3ODhBQUExJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG5cblxuICAgICAgfSk7XG4gICAgICB0ZXN0KCdzZXR0aW5nIHZwYyByZXF1aXJlcyB2cGNTdWJuZXRzIHRvIGJlIHNldCcsICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICAgIGNvbnN0IHNlY3JldCA9IG5ldyBTZWNyZXQoc3RhY2ssICdTZWNyZXQnLCB7IHNlY3JldE5hbWU6ICdBbWF6b25NU0tfS2Fma2FTZWNyZXQnIH0pO1xuICAgICAgICBjb25zdCBib290c3RyYXBTZXJ2ZXJzID0gWydrYWZrYS1icm9rZXI6OTA5MiddO1xuICAgICAgICBjb25zdCB2cGMgPSBuZXcgVnBjKHN0YWNrLCAnVnBjJyk7XG5cbiAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICBmbi5hZGRFdmVudFNvdXJjZShuZXcgc291cmNlcy5TZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJvb3RzdHJhcFNlcnZlcnM6IGJvb3RzdHJhcFNlcnZlcnMsXG4gICAgICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgICAgICBzZWNyZXQ6IHNlY3JldCxcbiAgICAgICAgICAgICAgc3RhcnRpbmdQb3NpdGlvbjogbGFtYmRhLlN0YXJ0aW5nUG9zaXRpb24uVFJJTV9IT1JJWk9OLFxuICAgICAgICAgICAgICB2cGM6IHZwYyxcbiAgICAgICAgICAgICAgc2VjdXJpdHlHcm91cDogU2VjdXJpdHlHcm91cC5mcm9tU2VjdXJpdHlHcm91cElkKHN0YWNrLCAnU2VjdXJpdHlHcm91cCcsICdzZy0wMTIzNDU2Nzg5JyksXG5cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkudG9UaHJvdygvdnBjU3VibmV0cyBtdXN0IGJlIHNldC8pO1xuXG5cbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KCdzZXR0aW5nIHZwYyByZXF1aXJlcyBzZWN1cml0eUdyb3VwIHRvIGJlIHNldCcsICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICAgIGNvbnN0IHNlY3JldCA9IG5ldyBTZWNyZXQoc3RhY2ssICdTZWNyZXQnLCB7IHNlY3JldE5hbWU6ICdBbWF6b25NU0tfS2Fma2FTZWNyZXQnIH0pO1xuICAgICAgICBjb25zdCBib290c3RyYXBTZXJ2ZXJzID0gWydrYWZrYS1icm9rZXI6OTA5MiddO1xuICAgICAgICBjb25zdCB2cGMgPSBuZXcgVnBjKHN0YWNrLCAnVnBjJyk7XG5cbiAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICBmbi5hZGRFdmVudFNvdXJjZShuZXcgc291cmNlcy5TZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJvb3RzdHJhcFNlcnZlcnM6IGJvb3RzdHJhcFNlcnZlcnMsXG4gICAgICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgICAgICBzZWNyZXQ6IHNlY3JldCxcbiAgICAgICAgICAgICAgc3RhcnRpbmdQb3NpdGlvbjogbGFtYmRhLlN0YXJ0aW5nUG9zaXRpb24uVFJJTV9IT1JJWk9OLFxuICAgICAgICAgICAgICB2cGM6IHZwYyxcbiAgICAgICAgICAgICAgdnBjU3VibmV0czogeyBzdWJuZXRUeXBlOiBTdWJuZXRUeXBlLlBSSVZBVEVfV0lUSF9FR1JFU1MgfSxcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkudG9UaHJvdygvc2VjdXJpdHlHcm91cCBtdXN0IGJlIHNldC8pO1xuXG5cbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgndXNpbmcgU0NSQU0tU0hBLTI1NicsICgpID0+IHtcbiAgICAgIC8vIEdJVkVOXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICBjb25zdCBrYWZrYVRvcGljID0gJ3NvbWUtdG9waWMnO1xuICAgICAgY29uc3Qgc2VjcmV0ID0gbmV3IFNlY3JldChzdGFjaywgJ1NlY3JldCcsIHsgc2VjcmV0TmFtZTogJ0FtYXpvbk1TS19LYWZrYVNlY3JldCcgfSk7XG4gICAgICBjb25zdCBib290c3RyYXBTZXJ2ZXJzID0gWydrYWZrYS1icm9rZXI6OTA5MiddO1xuICAgICAgY29uc3Qgc2cgPSBTZWN1cml0eUdyb3VwLmZyb21TZWN1cml0eUdyb3VwSWQoc3RhY2ssICdTZWN1cml0eUdyb3VwJywgJ3NnLTAxMjM0NTY3ODknKTtcbiAgICAgIGNvbnN0IHZwYyA9IG5ldyBWcGMoc3RhY2ssICdWcGMnKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgZm4uYWRkRXZlbnRTb3VyY2UobmV3IHNvdXJjZXMuU2VsZk1hbmFnZWRLYWZrYUV2ZW50U291cmNlKFxuICAgICAgICB7XG4gICAgICAgICAgYm9vdHN0cmFwU2VydmVyczogYm9vdHN0cmFwU2VydmVycyxcbiAgICAgICAgICB0b3BpYzoga2Fma2FUb3BpYyxcbiAgICAgICAgICBzZWNyZXQ6IHNlY3JldCxcbiAgICAgICAgICBzdGFydGluZ1Bvc2l0aW9uOiBsYW1iZGEuU3RhcnRpbmdQb3NpdGlvbi5UUklNX0hPUklaT04sXG4gICAgICAgICAgdnBjOiB2cGMsXG4gICAgICAgICAgdnBjU3VibmV0czogeyBzdWJuZXRUeXBlOiBTdWJuZXRUeXBlLlBSSVZBVEVfV0lUSF9FR1JFU1MgfSxcbiAgICAgICAgICBzZWN1cml0eUdyb3VwOiBzZyxcbiAgICAgICAgICBhdXRoZW50aWNhdGlvbk1ldGhvZDogc291cmNlcy5BdXRoZW50aWNhdGlvbk1ldGhvZC5TQVNMX1NDUkFNXzI1Nl9BVVRILFxuICAgICAgICB9KSk7XG5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RXZlbnRTb3VyY2VNYXBwaW5nJywge1xuICAgICAgICBTb3VyY2VBY2Nlc3NDb25maWd1cmF0aW9uczogTWF0Y2guYXJyYXlXaXRoKFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBUeXBlOiAnU0FTTF9TQ1JBTV8yNTZfQVVUSCcsXG4gICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2VjcmV0QTcyMEVGMDUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgndXNpbmcgQkFTSUNfQVVUSCcsICgpID0+IHtcbiAgICAgIC8vIEdJVkVOXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBjZGsuU3RhY2soKTtcbiAgICAgIGNvbnN0IGZuID0gbmV3IFRlc3RGdW5jdGlvbihzdGFjaywgJ0ZuJyk7XG4gICAgICBjb25zdCBrYWZrYVRvcGljID0gJ3NvbWUtdG9waWMnO1xuICAgICAgY29uc3Qgc2VjcmV0ID0gbmV3IFNlY3JldChzdGFjaywgJ1NlY3JldCcsIHsgc2VjcmV0TmFtZTogJ0FtYXpvbk1TS19LYWZrYVNlY3JldCcgfSk7XG4gICAgICBjb25zdCBib290c3RyYXBTZXJ2ZXJzID0gWydrYWZrYS1icm9rZXI6OTA5MiddO1xuICAgICAgY29uc3Qgc2cgPSBTZWN1cml0eUdyb3VwLmZyb21TZWN1cml0eUdyb3VwSWQoc3RhY2ssICdTZWN1cml0eUdyb3VwJywgJ3NnLTAxMjM0NTY3ODknKTtcbiAgICAgIGNvbnN0IHZwYyA9IG5ldyBWcGMoc3RhY2ssICdWcGMnKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgZm4uYWRkRXZlbnRTb3VyY2UobmV3IHNvdXJjZXMuU2VsZk1hbmFnZWRLYWZrYUV2ZW50U291cmNlKFxuICAgICAgICB7XG4gICAgICAgICAgYm9vdHN0cmFwU2VydmVyczogYm9vdHN0cmFwU2VydmVycyxcbiAgICAgICAgICB0b3BpYzoga2Fma2FUb3BpYyxcbiAgICAgICAgICBzZWNyZXQ6IHNlY3JldCxcbiAgICAgICAgICBzdGFydGluZ1Bvc2l0aW9uOiBsYW1iZGEuU3RhcnRpbmdQb3NpdGlvbi5UUklNX0hPUklaT04sXG4gICAgICAgICAgdnBjOiB2cGMsXG4gICAgICAgICAgdnBjU3VibmV0czogeyBzdWJuZXRUeXBlOiBTdWJuZXRUeXBlLlBSSVZBVEVfV0lUSF9FR1JFU1MgfSxcbiAgICAgICAgICBzZWN1cml0eUdyb3VwOiBzZyxcbiAgICAgICAgICBhdXRoZW50aWNhdGlvbk1ldGhvZDogc291cmNlcy5BdXRoZW50aWNhdGlvbk1ldGhvZC5CQVNJQ19BVVRILFxuICAgICAgICB9KSk7XG5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RXZlbnRTb3VyY2VNYXBwaW5nJywge1xuICAgICAgICBTb3VyY2VBY2Nlc3NDb25maWd1cmF0aW9uczogTWF0Y2guYXJyYXlXaXRoKFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBUeXBlOiAnQkFTSUNfQVVUSCcsXG4gICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2VjcmV0QTcyMEVGMDUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgndXNpbmcgQ0xJRU5UX0NFUlRJRklDQVRFX1RMU19BVVRIJywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICBjb25zdCBzZWNyZXQgPSBuZXcgU2VjcmV0KHN0YWNrLCAnU2VjcmV0JywgeyBzZWNyZXROYW1lOiAnQW1hem9uTVNLX0thZmthU2VjcmV0JyB9KTtcbiAgICAgIGNvbnN0IGJvb3RzdHJhcFNlcnZlcnMgPSBbJ2thZmthLWJyb2tlcjo5MDkyJ107XG4gICAgICBjb25zdCBzZyA9IFNlY3VyaXR5R3JvdXAuZnJvbVNlY3VyaXR5R3JvdXBJZChzdGFjaywgJ1NlY3VyaXR5R3JvdXAnLCAnc2ctMDEyMzQ1Njc4OScpO1xuICAgICAgY29uc3QgdnBjID0gbmV3IFZwYyhzdGFjaywgJ1ZwYycpO1xuXG4gICAgICAvLyBXSEVOXG4gICAgICBmbi5hZGRFdmVudFNvdXJjZShuZXcgc291cmNlcy5TZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgIHtcbiAgICAgICAgICBib290c3RyYXBTZXJ2ZXJzOiBib290c3RyYXBTZXJ2ZXJzLFxuICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgIHNlY3JldDogc2VjcmV0LFxuICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgICB2cGM6IHZwYyxcbiAgICAgICAgICB2cGNTdWJuZXRzOiB7IHN1Ym5ldFR5cGU6IFN1Ym5ldFR5cGUuUFJJVkFURV9XSVRIX0VHUkVTUyB9LFxuICAgICAgICAgIHNlY3VyaXR5R3JvdXA6IHNnLFxuICAgICAgICAgIGF1dGhlbnRpY2F0aW9uTWV0aG9kOiBzb3VyY2VzLkF1dGhlbnRpY2F0aW9uTWV0aG9kLkNMSUVOVF9DRVJUSUZJQ0FURV9UTFNfQVVUSCxcbiAgICAgICAgfSkpO1xuXG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpMYW1iZGE6OkV2ZW50U291cmNlTWFwcGluZycsIHtcbiAgICAgICAgU291cmNlQWNjZXNzQ29uZmlndXJhdGlvbnM6IE1hdGNoLmFycmF5V2l0aChbXG4gICAgICAgICAge1xuICAgICAgICAgICAgVHlwZTogJ0NMSUVOVF9DRVJUSUZJQ0FURV9UTFNfQVVUSCcsXG4gICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgUmVmOiAnU2VjcmV0QTcyMEVGMDUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgndXNpbmcgQ0xJRU5UX0NFUlRJRklDQVRFX1RMU19BVVRIIHdpdGggcm9vdENBJywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICBjb25zdCBzZWNyZXQgPSBuZXcgU2VjcmV0KHN0YWNrLCAnU2VjcmV0JywgeyBzZWNyZXROYW1lOiAnQW1hem9uTVNLX0thZmthU2VjcmV0JyB9KTtcbiAgICAgIGNvbnN0IHJvb3RDQUNlcnRpZmljYXRlID0gbmV3IFNlY3JldChzdGFjaywgJ1Jvb3RDQVNlY3JldCcsIHsgc2VjcmV0TmFtZTogJ0FtYXpvbk1TS19LYWZrYVNlY3JldF9Sb290X0NBJyB9KTtcbiAgICAgIGNvbnN0IGJvb3RzdHJhcFNlcnZlcnMgPSBbJ2thZmthLWJyb2tlcjo5MDkyJ107XG4gICAgICBjb25zdCBzZyA9IFNlY3VyaXR5R3JvdXAuZnJvbVNlY3VyaXR5R3JvdXBJZChzdGFjaywgJ1NlY3VyaXR5R3JvdXAnLCAnc2ctMDEyMzQ1Njc4OScpO1xuICAgICAgY29uc3QgdnBjID0gbmV3IFZwYyhzdGFjaywgJ1ZwYycpO1xuXG4gICAgICAvLyBXSEVOXG4gICAgICBmbi5hZGRFdmVudFNvdXJjZShuZXcgc291cmNlcy5TZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgIHtcbiAgICAgICAgICBib290c3RyYXBTZXJ2ZXJzOiBib290c3RyYXBTZXJ2ZXJzLFxuICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgIHNlY3JldDogc2VjcmV0LFxuICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgICB2cGM6IHZwYyxcbiAgICAgICAgICB2cGNTdWJuZXRzOiB7IHN1Ym5ldFR5cGU6IFN1Ym5ldFR5cGUuUFJJVkFURV9XSVRIX0VHUkVTUyB9LFxuICAgICAgICAgIHNlY3VyaXR5R3JvdXA6IHNnLFxuICAgICAgICAgIGF1dGhlbnRpY2F0aW9uTWV0aG9kOiBzb3VyY2VzLkF1dGhlbnRpY2F0aW9uTWV0aG9kLkNMSUVOVF9DRVJUSUZJQ0FURV9UTFNfQVVUSCxcbiAgICAgICAgICByb290Q0FDZXJ0aWZpY2F0ZTogcm9vdENBQ2VydGlmaWNhdGUsXG4gICAgICAgIH0pKTtcblxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpFdmVudFNvdXJjZU1hcHBpbmcnLCB7XG4gICAgICAgIFNvdXJjZUFjY2Vzc0NvbmZpZ3VyYXRpb25zOiBNYXRjaC5hcnJheVdpdGgoW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFR5cGU6ICdDTElFTlRfQ0VSVElGSUNBVEVfVExTX0FVVEgnLFxuICAgICAgICAgICAgVVJJOiB7XG4gICAgICAgICAgICAgIFJlZjogJ1NlY3JldEE3MjBFRjA1JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBUeXBlOiAnU0VSVkVSX1JPT1RfQ0FfQ0VSVElGSUNBVEUnLFxuICAgICAgICAgICAgVVJJOiB7XG4gICAgICAgICAgICAgIFJlZjogJ1Jvb3RDQVNlY3JldDIxNjMyQkI5JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3dpdGggcm9vdENBJywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGthZmthVG9waWMgPSAnc29tZS10b3BpYyc7XG4gICAgICBjb25zdCByb290Q0FDZXJ0aWZpY2F0ZSA9IG5ldyBTZWNyZXQoc3RhY2ssICdSb290Q0FTZWNyZXQnLCB7IHNlY3JldE5hbWU6ICdBbWF6b25NU0tfS2Fma2FTZWNyZXRfUm9vdF9DQScgfSk7XG4gICAgICBjb25zdCBib290c3RyYXBTZXJ2ZXJzID0gWydrYWZrYS1icm9rZXI6OTA5MiddO1xuICAgICAgY29uc3Qgc2cgPSBTZWN1cml0eUdyb3VwLmZyb21TZWN1cml0eUdyb3VwSWQoc3RhY2ssICdTZWN1cml0eUdyb3VwJywgJ3NnLTAxMjM0NTY3ODknKTtcbiAgICAgIGNvbnN0IHZwYyA9IG5ldyBWcGMoc3RhY2ssICdWcGMnKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgZm4uYWRkRXZlbnRTb3VyY2UobmV3IHNvdXJjZXMuU2VsZk1hbmFnZWRLYWZrYUV2ZW50U291cmNlKFxuICAgICAgICB7XG4gICAgICAgICAgYm9vdHN0cmFwU2VydmVyczogYm9vdHN0cmFwU2VydmVycyxcbiAgICAgICAgICB0b3BpYzoga2Fma2FUb3BpYyxcbiAgICAgICAgICBzdGFydGluZ1Bvc2l0aW9uOiBsYW1iZGEuU3RhcnRpbmdQb3NpdGlvbi5UUklNX0hPUklaT04sXG4gICAgICAgICAgdnBjOiB2cGMsXG4gICAgICAgICAgdnBjU3VibmV0czogeyBzdWJuZXRUeXBlOiBTdWJuZXRUeXBlLlBSSVZBVEVfV0lUSF9FR1JFU1MgfSxcbiAgICAgICAgICBzZWN1cml0eUdyb3VwOiBzZyxcbiAgICAgICAgICByb290Q0FDZXJ0aWZpY2F0ZTogcm9vdENBQ2VydGlmaWNhdGUsXG4gICAgICAgIH0pKTtcblxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpFdmVudFNvdXJjZU1hcHBpbmcnLCB7XG4gICAgICAgIFNvdXJjZUFjY2Vzc0NvbmZpZ3VyYXRpb25zOiBNYXRjaC5hcnJheVdpdGgoW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFR5cGU6ICdTRVJWRVJfUk9PVF9DQV9DRVJUSUZJQ0FURScsXG4gICAgICAgICAgICBVUkk6IHtcbiAgICAgICAgICAgICAgUmVmOiAnUm9vdENBU2VjcmV0MjE2MzJCQjknLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgncm9vdENBQ2VydGlmaWNhdGUgY2FuIGJlIElTZWNyZXQnLCAoKSA9PiB7XG4gICAgICAvLyBHSVZFTlxuICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgICBjb25zdCBmbiA9IG5ldyBUZXN0RnVuY3Rpb24oc3RhY2ssICdGbicpO1xuICAgICAgY29uc3Qga2Fma2FUb3BpYyA9ICdzb21lLXRvcGljJztcbiAgICAgIGNvbnN0IG1vY2tSb290Q0FDZXJ0aWZpY2F0ZVNlY3JldEFybiA9ICdhcm46YXdzOnNlY3JldHNtYW5hZ2VyOnVzLWVhc3QtMTowMTIzNDU2Nzg5MDE6c2VjcmV0Om1vY2snO1xuICAgICAgY29uc3Qgcm9vdENBQ2VydGlmaWNhdGUgPSBTZWNyZXQuZnJvbVNlY3JldFBhcnRpYWxBcm4oc3RhY2ssICdSb290Q0FTZWNyZXQnLCBtb2NrUm9vdENBQ2VydGlmaWNhdGVTZWNyZXRBcm4pO1xuICAgICAgY29uc3QgYm9vdHN0cmFwU2VydmVycyA9IFsna2Fma2EtYnJva2VyOjkwOTInXTtcbiAgICAgIGNvbnN0IHNnID0gU2VjdXJpdHlHcm91cC5mcm9tU2VjdXJpdHlHcm91cElkKHN0YWNrLCAnU2VjdXJpdHlHcm91cCcsICdzZy0wMTIzNDU2Nzg5Jyk7XG4gICAgICBjb25zdCB2cGMgPSBuZXcgVnBjKHN0YWNrLCAnVnBjJyk7XG5cbiAgICAgIC8vIFdIRU5cbiAgICAgIGZuLmFkZEV2ZW50U291cmNlKG5ldyBzb3VyY2VzLlNlbGZNYW5hZ2VkS2Fma2FFdmVudFNvdXJjZShcbiAgICAgICAge1xuICAgICAgICAgIGJvb3RzdHJhcFNlcnZlcnM6IGJvb3RzdHJhcFNlcnZlcnMsXG4gICAgICAgICAgdG9waWM6IGthZmthVG9waWMsXG4gICAgICAgICAgc3RhcnRpbmdQb3NpdGlvbjogbGFtYmRhLlN0YXJ0aW5nUG9zaXRpb24uVFJJTV9IT1JJWk9OLFxuICAgICAgICAgIHZwYzogdnBjLFxuICAgICAgICAgIHZwY1N1Ym5ldHM6IHsgc3VibmV0VHlwZTogU3VibmV0VHlwZS5QUklWQVRFX1dJVEhfRUdSRVNTIH0sXG4gICAgICAgICAgc2VjdXJpdHlHcm91cDogc2csXG4gICAgICAgICAgcm9vdENBQ2VydGlmaWNhdGU6IHJvb3RDQUNlcnRpZmljYXRlLFxuICAgICAgICB9KSk7XG5cbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RXZlbnRTb3VyY2VNYXBwaW5nJywge1xuICAgICAgICBTb3VyY2VBY2Nlc3NDb25maWd1cmF0aW9uczogTWF0Y2guYXJyYXlXaXRoKFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBUeXBlOiAnU0VSVkVSX1JPT1RfQ0FfQ0VSVElGSUNBVEUnLFxuICAgICAgICAgICAgVVJJOiBtb2NrUm9vdENBQ2VydGlmaWNhdGVTZWNyZXRBcm4sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSksXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2NvbnN1bWVyR3JvdXBJZCBjYW4gYmUgc2V0IGZvciBTZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UnLCAoKSA9PiB7XG4gICAgICAvLyBHSVZFTlxuICAgICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgICBjb25zdCBmbiA9IG5ldyBUZXN0RnVuY3Rpb24oc3RhY2ssICdGbicpO1xuICAgICAgY29uc3Qga2Fma2FUb3BpYyA9ICdzb21lLXRvcGljJztcbiAgICAgIGNvbnN0IHNlY3JldCA9IG5ldyBTZWNyZXQoc3RhY2ssICdTZWNyZXQnLCB7IHNlY3JldE5hbWU6ICdBbWF6b25NU0tfS2Fma2FTZWNyZXQnIH0pO1xuICAgICAgY29uc3QgYm9vdHN0cmFwU2VydmVycyA9IFsna2Fma2EtYnJva2VyOjkwOTInXTtcbiAgICAgIGNvbnN0IGNvbnN1bWVyR3JvdXBJZCA9ICdteS1jb25zdW1lci1ncm91cC1pZCc7XG4gICAgICBjb25zdCBldmVudFNvdXJjZU1hcHBpbmcgPSBuZXcgc291cmNlcy5TZWxmTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgIHtcbiAgICAgICAgICBib290c3RyYXBTZXJ2ZXJzOiBib290c3RyYXBTZXJ2ZXJzLFxuICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgIHNlY3JldDogc2VjcmV0LFxuICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgICBjb25zdW1lckdyb3VwSWQ6IGNvbnN1bWVyR3JvdXBJZCxcbiAgICAgICAgfSk7XG4gICAgICAvLyBXSEVOXG4gICAgICBmbi5hZGRFdmVudFNvdXJjZShldmVudFNvdXJjZU1hcHBpbmcpO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9IFRlbXBsYXRlLmZyb21TdGFjayhzdGFjayk7XG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpFdmVudFNvdXJjZU1hcHBpbmcnLCB7XG4gICAgICAgIFNlbGZNYW5hZ2VkS2Fma2FFdmVudFNvdXJjZUNvbmZpZzogeyBDb25zdW1lckdyb3VwSWQ6IGNvbnN1bWVyR3JvdXBJZCB9LFxuICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIHRlc3QoJ2NvbnN1bWVyR3JvdXBJZCBjYW4gYmUgc2V0IGZvciBNYW5hZ2VkS2Fma2FFdmVudFNvdXJjZScsICgpID0+IHtcblxuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGNsdXN0ZXJBcm4gPSAnc29tZS1hcm4nO1xuICAgICAgY29uc3Qga2Fma2FUb3BpYyA9ICdzb21lLXRvcGljJztcbiAgICAgIGNvbnN0IGNvbnN1bWVyR3JvdXBJZCA9ICdteS1jb25zdW1lci1ncm91cC1pZCc7XG5cblxuICAgICAgY29uc3QgbXNrRXZlbnRNYXBwaW5nID0gbmV3IHNvdXJjZXMuTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgIHtcbiAgICAgICAgICBjbHVzdGVyQXJuLFxuICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgICBjb25zdW1lckdyb3VwSWQsXG4gICAgICAgIH0pO1xuXG4gICAgICAvLyBXSEVOXG4gICAgICBmbi5hZGRFdmVudFNvdXJjZShtc2tFdmVudE1hcHBpbmcpO1xuICAgICAgZXhwZWN0KG1za0V2ZW50TWFwcGluZy5ldmVudFNvdXJjZU1hcHBpbmdJZCkudG9CZURlZmluZWQoKTtcblxuICAgICAgY29uc3QgdGVtcGxhdGUgPSBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spO1xuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RXZlbnRTb3VyY2VNYXBwaW5nJywge1xuICAgICAgICBBbWF6b25NYW5hZ2VkS2Fma2FFdmVudFNvdXJjZUNvbmZpZzogeyBDb25zdW1lckdyb3VwSWQ6IGNvbnN1bWVyR3JvdXBJZCB9LFxuICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIHRlc3QoJ01hbmFnZWRLYWZrYUV2ZW50U291cmNlIG5hbWUgY29uZm9ybXMgdG8gY29uc3RydWN0IGlkIHJ1bGVzJywgKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xuICAgICAgY29uc3QgZm4gPSBuZXcgVGVzdEZ1bmN0aW9uKHN0YWNrLCAnRm4nKTtcbiAgICAgIGNvbnN0IGNsdXN0ZXJBcm4gPSAnc29tZS1hcm4nO1xuICAgICAgY29uc3Qga2Fma2FUb3BpYyA9ICdzb21lLXRvcGljJztcblxuICAgICAgY29uc3QgbXNrRXZlbnRNYXBwaW5nID0gbmV3IHNvdXJjZXMuTWFuYWdlZEthZmthRXZlbnRTb3VyY2UoXG4gICAgICAgIHtcbiAgICAgICAgICBjbHVzdGVyQXJuLFxuICAgICAgICAgIHRvcGljOiBrYWZrYVRvcGljLFxuICAgICAgICAgIHN0YXJ0aW5nUG9zaXRpb246IGxhbWJkYS5TdGFydGluZ1Bvc2l0aW9uLlRSSU1fSE9SSVpPTixcbiAgICAgICAgfSk7XG5cbiAgICAgIC8vIFdIRU5cbiAgICAgIGZuLmFkZEV2ZW50U291cmNlKG1za0V2ZW50TWFwcGluZyk7XG4gICAgICBleHBlY3QobXNrRXZlbnRNYXBwaW5nLmV2ZW50U291cmNlTWFwcGluZ0lkKS50b0JlRGVmaW5lZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19