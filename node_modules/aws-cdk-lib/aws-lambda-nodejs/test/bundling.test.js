"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process = require("child_process");
const fs = require("fs");
const os = require("os");
const path = require("path");
const aws_lambda_1 = require("../../aws-lambda");
const core_1 = require("../../core");
const package_json_1 = require("delay/package.json");
const bundling_1 = require("../lib/bundling");
const package_installation_1 = require("../lib/package-installation");
const types_1 = require("../lib/types");
const util = require("../lib/util");
let detectPackageInstallationMock;
beforeEach(() => {
    jest.clearAllMocks();
    jest.resetAllMocks();
    jest.restoreAllMocks();
    bundling_1.Bundling.clearEsbuildInstallationCache();
    bundling_1.Bundling.clearTscInstallationCache();
    jest.spyOn(aws_lambda_1.Code, 'fromAsset');
    detectPackageInstallationMock = jest.spyOn(package_installation_1.PackageInstallation, 'detect').mockReturnValue({
        isLocal: true,
        version: '0.8.8',
    });
    jest.spyOn(core_1.DockerImage, 'fromBuild').mockReturnValue({
        image: 'built-image',
        cp: () => 'dest-path',
        run: () => { },
        toJSON: () => 'built-image',
    });
});
let projectRoot = '/project';
let depsLockFilePath = '/project/yarn.lock';
let entry = '/project/lib/handler.ts';
let tsconfig = '/project/lib/custom-tsconfig.ts';
test('esbuild bundling in Docker', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        environment: {
            KEY: 'value',
        },
        loader: {
            '.png': 'dataurl',
        },
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            environment: {
                KEY: 'value',
            },
            command: [
                'bash', '-c',
                'esbuild --bundle "/asset-input/lib/handler.ts" --target=node14 --platform=node --outfile="/asset-output/index.js" --external:aws-sdk --loader:.png=dataurl',
            ],
            workingDirectory: '/',
        }),
    });
    expect(core_1.DockerImage.fromBuild).toHaveBeenCalledWith(expect.stringMatching(/aws-lambda-nodejs\/lib$/), expect.objectContaining({
        buildArgs: expect.objectContaining({
            IMAGE: expect.stringMatching(/build-nodejs/),
        }),
        platform: 'linux/amd64',
    }));
});
test('esbuild bundling with handler named index.ts', () => {
    bundling_1.Bundling.bundle({
        entry: '/project/lib/index.ts',
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                'esbuild --bundle "/asset-input/lib/index.ts" --target=node14 --platform=node --outfile="/asset-output/index.js" --external:aws-sdk',
            ],
        }),
    });
});
test('esbuild bundling with tsx handler', () => {
    bundling_1.Bundling.bundle({
        entry: '/project/lib/handler.tsx',
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                'esbuild --bundle "/asset-input/lib/handler.tsx" --target=node14 --platform=node --outfile="/asset-output/index.js" --external:aws-sdk',
            ],
        }),
    });
});
test('esbuild with Windows paths', () => {
    const osPlatformMock = jest.spyOn(os, 'platform').mockReturnValue('win32');
    // Mock path.basename() because it cannot extract the basename of a Windows
    // path when running on Linux
    jest.spyOn(path, 'basename').mockReturnValueOnce('package-lock.json');
    jest.spyOn(path, 'relative').mockReturnValueOnce('lib\\entry.ts').mockReturnValueOnce('package-lock.json');
    bundling_1.Bundling.bundle({
        entry: 'C:\\my-project\\lib\\entry.ts',
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        projectRoot: 'C:\\my-project',
        depsLockFilePath: 'C:\\my-project\\package-lock.json',
        forceDockerBundling: true,
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(expect.any(String), expect.objectContaining({
        bundling: expect.objectContaining({
            command: expect.arrayContaining([
                expect.stringContaining('/lib/entry.ts'),
            ]),
        }),
    }));
    osPlatformMock.mockRestore();
});
test('esbuild bundling with externals and dependencies', () => {
    const packageLock = path.join(__dirname, '..', 'package-lock.json');
    bundling_1.Bundling.bundle({
        entry: __filename,
        projectRoot: path.dirname(packageLock),
        depsLockFilePath: packageLock,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        externalModules: ['abc'],
        nodeModules: ['delay'],
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(packageLock), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    'esbuild --bundle "/asset-input/test/bundling.test.js" --target=node14 --platform=node --outfile="/asset-output/index.js" --external:abc --external:delay',
                    `echo \'{\"dependencies\":{\"delay\":\"${package_json_1.version}\"}}\' > "/asset-output/package.json"`,
                    'cp "/asset-input/package-lock.json" "/asset-output/package-lock.json"',
                    'cd "/asset-output"',
                    'npm ci',
                ].join(' && '),
            ],
        }),
    });
});
test('esbuild bundling with esbuild options', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        minify: true,
        sourceMap: true,
        sourcesContent: false,
        target: 'es2020',
        loader: {
            '.png': 'dataurl',
        },
        logLevel: types_1.LogLevel.SILENT,
        keepNames: true,
        tsconfig,
        metafile: true,
        banner: '/* comments */',
        footer: '/* comments */',
        charset: types_1.Charset.UTF8,
        forceDockerBundling: true,
        mainFields: ['module', 'main'],
        define: {
            'process.env.KEY': JSON.stringify('VALUE'),
            'process.env.BOOL': 'true',
            'process.env.NUMBER': '7777',
            'process.env.STRING': JSON.stringify('this is a "test"'),
        },
        format: types_1.OutputFormat.ESM,
        inject: ['./my-shim.js'],
        esbuildArgs: {
            '--log-limit': '0',
            '--resolve-extensions': '.ts,.js',
            '--splitting': true,
            '--keep-names': '',
        },
    });
    // Correctly bundles with esbuild
    const defineInstructions = '--define:process.env.KEY="\\"VALUE\\"" --define:process.env.BOOL="true" --define:process.env.NUMBER="7777" --define:process.env.STRING="\\"this is a \\\\\\"test\\\\\\"\\""';
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash',
                '-c',
                [
                    'esbuild --bundle "/asset-input/lib/handler.ts"',
                    '--target=es2020 --platform=node --format=esm --outfile="/asset-output/index.mjs"',
                    '--minify --sourcemap --sources-content=false --external:aws-sdk --loader:.png=dataurl',
                    defineInstructions,
                    '--log-level=silent --keep-names --tsconfig=/asset-input/lib/custom-tsconfig.ts',
                    '--metafile=/asset-output/index.meta.json --banner:js="/* comments */" --footer:js="/* comments */"',
                    '--charset=utf8 --main-fields=module,main --inject:./my-shim.js',
                    '--log-limit="0" --resolve-extensions=".ts,.js" --splitting --keep-names',
                ].join(' '),
            ],
        }),
    });
    // Make sure that the define instructions are working as expected with the esbuild CLI
    const bundleProcess = util.exec('bash', ['-c', `npx esbuild --bundle ${`${__dirname}/integ-handlers/define.ts`} ${defineInstructions}`]);
    expect(bundleProcess.stdout.toString()).toMatchSnapshot();
});
test('throws with ESM and NODEJS_12_X', () => {
    expect(() => bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_12_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        format: types_1.OutputFormat.ESM,
    })).toThrow(/ECMAScript module output format is not supported by the nodejs12.x runtime/);
});
test('esbuild bundling source map default', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        sourceMap: true,
        sourceMapMode: types_1.SourceMapMode.DEFAULT,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    'esbuild --bundle "/asset-input/lib/handler.ts" --target=node14 --platform=node --outfile="/asset-output/index.js"',
                    '--sourcemap --external:aws-sdk',
                ].join(' '),
            ],
        }),
    });
});
test('esbuild bundling without aws-sdk v3 when use greater than or equal Runtime.NODEJS_18_X', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_18_X,
        architecture: aws_lambda_1.Architecture.X86_64,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                'esbuild --bundle "/asset-input/lib/handler.ts" --target=node18 --platform=node --outfile="/asset-output/index.js" --external:@aws-sdk/*',
            ],
        }),
    });
});
test('esbuild bundling source map inline', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        sourceMap: true,
        sourceMapMode: types_1.SourceMapMode.INLINE,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    'esbuild --bundle "/asset-input/lib/handler.ts" --target=node14 --platform=node --outfile="/asset-output/index.js"',
                    '--sourcemap=inline --external:aws-sdk',
                ].join(' '),
            ],
        }),
    });
});
test('esbuild bundling is correctly done with custom runtime matching predefined runtime', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: new aws_lambda_1.Runtime('nodejs14.x', aws_lambda_1.RuntimeFamily.NODEJS, { supportsInlineCode: true }),
        architecture: aws_lambda_1.Architecture.X86_64,
        sourceMapMode: types_1.SourceMapMode.INLINE,
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    'esbuild --bundle "/asset-input/lib/handler.ts" --target=node14 --platform=node --outfile="/asset-output/index.js"',
                    '--sourcemap=inline --external:aws-sdk',
                ].join(' '),
            ],
        }),
    });
});
test('esbuild bundling source map enabled when only source map mode exists', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        sourceMapMode: types_1.SourceMapMode.INLINE,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    'esbuild --bundle "/asset-input/lib/handler.ts" --target=node14 --platform=node --outfile="/asset-output/index.js"',
                    '--sourcemap=inline --external:aws-sdk',
                ].join(' '),
            ],
        }),
    });
});
test('esbuild bundling throws when sourceMapMode used with false sourceMap', () => {
    expect(() => {
        bundling_1.Bundling.bundle({
            entry,
            projectRoot,
            depsLockFilePath,
            runtime: aws_lambda_1.Runtime.NODEJS_14_X,
            architecture: aws_lambda_1.Architecture.X86_64,
            sourceMap: false,
            sourceMapMode: types_1.SourceMapMode.INLINE,
        });
    }).toThrow('sourceMapMode cannot be used when sourceMap is false');
});
test('Detects yarn.lock', () => {
    const yarnLock = path.join(__dirname, '..', 'yarn.lock');
    bundling_1.Bundling.bundle({
        entry: __filename,
        projectRoot: path.dirname(yarnLock),
        depsLockFilePath: yarnLock,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        nodeModules: ['delay'],
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(yarnLock), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: expect.arrayContaining([
                expect.stringMatching(/yarn\.lock.+yarn install --no-immutable/),
            ]),
        }),
    });
});
test('Detects pnpm-lock.yaml', () => {
    const pnpmLock = '/project/pnpm-lock.yaml';
    bundling_1.Bundling.bundle({
        entry: __filename,
        projectRoot,
        depsLockFilePath: pnpmLock,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        nodeModules: ['delay'],
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(pnpmLock), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: expect.arrayContaining([
                expect.stringMatching(/echo '' > "\/asset-output\/pnpm-workspace.yaml\".+pnpm-lock\.yaml.+pnpm install --config.node-linker=hoisted --config.package-import-method=clone-or-copy --no-prefer-frozen-lockfile && rm "\/asset-output\/node_modules\/.modules.yaml"/),
            ]),
        }),
    });
});
test('with Docker build args', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        buildArgs: {
            HELLO: 'WORLD',
        },
        forceDockerBundling: true,
    });
    expect(core_1.DockerImage.fromBuild).toHaveBeenCalledWith(expect.stringMatching(/lib$/), expect.objectContaining({
        buildArgs: expect.objectContaining({
            HELLO: 'WORLD',
        }),
    }));
});
test('Local bundling', () => {
    const spawnSyncMock = jest.spyOn(child_process, 'spawnSync').mockReturnValue({
        status: 0,
        stderr: Buffer.from('stderr'),
        stdout: Buffer.from('stdout'),
        pid: 123,
        output: ['stdout', 'stderr'],
        signal: null,
    });
    const bundler = new bundling_1.Bundling({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        environment: {
            KEY: 'value',
        },
        logLevel: types_1.LogLevel.ERROR,
    });
    expect(bundler.local).toBeDefined();
    const tryBundle = bundler.local?.tryBundle('/outdir', { image: aws_lambda_1.Runtime.NODEJS_14_X.bundlingDockerImage });
    expect(tryBundle).toBe(true);
    expect(spawnSyncMock).toHaveBeenCalledWith('bash', expect.arrayContaining(['-c', expect.stringContaining(entry)]), expect.objectContaining({
        env: expect.objectContaining({ KEY: 'value' }),
        cwd: '/project',
    }));
    // Docker image is not built
    expect(core_1.DockerImage.fromBuild).not.toHaveBeenCalled();
    spawnSyncMock.mockRestore();
});
test('Incorrect esbuild version', () => {
    detectPackageInstallationMock.mockReturnValueOnce({
        isLocal: true,
        version: '3.4.5',
    });
    const bundler = new bundling_1.Bundling({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
    });
    expect(() => bundler.local?.tryBundle('/outdir', {
        image: aws_lambda_1.Runtime.NODEJS_14_X.bundlingImage,
    })).toThrow(/Expected esbuild version 0.x but got 3.4.5/);
});
test('Custom bundling docker image', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        dockerImage: core_1.DockerImage.fromRegistry('my-custom-image'),
        forceDockerBundling: true,
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            image: { image: 'my-custom-image' },
        }),
    });
});
test('with command hooks', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        commandHooks: {
            beforeBundling(inputDir, outputDir) {
                return [
                    `echo hello > ${inputDir}/a.txt`,
                    `cp ${inputDir}/a.txt ${outputDir}`,
                ];
            },
            afterBundling(inputDir, outputDir) {
                return [`cp ${inputDir}/b.txt ${outputDir}/txt`];
            },
            beforeInstall() {
                return [];
            },
        },
        forceDockerBundling: true,
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                expect.stringMatching(/^echo hello > \/asset-input\/a.txt && cp \/asset-input\/a.txt \/asset-output && .+ && cp \/asset-input\/b.txt \/asset-output\/txt$/),
            ],
        }),
    });
});
test('esbuild bundling with projectRoot', () => {
    bundling_1.Bundling.bundle({
        entry: '/project/lib/index.ts',
        projectRoot: '/project',
        depsLockFilePath,
        tsconfig,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                'esbuild --bundle "/asset-input/lib/index.ts" --target=node14 --platform=node --outfile="/asset-output/index.js" --external:aws-sdk --tsconfig=/asset-input/lib/custom-tsconfig.ts',
            ],
        }),
    });
});
test('esbuild bundling with projectRoot and externals and dependencies', () => {
    const repoRoot = path.join(__dirname, '../../../..');
    const packageLock = path.join(repoRoot, 'common', 'package-lock.json');
    bundling_1.Bundling.bundle({
        entry: __filename,
        projectRoot: repoRoot,
        depsLockFilePath: packageLock,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        externalModules: ['abc'],
        nodeModules: ['delay'],
        forceDockerBundling: true,
    });
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(repoRoot, {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    'esbuild --bundle "/asset-input/packages/aws-cdk-lib/aws-lambda-nodejs/test/bundling.test.js" --target=node14 --platform=node --outfile="/asset-output/index.js" --external:abc --external:delay',
                    `echo \'{\"dependencies\":{\"delay\":\"${package_json_1.version}\"}}\' > "/asset-output/package.json"`,
                    'cp "/asset-input/common/package-lock.json" "/asset-output/package-lock.json"',
                    'cd "/asset-output"',
                    'npm ci',
                ].join(' && '),
            ],
        }),
    });
});
test('esbuild bundling with pre compilations', () => {
    const packageLock = path.join(__dirname, '..', 'package-lock.json');
    bundling_1.Bundling.bundle({
        entry: __filename.replace('.js', '.ts'),
        projectRoot: path.dirname(packageLock),
        depsLockFilePath: packageLock,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        preCompilation: true,
        forceDockerBundling: true,
        architecture: aws_lambda_1.Architecture.X86_64,
    });
    const compilerOptions = util.getTsconfigCompilerOptions(findParentTsConfigPath(__dirname));
    // Correctly bundles with esbuild
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(packageLock), {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            command: [
                'bash', '-c',
                [
                    `tsc \"/asset-input/test/bundling.test.ts\" ${compilerOptions} &&`,
                    'esbuild --bundle \"/asset-input/test/bundling.test.js\" --target=node14 --platform=node --outfile=\"/asset-output/index.js\" --external:aws-sdk',
                ].join(' '),
            ],
        }),
    });
    expect(detectPackageInstallationMock).toHaveBeenCalledWith('typescript');
});
test('throws with pre compilation and not found tsconfig', () => {
    expect(() => {
        bundling_1.Bundling.bundle({
            entry,
            projectRoot,
            depsLockFilePath,
            runtime: aws_lambda_1.Runtime.NODEJS_14_X,
            forceDockerBundling: true,
            preCompilation: true,
            architecture: aws_lambda_1.Architecture.X86_64,
        });
    }).toThrow('Cannot find a `tsconfig.json` but `preCompilation` is set to `true`, please specify it via `tsconfig`');
});
test('with custom hash', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        forceDockerBundling: true,
        assetHash: 'custom',
        architecture: aws_lambda_1.Architecture.X86_64,
    });
    // Correctly passes asset hash options
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith(path.dirname(depsLockFilePath), expect.objectContaining({
        assetHash: 'custom',
        assetHashType: core_1.AssetHashType.CUSTOM,
    }));
});
test('Custom bundling entrypoint', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        entrypoint: ['/cool/entrypoint', '--cool-entrypoint-arg'],
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            entrypoint: ['/cool/entrypoint', '--cool-entrypoint-arg'],
        }),
    });
});
test('Custom bundling volumes', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        volumes: [{ hostPath: '/host-path', containerPath: '/container-path' }],
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            volumes: [{ hostPath: '/host-path', containerPath: '/container-path' }],
        }),
    });
});
test('Custom bundling volumesFrom', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        volumesFrom: ['777f7dc92da7'],
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            volumesFrom: ['777f7dc92da7'],
        }),
    });
});
test('Custom bundling workingDirectory', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        workingDirectory: '/working-directory',
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            workingDirectory: '/working-directory',
        }),
    });
});
test('Custom bundling user', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        user: 'user:group',
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            user: 'user:group',
        }),
    });
});
test('Custom bundling securityOpt', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        securityOpt: 'no-new-privileges',
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            securityOpt: 'no-new-privileges',
        }),
    });
});
test('Custom bundling network', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        network: 'host',
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            network: 'host',
        }),
    });
});
test('Custom bundling file copy variant', () => {
    bundling_1.Bundling.bundle({
        entry,
        projectRoot,
        depsLockFilePath,
        runtime: aws_lambda_1.Runtime.NODEJS_14_X,
        architecture: aws_lambda_1.Architecture.X86_64,
        forceDockerBundling: true,
        bundlingFileAccess: core_1.BundlingFileAccess.VOLUME_COPY,
    });
    expect(aws_lambda_1.Code.fromAsset).toHaveBeenCalledWith('/project', {
        assetHashType: core_1.AssetHashType.OUTPUT,
        bundling: expect.objectContaining({
            bundlingFileAccess: core_1.BundlingFileAccess.VOLUME_COPY,
        }),
    });
});
function findParentTsConfigPath(dir, depth = 1, limit = 5) {
    const target = path.join(dir, 'tsconfig.json');
    if (fs.existsSync(target)) {
        return target;
    }
    else if (depth < limit) {
        return findParentTsConfigPath(path.join(dir, '..'), depth + 1, limit);
    }
    throw new Error(`No \`package.json\` file found within ${depth} parent directories`);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxpbmcudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImJ1bmRsaW5nLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQ0FBK0M7QUFDL0MseUJBQXlCO0FBQ3pCLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0IsaURBQThFO0FBQzlFLHFDQUE0RTtBQUM1RSxxREFBNkQ7QUFDN0QsOENBQTJDO0FBQzNDLHNFQUFrRTtBQUNsRSx3Q0FBOEU7QUFDOUUsb0NBQW9DO0FBR3BDLElBQUksNkJBQWdGLENBQUM7QUFDckYsVUFBVSxDQUFDLEdBQUcsRUFBRTtJQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUNyQixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDckIsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO0lBQ3ZCLG1CQUFRLENBQUMsNkJBQTZCLEVBQUUsQ0FBQztJQUN6QyxtQkFBUSxDQUFDLHlCQUF5QixFQUFFLENBQUM7SUFFckMsSUFBSSxDQUFDLEtBQUssQ0FBQyxpQkFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBRTlCLDZCQUE2QixHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsMENBQW1CLEVBQUUsUUFBUSxDQUFDLENBQUMsZUFBZSxDQUFDO1FBQ3hGLE9BQU8sRUFBRSxJQUFJO1FBQ2IsT0FBTyxFQUFFLE9BQU87S0FDakIsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBVyxFQUFFLFdBQVcsQ0FBQyxDQUFDLGVBQWUsQ0FBQztRQUNuRCxLQUFLLEVBQUUsYUFBYTtRQUNwQixFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsV0FBVztRQUNyQixHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUUsQ0FBQztRQUNiLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxhQUFhO0tBQzVCLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxXQUFXLEdBQUcsVUFBVSxDQUFD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Q2QsS0FBSztRQUNMLFdBQVc7UUFDWCxnQkFBZ0I7UUFDaEIsT0FBTyxFQUFFLG9CQUFPLENBQUMsV0FBVztRQUM1QixZQUFZLEVBQUUseUJBQVksQ0FBQyxNQUFNO1FBQ2pDLG1CQUFtQixFQUFFLElBQUk7UUFDekIsa0JBQWtCLEVBQUUseUJBQWtCLENBQUMsV0FBVztLQUNuRCxDQUFDLENBQUM7SUFFSCxNQUFNLENBQUMsaUJBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVLEVBQUU7UUFDdEQsYUFBYSxFQUFFLG9CQUFhLENBQUMsTUFBTTtRQUNuQyxRQUFRLEVBQUUsTUFBTSxDQUFDLGdCQUFnQixDQUFDO1lBQ2hDLGtCQUFrQixFQUFFLHlCQUFrQixDQUFDLFdBQVc7U0FDbkQsQ0FBQztLQUNILENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDO0FBRUgsU0FBUyxzQkFBc0IsQ0FBQyxHQUFXLEVBQUUsUUFBZ0IsQ0FBQyxFQUFFLFFBQWdCLENBQUM7SUFDL0UsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsZUFBZSxDQUFDLENBQUM7SUFDL0MsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQ3pCLE9BQU8sTUFBTSxDQUFDO0tBQ2Y7U0FBTSxJQUFJLEtBQUssR0FBRyxLQUFLLEVBQUU7UUFDeEIsT0FBTyxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxLQUFLLEdBQUcsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0tBQ3ZFO0lBRUQsTUFBTSxJQUFJLEtBQUssQ0FBQyx5Q0FBeUMsS0FBSyxxQkFBcUIsQ0FBQyxDQUFDO0FBQ3ZGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBjaGlsZF9wcm9jZXNzIGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IEFyY2hpdGVjdHVyZSwgQ29kZSwgUnVudGltZSwgUnVudGltZUZhbWlseSB9IGZyb20gJy4uLy4uL2F3cy1sYW1iZGEnO1xuaW1wb3J0IHsgQXNzZXRIYXNoVHlwZSwgQnVuZGxpbmdGaWxlQWNjZXNzLCBEb2NrZXJJbWFnZSB9IGZyb20gJy4uLy4uL2NvcmUnO1xuaW1wb3J0IHsgdmVyc2lvbiBhcyBkZWxheVZlcnNpb24gfSBmcm9tICdkZWxheS9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgQnVuZGxpbmcgfSBmcm9tICcuLi9saWIvYnVuZGxpbmcnO1xuaW1wb3J0IHsgUGFja2FnZUluc3RhbGxhdGlvbiB9IGZyb20gJy4uL2xpYi9wYWNrYWdlLWluc3RhbGxhdGlvbic7XG5pbXBvcnQgeyBDaGFyc2V0LCBMb2dMZXZlbCwgT3V0cHV0Rm9ybWF0LCBTb3VyY2VNYXBNb2RlIH0gZnJvbSAnLi4vbGliL3R5cGVzJztcbmltcG9ydCAqIGFzIHV0aWwgZnJvbSAnLi4vbGliL3V0aWwnO1xuXG5cbmxldCBkZXRlY3RQYWNrYWdlSW5zdGFsbGF0aW9uTW9jazogamVzdC5TcHlJbnN0YW5jZTxQYWNrYWdlSW5zdGFsbGF0aW9uIHwgdW5kZWZpbmVkPjtcbmJlZm9yZUVhY2goKCkgPT4ge1xuICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgamVzdC5yZXNldEFsbE1vY2tzKCk7XG4gIGplc3QucmVzdG9yZUFsbE1vY2tzKCk7XG4gIEJ1bmRsaW5nLmNsZWFyRXNidWlsZEluc3RhbGxhdGlvbkNhY2hlKCk7XG4gIEJ1bmRsaW5nLmNsZWFyVHNjSW5zdGFsbGF0aW9uQ2FjaGUoKTtcblxuICBqZXN0LnNweU9uKENvZGUsICdmcm9tQXNzZXQnKTtcblxuICBkZXRlY3RQYWNrYWdlSW5zdGFsbGF0aW9uTW9jayA9IGplc3Quc3B5T24oUGFja2FnZUluc3RhbGxhdGlvbiwgJ2RldGVjdCcpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgaXNMb2NhbDogdHJ1ZSxcbiAgICB2ZXJzaW9uOiAnMC44LjgnLFxuICB9KTtcblxuICBqZXN0LnNweU9uKERvY2tlckltYWdlLCAnZnJvbUJ1aWxkJykubW9ja1JldHVyblZhbHVlKHtcbiAgICBpbWFnZTogJ2J1aWx0LWltYWdlJyxcbiAgICBjcDogKCkgPT4gJ2Rlc3QtcGF0aCcsXG4gICAgcnVuOiAoKSA9PiB7fSxcbiAgICB0b0pTT046ICgpID0+ICdidWlsdC1pbWFnZScsXG4gIH0pO1xufSk7XG5cbmxldCBwcm9qZWN0Um9vdCA9ICcvcHJvamVjdCc7XG5sZXQgZGVwc0xvY2tGaWxlUGF0aCA9ICcvcHJvamVjdC95YXJuLmxvY2snO1xubGV0IGVudHJ5ID0gJy9wcm9qZWN0L2xpYi9oYW5kbGVyLnRzJztcbmxldCB0c2NvbmZpZyA9ICcvcHJvamVjdC9saWIvY3VzdG9tLXRzY29uZmlnLnRzJztcblxudGVzdCgnZXNidWlsZCBidW5kbGluZyBpbiBEb2NrZXInLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBlbnZpcm9ubWVudDoge1xuICAgICAgS0VZOiAndmFsdWUnLFxuICAgIH0sXG4gICAgbG9hZGVyOiB7XG4gICAgICAnLnBuZyc6ICdkYXRhdXJsJyxcbiAgICB9LFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZShkZXBzTG9ja0ZpbGVQYXRoKSwge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBlbnZpcm9ubWVudDoge1xuICAgICAgICBLRVk6ICd2YWx1ZScsXG4gICAgICB9LFxuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgICdlc2J1aWxkIC0tYnVuZGxlIFwiL2Fzc2V0LWlucHV0L2xpYi9oYW5kbGVyLnRzXCIgLS10YXJnZXQ9bm9kZTE0IC0tcGxhdGZvcm09bm9kZSAtLW91dGZpbGU9XCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXCIgLS1leHRlcm5hbDphd3Mtc2RrIC0tbG9hZGVyOi5wbmc9ZGF0YXVybCcsXG4gICAgICBdLFxuICAgICAgd29ya2luZ0RpcmVjdG9yeTogJy8nLFxuICAgIH0pLFxuICB9KTtcblxuICBleHBlY3QoRG9ja2VySW1hZ2UuZnJvbUJ1aWxkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Quc3RyaW5nTWF0Y2hpbmcoL2F3cy1sYW1iZGEtbm9kZWpzXFwvbGliJC8pLCBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgYnVpbGRBcmdzOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBJTUFHRTogZXhwZWN0LnN0cmluZ01hdGNoaW5nKC9idWlsZC1ub2RlanMvKSxcbiAgICB9KSxcbiAgICBwbGF0Zm9ybTogJ2xpbnV4L2FtZDY0JyxcbiAgfSkpO1xufSk7XG5cbnRlc3QoJ2VzYnVpbGQgYnVuZGxpbmcgd2l0aCBoYW5kbGVyIG5hbWVkIGluZGV4LnRzJywgKCkgPT4ge1xuICBCdW5kbGluZy5idW5kbGUoe1xuICAgIGVudHJ5OiAnL3Byb2plY3QvbGliL2luZGV4LnRzJyxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcHJvamVjdCcsIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgICdlc2J1aWxkIC0tYnVuZGxlIFwiL2Fzc2V0LWlucHV0L2xpYi9pbmRleC50c1wiIC0tdGFyZ2V0PW5vZGUxNCAtLXBsYXRmb3JtPW5vZGUgLS1vdXRmaWxlPVwiL2Fzc2V0LW91dHB1dC9pbmRleC5qc1wiIC0tZXh0ZXJuYWw6YXdzLXNkaycsXG4gICAgICBdLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdlc2J1aWxkIGJ1bmRsaW5nIHdpdGggdHN4IGhhbmRsZXInLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnk6ICcvcHJvamVjdC9saWIvaGFuZGxlci50c3gnLFxuICAgIHByb2plY3RSb290LFxuICAgIGRlcHNMb2NrRmlsZVBhdGgsXG4gICAgcnVudGltZTogUnVudGltZS5OT0RFSlNfMTRfWCxcbiAgICBhcmNoaXRlY3R1cmU6IEFyY2hpdGVjdHVyZS5YODZfNjQsXG4gICAgZm9yY2VEb2NrZXJCdW5kbGluZzogdHJ1ZSxcbiAgfSk7XG5cbiAgLy8gQ29ycmVjdGx5IGJ1bmRsZXMgd2l0aCBlc2J1aWxkXG4gIGV4cGVjdChDb2RlLmZyb21Bc3NldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9wcm9qZWN0Jywge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBjb21tYW5kOiBbXG4gICAgICAgICdiYXNoJywgJy1jJyxcbiAgICAgICAgJ2VzYnVpbGQgLS1idW5kbGUgXCIvYXNzZXQtaW5wdXQvbGliL2hhbmRsZXIudHN4XCIgLS10YXJnZXQ9bm9kZTE0IC0tcGxhdGZvcm09bm9kZSAtLW91dGZpbGU9XCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXCIgLS1leHRlcm5hbDphd3Mtc2RrJyxcbiAgICAgIF0sXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ2VzYnVpbGQgd2l0aCBXaW5kb3dzIHBhdGhzJywgKCkgPT4ge1xuICBjb25zdCBvc1BsYXRmb3JtTW9jayA9IGplc3Quc3B5T24ob3MsICdwbGF0Zm9ybScpLm1vY2tSZXR1cm5WYWx1ZSgnd2luMzInKTtcbiAgLy8gTW9jayBwYXRoLmJhc2VuYW1lKCkgYmVjYXVzZSBpdCBjYW5ub3QgZXh0cmFjdCB0aGUgYmFzZW5hbWUgb2YgYSBXaW5kb3dzXG4gIC8vIHBhdGggd2hlbiBydW5uaW5nIG9uIExpbnV4XG4gIGplc3Quc3B5T24ocGF0aCwgJ2Jhc2VuYW1lJykubW9ja1JldHVyblZhbHVlT25jZSgncGFja2FnZS1sb2NrLmpzb24nKTtcbiAgamVzdC5zcHlPbihwYXRoLCAncmVsYXRpdmUnKS5tb2NrUmV0dXJuVmFsdWVPbmNlKCdsaWJcXFxcZW50cnkudHMnKS5tb2NrUmV0dXJuVmFsdWVPbmNlKCdwYWNrYWdlLWxvY2suanNvbicpO1xuXG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnk6ICdDOlxcXFxteS1wcm9qZWN0XFxcXGxpYlxcXFxlbnRyeS50cycsXG4gICAgcnVudGltZTogUnVudGltZS5OT0RFSlNfMTRfWCxcbiAgICBhcmNoaXRlY3R1cmU6IEFyY2hpdGVjdHVyZS5YODZfNjQsXG4gICAgcHJvamVjdFJvb3Q6ICdDOlxcXFxteS1wcm9qZWN0JyxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoOiAnQzpcXFxcbXktcHJvamVjdFxcXFxwYWNrYWdlLWxvY2suanNvbicsXG4gICAgZm9yY2VEb2NrZXJCdW5kbGluZzogdHJ1ZSxcbiAgfSk7XG5cbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3QuYW55KFN0cmluZyksIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgIGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCcvbGliL2VudHJ5LnRzJyksXG4gICAgICBdKSxcbiAgICB9KSxcbiAgfSkpO1xuXG4gIG9zUGxhdGZvcm1Nb2NrLm1vY2tSZXN0b3JlKCk7XG59KTtcblxudGVzdCgnZXNidWlsZCBidW5kbGluZyB3aXRoIGV4dGVybmFscyBhbmQgZGVwZW5kZW5jaWVzJywgKCkgPT4ge1xuICBjb25zdCBwYWNrYWdlTG9jayA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICdwYWNrYWdlLWxvY2suanNvbicpO1xuICBCdW5kbGluZy5idW5kbGUoe1xuICAgIGVudHJ5OiBfX2ZpbGVuYW1lLFxuICAgIHByb2plY3RSb290OiBwYXRoLmRpcm5hbWUocGFja2FnZUxvY2spLFxuICAgIGRlcHNMb2NrRmlsZVBhdGg6IHBhY2thZ2VMb2NrLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGV4dGVybmFsTW9kdWxlczogWydhYmMnXSxcbiAgICBub2RlTW9kdWxlczogWydkZWxheSddLFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZShwYWNrYWdlTG9jayksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgIFtcbiAgICAgICAgICAnZXNidWlsZCAtLWJ1bmRsZSBcIi9hc3NldC1pbnB1dC90ZXN0L2J1bmRsaW5nLnRlc3QuanNcIiAtLXRhcmdldD1ub2RlMTQgLS1wbGF0Zm9ybT1ub2RlIC0tb3V0ZmlsZT1cIi9hc3NldC1vdXRwdXQvaW5kZXguanNcIiAtLWV4dGVybmFsOmFiYyAtLWV4dGVybmFsOmRlbGF5JyxcbiAgICAgICAgICBgZWNobyBcXCd7XFxcImRlcGVuZGVuY2llc1xcXCI6e1xcXCJkZWxheVxcXCI6XFxcIiR7ZGVsYXlWZXJzaW9ufVxcXCJ9fVxcJyA+IFwiL2Fzc2V0LW91dHB1dC9wYWNrYWdlLmpzb25cImAsXG4gICAgICAgICAgJ2NwIFwiL2Fzc2V0LWlucHV0L3BhY2thZ2UtbG9jay5qc29uXCIgXCIvYXNzZXQtb3V0cHV0L3BhY2thZ2UtbG9jay5qc29uXCInLFxuICAgICAgICAgICdjZCBcIi9hc3NldC1vdXRwdXRcIicsXG4gICAgICAgICAgJ25wbSBjaScsXG4gICAgICAgIF0uam9pbignICYmICcpLFxuICAgICAgXSxcbiAgICB9KSxcbiAgfSk7XG59KTtcblxudGVzdCgnZXNidWlsZCBidW5kbGluZyB3aXRoIGVzYnVpbGQgb3B0aW9ucycsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIG1pbmlmeTogdHJ1ZSxcbiAgICBzb3VyY2VNYXA6IHRydWUsXG4gICAgc291cmNlc0NvbnRlbnQ6IGZhbHNlLFxuICAgIHRhcmdldDogJ2VzMjAyMCcsXG4gICAgbG9hZGVyOiB7XG4gICAgICAnLnBuZyc6ICdkYXRhdXJsJyxcbiAgICB9LFxuICAgIGxvZ0xldmVsOiBMb2dMZXZlbC5TSUxFTlQsXG4gICAga2VlcE5hbWVzOiB0cnVlLFxuICAgIHRzY29uZmlnLFxuICAgIG1ldGFmaWxlOiB0cnVlLFxuICAgIGJhbm5lcjogJy8qIGNvbW1lbnRzICovJyxcbiAgICBmb290ZXI6ICcvKiBjb21tZW50cyAqLycsXG4gICAgY2hhcnNldDogQ2hhcnNldC5VVEY4LFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gICAgbWFpbkZpZWxkczogWydtb2R1bGUnLCAnbWFpbiddLFxuICAgIGRlZmluZToge1xuICAgICAgJ3Byb2Nlc3MuZW52LktFWSc6IEpTT04uc3RyaW5naWZ5KCdWQUxVRScpLFxuICAgICAgJ3Byb2Nlc3MuZW52LkJPT0wnOiAndHJ1ZScsXG4gICAgICAncHJvY2Vzcy5lbnYuTlVNQkVSJzogJzc3NzcnLFxuICAgICAgJ3Byb2Nlc3MuZW52LlNUUklORyc6IEpTT04uc3RyaW5naWZ5KCd0aGlzIGlzIGEgXCJ0ZXN0XCInKSxcbiAgICB9LFxuICAgIGZvcm1hdDogT3V0cHV0Rm9ybWF0LkVTTSxcbiAgICBpbmplY3Q6IFsnLi9teS1zaGltLmpzJ10sXG4gICAgZXNidWlsZEFyZ3M6IHtcbiAgICAgICctLWxvZy1saW1pdCc6ICcwJyxcbiAgICAgICctLXJlc29sdmUtZXh0ZW5zaW9ucyc6ICcudHMsLmpzJyxcbiAgICAgICctLXNwbGl0dGluZyc6IHRydWUsXG4gICAgICAnLS1rZWVwLW5hbWVzJzogJycsXG4gICAgfSxcbiAgfSk7XG5cbiAgLy8gQ29ycmVjdGx5IGJ1bmRsZXMgd2l0aCBlc2J1aWxkXG4gIGNvbnN0IGRlZmluZUluc3RydWN0aW9ucyA9ICctLWRlZmluZTpwcm9jZXNzLmVudi5LRVk9XCJcXFxcXCJWQUxVRVxcXFxcIlwiIC0tZGVmaW5lOnByb2Nlc3MuZW52LkJPT0w9XCJ0cnVlXCIgLS1kZWZpbmU6cHJvY2Vzcy5lbnYuTlVNQkVSPVwiNzc3N1wiIC0tZGVmaW5lOnByb2Nlc3MuZW52LlNUUklORz1cIlxcXFxcInRoaXMgaXMgYSBcXFxcXFxcXFxcXFxcInRlc3RcXFxcXFxcXFxcXFxcIlxcXFxcIlwiJztcbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXRoLmRpcm5hbWUoZGVwc0xvY2tGaWxlUGF0aCksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsXG4gICAgICAgICctYycsXG4gICAgICAgIFtcbiAgICAgICAgICAnZXNidWlsZCAtLWJ1bmRsZSBcIi9hc3NldC1pbnB1dC9saWIvaGFuZGxlci50c1wiJyxcbiAgICAgICAgICAnLS10YXJnZXQ9ZXMyMDIwIC0tcGxhdGZvcm09bm9kZSAtLWZvcm1hdD1lc20gLS1vdXRmaWxlPVwiL2Fzc2V0LW91dHB1dC9pbmRleC5tanNcIicsXG4gICAgICAgICAgJy0tbWluaWZ5IC0tc291cmNlbWFwIC0tc291cmNlcy1jb250ZW50PWZhbHNlIC0tZXh0ZXJuYWw6YXdzLXNkayAtLWxvYWRlcjoucG5nPWRhdGF1cmwnLFxuICAgICAgICAgIGRlZmluZUluc3RydWN0aW9ucyxcbiAgICAgICAgICAnLS1sb2ctbGV2ZWw9c2lsZW50IC0ta2VlcC1uYW1lcyAtLXRzY29uZmlnPS9hc3NldC1pbnB1dC9saWIvY3VzdG9tLXRzY29uZmlnLnRzJyxcbiAgICAgICAgICAnLS1tZXRhZmlsZT0vYXNzZXQtb3V0cHV0L2luZGV4Lm1ldGEuanNvbiAtLWJhbm5lcjpqcz1cIi8qIGNvbW1lbnRzICovXCIgLS1mb290ZXI6anM9XCIvKiBjb21tZW50cyAqL1wiJyxcbiAgICAgICAgICAnLS1jaGFyc2V0PXV0ZjggLS1tYWluLWZpZWxkcz1tb2R1bGUsbWFpbiAtLWluamVjdDouL215LXNoaW0uanMnLFxuICAgICAgICAgICctLWxvZy1saW1pdD1cIjBcIiAtLXJlc29sdmUtZXh0ZW5zaW9ucz1cIi50cywuanNcIiAtLXNwbGl0dGluZyAtLWtlZXAtbmFtZXMnLFxuICAgICAgICBdLmpvaW4oJyAnKSxcbiAgICAgIF0sXG4gICAgfSksXG4gIH0pO1xuXG4gIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBkZWZpbmUgaW5zdHJ1Y3Rpb25zIGFyZSB3b3JraW5nIGFzIGV4cGVjdGVkIHdpdGggdGhlIGVzYnVpbGQgQ0xJXG4gIGNvbnN0IGJ1bmRsZVByb2Nlc3MgPSB1dGlsLmV4ZWMoJ2Jhc2gnLCBbJy1jJywgYG5weCBlc2J1aWxkIC0tYnVuZGxlICR7YCR7X19kaXJuYW1lfS9pbnRlZy1oYW5kbGVycy9kZWZpbmUudHNgfSAke2RlZmluZUluc3RydWN0aW9uc31gXSk7XG4gIGV4cGVjdChidW5kbGVQcm9jZXNzLnN0ZG91dC50b1N0cmluZygpKS50b01hdGNoU25hcHNob3QoKTtcbn0pO1xuXG50ZXN0KCd0aHJvd3Mgd2l0aCBFU00gYW5kIE5PREVKU18xMl9YJywgKCkgPT4ge1xuICBleHBlY3QoKCkgPT4gQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzEyX1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGZvcm1hdDogT3V0cHV0Rm9ybWF0LkVTTSxcbiAgfSkpLnRvVGhyb3coL0VDTUFTY3JpcHQgbW9kdWxlIG91dHB1dCBmb3JtYXQgaXMgbm90IHN1cHBvcnRlZCBieSB0aGUgbm9kZWpzMTIueCBydW50aW1lLyk7XG59KTtcblxudGVzdCgnZXNidWlsZCBidW5kbGluZyBzb3VyY2UgbWFwIGRlZmF1bHQnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBzb3VyY2VNYXA6IHRydWUsXG4gICAgc291cmNlTWFwTW9kZTogU291cmNlTWFwTW9kZS5ERUZBVUxULFxuICB9KTtcblxuICAvLyBDb3JyZWN0bHkgYnVuZGxlcyB3aXRoIGVzYnVpbGRcbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXRoLmRpcm5hbWUoZGVwc0xvY2tGaWxlUGF0aCksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgIFtcbiAgICAgICAgICAnZXNidWlsZCAtLWJ1bmRsZSBcIi9hc3NldC1pbnB1dC9saWIvaGFuZGxlci50c1wiIC0tdGFyZ2V0PW5vZGUxNCAtLXBsYXRmb3JtPW5vZGUgLS1vdXRmaWxlPVwiL2Fzc2V0LW91dHB1dC9pbmRleC5qc1wiJyxcbiAgICAgICAgICAnLS1zb3VyY2VtYXAgLS1leHRlcm5hbDphd3Mtc2RrJyxcbiAgICAgICAgXS5qb2luKCcgJyksXG4gICAgICBdLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdlc2J1aWxkIGJ1bmRsaW5nIHdpdGhvdXQgYXdzLXNkayB2MyB3aGVuIHVzZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgUnVudGltZS5OT0RFSlNfMThfWCcsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE4X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICB9KTtcblxuICAvLyBDb3JyZWN0bHkgYnVuZGxlcyB3aXRoIGVzYnVpbGRcbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXRoLmRpcm5hbWUoZGVwc0xvY2tGaWxlUGF0aCksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgICdlc2J1aWxkIC0tYnVuZGxlIFwiL2Fzc2V0LWlucHV0L2xpYi9oYW5kbGVyLnRzXCIgLS10YXJnZXQ9bm9kZTE4IC0tcGxhdGZvcm09bm9kZSAtLW91dGZpbGU9XCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXCIgLS1leHRlcm5hbDpAYXdzLXNkay8qJyxcbiAgICAgIF0sXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ2VzYnVpbGQgYnVuZGxpbmcgc291cmNlIG1hcCBpbmxpbmUnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBzb3VyY2VNYXA6IHRydWUsXG4gICAgc291cmNlTWFwTW9kZTogU291cmNlTWFwTW9kZS5JTkxJTkUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZShkZXBzTG9ja0ZpbGVQYXRoKSwge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBjb21tYW5kOiBbXG4gICAgICAgICdiYXNoJywgJy1jJyxcbiAgICAgICAgW1xuICAgICAgICAgICdlc2J1aWxkIC0tYnVuZGxlIFwiL2Fzc2V0LWlucHV0L2xpYi9oYW5kbGVyLnRzXCIgLS10YXJnZXQ9bm9kZTE0IC0tcGxhdGZvcm09bm9kZSAtLW91dGZpbGU9XCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXCInLFxuICAgICAgICAgICctLXNvdXJjZW1hcD1pbmxpbmUgLS1leHRlcm5hbDphd3Mtc2RrJyxcbiAgICAgICAgXS5qb2luKCcgJyksXG4gICAgICBdLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdlc2J1aWxkIGJ1bmRsaW5nIGlzIGNvcnJlY3RseSBkb25lIHdpdGggY3VzdG9tIHJ1bnRpbWUgbWF0Y2hpbmcgcHJlZGVmaW5lZCBydW50aW1lJywgKCkgPT4ge1xuICBCdW5kbGluZy5idW5kbGUoe1xuICAgIGVudHJ5LFxuICAgIHByb2plY3RSb290LFxuICAgIGRlcHNMb2NrRmlsZVBhdGgsXG4gICAgcnVudGltZTogbmV3IFJ1bnRpbWUoJ25vZGVqczE0LngnLCBSdW50aW1lRmFtaWx5Lk5PREVKUywgeyBzdXBwb3J0c0lubGluZUNvZGU6IHRydWUgfSksXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIHNvdXJjZU1hcE1vZGU6IFNvdXJjZU1hcE1vZGUuSU5MSU5FLFxuICB9KTtcblxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZShkZXBzTG9ja0ZpbGVQYXRoKSwge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBjb21tYW5kOiBbXG4gICAgICAgICdiYXNoJywgJy1jJyxcbiAgICAgICAgW1xuICAgICAgICAgICdlc2J1aWxkIC0tYnVuZGxlIFwiL2Fzc2V0LWlucHV0L2xpYi9oYW5kbGVyLnRzXCIgLS10YXJnZXQ9bm9kZTE0IC0tcGxhdGZvcm09bm9kZSAtLW91dGZpbGU9XCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXCInLFxuICAgICAgICAgICctLXNvdXJjZW1hcD1pbmxpbmUgLS1leHRlcm5hbDphd3Mtc2RrJyxcbiAgICAgICAgXS5qb2luKCcgJyksXG4gICAgICBdLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdlc2J1aWxkIGJ1bmRsaW5nIHNvdXJjZSBtYXAgZW5hYmxlZCB3aGVuIG9ubHkgc291cmNlIG1hcCBtb2RlIGV4aXN0cycsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIHNvdXJjZU1hcE1vZGU6IFNvdXJjZU1hcE1vZGUuSU5MSU5FLFxuICB9KTtcblxuICAvLyBDb3JyZWN0bHkgYnVuZGxlcyB3aXRoIGVzYnVpbGRcbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXRoLmRpcm5hbWUoZGVwc0xvY2tGaWxlUGF0aCksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgIFtcbiAgICAgICAgICAnZXNidWlsZCAtLWJ1bmRsZSBcIi9hc3NldC1pbnB1dC9saWIvaGFuZGxlci50c1wiIC0tdGFyZ2V0PW5vZGUxNCAtLXBsYXRmb3JtPW5vZGUgLS1vdXRmaWxlPVwiL2Fzc2V0LW91dHB1dC9pbmRleC5qc1wiJyxcbiAgICAgICAgICAnLS1zb3VyY2VtYXA9aW5saW5lIC0tZXh0ZXJuYWw6YXdzLXNkaycsXG4gICAgICAgIF0uam9pbignICcpLFxuICAgICAgXSxcbiAgICB9KSxcbiAgfSk7XG59KTtcblxudGVzdCgnZXNidWlsZCBidW5kbGluZyB0aHJvd3Mgd2hlbiBzb3VyY2VNYXBNb2RlIHVzZWQgd2l0aCBmYWxzZSBzb3VyY2VNYXAnLCAoKSA9PiB7XG4gIGV4cGVjdCgoKSA9PiB7XG4gICAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICAgIGVudHJ5LFxuICAgICAgcHJvamVjdFJvb3QsXG4gICAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgICAgcnVudGltZTogUnVudGltZS5OT0RFSlNfMTRfWCxcbiAgICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICAgIHNvdXJjZU1hcDogZmFsc2UsXG4gICAgICBzb3VyY2VNYXBNb2RlOiBTb3VyY2VNYXBNb2RlLklOTElORSxcbiAgICB9KTtcbiAgfSkudG9UaHJvdygnc291cmNlTWFwTW9kZSBjYW5ub3QgYmUgdXNlZCB3aGVuIHNvdXJjZU1hcCBpcyBmYWxzZScpO1xufSk7XG5cbnRlc3QoJ0RldGVjdHMgeWFybi5sb2NrJywgKCkgPT4ge1xuICBjb25zdCB5YXJuTG9jayA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICd5YXJuLmxvY2snKTtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeTogX19maWxlbmFtZSxcbiAgICBwcm9qZWN0Um9vdDogcGF0aC5kaXJuYW1lKHlhcm5Mb2NrKSxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoOiB5YXJuTG9jayxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBub2RlTW9kdWxlczogWydkZWxheSddLFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZSh5YXJuTG9jayksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgIGV4cGVjdC5zdHJpbmdNYXRjaGluZygveWFyblxcLmxvY2suK3lhcm4gaW5zdGFsbCAtLW5vLWltbXV0YWJsZS8pLFxuICAgICAgXSksXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ0RldGVjdHMgcG5wbS1sb2NrLnlhbWwnLCAoKSA9PiB7XG4gIGNvbnN0IHBucG1Mb2NrID0gJy9wcm9qZWN0L3BucG0tbG9jay55YW1sJztcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeTogX19maWxlbmFtZSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoOiBwbnBtTG9jayxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBub2RlTW9kdWxlczogWydkZWxheSddLFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZShwbnBtTG9jayksIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogZXhwZWN0LmFycmF5Q29udGFpbmluZyhbXG4gICAgICAgIGV4cGVjdC5zdHJpbmdNYXRjaGluZygvZWNobyAnJyA+IFwiXFwvYXNzZXQtb3V0cHV0XFwvcG5wbS13b3Jrc3BhY2UueWFtbFxcXCIuK3BucG0tbG9ja1xcLnlhbWwuK3BucG0gaW5zdGFsbCAtLWNvbmZpZy5ub2RlLWxpbmtlcj1ob2lzdGVkIC0tY29uZmlnLnBhY2thZ2UtaW1wb3J0LW1ldGhvZD1jbG9uZS1vci1jb3B5IC0tbm8tcHJlZmVyLWZyb3plbi1sb2NrZmlsZSAmJiBybSBcIlxcL2Fzc2V0LW91dHB1dFxcL25vZGVfbW9kdWxlc1xcLy5tb2R1bGVzLnlhbWxcIi8pLFxuICAgICAgXSksXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ3dpdGggRG9ja2VyIGJ1aWxkIGFyZ3MnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBidWlsZEFyZ3M6IHtcbiAgICAgIEhFTExPOiAnV09STEQnLFxuICAgIH0sXG4gICAgZm9yY2VEb2NrZXJCdW5kbGluZzogdHJ1ZSxcbiAgfSk7XG5cbiAgZXhwZWN0KERvY2tlckltYWdlLmZyb21CdWlsZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0LnN0cmluZ01hdGNoaW5nKC9saWIkLyksIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICBidWlsZEFyZ3M6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgIEhFTExPOiAnV09STEQnLFxuICAgIH0pLFxuICB9KSk7XG59KTtcblxudGVzdCgnTG9jYWwgYnVuZGxpbmcnLCAoKSA9PiB7XG4gIGNvbnN0IHNwYXduU3luY01vY2sgPSBqZXN0LnNweU9uKGNoaWxkX3Byb2Nlc3MsICdzcGF3blN5bmMnKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgIHN0YXR1czogMCxcbiAgICBzdGRlcnI6IEJ1ZmZlci5mcm9tKCdzdGRlcnInKSxcbiAgICBzdGRvdXQ6IEJ1ZmZlci5mcm9tKCdzdGRvdXQnKSxcbiAgICBwaWQ6IDEyMyxcbiAgICBvdXRwdXQ6IFsnc3Rkb3V0JywgJ3N0ZGVyciddLFxuICAgIHNpZ25hbDogbnVsbCxcbiAgfSk7XG5cbiAgY29uc3QgYnVuZGxlciA9IG5ldyBCdW5kbGluZyh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBlbnZpcm9ubWVudDoge1xuICAgICAgS0VZOiAndmFsdWUnLFxuICAgIH0sXG4gICAgbG9nTGV2ZWw6IExvZ0xldmVsLkVSUk9SLFxuICB9KTtcblxuICBleHBlY3QoYnVuZGxlci5sb2NhbCkudG9CZURlZmluZWQoKTtcblxuICBjb25zdCB0cnlCdW5kbGUgPSBidW5kbGVyLmxvY2FsPy50cnlCdW5kbGUoJy9vdXRkaXInLCB7IGltYWdlOiBSdW50aW1lLk5PREVKU18xNF9YLmJ1bmRsaW5nRG9ja2VySW1hZ2UgfSk7XG4gIGV4cGVjdCh0cnlCdW5kbGUpLnRvQmUodHJ1ZSk7XG5cbiAgZXhwZWN0KHNwYXduU3luY01vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICdiYXNoJyxcbiAgICBleHBlY3QuYXJyYXlDb250YWluaW5nKFsnLWMnLCBleHBlY3Quc3RyaW5nQ29udGFpbmluZyhlbnRyeSldKSxcbiAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBlbnY6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgS0VZOiAndmFsdWUnIH0pLFxuICAgICAgY3dkOiAnL3Byb2plY3QnLFxuICAgIH0pLFxuICApO1xuXG4gIC8vIERvY2tlciBpbWFnZSBpcyBub3QgYnVpbHRcbiAgZXhwZWN0KERvY2tlckltYWdlLmZyb21CdWlsZCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcblxuICBzcGF3blN5bmNNb2NrLm1vY2tSZXN0b3JlKCk7XG59KTtcblxuXG50ZXN0KCdJbmNvcnJlY3QgZXNidWlsZCB2ZXJzaW9uJywgKCkgPT4ge1xuICBkZXRlY3RQYWNrYWdlSW5zdGFsbGF0aW9uTW9jay5tb2NrUmV0dXJuVmFsdWVPbmNlKHtcbiAgICBpc0xvY2FsOiB0cnVlLFxuICAgIHZlcnNpb246ICczLjQuNScsXG4gIH0pO1xuXG4gIGNvbnN0IGJ1bmRsZXIgPSBuZXcgQnVuZGxpbmcoe1xuICAgIGVudHJ5LFxuICAgIHByb2plY3RSb290LFxuICAgIGRlcHNMb2NrRmlsZVBhdGgsXG4gICAgcnVudGltZTogUnVudGltZS5OT0RFSlNfMTRfWCxcbiAgICBhcmNoaXRlY3R1cmU6IEFyY2hpdGVjdHVyZS5YODZfNjQsXG4gIH0pO1xuXG4gIGV4cGVjdCgoKSA9PiBidW5kbGVyLmxvY2FsPy50cnlCdW5kbGUoJy9vdXRkaXInLCB7XG4gICAgaW1hZ2U6IFJ1bnRpbWUuTk9ERUpTXzE0X1guYnVuZGxpbmdJbWFnZSxcbiAgfSkpLnRvVGhyb3coL0V4cGVjdGVkIGVzYnVpbGQgdmVyc2lvbiAwLnggYnV0IGdvdCAzLjQuNS8pO1xufSk7XG5cbnRlc3QoJ0N1c3RvbSBidW5kbGluZyBkb2NrZXIgaW1hZ2UnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBkb2NrZXJJbWFnZTogRG9ja2VySW1hZ2UuZnJvbVJlZ2lzdHJ5KCdteS1jdXN0b20taW1hZ2UnKSxcbiAgICBmb3JjZURvY2tlckJ1bmRsaW5nOiB0cnVlLFxuICB9KTtcblxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcHJvamVjdCcsIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgaW1hZ2U6IHsgaW1hZ2U6ICdteS1jdXN0b20taW1hZ2UnIH0sXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ3dpdGggY29tbWFuZCBob29rcycsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGNvbW1hbmRIb29rczoge1xuICAgICAgYmVmb3JlQnVuZGxpbmcoaW5wdXREaXI6IHN0cmluZywgb3V0cHV0RGlyOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgYGVjaG8gaGVsbG8gPiAke2lucHV0RGlyfS9hLnR4dGAsXG4gICAgICAgICAgYGNwICR7aW5wdXREaXJ9L2EudHh0ICR7b3V0cHV0RGlyfWAsXG4gICAgICAgIF07XG4gICAgICB9LFxuICAgICAgYWZ0ZXJCdW5kbGluZyhpbnB1dERpcjogc3RyaW5nLCBvdXRwdXREaXI6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIFtgY3AgJHtpbnB1dERpcn0vYi50eHQgJHtvdXRwdXREaXJ9L3R4dGBdO1xuICAgICAgfSxcbiAgICAgIGJlZm9yZUluc3RhbGwoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH0sXG4gICAgfSxcbiAgICBmb3JjZURvY2tlckJ1bmRsaW5nOiB0cnVlLFxuICB9KTtcblxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHBhdGguZGlybmFtZShkZXBzTG9ja0ZpbGVQYXRoKSwge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBjb21tYW5kOiBbXG4gICAgICAgICdiYXNoJywgJy1jJyxcbiAgICAgICAgZXhwZWN0LnN0cmluZ01hdGNoaW5nKC9eZWNobyBoZWxsbyA+IFxcL2Fzc2V0LWlucHV0XFwvYS50eHQgJiYgY3AgXFwvYXNzZXQtaW5wdXRcXC9hLnR4dCBcXC9hc3NldC1vdXRwdXQgJiYgLisgJiYgY3AgXFwvYXNzZXQtaW5wdXRcXC9iLnR4dCBcXC9hc3NldC1vdXRwdXRcXC90eHQkLyksXG4gICAgICBdLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdlc2J1aWxkIGJ1bmRsaW5nIHdpdGggcHJvamVjdFJvb3QnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnk6ICcvcHJvamVjdC9saWIvaW5kZXgudHMnLFxuICAgIHByb2plY3RSb290OiAnL3Byb2plY3QnLFxuICAgIGRlcHNMb2NrRmlsZVBhdGgsXG4gICAgdHNjb25maWcsXG4gICAgcnVudGltZTogUnVudGltZS5OT0RFSlNfMTRfWCxcbiAgICBhcmNoaXRlY3R1cmU6IEFyY2hpdGVjdHVyZS5YODZfNjQsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcHJvamVjdCcsIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgY29tbWFuZDogW1xuICAgICAgICAnYmFzaCcsICctYycsXG4gICAgICAgICdlc2J1aWxkIC0tYnVuZGxlIFwiL2Fzc2V0LWlucHV0L2xpYi9pbmRleC50c1wiIC0tdGFyZ2V0PW5vZGUxNCAtLXBsYXRmb3JtPW5vZGUgLS1vdXRmaWxlPVwiL2Fzc2V0LW91dHB1dC9pbmRleC5qc1wiIC0tZXh0ZXJuYWw6YXdzLXNkayAtLXRzY29uZmlnPS9hc3NldC1pbnB1dC9saWIvY3VzdG9tLXRzY29uZmlnLnRzJyxcbiAgICAgIF0sXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ2VzYnVpbGQgYnVuZGxpbmcgd2l0aCBwcm9qZWN0Um9vdCBhbmQgZXh0ZXJuYWxzIGFuZCBkZXBlbmRlbmNpZXMnLCAoKSA9PiB7XG4gIGNvbnN0IHJlcG9Sb290ID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uLy4uLy4uJyk7XG4gIGNvbnN0IHBhY2thZ2VMb2NrID0gcGF0aC5qb2luKHJlcG9Sb290LCAnY29tbW9uJywgJ3BhY2thZ2UtbG9jay5qc29uJyk7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnk6IF9fZmlsZW5hbWUsXG4gICAgcHJvamVjdFJvb3Q6IHJlcG9Sb290LFxuICAgIGRlcHNMb2NrRmlsZVBhdGg6IHBhY2thZ2VMb2NrLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGV4dGVybmFsTW9kdWxlczogWydhYmMnXSxcbiAgICBub2RlTW9kdWxlczogWydkZWxheSddLFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gIH0pO1xuXG4gIC8vIENvcnJlY3RseSBidW5kbGVzIHdpdGggZXNidWlsZFxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHJlcG9Sb290LCB7XG4gICAgYXNzZXRIYXNoVHlwZTogQXNzZXRIYXNoVHlwZS5PVVRQVVQsXG4gICAgYnVuZGxpbmc6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgIGNvbW1hbmQ6IFtcbiAgICAgICAgJ2Jhc2gnLCAnLWMnLFxuICAgICAgICBbXG4gICAgICAgICAgJ2VzYnVpbGQgLS1idW5kbGUgXCIvYXNzZXQtaW5wdXQvcGFja2FnZXMvYXdzLWNkay1saWIvYXdzLWxhbWJkYS1ub2RlanMvdGVzdC9idW5kbGluZy50ZXN0LmpzXCIgLS10YXJnZXQ9bm9kZTE0IC0tcGxhdGZvcm09bm9kZSAtLW91dGZpbGU9XCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXCIgLS1leHRlcm5hbDphYmMgLS1leHRlcm5hbDpkZWxheScsXG4gICAgICAgICAgYGVjaG8gXFwne1xcXCJkZXBlbmRlbmNpZXNcXFwiOntcXFwiZGVsYXlcXFwiOlxcXCIke2RlbGF5VmVyc2lvbn1cXFwifX1cXCcgPiBcIi9hc3NldC1vdXRwdXQvcGFja2FnZS5qc29uXCJgLFxuICAgICAgICAgICdjcCBcIi9hc3NldC1pbnB1dC9jb21tb24vcGFja2FnZS1sb2NrLmpzb25cIiBcIi9hc3NldC1vdXRwdXQvcGFja2FnZS1sb2NrLmpzb25cIicsXG4gICAgICAgICAgJ2NkIFwiL2Fzc2V0LW91dHB1dFwiJyxcbiAgICAgICAgICAnbnBtIGNpJyxcbiAgICAgICAgXS5qb2luKCcgJiYgJyksXG4gICAgICBdLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdlc2J1aWxkIGJ1bmRsaW5nIHdpdGggcHJlIGNvbXBpbGF0aW9ucycsICgpID0+IHtcbiAgY29uc3QgcGFja2FnZUxvY2sgPSBwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4nLCAncGFja2FnZS1sb2NrLmpzb24nKTtcblxuICBCdW5kbGluZy5idW5kbGUoe1xuICAgIGVudHJ5OiBfX2ZpbGVuYW1lLnJlcGxhY2UoJy5qcycsICcudHMnKSxcbiAgICBwcm9qZWN0Um9vdDogcGF0aC5kaXJuYW1lKHBhY2thZ2VMb2NrKSxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoOiBwYWNrYWdlTG9jayxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIHByZUNvbXBpbGF0aW9uOiB0cnVlLFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICB9KTtcblxuICBjb25zdCBjb21waWxlck9wdGlvbnMgPSB1dGlsLmdldFRzY29uZmlnQ29tcGlsZXJPcHRpb25zKGZpbmRQYXJlbnRUc0NvbmZpZ1BhdGgoX19kaXJuYW1lKSk7XG5cbiAgLy8gQ29ycmVjdGx5IGJ1bmRsZXMgd2l0aCBlc2J1aWxkXG4gIGV4cGVjdChDb2RlLmZyb21Bc3NldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgocGF0aC5kaXJuYW1lKHBhY2thZ2VMb2NrKSwge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICBjb21tYW5kOiBbXG4gICAgICAgICdiYXNoJywgJy1jJyxcbiAgICAgICAgW1xuICAgICAgICAgIGB0c2MgXFxcIi9hc3NldC1pbnB1dC90ZXN0L2J1bmRsaW5nLnRlc3QudHNcXFwiICR7Y29tcGlsZXJPcHRpb25zfSAmJmAsXG4gICAgICAgICAgJ2VzYnVpbGQgLS1idW5kbGUgXFxcIi9hc3NldC1pbnB1dC90ZXN0L2J1bmRsaW5nLnRlc3QuanNcXFwiIC0tdGFyZ2V0PW5vZGUxNCAtLXBsYXRmb3JtPW5vZGUgLS1vdXRmaWxlPVxcXCIvYXNzZXQtb3V0cHV0L2luZGV4LmpzXFxcIiAtLWV4dGVybmFsOmF3cy1zZGsnLFxuICAgICAgICBdLmpvaW4oJyAnKSxcbiAgICAgIF0sXG4gICAgfSksXG4gIH0pO1xuXG4gIGV4cGVjdChkZXRlY3RQYWNrYWdlSW5zdGFsbGF0aW9uTW9jaykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ3R5cGVzY3JpcHQnKTtcbn0pO1xuXG50ZXN0KCd0aHJvd3Mgd2l0aCBwcmUgY29tcGlsYXRpb24gYW5kIG5vdCBmb3VuZCB0c2NvbmZpZycsICgpID0+IHtcbiAgZXhwZWN0KCgpID0+IHtcbiAgICBCdW5kbGluZy5idW5kbGUoe1xuICAgICAgZW50cnksXG4gICAgICBwcm9qZWN0Um9vdCxcbiAgICAgIGRlcHNMb2NrRmlsZVBhdGgsXG4gICAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgICAgZm9yY2VEb2NrZXJCdW5kbGluZzogdHJ1ZSxcbiAgICAgIHByZUNvbXBpbGF0aW9uOiB0cnVlLFxuICAgICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIH0pO1xuICB9KS50b1Rocm93KCdDYW5ub3QgZmluZCBhIGB0c2NvbmZpZy5qc29uYCBidXQgYHByZUNvbXBpbGF0aW9uYCBpcyBzZXQgdG8gYHRydWVgLCBwbGVhc2Ugc3BlY2lmeSBpdCB2aWEgYHRzY29uZmlnYCcpO1xuXG59KTtcblxudGVzdCgnd2l0aCBjdXN0b20gaGFzaCcsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgZm9yY2VEb2NrZXJCdW5kbGluZzogdHJ1ZSxcbiAgICBhc3NldEhhc2g6ICdjdXN0b20nLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgfSk7XG5cbiAgLy8gQ29ycmVjdGx5IHBhc3NlcyBhc3NldCBoYXNoIG9wdGlvbnNcbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXRoLmRpcm5hbWUoZGVwc0xvY2tGaWxlUGF0aCksIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICBhc3NldEhhc2g6ICdjdXN0b20nLFxuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuQ1VTVE9NLFxuICB9KSk7XG59KTtcblxudGVzdCgnQ3VzdG9tIGJ1bmRsaW5nIGVudHJ5cG9pbnQnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBmb3JjZURvY2tlckJ1bmRsaW5nOiB0cnVlLFxuICAgIGVudHJ5cG9pbnQ6IFsnL2Nvb2wvZW50cnlwb2ludCcsICctLWNvb2wtZW50cnlwb2ludC1hcmcnXSxcbiAgfSk7XG5cbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL3Byb2plY3QnLCB7XG4gICAgYXNzZXRIYXNoVHlwZTogQXNzZXRIYXNoVHlwZS5PVVRQVVQsXG4gICAgYnVuZGxpbmc6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgIGVudHJ5cG9pbnQ6IFsnL2Nvb2wvZW50cnlwb2ludCcsICctLWNvb2wtZW50cnlwb2ludC1hcmcnXSxcbiAgICB9KSxcbiAgfSk7XG59KTtcblxudGVzdCgnQ3VzdG9tIGJ1bmRsaW5nIHZvbHVtZXMnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBmb3JjZURvY2tlckJ1bmRsaW5nOiB0cnVlLFxuICAgIHZvbHVtZXM6IFt7IGhvc3RQYXRoOiAnL2hvc3QtcGF0aCcsIGNvbnRhaW5lclBhdGg6ICcvY29udGFpbmVyLXBhdGgnIH1dLFxuICB9KTtcblxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcHJvamVjdCcsIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgdm9sdW1lczogW3sgaG9zdFBhdGg6ICcvaG9zdC1wYXRoJywgY29udGFpbmVyUGF0aDogJy9jb250YWluZXItcGF0aCcgfV0sXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbnRlc3QoJ0N1c3RvbSBidW5kbGluZyB2b2x1bWVzRnJvbScsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gICAgdm9sdW1lc0Zyb206IFsnNzc3ZjdkYzkyZGE3J10sXG4gIH0pO1xuXG4gIGV4cGVjdChDb2RlLmZyb21Bc3NldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9wcm9qZWN0Jywge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICB2b2x1bWVzRnJvbTogWyc3NzdmN2RjOTJkYTcnXSxcbiAgICB9KSxcbiAgfSk7XG59KTtcblxuXG50ZXN0KCdDdXN0b20gYnVuZGxpbmcgd29ya2luZ0RpcmVjdG9yeScsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gICAgd29ya2luZ0RpcmVjdG9yeTogJy93b3JraW5nLWRpcmVjdG9yeScsXG4gIH0pO1xuXG4gIGV4cGVjdChDb2RlLmZyb21Bc3NldCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9wcm9qZWN0Jywge1xuICAgIGFzc2V0SGFzaFR5cGU6IEFzc2V0SGFzaFR5cGUuT1VUUFVULFxuICAgIGJ1bmRsaW5nOiBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICB3b3JraW5nRGlyZWN0b3J5OiAnL3dvcmtpbmctZGlyZWN0b3J5JyxcbiAgICB9KSxcbiAgfSk7XG59KTtcblxudGVzdCgnQ3VzdG9tIGJ1bmRsaW5nIHVzZXInLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBmb3JjZURvY2tlckJ1bmRsaW5nOiB0cnVlLFxuICAgIHVzZXI6ICd1c2VyOmdyb3VwJyxcbiAgfSk7XG5cbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL3Byb2plY3QnLCB7XG4gICAgYXNzZXRIYXNoVHlwZTogQXNzZXRIYXNoVHlwZS5PVVRQVVQsXG4gICAgYnVuZGxpbmc6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgIHVzZXI6ICd1c2VyOmdyb3VwJyxcbiAgICB9KSxcbiAgfSk7XG59KTtcblxudGVzdCgnQ3VzdG9tIGJ1bmRsaW5nIHNlY3VyaXR5T3B0JywgKCkgPT4ge1xuICBCdW5kbGluZy5idW5kbGUoe1xuICAgIGVudHJ5LFxuICAgIHByb2plY3RSb290LFxuICAgIGRlcHNMb2NrRmlsZVBhdGgsXG4gICAgcnVudGltZTogUnVudGltZS5OT0RFSlNfMTRfWCxcbiAgICBhcmNoaXRlY3R1cmU6IEFyY2hpdGVjdHVyZS5YODZfNjQsXG4gICAgZm9yY2VEb2NrZXJCdW5kbGluZzogdHJ1ZSxcbiAgICBzZWN1cml0eU9wdDogJ25vLW5ldy1wcml2aWxlZ2VzJyxcbiAgfSk7XG5cbiAgZXhwZWN0KENvZGUuZnJvbUFzc2V0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL3Byb2plY3QnLCB7XG4gICAgYXNzZXRIYXNoVHlwZTogQXNzZXRIYXNoVHlwZS5PVVRQVVQsXG4gICAgYnVuZGxpbmc6IGV4cGVjdC5vYmplY3RDb250YWluaW5nKHtcbiAgICAgIHNlY3VyaXR5T3B0OiAnbm8tbmV3LXByaXZpbGVnZXMnLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdDdXN0b20gYnVuZGxpbmcgbmV0d29yaycsICgpID0+IHtcbiAgQnVuZGxpbmcuYnVuZGxlKHtcbiAgICBlbnRyeSxcbiAgICBwcm9qZWN0Um9vdCxcbiAgICBkZXBzTG9ja0ZpbGVQYXRoLFxuICAgIHJ1bnRpbWU6IFJ1bnRpbWUuTk9ERUpTXzE0X1gsXG4gICAgYXJjaGl0ZWN0dXJlOiBBcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgIGZvcmNlRG9ja2VyQnVuZGxpbmc6IHRydWUsXG4gICAgbmV0d29yazogJ2hvc3QnLFxuICB9KTtcblxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcHJvamVjdCcsIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgbmV0d29yazogJ2hvc3QnLFxuICAgIH0pLFxuICB9KTtcbn0pO1xuXG50ZXN0KCdDdXN0b20gYnVuZGxpbmcgZmlsZSBjb3B5IHZhcmlhbnQnLCAoKSA9PiB7XG4gIEJ1bmRsaW5nLmJ1bmRsZSh7XG4gICAgZW50cnksXG4gICAgcHJvamVjdFJvb3QsXG4gICAgZGVwc0xvY2tGaWxlUGF0aCxcbiAgICBydW50aW1lOiBSdW50aW1lLk5PREVKU18xNF9YLFxuICAgIGFyY2hpdGVjdHVyZTogQXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgICBmb3JjZURvY2tlckJ1bmRsaW5nOiB0cnVlLFxuICAgIGJ1bmRsaW5nRmlsZUFjY2VzczogQnVuZGxpbmdGaWxlQWNjZXNzLlZPTFVNRV9DT1BZLFxuICB9KTtcblxuICBleHBlY3QoQ29kZS5mcm9tQXNzZXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvcHJvamVjdCcsIHtcbiAgICBhc3NldEhhc2hUeXBlOiBBc3NldEhhc2hUeXBlLk9VVFBVVCxcbiAgICBidW5kbGluZzogZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgYnVuZGxpbmdGaWxlQWNjZXNzOiBCdW5kbGluZ0ZpbGVBY2Nlc3MuVk9MVU1FX0NPUFksXG4gICAgfSksXG4gIH0pO1xufSk7XG5cbmZ1bmN0aW9uIGZpbmRQYXJlbnRUc0NvbmZpZ1BhdGgoZGlyOiBzdHJpbmcsIGRlcHRoOiBudW1iZXIgPSAxLCBsaW1pdDogbnVtYmVyID0gNSk6IHN0cmluZyB7XG4gIGNvbnN0IHRhcmdldCA9IHBhdGguam9pbihkaXIsICd0c2NvbmZpZy5qc29uJyk7XG4gIGlmIChmcy5leGlzdHNTeW5jKHRhcmdldCkpIHtcbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9IGVsc2UgaWYgKGRlcHRoIDwgbGltaXQpIHtcbiAgICByZXR1cm4gZmluZFBhcmVudFRzQ29uZmlnUGF0aChwYXRoLmpvaW4oZGlyLCAnLi4nKSwgZGVwdGggKyAxLCBsaW1pdCk7XG4gIH1cblxuICB0aHJvdyBuZXcgRXJyb3IoYE5vIFxcYHBhY2thZ2UuanNvblxcYCBmaWxlIGZvdW5kIHdpdGhpbiAke2RlcHRofSBwYXJlbnQgZGlyZWN0b3JpZXNgKTtcbn1cbiJdfQ==