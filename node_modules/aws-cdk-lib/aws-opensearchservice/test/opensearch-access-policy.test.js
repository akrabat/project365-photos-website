"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../assertions");
const iam = require("../../aws-iam");
const core_1 = require("../../core");
const opensearch_access_policy_1 = require("../lib/opensearch-access-policy");
let app;
let stack;
beforeEach(() => {
    app = new core_1.App();
    stack = new core_1.Stack(app, 'Stack', {
        env: { account: '1234', region: 'testregion' },
    });
});
test('minimal example renders correctly', () => {
    const domainArn = 'test:arn';
    new opensearch_access_policy_1.OpenSearchAccessPolicy(stack, 'OpenSearchAccessPolicy', {
        domainName: 'TestDomain',
        domainArn: domainArn,
        accessPolicies: [new iam.PolicyStatement({
                effect: iam.Effect.ALLOW,
                actions: ['es:ESHttp*'],
                principals: [new iam.AnyPrincipal()],
                resources: [domainArn],
            })],
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('Custom::OpenSearchAccessPolicy', {
        ServiceToken: {
            'Fn::GetAtt': [
                'AWS679f53fac002430cb0da5b7982bd22872D164C4C',
                'Arn',
            ],
        },
        Create: JSON.stringify({
            action: 'updateDomainConfig',
            service: 'OpenSearch',
            parameters: {
                DomainName: 'TestDomain',
                AccessPolicies: '{"Statement":[{"Action":"es:ESHttp*","Effect":"Allow","Principal":{"AWS":"*"},"Resource":"test:arn"}],"Version":"2012-10-17"}',
            },
            outputPaths: ['DomainConfig.AccessPolicies'],
            physicalResourceId: { id: 'TestDomainAccessPolicy' },
        }),
        Update: JSON.stringify({
            action: 'updateDomainConfig',
            service: 'OpenSearch',
            parameters: {
                DomainName: 'TestDomain',
                AccessPolicies: '{"Statement":[{"Action":"es:ESHttp*","Effect":"Allow","Principal":{"AWS":"*"},"Resource":"test:arn"}],"Version":"2012-10-17"}',
            },
            outputPaths: ['DomainConfig.AccessPolicies'],
            physicalResourceId: { id: 'TestDomainAccessPolicy' },
        }),
    });
    assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
        PolicyDocument: {
            Statement: [{
                    Action: 'es:UpdateDomainConfig',
                    Effect: 'Allow',
                    Resource: domainArn,
                }],
        },
    });
});
test('support access policy added inline and later', () => {
    const opensearchAccessPolicy = new opensearch_access_policy_1.OpenSearchAccessPolicy(stack, 'OpenSearchAccessPolicy', {
        domainName: 'TestDomain',
        domainArn: 'test:arn',
        accessPolicies: [
            new iam.PolicyStatement({
                effect: iam.Effect.ALLOW,
                actions: ['es:ESHttp*'],
                principals: [new iam.AnyPrincipal()],
                resources: ['test:arn'],
            }),
        ],
    });
    opensearchAccessPolicy.addAccessPolicies(new iam.PolicyStatement({
        effect: iam.Effect.ALLOW,
        actions: ['*'],
        principals: [new iam.AnyPrincipal()],
        resources: ['test:arn'],
    }));
    assertions_1.Template.fromStack(stack).hasResourceProperties('Custom::OpenSearchAccessPolicy', {
        ServiceToken: {
            'Fn::GetAtt': [
                'AWS679f53fac002430cb0da5b7982bd22872D164C4C',
                'Arn',
            ],
        },
        Create: JSON.stringify({
            action: 'updateDomainConfig',
            service: 'OpenSearch',
            parameters: {
                DomainName: 'TestDomain',
                AccessPolicies: '{"Statement":[{"Action":"es:ESHttp*","Effect":"Allow","Principal":{"AWS":"*"},"Resource":"test:arn"},{"Action":"*","Effect":"Allow","Principal":{"AWS":"*"},"Resource":"test:arn"}],"Version":"2012-10-17"}',
            },
            outputPaths: ['DomainConfig.AccessPolicies'],
            physicalResourceId: { id: 'TestDomainAccessPolicy' },
        }),
        Update: JSON.stringify({
            action: 'updateDomainConfig',
            service: 'OpenSearch',
            parameters: {
                DomainName: 'TestDomain',
                AccessPolicies: '{"Statement":[{"Action":"es:ESHttp*","Effect":"Allow","Principal":{"AWS":"*"},"Resource":"test:arn"},{"Action":"*","Effect":"Allow","Principal":{"AWS":"*"},"Resource":"test:arn"}],"Version":"2012-10-17"}',
            },
            outputPaths: ['DomainConfig.AccessPolicies'],
            physicalResourceId: { id: 'TestDomainAccessPolicy' },
        }),
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3BlbnNlYXJjaC1hY2Nlc3MtcG9saWN5LnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJvcGVuc2VhcmNoLWFjY2Vzcy1wb2xpY3kudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlEQUE0QztBQUM1QyxxQ0FBcUM7QUFDckMscUNBQXdDO0FBQ3hDLDhFQUF5RTtBQUV6RSxJQUFJLEdBQVEsQ0FBQztBQUNiLElBQUksS0FBWSxDQUFDO0FBRWpCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7SUFDZCxHQUFHLEdBQUcsSUFBSSxVQUFHLEVBQUUsQ0FBQztJQUNoQixLQUFLLEdBQUcsSUFBSSxZQUFLLENBQUMsR0FBRyxFQUFFLE9BQU8sRUFBRTtRQUM5QixHQUFHLEVBQUUsRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQUU7S0FDL0MsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsbUNBQW1DLEVBQUUsR0FBRyxFQUFFO0lBQzdDLE1BQU0sU0FBUyxHQUFHLFVBQVUsQ0FBQztJQUU3QixJQUFJLGlEQUFzQixDQUFDLEtBQUssRUFBRSx3QkFBd0IsRUFBRTtRQUMxRCxVQUFVLEVBQUUsWUFBWTtRQUN4QixTQUFTLEVBQUUsU0FBUztRQUNwQixjQUFjLEVBQUUsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxlQUFlLENBQUM7Z0JBQ3ZDLE1BQU0sRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUs7Z0JBQ3hCLE9BQU8sRUFBRSxDQUFDLFlBQVksQ0FBQztnQkFDdkIsVUFBVSxFQUFFLENBQUMsSUFBSSxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUM7Z0JBQ3BDLFNBQVMsRUFBRSxDQUFDLFNBQVMsQ0FBQzthQUV2QixDQUFDLENBQUM7S0FDSixDQUFDLENBQUM7SUFFSCxxQkFBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxnQ0FBZ0MsRUFBRTtRQUNoRixZQUFZLEVBQUU7WUFDWixZQUFZLEVBQUU7Z0JBQ1osNkNBQTZDO2dCQUM3QyxLQUFLO2FBQ047U0FDRjtRQUNELE1BQU0sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ3JCLE1BQU0sRUFBRSxvQkFBb0I7WUFDNUIsT0FBTyxFQUFFLFlBQVk7WUFDckIsVUFBVSxFQUFFO2dCQUNWLFVBQVUsRUFBRSxZQUFZO2dCQUN4QixjQUFjLEVBQUUsK0hBQStIO2FBQ2hKO1lBQ0QsV0FBVyxFQUFFLENBQUMsNkJBQTZCLENBQUM7WUFDNUMsa0JBQWtCLEVBQUUsRUFBRSxFQUFFLEVBQUUsd0JBQXdCLEVBQUU7U0FDckQsQ0FBQztRQUNGLE1BQU0sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ3JCLE1BQU0sRUFBRSxvQkFBb0I7WUFDNUIsT0FBTyxFQUFFLFlBQVk7WUFDckIsVUFBVSxFQUFFO2dCQUNWLFVBQVUsRUFBRSxZQUFZO2dCQUN4QixjQUFjLEVBQUUsK0hBQStIO2FBQ2hKO1lBQ0QsV0FBVyxFQUFFLENBQUMsNkJBQTZCLENBQUM7WUFDNUMsa0JBQWtCLEVBQUUsRUFBRSxFQUFFLEVBQUUsd0JBQXdCLEVBQUU7U0FDckQsQ0FBQztLQUNILENBQUMsQ0FBQztJQUNILHFCQUFRLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLHFCQUFxQixDQUFDLGtCQUFrQixFQUFFO1FBQ2xFLGNBQWMsRUFBRTtZQUNkLFNBQVMsRUFBRSxDQUFDO29CQUNWLE1BQU0sRUFBRSx1QkFBdUI7b0JBQy9CLE1BQU0sRUFBRSxPQUFPO29CQUNmLFFBQVEsRUFBRSxTQUFTO2lCQUNwQixDQUFDO1NBQ0g7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQyw4Q0FBOEMsRUFBRSxHQUFHLEVBQUU7SUFDeEQsTUFBTSxzQkFBc0IsR0FBRyxJQUFJLGlEQUFzQixDQUFDLEtBQUssRUFBRSx3QkFBd0IsRUFBRTtRQUN6RixVQUFVLEVBQUUsWUFBWTtRQUN4QixTQUFTLEVBQUUsVUFBVTtRQUNyQixjQUFjLEVBQUU7WUFDZCxJQUFJLEdBQUcsQ0FBQyxlQUFlLENBQUM7Z0JBQ3RCLE1BQU0sRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUs7Z0JBQ3hCLE9BQU8sRUFBRSxDQUFDLFlBQVksQ0FBQztnQkFDdkIsVUFBVSxFQUFFLENBQUMsSUFBSSxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUM7Z0JBQ3BDLFNBQVMsRUFBRSxDQUFDLFVBQVUsQ0FBQzthQUN4QixDQUFDO1NBQ0g7S0FDRixDQUFDLENBQUM7SUFDSCxzQkFBc0IsQ0FBQyxpQkFBaUIsQ0FDdEMsSUFBSSxHQUFHLENBQUMsZUFBZSxDQUFDO1FBQ3RCLE1BQU0sRUFBRSxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUs7UUFDeEIsT0FBTyxFQUFFLENBQUMsR0FBRyxDQUFDO1FBQ2QsVUFBVSxFQUFFLENBQUMsSUFBSSxHQUFHLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDcEMsU0FBUyxFQUFFLENBQUMsVUFBVSxDQUFDO0tBQ3hCLENBQUMsQ0FDSCxDQUFDO0lBRUYscUJBQVEsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMscUJBQXFCLENBQUMsZ0NBQWdDLEVBQUU7UUFDaEYsWUFBWSxFQUFFO1lBQ1osWUFBWSxFQUFFO2dCQUNaLDZDQUE2QztnQkFDN0MsS0FBSzthQUNOO1NBQ0Y7UUFDRCxNQUFNLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNyQixNQUFNLEVBQUUsb0JBQW9CO1lBQzVCLE9BQU8sRUFBRSxZQUFZO1lBQ3JCLFVBQVUsRUFBRTtnQkFDVixVQUFVLEVBQUUsWUFBWTtnQkFDeEIsY0FBYyxFQUFFLDZNQUE2TTthQUM5TjtZQUNELFdBQVcsRUFBRSxDQUFDLDZCQUE2QixDQUFDO1lBQzVDLGtCQUFrQixFQUFFLEVBQUUsRUFBRSxFQUFFLHdCQUF3QixFQUFFO1NBQ3JELENBQUM7UUFDRixNQUFNLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUNyQixNQUFNLEVBQUUsb0JBQW9CO1lBQzVCLE9BQU8sRUFBRSxZQUFZO1lBQ3JCLFVBQVUsRUFBRTtnQkFDVixVQUFVLEVBQUUsWUFBWTtnQkFDeEIsY0FBYyxFQUFFLDZNQUE2TTthQUM5TjtZQUNELFdBQVcsRUFBRSxDQUFDLDZCQUE2QixDQUFDO1lBQzVDLGtCQUFrQixFQUFFLEVBQUUsRUFBRSxFQUFFLHdCQUF3QixFQUFFO1NBQ3JELENBQUM7S0FDSCxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFRlbXBsYXRlIH0gZnJvbSAnLi4vLi4vYXNzZXJ0aW9ucyc7XG5pbXBvcnQgKiBhcyBpYW0gZnJvbSAnLi4vLi4vYXdzLWlhbSc7XG5pbXBvcnQgeyBBcHAsIFN0YWNrIH0gZnJvbSAnLi4vLi4vY29yZSc7XG5pbXBvcnQgeyBPcGVuU2VhcmNoQWNjZXNzUG9saWN5IH0gZnJvbSAnLi4vbGliL29wZW5zZWFyY2gtYWNjZXNzLXBvbGljeSc7XG5cbmxldCBhcHA6IEFwcDtcbmxldCBzdGFjazogU3RhY2s7XG5cbmJlZm9yZUVhY2goKCkgPT4ge1xuICBhcHAgPSBuZXcgQXBwKCk7XG4gIHN0YWNrID0gbmV3IFN0YWNrKGFwcCwgJ1N0YWNrJywge1xuICAgIGVudjogeyBhY2NvdW50OiAnMTIzNCcsIHJlZ2lvbjogJ3Rlc3RyZWdpb24nIH0sXG4gIH0pO1xufSk7XG5cbnRlc3QoJ21pbmltYWwgZXhhbXBsZSByZW5kZXJzIGNvcnJlY3RseScsICgpID0+IHtcbiAgY29uc3QgZG9tYWluQXJuID0gJ3Rlc3Q6YXJuJztcblxuICBuZXcgT3BlblNlYXJjaEFjY2Vzc1BvbGljeShzdGFjaywgJ09wZW5TZWFyY2hBY2Nlc3NQb2xpY3knLCB7XG4gICAgZG9tYWluTmFtZTogJ1Rlc3REb21haW4nLFxuICAgIGRvbWFpbkFybjogZG9tYWluQXJuLFxuICAgIGFjY2Vzc1BvbGljaWVzOiBbbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxuICAgICAgYWN0aW9uczogWydlczpFU0h0dHAqJ10sXG4gICAgICBwcmluY2lwYWxzOiBbbmV3IGlhbS5BbnlQcmluY2lwYWwoKV0sXG4gICAgICByZXNvdXJjZXM6IFtkb21haW5Bcm5dLFxuXG4gICAgfSldLFxuICB9KTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQ3VzdG9tOjpPcGVuU2VhcmNoQWNjZXNzUG9saWN5Jywge1xuICAgIFNlcnZpY2VUb2tlbjoge1xuICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICdBV1M2NzlmNTNmYWMwMDI0MzBjYjBkYTViNzk4MmJkMjI4NzJEMTY0QzRDJyxcbiAgICAgICAgJ0FybicsXG4gICAgICBdLFxuICAgIH0sXG4gICAgQ3JlYXRlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBhY3Rpb246ICd1cGRhdGVEb21haW5Db25maWcnLFxuICAgICAgc2VydmljZTogJ09wZW5TZWFyY2gnLFxuICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICBEb21haW5OYW1lOiAnVGVzdERvbWFpbicsXG4gICAgICAgIEFjY2Vzc1BvbGljaWVzOiAne1wiU3RhdGVtZW50XCI6W3tcIkFjdGlvblwiOlwiZXM6RVNIdHRwKlwiLFwiRWZmZWN0XCI6XCJBbGxvd1wiLFwiUHJpbmNpcGFsXCI6e1wiQVdTXCI6XCIqXCJ9LFwiUmVzb3VyY2VcIjpcInRlc3Q6YXJuXCJ9XSxcIlZlcnNpb25cIjpcIjIwMTItMTAtMTdcIn0nLFxuICAgICAgfSxcbiAgICAgIG91dHB1dFBhdGhzOiBbJ0RvbWFpbkNvbmZpZy5BY2Nlc3NQb2xpY2llcyddLFxuICAgICAgcGh5c2ljYWxSZXNvdXJjZUlkOiB7IGlkOiAnVGVzdERvbWFpbkFjY2Vzc1BvbGljeScgfSxcbiAgICB9KSxcbiAgICBVcGRhdGU6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIGFjdGlvbjogJ3VwZGF0ZURvbWFpbkNvbmZpZycsXG4gICAgICBzZXJ2aWNlOiAnT3BlblNlYXJjaCcsXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgIERvbWFpbk5hbWU6ICdUZXN0RG9tYWluJyxcbiAgICAgICAgQWNjZXNzUG9saWNpZXM6ICd7XCJTdGF0ZW1lbnRcIjpbe1wiQWN0aW9uXCI6XCJlczpFU0h0dHAqXCIsXCJFZmZlY3RcIjpcIkFsbG93XCIsXCJQcmluY2lwYWxcIjp7XCJBV1NcIjpcIipcIn0sXCJSZXNvdXJjZVwiOlwidGVzdDphcm5cIn1dLFwiVmVyc2lvblwiOlwiMjAxMi0xMC0xN1wifScsXG4gICAgICB9LFxuICAgICAgb3V0cHV0UGF0aHM6IFsnRG9tYWluQ29uZmlnLkFjY2Vzc1BvbGljaWVzJ10sXG4gICAgICBwaHlzaWNhbFJlc291cmNlSWQ6IHsgaWQ6ICdUZXN0RG9tYWluQWNjZXNzUG9saWN5JyB9LFxuICAgIH0pLFxuICB9KTtcbiAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLCB7XG4gICAgUG9saWN5RG9jdW1lbnQ6IHtcbiAgICAgIFN0YXRlbWVudDogW3tcbiAgICAgICAgQWN0aW9uOiAnZXM6VXBkYXRlRG9tYWluQ29uZmlnJyxcbiAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICBSZXNvdXJjZTogZG9tYWluQXJuLFxuICAgICAgfV0sXG4gICAgfSxcbiAgfSk7XG59KTtcblxudGVzdCgnc3VwcG9ydCBhY2Nlc3MgcG9saWN5IGFkZGVkIGlubGluZSBhbmQgbGF0ZXInLCAoKSA9PiB7XG4gIGNvbnN0IG9wZW5zZWFyY2hBY2Nlc3NQb2xpY3kgPSBuZXcgT3BlblNlYXJjaEFjY2Vzc1BvbGljeShzdGFjaywgJ09wZW5TZWFyY2hBY2Nlc3NQb2xpY3knLCB7XG4gICAgZG9tYWluTmFtZTogJ1Rlc3REb21haW4nLFxuICAgIGRvbWFpbkFybjogJ3Rlc3Q6YXJuJyxcbiAgICBhY2Nlc3NQb2xpY2llczogW1xuICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgICBlZmZlY3Q6IGlhbS5FZmZlY3QuQUxMT1csXG4gICAgICAgIGFjdGlvbnM6IFsnZXM6RVNIdHRwKiddLFxuICAgICAgICBwcmluY2lwYWxzOiBbbmV3IGlhbS5BbnlQcmluY2lwYWwoKV0sXG4gICAgICAgIHJlc291cmNlczogWyd0ZXN0OmFybiddLFxuICAgICAgfSksXG4gICAgXSxcbiAgfSk7XG4gIG9wZW5zZWFyY2hBY2Nlc3NQb2xpY3kuYWRkQWNjZXNzUG9saWNpZXMoXG4gICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxuICAgICAgYWN0aW9uczogWycqJ10sXG4gICAgICBwcmluY2lwYWxzOiBbbmV3IGlhbS5BbnlQcmluY2lwYWwoKV0sXG4gICAgICByZXNvdXJjZXM6IFsndGVzdDphcm4nXSxcbiAgICB9KSxcbiAgKTtcblxuICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQ3VzdG9tOjpPcGVuU2VhcmNoQWNjZXNzUG9saWN5Jywge1xuICAgIFNlcnZpY2VUb2tlbjoge1xuICAgICAgJ0ZuOjpHZXRBdHQnOiBbXG4gICAgICAgICdBV1M2NzlmNTNmYWMwMDI0MzBjYjBkYTViNzk4MmJkMjI4NzJEMTY0QzRDJyxcbiAgICAgICAgJ0FybicsXG4gICAgICBdLFxuICAgIH0sXG4gICAgQ3JlYXRlOiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBhY3Rpb246ICd1cGRhdGVEb21haW5Db25maWcnLFxuICAgICAgc2VydmljZTogJ09wZW5TZWFyY2gnLFxuICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICBEb21haW5OYW1lOiAnVGVzdERvbWFpbicsXG4gICAgICAgIEFjY2Vzc1BvbGljaWVzOiAne1wiU3RhdGVtZW50XCI6W3tcIkFjdGlvblwiOlwiZXM6RVNIdHRwKlwiLFwiRWZmZWN0XCI6XCJBbGxvd1wiLFwiUHJpbmNpcGFsXCI6e1wiQVdTXCI6XCIqXCJ9LFwiUmVzb3VyY2VcIjpcInRlc3Q6YXJuXCJ9LHtcIkFjdGlvblwiOlwiKlwiLFwiRWZmZWN0XCI6XCJBbGxvd1wiLFwiUHJpbmNpcGFsXCI6e1wiQVdTXCI6XCIqXCJ9LFwiUmVzb3VyY2VcIjpcInRlc3Q6YXJuXCJ9XSxcIlZlcnNpb25cIjpcIjIwMTItMTAtMTdcIn0nLFxuICAgICAgfSxcbiAgICAgIG91dHB1dFBhdGhzOiBbJ0RvbWFpbkNvbmZpZy5BY2Nlc3NQb2xpY2llcyddLFxuICAgICAgcGh5c2ljYWxSZXNvdXJjZUlkOiB7IGlkOiAnVGVzdERvbWFpbkFjY2Vzc1BvbGljeScgfSxcbiAgICB9KSxcbiAgICBVcGRhdGU6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIGFjdGlvbjogJ3VwZGF0ZURvbWFpbkNvbmZpZycsXG4gICAgICBzZXJ2aWNlOiAnT3BlblNlYXJjaCcsXG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgIERvbWFpbk5hbWU6ICdUZXN0RG9tYWluJyxcbiAgICAgICAgQWNjZXNzUG9saWNpZXM6ICd7XCJTdGF0ZW1lbnRcIjpbe1wiQWN0aW9uXCI6XCJlczpFU0h0dHAqXCIsXCJFZmZlY3RcIjpcIkFsbG93XCIsXCJQcmluY2lwYWxcIjp7XCJBV1NcIjpcIipcIn0sXCJSZXNvdXJjZVwiOlwidGVzdDphcm5cIn0se1wiQWN0aW9uXCI6XCIqXCIsXCJFZmZlY3RcIjpcIkFsbG93XCIsXCJQcmluY2lwYWxcIjp7XCJBV1NcIjpcIipcIn0sXCJSZXNvdXJjZVwiOlwidGVzdDphcm5cIn1dLFwiVmVyc2lvblwiOlwiMjAxMi0xMC0xN1wifScsXG4gICAgICB9LFxuICAgICAgb3V0cHV0UGF0aHM6IFsnRG9tYWluQ29uZmlnLkFjY2Vzc1BvbGljaWVzJ10sXG4gICAgICBwaHlzaWNhbFJlc291cmNlSWQ6IHsgaWQ6ICdUZXN0RG9tYWluQWNjZXNzUG9saWN5JyB9LFxuICAgIH0pLFxuICB9KTtcbn0pO1xuIl19