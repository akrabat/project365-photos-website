"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../assertions");
const core_1 = require("../../core");
const lib_1 = require("../lib");
/* eslint-disable quote-props */
describe('receipt rule', () => {
    test('can create receipt rules with second after first', () => {
        // GIVEN
        const stack = new core_1.Stack();
        // WHEN
        new lib_1.ReceiptRuleSet(stack, 'RuleSet', {
            rules: [
                {
                    receiptRuleName: 'FirstRule',
                },
                {
                    enabled: false,
                    receiptRuleName: 'SecondRule',
                    recipients: ['hello@aws.com'],
                    scanEnabled: true,
                    tlsPolicy: lib_1.TlsPolicy.REQUIRE,
                },
            ],
        });
        // THEN
        assertions_1.Template.fromStack(stack).templateMatches({
            'Resources': {
                'RuleSetE30C6C48': {
                    'Type': 'AWS::SES::ReceiptRuleSet',
                },
                'RuleSetRule023C3B8E1': {
                    'Type': 'AWS::SES::ReceiptRule',
                    'Properties': {
                        'Rule': {
                            'Name': 'FirstRule',
                            'Enabled': true,
                        },
                        'RuleSetName': {
                            'Ref': 'RuleSetE30C6C48',
                        },
                    },
                },
                'RuleSetRule117041B57': {
                    'Type': 'AWS::SES::ReceiptRule',
                    'Properties': {
                        'Rule': {
                            'Enabled': false,
                            'Name': 'SecondRule',
                            'Recipients': [
                                'hello@aws.com',
                            ],
                            'ScanEnabled': true,
                            'TlsPolicy': 'Require',
                        },
                        'RuleSetName': {
                            'Ref': 'RuleSetE30C6C48',
                        },
                        'After': {
                            'Ref': 'RuleSetRule023C3B8E1',
                        },
                    },
                },
            },
        });
    });
    test('import receipt rule', () => {
        // GIVEN
        const stack = new core_1.Stack();
        // WHEN
        const receiptRule = lib_1.ReceiptRule.fromReceiptRuleName(stack, 'ImportedRule', 'MyRule');
        const receiptRuleSet = new lib_1.ReceiptRuleSet(stack, 'RuleSet');
        receiptRuleSet.addRule('MyRule', {
            after: receiptRule,
        });
        // THEN
        assertions_1.Template.fromStack(stack).templateMatches({
            'Resources': {
                'RuleSetE30C6C48': {
                    'Type': 'AWS::SES::ReceiptRuleSet',
                },
                'RuleSetMyRule60B1D107': {
                    'Type': 'AWS::SES::ReceiptRule',
                    'Properties': {
                        'Rule': {
                            'Enabled': true,
                        },
                        'RuleSetName': {
                            'Ref': 'RuleSetE30C6C48',
                        },
                        'After': 'MyRule',
                    },
                },
            },
        });
    });
    test('can add actions in rule props', () => {
        // GIVEN
        const stack = new core_1.Stack();
        // WHEN
        const ruleSet = new lib_1.ReceiptRuleSet(stack, 'RuleSet');
        ruleSet.addRule('Rule', {
            actions: [
                {
                    bind: () => ({
                        stopAction: {
                            scope: 'RuleSet',
                        },
                    }),
                },
            ],
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SES::ReceiptRule', {
            'Rule': {
                'Actions': [
                    {
                        'StopAction': {
                            'Scope': 'RuleSet',
                        },
                    },
                ],
                'Enabled': true,
            },
            'RuleSetName': {
                'Ref': 'RuleSetE30C6C48',
            },
        });
    });
    test('can add action with addAction', () => {
        // GIVEN
        const stack = new core_1.Stack();
        // WHEN
        const ruleSet = new lib_1.ReceiptRuleSet(stack, 'RuleSet');
        const rule = ruleSet.addRule('Rule');
        rule.addAction({
            bind: () => ({
                stopAction: {
                    scope: 'RuleSet',
                },
            }),
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::SES::ReceiptRule', {
            'Rule': {
                'Actions': [
                    {
                        'StopAction': {
                            'Scope': 'RuleSet',
                        },
                    },
                ],
                'Enabled': true,
            },
            'RuleSetName': {
                'Ref': 'RuleSetE30C6C48',
            },
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjZWlwdC1ydWxlLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWNlaXB0LXJ1bGUudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlEQUE0QztBQUM1QyxxQ0FBbUM7QUFDbkMsZ0NBQWdFO0FBRWhFLGdDQUFnQztBQUVoQyxRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRTtJQUM1QixJQUFJLENBQUMsa0RBQWtELEVBQUUsR0FBRyxFQUFFO1FBQzVELFFBQVE7UUFDUixNQUFNLEtBQUssR0FBRyxJQUFJLFlBQUssRUFBRSxDQUFDO1FBRTFCLE9BQU87UUFDUCxJQUFJLG9CQUFjLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRTtZQUNuQyxLQUFLLEVBQUU7Z0JBQ0w7b0JBQ0UsZUFBZSxFQUFFLFdBQVc7aUJBQzdCO2dCQUNEO29CQUNFLE9BQU8sRUFBRSxLQUFLO29CQUNkLGVBQWUsRUFBRSxZQUFZO29CQUM3QixVQUFVLEVBQUUsQ0FBQyxlQUFlLENBQUM7b0JBQzdCLFdBQVcsRUFBRSxJQUFJO29CQUNqQixTQUFTLEVBQUUsZUFBUyxDQUFDLE9BQU87aUJBQzdCO2FBQ0Y7U0FDRixDQUFDLENBQUM7UUFFSCxPQUFPO1FBQ1AscUJBQVEsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsZUFBZSxDQUFDO1lBQ3hDLFdBQVcsRUFBRTtnQkFDWCxpQkFBaUIsRUFBRTtvQkFDakIsTUFBTSxFQUFFLDBCQUEwQjtpQkFDbkM7Z0JBQ0Qsc0JBQXNCLEVBQUU7b0JBQ3RCLE1BQU0sRUFBRSx1QkFBdUI7b0JBQy9CLFlBQVksRUFBRTt3QkFDWixNQUFNLEVBQUU7NEJBQ04sTUFBTSxFQUFFLFdBQVc7NEJBQ25CLFNBQVMsRUFBRSxJQUFJO3lCQUNoQjt3QkFDRCxhQUFhLEVBQUU7NEJBQ2IsS0FBSyxFQUFFLGlCQUFpQjt5QkFDekI7cUJBQ0Y7aUJBQ0Y7Z0JBQ0Qsc0JBQXNCLEVBQUU7b0JBQ3RCLE1BQU0sRUFB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O1FBQ3JDLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDYixJQUFJLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztnQkFDWCxVQUFVLEVBQUU7b0JBQ1YsS0FBSyxFQUFFLFNBQVM7aUJBQ2pCO2FBQ0YsQ0FBQztTQUNILENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxxQkFBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyx1QkFBdUIsRUFBRTtZQUN2RSxNQUFNLEVBQUU7Z0JBQ04sU0FBUyxFQUFFO29CQUNUO3dCQUNFLFlBQVksRUFBRTs0QkFDWixPQUFPLEVBQUUsU0FBUzt5QkFDbkI7cUJBQ0Y7aUJBQ0Y7Z0JBQ0QsU0FBUyxFQUFFLElBQUk7YUFDaEI7WUFDRCxhQUFhLEVBQUU7Z0JBQ2IsS0FBSyxFQUFFLGlCQUFpQjthQUN6QjtTQUNGLENBQUMsQ0FBQztJQUdMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZW1wbGF0ZSB9IGZyb20gJy4uLy4uL2Fzc2VydGlvbnMnO1xuaW1wb3J0IHsgU3RhY2sgfSBmcm9tICcuLi8uLi9jb3JlJztcbmltcG9ydCB7IFJlY2VpcHRSdWxlLCBSZWNlaXB0UnVsZVNldCwgVGxzUG9saWN5IH0gZnJvbSAnLi4vbGliJztcblxuLyogZXNsaW50LWRpc2FibGUgcXVvdGUtcHJvcHMgKi9cblxuZGVzY3JpYmUoJ3JlY2VpcHQgcnVsZScsICgpID0+IHtcbiAgdGVzdCgnY2FuIGNyZWF0ZSByZWNlaXB0IHJ1bGVzIHdpdGggc2Vjb25kIGFmdGVyIGZpcnN0JywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgU3RhY2soKTtcblxuICAgIC8vIFdIRU5cbiAgICBuZXcgUmVjZWlwdFJ1bGVTZXQoc3RhY2ssICdSdWxlU2V0Jywge1xuICAgICAgcnVsZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHJlY2VpcHRSdWxlTmFtZTogJ0ZpcnN0UnVsZScsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBlbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICByZWNlaXB0UnVsZU5hbWU6ICdTZWNvbmRSdWxlJyxcbiAgICAgICAgICByZWNpcGllbnRzOiBbJ2hlbGxvQGF3cy5jb20nXSxcbiAgICAgICAgICBzY2FuRW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICB0bHNQb2xpY3k6IFRsc1BvbGljeS5SRVFVSVJFLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICAnUmVzb3VyY2VzJzoge1xuICAgICAgICAnUnVsZVNldEUzMEM2QzQ4Jzoge1xuICAgICAgICAgICdUeXBlJzogJ0FXUzo6U0VTOjpSZWNlaXB0UnVsZVNldCcsXG4gICAgICAgIH0sXG4gICAgICAgICdSdWxlU2V0UnVsZTAyM0MzQjhFMSc6IHtcbiAgICAgICAgICAnVHlwZSc6ICdBV1M6OlNFUzo6UmVjZWlwdFJ1bGUnLFxuICAgICAgICAgICdQcm9wZXJ0aWVzJzoge1xuICAgICAgICAgICAgJ1J1bGUnOiB7XG4gICAgICAgICAgICAgICdOYW1lJzogJ0ZpcnN0UnVsZScsXG4gICAgICAgICAgICAgICdFbmFibGVkJzogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnUnVsZVNldE5hbWUnOiB7XG4gICAgICAgICAgICAgICdSZWYnOiAnUnVsZVNldEUzMEM2QzQ4JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgJ1J1bGVTZXRSdWxlMTE3MDQxQjU3Jzoge1xuICAgICAgICAgICdUeXBlJzogJ0FXUzo6U0VTOjpSZWNlaXB0UnVsZScsXG4gICAgICAgICAgJ1Byb3BlcnRpZXMnOiB7XG4gICAgICAgICAgICAnUnVsZSc6IHtcbiAgICAgICAgICAgICAgJ0VuYWJsZWQnOiBmYWxzZSxcbiAgICAgICAgICAgICAgJ05hbWUnOiAnU2Vjb25kUnVsZScsXG4gICAgICAgICAgICAgICdSZWNpcGllbnRzJzogW1xuICAgICAgICAgICAgICAgICdoZWxsb0Bhd3MuY29tJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgJ1NjYW5FbmFibGVkJzogdHJ1ZSxcbiAgICAgICAgICAgICAgJ1Rsc1BvbGljeSc6ICdSZXF1aXJlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnUnVsZVNldE5hbWUnOiB7XG4gICAgICAgICAgICAgICdSZWYnOiAnUnVsZVNldEUzMEM2QzQ4JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnQWZ0ZXInOiB7XG4gICAgICAgICAgICAgICdSZWYnOiAnUnVsZVNldFJ1bGUwMjNDM0I4RTEnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuXG4gIH0pO1xuXG4gIHRlc3QoJ2ltcG9ydCByZWNlaXB0IHJ1bGUnLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBzdGFjayA9IG5ldyBTdGFjaygpO1xuXG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHJlY2VpcHRSdWxlID0gUmVjZWlwdFJ1bGUuZnJvbVJlY2VpcHRSdWxlTmFtZShzdGFjaywgJ0ltcG9ydGVkUnVsZScsICdNeVJ1bGUnKTtcbiAgICBjb25zdCByZWNlaXB0UnVsZVNldCA9IG5ldyBSZWNlaXB0UnVsZVNldChzdGFjaywgJ1J1bGVTZXQnKTtcblxuICAgIHJlY2VpcHRSdWxlU2V0LmFkZFJ1bGUoJ015UnVsZScsIHtcbiAgICAgIGFmdGVyOiByZWNlaXB0UnVsZSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICAnUmVzb3VyY2VzJzoge1xuICAgICAgICAnUnVsZVNldEUzMEM2QzQ4Jzoge1xuICAgICAgICAgICdUeXBlJzogJ0FXUzo6U0VTOjpSZWNlaXB0UnVsZVNldCcsXG4gICAgICAgIH0sXG4gICAgICAgICdSdWxlU2V0TXlSdWxlNjBCMUQxMDcnOiB7XG4gICAgICAgICAgJ1R5cGUnOiAnQVdTOjpTRVM6OlJlY2VpcHRSdWxlJyxcbiAgICAgICAgICAnUHJvcGVydGllcyc6IHtcbiAgICAgICAgICAgICdSdWxlJzoge1xuICAgICAgICAgICAgICAnRW5hYmxlZCc6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ1J1bGVTZXROYW1lJzoge1xuICAgICAgICAgICAgICAnUmVmJzogJ1J1bGVTZXRFMzBDNkM0OCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ0FmdGVyJzogJ015UnVsZScsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cblxuICB9KTtcblxuICB0ZXN0KCdjYW4gYWRkIGFjdGlvbnMgaW4gcnVsZSBwcm9wcycsICgpID0+IHtcbiAgICAvLyBHSVZFTlxuICAgIGNvbnN0IHN0YWNrID0gbmV3IFN0YWNrKCk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgcnVsZVNldCA9IG5ldyBSZWNlaXB0UnVsZVNldChzdGFjaywgJ1J1bGVTZXQnKTtcbiAgICBydWxlU2V0LmFkZFJ1bGUoJ1J1bGUnLCB7XG4gICAgICBhY3Rpb25zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBiaW5kOiAoKSA9PiAoe1xuICAgICAgICAgICAgc3RvcEFjdGlvbjoge1xuICAgICAgICAgICAgICBzY29wZTogJ1J1bGVTZXQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6U0VTOjpSZWNlaXB0UnVsZScsIHtcbiAgICAgICdSdWxlJzoge1xuICAgICAgICAnQWN0aW9ucyc6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAnU3RvcEFjdGlvbic6IHtcbiAgICAgICAgICAgICAgJ1Njb3BlJzogJ1J1bGVTZXQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICAnRW5hYmxlZCc6IHRydWUsXG4gICAgICB9LFxuICAgICAgJ1J1bGVTZXROYW1lJzoge1xuICAgICAgICAnUmVmJzogJ1J1bGVTZXRFMzBDNkM0OCcsXG4gICAgICB9LFxuICAgIH0pO1xuXG5cbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGFkZCBhY3Rpb24gd2l0aCBhZGRBY3Rpb24nLCAoKSA9PiB7XG4gICAgLy8gR0lWRU5cbiAgICBjb25zdCBzdGFjayA9IG5ldyBTdGFjaygpO1xuXG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHJ1bGVTZXQgPSBuZXcgUmVjZWlwdFJ1bGVTZXQoc3RhY2ssICdSdWxlU2V0Jyk7XG4gICAgY29uc3QgcnVsZSA9IHJ1bGVTZXQuYWRkUnVsZSgnUnVsZScpO1xuICAgIHJ1bGUuYWRkQWN0aW9uKHtcbiAgICAgIGJpbmQ6ICgpID0+ICh7XG4gICAgICAgIHN0b3BBY3Rpb246IHtcbiAgICAgICAgICBzY29wZTogJ1J1bGVTZXQnLFxuICAgICAgICB9LFxuICAgICAgfSksXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6U0VTOjpSZWNlaXB0UnVsZScsIHtcbiAgICAgICdSdWxlJzoge1xuICAgICAgICAnQWN0aW9ucyc6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAnU3RvcEFjdGlvbic6IHtcbiAgICAgICAgICAgICAgJ1Njb3BlJzogJ1J1bGVTZXQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICAnRW5hYmxlZCc6IHRydWUsXG4gICAgICB9LFxuICAgICAgJ1J1bGVTZXROYW1lJzoge1xuICAgICAgICAnUmVmJzogJ1J1bGVTZXRFMzBDNkM0OCcsXG4gICAgICB9LFxuICAgIH0pO1xuXG5cbiAgfSk7XG59KTtcbiJdfQ==