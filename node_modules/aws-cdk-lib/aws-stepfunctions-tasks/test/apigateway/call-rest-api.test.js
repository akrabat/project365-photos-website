"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const apigateway = require("../../../aws-apigateway");
const sfn = require("../../../aws-stepfunctions");
const cdk = require("../../../core");
const lib_1 = require("../../lib");
describe('CallApiGatewayRestApiEndpoint', () => {
    test('default', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const restApi = new apigateway.RestApi(stack, 'RestApi');
        // WHEN
        const task = new lib_1.CallApiGatewayRestApiEndpoint(stack, 'Call', {
            api: restApi,
            method: lib_1.HttpMethod.GET,
            stageName: 'dev',
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toEqual({
            Type: 'Task',
            End: true,
            Parameters: {
                ApiEndpoint: {
                    'Fn::Join': [
                        '',
                        [
                            {
                                Ref: 'RestApi0C43BF4B',
                            },
                            '.execute-api.',
                            {
                                Ref: 'AWS::Region',
                            },
                            '.',
                            {
                                Ref: 'AWS::URLSuffix',
                            },
                        ],
                    ],
                },
                AuthType: 'NO_AUTH',
                Method: 'GET',
                Stage: 'dev',
            },
            Resource: {
                'Fn::Join': [
                    '',
                    [
                        'arn:',
                        {
                            Ref: 'AWS::Partition',
                        },
                        ':states:::apigateway:invoke',
                    ],
                ],
            },
        });
    });
    test('wait for task token', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const restApi = new apigateway.RestApi(stack, 'RestApi');
        // WHEN
        const task = new lib_1.CallApiGatewayRestApiEndpoint(stack, 'Call', {
            api: restApi,
            method: lib_1.HttpMethod.GET,
            stageName: 'dev',
            integrationPattern: sfn.IntegrationPattern.WAIT_FOR_TASK_TOKEN,
            headers: sfn.TaskInput.fromObject({ TaskToken: sfn.JsonPath.array(sfn.JsonPath.taskToken) }),
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toEqual({
            Type: 'Task',
            End: true,
            Parameters: {
                ApiEndpoint: {
                    'Fn::Join': [
                        '',
                        [
                            {
                                Ref: 'RestApi0C43BF4B',
                            },
                            '.execute-api.',
                            {
                                Ref: 'AWS::Region',
                            },
                            '.',
                            {
                                Ref: 'AWS::URLSuffix',
                            },
                        ],
                    ],
                },
                AuthType: 'NO_AUTH',
                Headers: {
                    'TaskToken.$': 'States.Array($$.Task.Token)',
                },
                Method: 'GET',
                Stage: 'dev',
            },
            Resource: {
                'Fn::Join': [
                    '',
                    [
                        'arn:',
                        {
                            Ref: 'AWS::Partition',
                        },
                        ':states:::apigateway:invoke.waitForTaskToken',
                    ],
                ],
            },
        });
    });
    test('wait for task token - missing token', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const restApi = new apigateway.RestApi(stack, 'RestApi');
        // THEN
        expect(() => {
            new lib_1.CallApiGatewayRestApiEndpoint(stack, 'Call', {
                api: restApi,
                method: lib_1.HttpMethod.GET,
                stageName: 'dev',
                integrationPattern: sfn.IntegrationPattern.WAIT_FOR_TASK_TOKEN,
            });
        }).toThrow(/Task Token is required in `headers` for WAIT_FOR_TASK_TOKEN pattern. Use JsonPath.taskToken to set the token./);
    });
    test('unsupported integration pattern - RUN_JOB', () => {
        // GIVEN
        const stack = new cdk.Stack();
        const restApi = new apigateway.RestApi(stack, 'RestApi');
        // THEN
        expect(() => {
            new lib_1.CallApiGatewayRestApiEndpoint(stack, 'Call', {
                api: restApi,
                method: lib_1.HttpMethod.GET,
                stageName: 'dev',
                integrationPattern: sfn.IntegrationPattern.RUN_JOB,
            });
        }).toThrow(/Unsupported service integration pattern./);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsbC1yZXN0LWFwaS50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY2FsbC1yZXN0LWFwaS50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0RBQXNEO0FBQ3RELGtEQUFrRDtBQUNsRCxxQ0FBcUM7QUFDckMsbUNBQXNFO0FBRXRFLFFBQVEsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7SUFDN0MsSUFBSSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7UUFDbkIsUUFBUTtRQUNSLE1BQU0sS0FBSyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzlCLE1BQU0sT0FBTyxHQUFHLElBQUksVUFBVSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFFekQsT0FBTztRQUNQLE1BQU0sSUFBSSxHQUFHLElBQUksbUNBQTZCLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRTtZQUM1RCxHQUFHLEVBQUUsT0FBTztZQUNaLE1BQU0sRUFBRSxnQkFBVSxDQUFDLEdBQUc7WUFDdEIsU0FBUyxFQUFFLEtBQUs7U0FDakIsQ0FBQyxDQUFDO1FBRUgsT0FBTztRQUNQLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDO1lBQ2hELElBQUksRUFBRSxNQUFNO1lBQ1osR0FBRyxFQUFFLElBQUk7WUFDVCxVQUFVLEVBQUU7Z0JBQ1YsV0FBVyxFQUFFO29CQUNYLFVBQVUsRUFBRTt3QkFDVixFQUFFO3dCQUNGOzRCQUNFO2dDQUNFLEdBQUcsRUFBRSxpQkFBaUI7NkJBQ3ZCOzRCQUNELGVBQWU7NEJBQ2Y7Z0NBQ0UsR0FBRyxFQUFFLGFBQWE7NkJBQ25COzRCQUNELEdBQUc7NEJBQ0g7Z0NBQ0UsR0FBRyxFQUFFLGdCQUFnQjs2QkFDdEI7eUJBQ0Y7cUJBQ0Y7aUJBQ0Y7Z0JBQ0QsUUFBUSxFQUFFLFNBQVM7Z0JB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QTJDLEVBQUUsR0FBRyxFQUFFO1FBQ3JELFFBQVE7UUFDUixNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUM5QixNQUFNLE9BQU8sR0FBRyxJQUFJLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBRXpELE9BQU87UUFDUCxNQUFNLENBQUMsR0FBRyxFQUFFO1lBQ1YsSUFBSSxtQ0FBNkIsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFO2dCQUMvQyxHQUFHLEVBQUUsT0FBTztnQkFDWixNQUFNLEVBQUUsZ0JBQVUsQ0FBQyxHQUFHO2dCQUN0QixTQUFTLEVBQUUsS0FBSztnQkFDaEIsa0JBQWtCLEVBQUUsR0FBRyxDQUFDLGtCQUFrQixDQUFDLE9BQU87YUFDbkQsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLDBDQUEwQyxDQUFDLENBQUM7SUFDekQsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGFwaWdhdGV3YXkgZnJvbSAnLi4vLi4vLi4vYXdzLWFwaWdhdGV3YXknO1xuaW1wb3J0ICogYXMgc2ZuIGZyb20gJy4uLy4uLy4uL2F3cy1zdGVwZnVuY3Rpb25zJztcbmltcG9ydCAqIGFzIGNkayBmcm9tICcuLi8uLi8uLi9jb3JlJztcbmltcG9ydCB7IEh0dHBNZXRob2QsIENhbGxBcGlHYXRld2F5UmVzdEFwaUVuZHBvaW50IH0gZnJvbSAnLi4vLi4vbGliJztcblxuZGVzY3JpYmUoJ0NhbGxBcGlHYXRld2F5UmVzdEFwaUVuZHBvaW50JywgKCkgPT4ge1xuICB0ZXN0KCdkZWZhdWx0JywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgY29uc3QgcmVzdEFwaSA9IG5ldyBhcGlnYXRld2F5LlJlc3RBcGkoc3RhY2ssICdSZXN0QXBpJyk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBDYWxsQXBpR2F0ZXdheVJlc3RBcGlFbmRwb2ludChzdGFjaywgJ0NhbGwnLCB7XG4gICAgICBhcGk6IHJlc3RBcGksXG4gICAgICBtZXRob2Q6IEh0dHBNZXRob2QuR0VULFxuICAgICAgc3RhZ2VOYW1lOiAnZGV2JyxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3Qoc3RhY2sucmVzb2x2ZSh0YXNrLnRvU3RhdGVKc29uKCkpKS50b0VxdWFsKHtcbiAgICAgIFR5cGU6ICdUYXNrJyxcbiAgICAgIEVuZDogdHJ1ZSxcbiAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgQXBpRW5kcG9pbnQ6IHtcbiAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAnJyxcbiAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFJlZjogJ1Jlc3RBcGkwQzQzQkY0QicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICcuZXhlY3V0ZS1hcGkuJyxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UmVnaW9uJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgJy4nLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpVUkxTdWZmaXgnLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBBdXRoVHlwZTogJ05PX0FVVEgnLFxuICAgICAgICBNZXRob2Q6ICdHRVQnLFxuICAgICAgICBTdGFnZTogJ2RldicsXG4gICAgICB9LFxuICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICcnLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICc6c3RhdGVzOjo6YXBpZ2F0ZXdheTppbnZva2UnLFxuICAgICAgICAgIF0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCd3YWl0IGZvciB0YXNrIHRva2VuJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgY29uc3QgcmVzdEFwaSA9IG5ldyBhcGlnYXRld2F5LlJlc3RBcGkoc3RhY2ssICdSZXN0QXBpJyk7XG5cbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBDYWxsQXBpR2F0ZXdheVJlc3RBcGlFbmRwb2ludChzdGFjaywgJ0NhbGwnLCB7XG4gICAgICBhcGk6IHJlc3RBcGksXG4gICAgICBtZXRob2Q6IEh0dHBNZXRob2QuR0VULFxuICAgICAgc3RhZ2VOYW1lOiAnZGV2JyxcbiAgICAgIGludGVncmF0aW9uUGF0dGVybjogc2ZuLkludGVncmF0aW9uUGF0dGVybi5XQUlUX0ZPUl9UQVNLX1RPS0VOLFxuICAgICAgaGVhZGVyczogc2ZuLlRhc2tJbnB1dC5mcm9tT2JqZWN0KHsgVGFza1Rva2VuOiBzZm4uSnNvblBhdGguYXJyYXkoc2ZuLkpzb25QYXRoLnRhc2tUb2tlbikgfSksXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9FcXVhbCh7XG4gICAgICBUeXBlOiAnVGFzaycsXG4gICAgICBFbmQ6IHRydWUsXG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIEFwaUVuZHBvaW50OiB7XG4gICAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICAgJycsXG4gICAgICAgICAgICBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBSZWY6ICdSZXN0QXBpMEM0M0JGNEInLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAnLmV4ZWN1dGUtYXBpLicsXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICcuJyxcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6VVJMU3VmZml4JyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgQXV0aFR5cGU6ICdOT19BVVRIJyxcbiAgICAgICAgSGVhZGVyczoge1xuICAgICAgICAgICdUYXNrVG9rZW4uJCc6ICdTdGF0ZXMuQXJyYXkoJCQuVGFzay5Ub2tlbiknLFxuICAgICAgICB9LFxuICAgICAgICBNZXRob2Q6ICdHRVQnLFxuICAgICAgICBTdGFnZTogJ2RldicsXG4gICAgICB9LFxuICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICcnLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICc6c3RhdGVzOjo6YXBpZ2F0ZXdheTppbnZva2Uud2FpdEZvclRhc2tUb2tlbicsXG4gICAgICAgICAgXSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3dhaXQgZm9yIHRhc2sgdG9rZW4gLSBtaXNzaW5nIHRva2VuJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgY29uc3QgcmVzdEFwaSA9IG5ldyBhcGlnYXRld2F5LlJlc3RBcGkoc3RhY2ssICdSZXN0QXBpJyk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIG5ldyBDYWxsQXBpR2F0ZXdheVJlc3RBcGlFbmRwb2ludChzdGFjaywgJ0NhbGwnLCB7XG4gICAgICAgIGFwaTogcmVzdEFwaSxcbiAgICAgICAgbWV0aG9kOiBIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgc3RhZ2VOYW1lOiAnZGV2JyxcbiAgICAgICAgaW50ZWdyYXRpb25QYXR0ZXJuOiBzZm4uSW50ZWdyYXRpb25QYXR0ZXJuLldBSVRfRk9SX1RBU0tfVE9LRU4sXG4gICAgICB9KTtcbiAgICB9KS50b1Rocm93KC9UYXNrIFRva2VuIGlzIHJlcXVpcmVkIGluIGBoZWFkZXJzYCBmb3IgV0FJVF9GT1JfVEFTS19UT0tFTiBwYXR0ZXJuLiBVc2UgSnNvblBhdGgudGFza1Rva2VuIHRvIHNldCB0aGUgdG9rZW4uLyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Vuc3VwcG9ydGVkIGludGVncmF0aW9uIHBhdHRlcm4gLSBSVU5fSk9CJywgKCkgPT4ge1xuICAgIC8vIEdJVkVOXG4gICAgY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKCk7XG4gICAgY29uc3QgcmVzdEFwaSA9IG5ldyBhcGlnYXRld2F5LlJlc3RBcGkoc3RhY2ssICdSZXN0QXBpJyk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIG5ldyBDYWxsQXBpR2F0ZXdheVJlc3RBcGlFbmRwb2ludChzdGFjaywgJ0NhbGwnLCB7XG4gICAgICAgIGFwaTogcmVzdEFwaSxcbiAgICAgICAgbWV0aG9kOiBIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgc3RhZ2VOYW1lOiAnZGV2JyxcbiAgICAgICAgaW50ZWdyYXRpb25QYXR0ZXJuOiBzZm4uSW50ZWdyYXRpb25QYXR0ZXJuLlJVTl9KT0IsXG4gICAgICB9KTtcbiAgICB9KS50b1Rocm93KC9VbnN1cHBvcnRlZCBzZXJ2aWNlIGludGVncmF0aW9uIHBhdHRlcm4uLyk7XG4gIH0pO1xufSk7XG4iXX0=