"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const assertions_1 = require("../../../assertions");
const iam = require("../../../aws-iam");
const logs = require("../../../aws-logs");
const s3 = require("../../../aws-s3");
const sfn = require("../../../aws-stepfunctions");
const core_1 = require("../../../core");
const start_job_run_1 = require("../../lib/emrcontainers/start-job-run");
let stack;
let clusterId;
let defaultProps;
beforeEach(() => {
    stack = new core_1.Stack();
    clusterId = 'clusterId';
    defaultProps = {
        virtualCluster: start_job_run_1.VirtualClusterInput.fromTaskInput(sfn.TaskInput.fromText(clusterId)),
        releaseLabel: start_job_run_1.ReleaseLabel.EMR_6_2_0,
        jobDriver: {
            sparkSubmitJobDriver: {
                entryPoint: sfn.TaskInput.fromText('local:///usr/lib/spark/examples/src/main/python/pi.py'),
                sparkSubmitParameters: '--conf spark.executor.instances=2',
            },
        },
    };
});
describe('Invoke EMR Containers Start Job Run with ', () => {
    test('Request/Response integration pattern', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            integrationPattern: sfn.IntegrationPattern.REQUEST_RESPONSE,
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Type: 'Task',
            Resource: {
                'Fn::Join': [
                    '',
                    [
                        'arn:',
                        {
                            Ref: 'AWS::Partition',
                        },
                        ':states:::emr-containers:startJobRun',
                    ],
                ],
            },
        });
    });
    test('.sync integration pattern', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', defaultProps);
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Type: 'Task',
            Resource: {
                'Fn::Join': [
                    '',
                    [
                        'arn:',
                        {
                            Ref: 'AWS::Partition',
                        },
                        ':states:::emr-containers:startJobRun.sync',
                    ],
                ],
            },
        });
    });
    test('virtual cluster id from payload', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            virtualCluster: start_job_run_1.VirtualClusterInput.fromTaskInput(sfn.TaskInput.fromJsonPathAt('$.ClusterId')),
            executionRole: iam.Role.fromRoleArn(stack, 'Job Execution Role', 'arn:aws:iam::xxxxxxxxxxxx:role/JobExecutionRole'),
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                'VirtualClusterId.$': '$.ClusterId',
                'ExecutionRoleArn': 'arn:aws:iam::xxxxxxxxxxxx:role/JobExecutionRole',
            },
        });
    });
    test('Tags', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            tags: {
                key: 'value',
            },
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                Tags: {
                    key: 'value',
                },
            },
        });
    });
    test('Application Configuration', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            applicationConfig: [{
                    classification: start_job_run_1.Classification.SPARK_DEFAULTS,
                    properties: {
                        'spark.executor.instances': '1',
                        'spark.executor.memory': '512M',
                    },
                }],
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                ConfigurationOverrides: {
                    ApplicationConfiguration: [{
                            Classification: start_job_run_1.Classification.SPARK_DEFAULTS.classificationStatement,
                            Properties: {
                                'spark.executor.instances': '1',
                                'spark.executor.memory': '512M',
                            },
                        }],
                },
            },
        });
    });
    test('Application Configuration with nested app config and no properties', () => {
        const properties = { HADOOP_DATANODE_HEAPSIZE: '2048', HADOOP_NAMENODE_OPTS: '-XX:GCTimeRatio=19' };
        const struct = { classification: new start_job_run_1.Classification('export'), properties: properties };
        const appConfigNested = [struct];
        const mainConfig = { classification: new start_job_run_1.Classification('hadoop-env'), nestedConfig: appConfigNested };
        const appConfig = [mainConfig];
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            applicationConfig: appConfig,
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                ConfigurationOverrides: {
                    ApplicationConfiguration: [{
                            Classification: 'hadoop-env',
                            Configurations: [{
                                    Classification: 'export',
                                    Properties: {
                                        HADOOP_DATANODE_HEAPSIZE: '2048',
                                        HADOOP_NAMENODE_OPTS: '-XX:GCTimeRatio=19',
                                    },
                                }],
                        }],
                },
            },
        });
    });
    test('Job Driver with Entry Point Arguments', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            jobDriver: {
                sparkSubmitJobDriver: {
                    entryPoint: sfn.TaskInput.fromText('entrypoint'),
                    entryPointArguments: sfn.TaskInput.fromJsonPathAt('$.entrypointArguments'),
                },
            },
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                JobDriver: {
                    SparkSubmitJobDriver: {
                        'EntryPoint': 'entrypoint',
                        'EntryPointArguments.$': '$.entrypointArguments',
                    },
                },
            },
        });
    });
    test('Job Execution Role', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            executionRole: iam.Role.fromRoleArn(stack, 'Job Execution Role', 'arn:aws:iam::xxxxxxxxxxxx:role/JobExecutionRole'),
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                ExecutionRoleArn: 'arn:aws:iam::xxxxxxxxxxxx:role/JobExecutionRole',
            },
        });
        // THEN
        assertions_1.Template.fromStack(stack).resourceCountIs('AWS::CloudFormation::CustomResource', 0);
    });
    test('Virtual Cluster Input from virtualClusterId', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
            ...defaultProps,
            virtualCluster: start_job_run_1.VirtualClusterInput.fromVirtualClusterId(clusterId),
        });
        // THEN
        expect(stack.resolve(task.toStateJson())).toMatchObject({
            Parameters: {
                VirtualClusterId: clusterId,
            },
        });
    });
    describe('Invoke EMR Containers Start Job Run with Monitoring ', () => {
        test('generated automatically', () => {
            // WHEN
            const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
                ...defaultProps,
                monitoring: {
                    logging: true,
                },
            });
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
                PolicyDocument: {
                    Statement: [
                        {
                            Action: [
                                's3:GetObject*',
                                's3:GetBucket*',
                                's3:List*',
                                's3:DeleteObject*',
                                's3:PutObject',
                                's3:PutObjectLegalHold',
                                's3:PutObjectRetention',
                                's3:PutObjectTagging',
                                's3:PutObjectVersionTagging',
                                's3:Abort*',
                            ],
                            Effect: 'Allow',
                            Resource: [
                                {
                                    'Fn::GetAtt': [
                                        'EMRContainersStartJobRunMonitoringBucket8BB3FC54',
                                        'Arn',
                                    ],
                                },
                                {
                                    'Fn::Join': [
                                        '',
                                        [
                                            {
                                                'Fn::GetAtt': [
                                                    'EMRContainersStartJobRunMonitoringBucket8BB3FC54',
                                                    'Arn',
                                                ],
                                            },
                                            '/*',
                                        ],
                                    ],
                                },
                            ],
                        },
                        {
                            Action: [
                                'logs:CreateLogStream',
                                'logs:PutLogEvents',
                            ],
                            Effect: 'Allow',
                            Resource: {
                                'Fn::GetAtt': [
                                    'EMRContainersStartJobRunMonitoringLogGroup882D450C',
                                    'Arn',
                                ],
                            },
                        },
                        {
                            Action: 'logs:DescribeLogStreams',
                            Effect: 'Allow',
                            Resource: {
                                'Fn::GetAtt': [
                                    'EMRContainersStartJobRunMonitoringLogGroup882D450C',
                                    'Arn',
                                ],
                            },
                        },
                        {
                            Action: 'logs:DescribeLogGroups',
                            Effect: 'Allow',
                            Resource: {
                                'Fn::Join': [
                                    '',
                                    [
                                        'arn:',
                                        {
                                            Ref: 'AWS::Partition',
                                        },
                                        ':logs:',
                                        {
                                            Ref: 'AWS::Region',
                                        },
                                        ':',
                                        {
                                            Ref: 'AWS::AccountId',
                                        },
                                        ':*',
                                    ],
                                ],
                            },
                        },
                    ],
                    Version: '2012-10-17',
                },
                PolicyName: 'EMRContainersStartJobRunJobExecutionRoleDefaultPolicyCDBDF13E',
                Roles: [
                    {
                        Ref: 'EMRContainersStartJobRunJobExecutionRole40B8DD81',
                    },
                ],
            });
            // THEN
            expect(stack.resolve(task.toStateJson())).toMatchObject({
                Parameters: {
                    ConfigurationOverrides: {
                        MonitoringConfiguration: {
                            CloudWatchMonitoringConfiguration: {
                                LogGroupName: {
                                    Ref: 'EMRContainersStartJobRunMonitoringLogGroup882D450C',
                                },
                            },
                            PersistentAppUI: 'ENABLED',
                            S3MonitoringConfiguration: {
                                LogUri: {
                                    'Fn::Join': [
                                        '',
                                        [
                                            's3://',
                                            {
                                                Ref: 'EMRContainersStartJobRunMonitoringBucket8BB3FC54',
                                            },
                                        ],
                                    ],
                                },
                            },
                        },
                    },
                },
            });
        });
        test('provided from user', () => {
            // WHEN
            const logGroup = logs.LogGroup.fromLogGroupName(stack, 'Monitoring Group', 'providedloggroup');
            const s3Bucket = s3.Bucket.fromBucketName(stack, 'Monitoring Bucket', 'providedbucket');
            ;
            const prefixName = 'prefix';
            const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
                ...defaultProps,
                monitoring: {
                    logBucket: s3Bucket,
                    logGroup: logGroup,
                    logStreamNamePrefix: prefixName,
                    logging: false,
                },
            });
            // THEN
            assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
                PolicyDocument: {
                    Statement: [
                        {
                            Action: [
                                's3:GetObject*',
                                's3:GetBucket*',
                                's3:List*',
                                's3:DeleteObject*',
                                's3:PutObject',
                                's3:PutObjectLegalHold',
                                's3:PutObjectRetention',
                                's3:PutObjectTagging',
                                's3:PutObjectVersionTagging',
                                's3:Abort*',
                            ],
                            Effect: 'Allow',
                            Resource: [
                                {
                                    'Fn::Join': [
                                        '',
                                        [
                                            'arn:',
                                            {
                                                Ref: 'AWS::Partition',
                                            },
                                            ':s3:::providedbucket',
                                        ],
                                    ],
                                },
                                {
                                    'Fn::Join': [
                                        '',
                                        [
                                            'arn:',
                                            {
                                                Ref: 'AWS::Partition',
                                            },
                                            ':s3:::providedbucket/*',
                                        ],
                                    ],
                                },
                            ],
                        },
                        {
                            Action: [
                                'logs:CreateLogStream',
                                'logs:PutLogEvents',
                            ],
                            Effect: 'Allow',
                            Resource: {
                                'Fn::Join': [
                                    '',
                                    [
                                        'arn:',
                                        {
                                            Ref: 'AWS::Partition',
                                        },
                                        ':logs:',
                                        {
                                            Ref: 'AWS::Region',
                                        },
                                        ':',
                                        {
                                            Ref: 'AWS::AccountId',
                                        },
                                        ':log-group:providedloggroup:*',
                                    ],
                                ],
                            },
                        },
                        {
                            Action: 'logs:DescribeLogStreams',
                            Effect: 'Allow',
                            Resource: {
                                'Fn::Join': [
                                    '',
                                    [
                                        'arn:',
                                        {
                                            Ref: 'AWS::Partition',
                                        },
                                        ':logs:',
                                        {
                                            Ref: 'AWS::Region',
                                        },
                                        ':',
                                        {
                                            Ref: 'AWS::AccountId',
                                        },
                                        ':log-group:providedloggroup:*',
                                    ],
                                ],
                            },
                        },
                        {
                            Action: 'logs:DescribeLogGroups',
                            Effect: 'Allow',
                            Resource: {
                                'Fn::Join': [
                                    '',
                                    [
                                        'arn:',
                                        {
                                            Ref: 'AWS::Partition',
                                        },
                                        ':logs:',
                                        {
                                            Ref: 'AWS::Region',
                                        },
                                        ':',
                                        {
                                            Ref: 'AWS::AccountId',
                                        },
                                        ':*',
                                    ],
                                ],
                            },
                        },
                    ],
                    Version: '2012-10-17',
                },
                PolicyName: 'EMRContainersStartJobRunJobExecutionRoleDefaultPolicyCDBDF13E',
                Roles: [
                    {
                        Ref: 'EMRContainersStartJobRunJobExecutionRole40B8DD81',
                    },
                ],
            });
            // THEN
            expect(stack.resolve(task.toStateJson())).toMatchObject({
                Parameters: {
                    ConfigurationOverrides: {
                        MonitoringConfiguration: {
                            CloudWatchMonitoringConfiguration: {
                                LogGroupName: logGroup.logGroupName,
                                LogStreamNamePrefix: prefixName,
                            },
                            S3MonitoringConfiguration: {
                                LogUri: 's3://' + s3Bucket.bucketName,
                            },
                        },
                    },
                    ExecutionRoleArn: {
                        'Fn::GetAtt': [
                            'EMRContainersStartJobRunJobExecutionRole40B8DD81',
                            'Arn',
                        ],
                    },
                },
            });
        });
        test('PersistentAppUI to be disabled when set to false', () => {
            // WHEN
            const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', {
                ...defaultProps,
                monitoring: {
                    persistentAppUI: false,
                },
            });
            // THEN
            expect(stack.resolve(task.toStateJson())).toMatchObject({
                Parameters: {
                    ConfigurationOverrides: {
                        MonitoringConfiguration: {
                            PersistentAppUI: 'DISABLED',
                        },
                    },
                },
            });
        });
    });
    describe('Task throws if ', () => {
        test('Application Configuration array is larger than 100', () => {
            // WHEN
            const struct = { classification: start_job_run_1.Classification.SPARK };
            const appConfig = new Array(101).fill(struct);
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
                    ...defaultProps,
                    applicationConfig: appConfig,
                });
            }).toThrow(`Application configuration array must have 100 or fewer entries. Received ${appConfig.length}`);
        });
        test('Application Configuration nested configuration array is larger than 100', () => {
            // WHEN
            const struct = { classification: start_job_run_1.Classification.SPARK };
            let appConfig = new Array(101).fill(struct);
            const nestedConfigStruct = { classification: start_job_run_1.Classification.SPARK, nestedConfig: appConfig };
            appConfig[0] = nestedConfigStruct;
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
                    ...defaultProps,
                    applicationConfig: appConfig,
                });
            }).toThrow(`Application configuration array must have 100 or fewer entries. Received ${appConfig.length}`);
        });
        test('Application Configuration properties is larger than 100 entries', () => {
            // WHEN
            const properties = {};
            for (let index = 0; index <= 100; index++) {
                properties[index.toString()] = 'value';
            }
            const appConfig = { classification: start_job_run_1.Classification.SPARK, properties: properties };
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
                    ...defaultProps,
                    applicationConfig: [appConfig],
                });
            }).toThrow(`Application configuration properties must have 100 or fewer entries. Received ${Object.keys(properties).length}`);
        });
        test('Application Configuration properties is undefined and nested configuration array is undefined', () => {
            // WHEN
            const struct = { classification: start_job_run_1.Classification.SPARK };
            let appConfig = new Array(1).fill(struct);
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
                    ...defaultProps,
                    applicationConfig: appConfig,
                });
            }).toThrow('Application configuration must have either properties or nested app configurations defined.');
        });
        test('Entry Point is not between 1 to 256 characters in length', () => {
            // WHEN
            const entryPointString = 'x'.repeat(257);
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Start Job Run Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText(entryPointString),
                        },
                    },
                });
            }).toThrow(`Entry point must be between 1 and 256 characters in length. Received ${entryPointString.length}.`);
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText(''),
                        },
                    },
                });
            }).toThrow('Entry point must be between 1 and 256 characters in length. Received 0.');
        });
        test('Entry Point Arguments is not a string array that is between 1 and 10280 entries in length', () => {
            // WHEN
            const entryPointArgs = sfn.TaskInput.fromObject(new Array(10281).fill('x', 10281));
            const entryPointArgsNone = sfn.TaskInput.fromObject([]);
            const entryPointNumbers = sfn.TaskInput.fromObject(new Array(1).fill(1));
            const entryPointJson = sfn.TaskInput.fromText('x');
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'String array error Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText('job-location'),
                            entryPointArguments: entryPointNumbers,
                        },
                    },
                });
            }).toThrow('Entry point arguments must be a string array or an encoded JSON path but received object');
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'JSON Path error Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText('job-location'),
                            entryPointArguments: entryPointJson,
                        },
                    },
                });
            }).toThrow('Entry point arguments must be a string array or an encoded JSON path, but received a non JSON path string');
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Greater than 256 Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText('job-location'),
                            entryPointArguments: entryPointArgs,
                        },
                    },
                });
            }).toThrow(`Entry point arguments must be a string array between 1 and 10280 in length. Received ${entryPointArgs.value.length}.`);
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Less than 1 Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText('job-location'),
                            entryPointArguments: entryPointArgsNone,
                        },
                    },
                });
            }).toThrow(`Entry point arguments must be a string array between 1 and 10280 in length. Received ${entryPointArgsNone.value.length}.`);
        });
        test('Spark Submit Parameters is NOT between 1 characters and 102400 characters in length', () => {
            // WHEN
            const sparkSubmitParam = 'x'.repeat(102401);
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Spark Submit Parameter Task', {
                    ...defaultProps,
                    jobDriver: {
                        sparkSubmitJobDriver: {
                            entryPoint: sfn.TaskInput.fromText('job-location'),
                            sparkSubmitParameters: sparkSubmitParam,
                        },
                    },
                });
            }).toThrow(`Spark submit parameters must be between 1 and 102400 characters in length. Received ${sparkSubmitParam.length}.`);
        });
        test('an execution role is undefined and the virtual cluster ID is not a concrete value', () => {
            // WHEN
            const jsonPath = '$.ClusterId';
            // THEN
            expect(() => {
                new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
                    ...defaultProps,
                    virtualCluster: start_job_run_1.VirtualClusterInput.fromTaskInput(sfn.TaskInput.fromJsonPathAt(jsonPath)),
                });
            }).toThrow('Execution role cannot be undefined when the virtual cluster ID is not a concrete value. Provide an execution role with the correct trust policy');
        });
    });
    test('Permitted role actions and resources with Start Job Run for SYNC integration pattern', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'EMR Containers Start Job Run', defaultProps);
        new sfn.StateMachine(stack, 'SM', {
            definition: task,
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: [{
                        Action: 'emr-containers:StartJobRun',
                        Condition: {
                            StringEquals: {
                                'emr-containers:ExecutionRoleArn': {
                                    'Fn::GetAtt': [
                                        'EMRContainersStartJobRunJobExecutionRole40B8DD81',
                                        'Arn',
                                    ],
                                },
                            },
                        },
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    {
                                        Ref: 'AWS::Partition',
                                    },
                                    ':emr-containers:',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    ':',
                                    {
                                        Ref: 'AWS::AccountId',
                                    },
                                    `:/virtualclusters/${clusterId}`,
                                ],
                            ],
                        },
                    },
                    {
                        Action: [
                            'emr-containers:DescribeJobRun',
                            'emr-containers:CancelJobRun',
                        ],
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    {
                                        Ref: 'AWS::Partition',
                                    },
                                    ':emr-containers:',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    ':',
                                    {
                                        Ref: 'AWS::AccountId',
                                    },
                                    `:/virtualclusters/${clusterId}/jobruns/*`,
                                ],
                            ],
                        },
                    }],
            },
        });
    });
    test('Permitted role actions and resources with Start Job Run from payload', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
            ...defaultProps,
            virtualCluster: start_job_run_1.VirtualClusterInput.fromTaskInput(sfn.TaskInput.fromJsonPathAt('$.ClusterId')),
            executionRole: iam.Role.fromRoleArn(stack, 'Job Role', 'arn:aws:iam::xxxxxxxxxxxx:role/JobExecutionRole'),
        });
        new sfn.StateMachine(stack, 'SM', {
            definition: task,
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: [{
                        Action: 'emr-containers:StartJobRun',
                        Condition: {
                            StringEquals: {
                                'emr-containers:ExecutionRoleArn': 'arn:aws:iam::xxxxxxxxxxxx:role/JobExecutionRole',
                            },
                        },
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    {
                                        Ref: 'AWS::Partition',
                                    },
                                    ':emr-containers:',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    ':',
                                    {
                                        Ref: 'AWS::AccountId',
                                    },
                                    ':/virtualclusters/*',
                                ],
                            ],
                        },
                    },
                    {
                        Action: [
                            'emr-containers:DescribeJobRun',
                            'emr-containers:CancelJobRun',
                        ],
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    {
                                        Ref: 'AWS::Partition',
                                    },
                                    ':emr-containers:',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    ':',
                                    {
                                        Ref: 'AWS::AccountId',
                                    },
                                    ':/virtualclusters/*',
                                ],
                            ],
                        },
                    }],
            },
        });
    });
    test('Permitted role actions for Start Job Run with REQUEST/RESPONSE integration pattern', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
            ...defaultProps,
            integrationPattern: sfn.IntegrationPattern.REQUEST_RESPONSE,
        });
        new sfn.StateMachine(stack, 'SM', {
            definition: task,
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: [{
                        Action: 'emr-containers:StartJobRun',
                        Condition: {
                            StringEquals: {
                                'emr-containers:ExecutionRoleArn': {
                                    'Fn::GetAtt': [
                                        'TaskJobExecutionRole5D5BBA5A',
                                        'Arn',
                                    ],
                                },
                            },
                        },
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    {
                                        Ref: 'AWS::Partition',
                                    },
                                    ':emr-containers:',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    ':',
                                    {
                                        Ref: 'AWS::AccountId',
                                    },
                                    `:/virtualclusters/${clusterId}`,
                                ],
                            ],
                        },
                    }],
            },
        });
    });
    test('Custom resource is created with EMR Containers Describe Virtual Cluster invocation and has correct IAM policy permissions', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', defaultProps);
        new sfn.StateMachine(stack, 'SM', {
            definition: task,
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('Custom::AWS', {
            ServiceToken: {
                'Fn::GetAtt': [
                    'AWS679f53fac002430cb0da5b7982bd22872D164C4C',
                    'Arn',
                ],
            },
            Create: '{\"service\":\"EMRcontainers\",\"action\":\"describeVirtualCluster\",\"parameters\":{\"id\":\"clusterId\"},\"outputPaths\":[\"virtualCluster.containerProvider.info.eksInfo.namespace\",\"virtualCluster.containerProvider.id\"],\"physicalResourceId\":{\"id\":\"id\"}}',
            InstallLatestAwsSdk: false,
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: [{
                        Action: 'emr-containers:DescribeVirtualCluster',
                        Effect: 'Allow',
                        Resource: '*',
                    }],
            },
        });
    });
    test('Custom resource is created that has correct EKS namespace, environment, AWSCLI layer, and IAM policy permissions', () => {
        // WHEN
        const task = new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', defaultProps);
        new sfn.StateMachine(stack, 'SM', {
            definition: task,
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: [
                    {
                        Action: 'eks:DescribeCluster',
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    {
                                        Ref: 'AWS::Partition',
                                    },
                                    ':eks:',
                                    {
                                        Ref: 'AWS::Region',
                                    },
                                    ':',
                                    {
                                        Ref: 'AWS::AccountId',
                                    },
                                    ':cluster/',
                                    {
                                        'Fn::GetAtt': [
                                            'TaskGetEksClusterInfo2F156985',
                                            'virtualCluster.containerProvider.id',
                                        ],
                                    },
                                ],
                            ],
                        },
                    },
                    {
                        Action: [
                            'iam:GetRole',
                            'iam:UpdateAssumeRolePolicy',
                        ],
                        Effect: 'Allow',
                        Resource: {
                            'Fn::GetAtt': [
                                'TaskJobExecutionRole5D5BBA5A',
                                'Arn',
                            ],
                        },
                    },
                ],
            },
        });
        // THEN
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::Lambda::Function', {
            Handler: 'index.handler',
            Layers: [
                {
                    Ref: 'TaskawsclilayerB1A11740',
                },
            ],
            MemorySize: 256,
            Runtime: 'python3.9',
            Timeout: 30,
        });
    });
});
test('Task throws if WAIT_FOR_TASK_TOKEN is supplied as service integration pattern', () => {
    expect(() => {
        new start_job_run_1.EmrContainersStartJobRun(stack, 'Task', {
            virtualCluster: start_job_run_1.VirtualClusterInput.fromTaskInput(sfn.TaskInput.fromText(clusterId)),
            releaseLabel: start_job_run_1.ReleaseLabel.EMR_6_2_0,
            jobDriver: {
                sparkSubmitJobDriver: {
                    entryPoint: sfn.TaskInput.fromText('job-location'),
                },
            },
            integrationPattern: sfn.IntegrationPattern.WAIT_FOR_TASK_TOKEN,
        });
    }).toThrow(/Unsupported service integration pattern. Supported Patterns: REQUEST_RESPONSE,RUN_JOB. Received: WAIT_FOR_TASK_TOKEN/);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcnQtam9iLXJ1bi50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic3RhcnQtam9iLXJ1bi50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsb0RBQStDO0FBQy9DLHdDQUF3QztBQUN4QywwQ0FBMEM7QUFDMUMsc0NBQXNDO0FBQ3RDLGtEQUFrRDtBQUNsRCx3Q0FBc0M7QUFDdEMseUVBQTZMO0FBRTdMLElBQUksS0FBWSxDQUFDO0FBQ2pCLElBQUksU0FBaUIsQ0FBQztBQUN0QixJQUFJLFlBQTJDLENBQUM7QUFFaEQsVUFBVSxDQUFDLEdBQUcsRUFBRTtJQUNkLEtBQUssR0FBRyxJQUFJLFlBQUssRUFBRSxDQUFDO0lBQ3BCLFNBQVMsR0FBRyxXQUFXLENBQUM7SUFDeEIsWUFBWSxHQUFHO1FBQ2IsY0FBYyxFQUFFLG1DQUFtQixDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNwRixZQUFZLEVBQUUsNEJBQVksQ0FBQyxTQUFTO1FBQ3BDLFNBQVMsRUFBRTtZQUNULG9CQUFvQixFQUFFO2dCQUNwQixVQUFVLEVBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsdURBQXVELENBQUM7Z0JBQzNGLHFCQUFxQixFQUFFLG1DQUFtQzthQUMzRDtTQUNGO0tBQ0YsQ0FBQztBQUNKLENBQUMsQ0FBQyxDQUFDO0FBRUgsUUFBUSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsRUFBRTtJQUN6RCxJQUFJLENBQUMsc0NBQXNDLEVBQUUsR0FBRyxFQUFFO1FBQ2hELE9BQU87UUFDUCxNQUFNLElBQUksR0FBRyxJQUFJLHdDQUF3QixDQUFDLEtBQUssRUFBRSw4QkFBOEIsRUFBRTtZQUMvRSxHQUFHLFlBQVk7WUFDZixrQkFBa0IsRUFBRSxHQUFHLENBQUMsa0JBQWtCLENBQUMsZ0JBQWdCO1NBQzVELENBQUMsQ0FBQztRQUVILE9BQU87UUFDUCxNQUFNLENBQUMs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LENBQUM7QUFFSCxJQUFJLENBQUMsK0VBQStFLEVBQUUsR0FBRyxFQUFFO0lBQ3pGLE1BQU0sQ0FBQyxHQUFHLEVBQUU7UUFDVixJQUFJLHdDQUF3QixDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUU7WUFDMUMsY0FBYyxFQUFFLG1DQUFtQixDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNwRixZQUFZLEVBQUUsNEJBQVksQ0FBQyxTQUFTO1lBQ3BDLFNBQVMsRUFBRTtnQkFDVCxvQkFBb0IsRUFBRTtvQkFDcEIsVUFBVSxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQztpQkFDbkQ7YUFDRjtZQUNELGtCQUFrQixFQUFFLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxtQkFBbUI7U0FDL0QsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLHNIQUFzSCxDQUFDLENBQUM7QUFDckksQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUZW1wbGF0ZSB9IGZyb20gJy4uLy4uLy4uL2Fzc2VydGlvbnMnO1xuaW1wb3J0ICogYXMgaWFtIGZyb20gJy4uLy4uLy4uL2F3cy1pYW0nO1xuaW1wb3J0ICogYXMgbG9ncyBmcm9tICcuLi8uLi8uLi9hd3MtbG9ncyc7XG5pbXBvcnQgKiBhcyBzMyBmcm9tICcuLi8uLi8uLi9hd3MtczMnO1xuaW1wb3J0ICogYXMgc2ZuIGZyb20gJy4uLy4uLy4uL2F3cy1zdGVwZnVuY3Rpb25zJztcbmltcG9ydCB7IFN0YWNrIH0gZnJvbSAnLi4vLi4vLi4vY29yZSc7XG5pbXBvcnQgeyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4sIFZpcnR1YWxDbHVzdGVySW5wdXQsIFJlbGVhc2VMYWJlbCwgQXBwbGljYXRpb25Db25maWd1cmF0aW9uLCBDbGFzc2lmaWNhdGlvbiwgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuUHJvcHMgfSBmcm9tICcuLi8uLi9saWIvZW1yY29udGFpbmVycy9zdGFydC1qb2ItcnVuJztcblxubGV0IHN0YWNrOiBTdGFjaztcbmxldCBjbHVzdGVySWQ6IHN0cmluZztcbmxldCBkZWZhdWx0UHJvcHM6IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1blByb3BzO1xuXG5iZWZvcmVFYWNoKCgpID0+IHtcbiAgc3RhY2sgPSBuZXcgU3RhY2soKTtcbiAgY2x1c3RlcklkID0gJ2NsdXN0ZXJJZCc7XG4gIGRlZmF1bHRQcm9wcyA9IHtcbiAgICB2aXJ0dWFsQ2x1c3RlcjogVmlydHVhbENsdXN0ZXJJbnB1dC5mcm9tVGFza0lucHV0KHNmbi5UYXNrSW5wdXQuZnJvbVRleHQoY2x1c3RlcklkKSksXG4gICAgcmVsZWFzZUxhYmVsOiBSZWxlYXNlTGFiZWwuRU1SXzZfMl8wLFxuICAgIGpvYkRyaXZlcjoge1xuICAgICAgc3BhcmtTdWJtaXRKb2JEcml2ZXI6IHtcbiAgICAgICAgZW50cnlQb2ludDogc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dCgnbG9jYWw6Ly8vdXNyL2xpYi9zcGFyay9leGFtcGxlcy9zcmMvbWFpbi9weXRob24vcGkucHknKSxcbiAgICAgICAgc3BhcmtTdWJtaXRQYXJhbWV0ZXJzOiAnLS1jb25mIHNwYXJrLmV4ZWN1dG9yLmluc3RhbmNlcz0yJyxcbiAgICAgIH0sXG4gICAgfSxcbiAgfTtcbn0pO1xuXG5kZXNjcmliZSgnSW52b2tlIEVNUiBDb250YWluZXJzIFN0YXJ0IEpvYiBSdW4gd2l0aCAnLCAoKSA9PiB7XG4gIHRlc3QoJ1JlcXVlc3QvUmVzcG9uc2UgaW50ZWdyYXRpb24gcGF0dGVybicsICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdFTVIgQ29udGFpbmVycyBTdGFydCBKb2IgUnVuJywge1xuICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgaW50ZWdyYXRpb25QYXR0ZXJuOiBzZm4uSW50ZWdyYXRpb25QYXR0ZXJuLlJFUVVFU1RfUkVTUE9OU0UsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9NYXRjaE9iamVjdCh7XG4gICAgICBUeXBlOiAnVGFzaycsXG4gICAgICBSZXNvdXJjZToge1xuICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgJycsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBSZWY6ICdBV1M6OlBhcnRpdGlvbicsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJzpzdGF0ZXM6OjplbXItY29udGFpbmVyczpzdGFydEpvYlJ1bicsXG4gICAgICAgICAgXSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJy5zeW5jIGludGVncmF0aW9uIHBhdHRlcm4nLCAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHRhc2sgPSBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnRU1SIENvbnRhaW5lcnMgU3RhcnQgSm9iIFJ1bicsIGRlZmF1bHRQcm9wcyk7XG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChzdGFjay5yZXNvbHZlKHRhc2sudG9TdGF0ZUpzb24oKSkpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgVHlwZTogJ1Rhc2snLFxuICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICcnLFxuICAgICAgICAgIFtcbiAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICc6c3RhdGVzOjo6ZW1yLWNvbnRhaW5lcnM6c3RhcnRKb2JSdW4uc3luYycsXG4gICAgICAgICAgXSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3ZpcnR1YWwgY2x1c3RlciBpZCBmcm9tIHBheWxvYWQnLCAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHRhc2sgPSBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnRU1SIENvbnRhaW5lcnMgU3RhcnQgSm9iIFJ1bicsIHtcbiAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgIHZpcnR1YWxDbHVzdGVyOiBWaXJ0dWFsQ2x1c3RlcklucHV0LmZyb21UYXNrSW5wdXQoc2ZuLlRhc2tJbnB1dC5mcm9tSnNvblBhdGhBdCgnJC5DbHVzdGVySWQnKSksXG4gICAgICBleGVjdXRpb25Sb2xlOiBpYW0uUm9sZS5mcm9tUm9sZUFybihzdGFjaywgJ0pvYiBFeGVjdXRpb24gUm9sZScsICdhcm46YXdzOmlhbTo6eHh4eHh4eHh4eHh4OnJvbGUvSm9iRXhlY3V0aW9uUm9sZScpLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChzdGFjay5yZXNvbHZlKHRhc2sudG9TdGF0ZUpzb24oKSkpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICAnVmlydHVhbENsdXN0ZXJJZC4kJzogJyQuQ2x1c3RlcklkJyxcbiAgICAgICAgJ0V4ZWN1dGlvblJvbGVBcm4nOiAnYXJuOmF3czppYW06Onh4eHh4eHh4eHh4eDpyb2xlL0pvYkV4ZWN1dGlvblJvbGUnLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnVGFncycsICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdFTVIgQ29udGFpbmVycyBTdGFydCBKb2IgUnVuJywge1xuICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgdGFnczoge1xuICAgICAgICBrZXk6ICd2YWx1ZScsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChzdGFjay5yZXNvbHZlKHRhc2sudG9TdGF0ZUpzb24oKSkpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICBUYWdzOiB7XG4gICAgICAgICAga2V5OiAndmFsdWUnLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cblxuICB0ZXN0KCdBcHBsaWNhdGlvbiBDb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ0VNUiBDb250YWluZXJzIFN0YXJ0IEpvYiBSdW4nLCB7XG4gICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICBhcHBsaWNhdGlvbkNvbmZpZzogW3tcbiAgICAgICAgY2xhc3NpZmljYXRpb246IENsYXNzaWZpY2F0aW9uLlNQQVJLX0RFRkFVTFRTLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgJ3NwYXJrLmV4ZWN1dG9yLmluc3RhbmNlcyc6ICcxJyxcbiAgICAgICAgICAnc3BhcmsuZXhlY3V0b3IubWVtb3J5JzogJzUxMk0nLFxuICAgICAgICB9LFxuICAgICAgfV0sXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9NYXRjaE9iamVjdCh7XG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIENvbmZpZ3VyYXRpb25PdmVycmlkZXM6IHtcbiAgICAgICAgICBBcHBsaWNhdGlvbkNvbmZpZ3VyYXRpb246IFt7XG4gICAgICAgICAgICBDbGFzc2lmaWNhdGlvbjogQ2xhc3NpZmljYXRpb24uU1BBUktfREVGQVVMVFMuY2xhc3NpZmljYXRpb25TdGF0ZW1lbnQsXG4gICAgICAgICAgICBQcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICdzcGFyay5leGVjdXRvci5pbnN0YW5jZXMnOiAnMScsXG4gICAgICAgICAgICAgICdzcGFyay5leGVjdXRvci5tZW1vcnknOiAnNTEyTScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH1dLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnQXBwbGljYXRpb24gQ29uZmlndXJhdGlvbiB3aXRoIG5lc3RlZCBhcHAgY29uZmlnIGFuZCBubyBwcm9wZXJ0aWVzJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb3BlcnRpZXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7IEhBRE9PUF9EQVRBTk9ERV9IRUFQU0laRTogJzIwNDgnLCBIQURPT1BfTkFNRU5PREVfT1BUUzogJy1YWDpHQ1RpbWVSYXRpbz0xOScgfTtcbiAgICBjb25zdCBzdHJ1Y3QgPSB7IGNsYXNzaWZpY2F0aW9uOiBuZXcgQ2xhc3NpZmljYXRpb24oJ2V4cG9ydCcpLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzIH07XG4gICAgY29uc3QgYXBwQ29uZmlnTmVzdGVkOiBBcHBsaWNhdGlvbkNvbmZpZ3VyYXRpb25bXSA9IFtzdHJ1Y3RdO1xuXG4gICAgY29uc3QgbWFpbkNvbmZpZyA9IHsgY2xhc3NpZmljYXRpb246IG5ldyBDbGFzc2lmaWNhdGlvbignaGFkb29wLWVudicpLCBuZXN0ZWRDb25maWc6IGFwcENvbmZpZ05lc3RlZCB9O1xuICAgIGNvbnN0IGFwcENvbmZpZzogQXBwbGljYXRpb25Db25maWd1cmF0aW9uW10gPSBbbWFpbkNvbmZpZ107XG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHRhc2sgPSBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnRU1SIENvbnRhaW5lcnMgU3RhcnQgSm9iIFJ1bicsIHtcbiAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgIGFwcGxpY2F0aW9uQ29uZmlnOiBhcHBDb25maWcsXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9NYXRjaE9iamVjdCh7XG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIENvbmZpZ3VyYXRpb25PdmVycmlkZXM6IHtcbiAgICAgICAgICBBcHBsaWNhdGlvbkNvbmZpZ3VyYXRpb246IFt7XG4gICAgICAgICAgICBDbGFzc2lmaWNhdGlvbjogJ2hhZG9vcC1lbnYnLFxuICAgICAgICAgICAgQ29uZmlndXJhdGlvbnM6IFt7XG4gICAgICAgICAgICAgIENsYXNzaWZpY2F0aW9uOiAnZXhwb3J0JyxcbiAgICAgICAgICAgICAgUHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgIEhBRE9PUF9EQVRBTk9ERV9IRUFQU0laRTogJzIwNDgnLFxuICAgICAgICAgICAgICAgIEhBRE9PUF9OQU1FTk9ERV9PUFRTOiAnLVhYOkdDVGltZVJhdGlvPTE5JyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH1dLFxuICAgICAgICAgIH1dLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnSm9iIERyaXZlciB3aXRoIEVudHJ5IFBvaW50IEFyZ3VtZW50cycsICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdFTVIgQ29udGFpbmVycyBTdGFydCBKb2IgUnVuJywge1xuICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgam9iRHJpdmVyOiB7XG4gICAgICAgIHNwYXJrU3VibWl0Sm9iRHJpdmVyOiB7XG4gICAgICAgICAgZW50cnlQb2ludDogc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dCgnZW50cnlwb2ludCcpLFxuICAgICAgICAgIGVudHJ5UG9pbnRBcmd1bWVudHM6IHNmbi5UYXNrSW5wdXQuZnJvbUpzb25QYXRoQXQoJyQuZW50cnlwb2ludEFyZ3VtZW50cycpLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBleHBlY3Qoc3RhY2sucmVzb2x2ZSh0YXNrLnRvU3RhdGVKc29uKCkpKS50b01hdGNoT2JqZWN0KHtcbiAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgSm9iRHJpdmVyOiB7XG4gICAgICAgICAgU3BhcmtTdWJtaXRKb2JEcml2ZXI6IHtcbiAgICAgICAgICAgICdFbnRyeVBvaW50JzogJ2VudHJ5cG9pbnQnLFxuICAgICAgICAgICAgJ0VudHJ5UG9pbnRBcmd1bWVudHMuJCc6ICckLmVudHJ5cG9pbnRBcmd1bWVudHMnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdKb2IgRXhlY3V0aW9uIFJvbGUnLCAoKSA9PiB7XG4gICAgLy8gV0hFTlxuICAgIGNvbnN0IHRhc2sgPSBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnRU1SIENvbnRhaW5lcnMgU3RhcnQgSm9iIFJ1bicsIHtcbiAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgIGV4ZWN1dGlvblJvbGU6IGlhbS5Sb2xlLmZyb21Sb2xlQXJuKHN0YWNrLCAnSm9iIEV4ZWN1dGlvbiBSb2xlJywgJ2Fybjphd3M6aWFtOjp4eHh4eHh4eHh4eHg6cm9sZS9Kb2JFeGVjdXRpb25Sb2xlJyksXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9NYXRjaE9iamVjdCh7XG4gICAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICAgIEV4ZWN1dGlvblJvbGVBcm46ICdhcm46YXdzOmlhbTo6eHh4eHh4eHh4eHh4OnJvbGUvSm9iRXhlY3V0aW9uUm9sZScsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykucmVzb3VyY2VDb3VudElzKCdBV1M6OkNsb3VkRm9ybWF0aW9uOjpDdXN0b21SZXNvdXJjZScsIDApO1xuICB9KTtcblxuICB0ZXN0KCdWaXJ0dWFsIENsdXN0ZXIgSW5wdXQgZnJvbSB2aXJ0dWFsQ2x1c3RlcklkJywgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ0VNUiBDb250YWluZXJzIFN0YXJ0IEpvYiBSdW4nLCB7XG4gICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICB2aXJ0dWFsQ2x1c3RlcjogVmlydHVhbENsdXN0ZXJJbnB1dC5mcm9tVmlydHVhbENsdXN0ZXJJZChjbHVzdGVySWQpLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIGV4cGVjdChzdGFjay5yZXNvbHZlKHRhc2sudG9TdGF0ZUpzb24oKSkpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICBWaXJ0dWFsQ2x1c3RlcklkOiBjbHVzdGVySWQsXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnSW52b2tlIEVNUiBDb250YWluZXJzIFN0YXJ0IEpvYiBSdW4gd2l0aCBNb25pdG9yaW5nICcsICgpID0+IHtcbiAgICB0ZXN0KCdnZW5lcmF0ZWQgYXV0b21hdGljYWxseScsICgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IHRhc2sgPSBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnRU1SIENvbnRhaW5lcnMgU3RhcnQgSm9iIFJ1bicsIHtcbiAgICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgICBtb25pdG9yaW5nOiB7XG4gICAgICAgICAgbG9nZ2luZzogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICAgICAgUG9saWN5RG9jdW1lbnQ6IHtcbiAgICAgICAgICBTdGF0ZW1lbnQ6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgQWN0aW9uOiBbXG4gICAgICAgICAgICAgICAgJ3MzOkdldE9iamVjdConLFxuICAgICAgICAgICAgICAgICdzMzpHZXRCdWNrZXQqJyxcbiAgICAgICAgICAgICAgICAnczM6TGlzdConLFxuICAgICAgICAgICAgICAgICdzMzpEZWxldGVPYmplY3QqJyxcbiAgICAgICAgICAgICAgICAnczM6UHV0T2JqZWN0JyxcbiAgICAgICAgICAgICAgICAnczM6UHV0T2JqZWN0TGVnYWxIb2xkJyxcbiAgICAgICAgICAgICAgICAnczM6UHV0T2JqZWN0UmV0ZW50aW9uJyxcbiAgICAgICAgICAgICAgICAnczM6UHV0T2JqZWN0VGFnZ2luZycsXG4gICAgICAgICAgICAgICAgJ3MzOlB1dE9iamVjdFZlcnNpb25UYWdnaW5nJyxcbiAgICAgICAgICAgICAgICAnczM6QWJvcnQqJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgICBSZXNvdXJjZTogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogW1xuICAgICAgICAgICAgICAgICAgICAnRU1SQ29udGFpbmVyc1N0YXJ0Sm9iUnVuTW9uaXRvcmluZ0J1Y2tldDhCQjNGQzU0JyxcbiAgICAgICAgICAgICAgICAgICAgJ0FybicsXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAnRU1SQ29udGFpbmVyc1N0YXJ0Sm9iUnVuTW9uaXRvcmluZ0J1Y2tldDhCQjNGQzU0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJ0FybicsXG4gICAgICAgICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgJy8qJyxcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIEFjdGlvbjogW1xuICAgICAgICAgICAgICAgICdsb2dzOkNyZWF0ZUxvZ1N0cmVhbScsXG4gICAgICAgICAgICAgICAgJ2xvZ3M6UHV0TG9nRXZlbnRzJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogW1xuICAgICAgICAgICAgICAgICAgJ0VNUkNvbnRhaW5lcnNTdGFydEpvYlJ1bk1vbml0b3JpbmdMb2dHcm91cDg4MkQ0NTBDJyxcbiAgICAgICAgICAgICAgICAgICdBcm4nLFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBBY3Rpb246ICdsb2dzOkRlc2NyaWJlTG9nU3RyZWFtcycsXG4gICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgICAgICdFTVJDb250YWluZXJzU3RhcnRKb2JSdW5Nb25pdG9yaW5nTG9nR3JvdXA4ODJENDUwQycsXG4gICAgICAgICAgICAgICAgICAnQXJuJyxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgQWN0aW9uOiAnbG9nczpEZXNjcmliZUxvZ0dyb3VwcycsXG4gICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnOmxvZ3M6JyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UmVnaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJzonLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpBY2NvdW50SWQnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnOionLFxuICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdLFxuICAgICAgICAgIFZlcnNpb246ICcyMDEyLTEwLTE3JyxcbiAgICAgICAgfSxcbiAgICAgICAgUG9saWN5TmFtZTogJ0VNUkNvbnRhaW5lcnNTdGFydEpvYlJ1bkpvYkV4ZWN1dGlvblJvbGVEZWZhdWx0UG9saWN5Q0RCREYxM0UnLFxuICAgICAgICBSb2xlczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFJlZjogJ0VNUkNvbnRhaW5lcnNTdGFydEpvYlJ1bkpvYkV4ZWN1dGlvblJvbGU0MEI4REQ4MScsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBleHBlY3Qoc3RhY2sucmVzb2x2ZSh0YXNrLnRvU3RhdGVKc29uKCkpKS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgUGFyYW1ldGVyczoge1xuICAgICAgICAgIENvbmZpZ3VyYXRpb25PdmVycmlkZXM6IHtcbiAgICAgICAgICAgIE1vbml0b3JpbmdDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgIENsb3VkV2F0Y2hNb25pdG9yaW5nQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICAgIExvZ0dyb3VwTmFtZToge1xuICAgICAgICAgICAgICAgICAgUmVmOiAnRU1SQ29udGFpbmVyc1N0YXJ0Sm9iUnVuTW9uaXRvcmluZ0xvZ0dyb3VwODgyRDQ1MEMnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIFBlcnNpc3RlbnRBcHBVSTogJ0VOQUJMRUQnLFxuICAgICAgICAgICAgICBTM01vbml0b3JpbmdDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgTG9nVXJpOiB7XG4gICAgICAgICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgJ3MzOi8vJyxcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBSZWY6ICdFTVJDb250YWluZXJzU3RhcnRKb2JSdW5Nb25pdG9yaW5nQnVja2V0OEJCM0ZDNTQnLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Byb3ZpZGVkIGZyb20gdXNlcicsICgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IGxvZ0dyb3VwID0gbG9ncy5Mb2dHcm91cC5mcm9tTG9nR3JvdXBOYW1lKHN0YWNrLCAnTW9uaXRvcmluZyBHcm91cCcsICdwcm92aWRlZGxvZ2dyb3VwJyk7XG4gICAgICBjb25zdCBzM0J1Y2tldCA9IHMzLkJ1Y2tldC5mcm9tQnVja2V0TmFtZShzdGFjaywgJ01vbml0b3JpbmcgQnVja2V0JywgJ3Byb3ZpZGVkYnVja2V0Jyk7O1xuICAgICAgY29uc3QgcHJlZml4TmFtZSA9ICdwcmVmaXgnO1xuXG4gICAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ0VNUiBDb250YWluZXJzIFN0YXJ0IEpvYiBSdW4nLCB7XG4gICAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgICAgbW9uaXRvcmluZzoge1xuICAgICAgICAgIGxvZ0J1Y2tldDogczNCdWNrZXQsXG4gICAgICAgICAgbG9nR3JvdXA6IGxvZ0dyb3VwLFxuICAgICAgICAgIGxvZ1N0cmVhbU5hbWVQcmVmaXg6IHByZWZpeE5hbWUsXG4gICAgICAgICAgbG9nZ2luZzogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLCB7XG4gICAgICAgIFBvbGljeURvY3VtZW50OiB7XG4gICAgICAgICAgU3RhdGVtZW50OiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIEFjdGlvbjogW1xuICAgICAgICAgICAgICAgICdzMzpHZXRPYmplY3QqJyxcbiAgICAgICAgICAgICAgICAnczM6R2V0QnVja2V0KicsXG4gICAgICAgICAgICAgICAgJ3MzOkxpc3QqJyxcbiAgICAgICAgICAgICAgICAnczM6RGVsZXRlT2JqZWN0KicsXG4gICAgICAgICAgICAgICAgJ3MzOlB1dE9iamVjdCcsXG4gICAgICAgICAgICAgICAgJ3MzOlB1dE9iamVjdExlZ2FsSG9sZCcsXG4gICAgICAgICAgICAgICAgJ3MzOlB1dE9iamVjdFJldGVudGlvbicsXG4gICAgICAgICAgICAgICAgJ3MzOlB1dE9iamVjdFRhZ2dpbmcnLFxuICAgICAgICAgICAgICAgICdzMzpQdXRPYmplY3RWZXJzaW9uVGFnZ2luZycsXG4gICAgICAgICAgICAgICAgJ3MzOkFib3J0KicsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgUmVzb3VyY2U6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICc6czM6Ojpwcm92aWRlZGJ1Y2tldCcsXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlBhcnRpdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAnOnMzOjo6cHJvdmlkZWRidWNrZXQvKicsXG4gICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICAgICAnbG9nczpDcmVhdGVMb2dTdHJlYW0nLFxuICAgICAgICAgICAgICAgICdsb2dzOlB1dExvZ0V2ZW50cycsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnOmxvZ3M6JyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UmVnaW9uJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJzonLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpBY2NvdW50SWQnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnOmxvZy1ncm91cDpwcm92aWRlZGxvZ2dyb3VwOionLFxuICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgQWN0aW9uOiAnbG9nczpEZXNjcmliZUxvZ1N0cmVhbXMnLFxuICAgICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJzpsb2dzOicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICc6JyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6QWNjb3VudElkJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJzpsb2ctZ3JvdXA6cHJvdmlkZWRsb2dncm91cDoqJyxcbiAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIEFjdGlvbjogJ2xvZ3M6RGVzY3JpYmVMb2dHcm91cHMnLFxuICAgICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJzpsb2dzOicsXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICc6JyxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6QWNjb3VudElkJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJzoqJyxcbiAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgICBWZXJzaW9uOiAnMjAxMi0xMC0xNycsXG4gICAgICAgIH0sXG4gICAgICAgIFBvbGljeU5hbWU6ICdFTVJDb250YWluZXJzU3RhcnRKb2JSdW5Kb2JFeGVjdXRpb25Sb2xlRGVmYXVsdFBvbGljeUNEQkRGMTNFJyxcbiAgICAgICAgUm9sZXM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBSZWY6ICdFTVJDb250YWluZXJzU3RhcnRKb2JSdW5Kb2JFeGVjdXRpb25Sb2xlNDBCOEREODEnLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9KTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9NYXRjaE9iamVjdCh7XG4gICAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgICBDb25maWd1cmF0aW9uT3ZlcnJpZGVzOiB7XG4gICAgICAgICAgICBNb25pdG9yaW5nQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICBDbG91ZFdhdGNoTW9uaXRvcmluZ0NvbmZpZ3VyYXRpb246IHtcbiAgICAgICAgICAgICAgICBMb2dHcm91cE5hbWU6IGxvZ0dyb3VwLmxvZ0dyb3VwTmFtZSxcbiAgICAgICAgICAgICAgICBMb2dTdHJlYW1OYW1lUHJlZml4OiBwcmVmaXhOYW1lLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBTM01vbml0b3JpbmdDb25maWd1cmF0aW9uOiB7XG4gICAgICAgICAgICAgICAgTG9nVXJpOiAnczM6Ly8nICsgczNCdWNrZXQuYnVja2V0TmFtZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBFeGVjdXRpb25Sb2xlQXJuOiB7XG4gICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgJ0VNUkNvbnRhaW5lcnNTdGFydEpvYlJ1bkpvYkV4ZWN1dGlvblJvbGU0MEI4REQ4MScsXG4gICAgICAgICAgICAgICdBcm4nLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdQZXJzaXN0ZW50QXBwVUkgdG8gYmUgZGlzYWJsZWQgd2hlbiBzZXQgdG8gZmFsc2UnLCAoKSA9PiB7XG4gICAgICAvLyBXSEVOXG4gICAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ0VNUiBDb250YWluZXJzIFN0YXJ0IEpvYiBSdW4nLCB7XG4gICAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgICAgbW9uaXRvcmluZzoge1xuICAgICAgICAgIHBlcnNpc3RlbnRBcHBVSTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9NYXRjaE9iamVjdCh7XG4gICAgICAgIFBhcmFtZXRlcnM6IHtcbiAgICAgICAgICBDb25maWd1cmF0aW9uT3ZlcnJpZGVzOiB7XG4gICAgICAgICAgICBNb25pdG9yaW5nQ29uZmlndXJhdGlvbjoge1xuICAgICAgICAgICAgICBQZXJzaXN0ZW50QXBwVUk6ICdESVNBQkxFRCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Rhc2sgdGhyb3dzIGlmICcsICgpID0+IHtcbiAgICB0ZXN0KCdBcHBsaWNhdGlvbiBDb25maWd1cmF0aW9uIGFycmF5IGlzIGxhcmdlciB0aGFuIDEwMCcsICgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IHN0cnVjdCA9IHsgY2xhc3NpZmljYXRpb246IENsYXNzaWZpY2F0aW9uLlNQQVJLIH07XG4gICAgICBjb25zdCBhcHBDb25maWc6IEFwcGxpY2F0aW9uQ29uZmlndXJhdGlvbltdID0gbmV3IEFycmF5KDEwMSkuZmlsbChzdHJ1Y3QpO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnVGFzaycsIHtcbiAgICAgICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICAgICAgYXBwbGljYXRpb25Db25maWc6IGFwcENvbmZpZyxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KGBBcHBsaWNhdGlvbiBjb25maWd1cmF0aW9uIGFycmF5IG11c3QgaGF2ZSAxMDAgb3IgZmV3ZXIgZW50cmllcy4gUmVjZWl2ZWQgJHthcHBDb25maWcubGVuZ3RofWApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnQXBwbGljYXRpb24gQ29uZmlndXJhdGlvbiBuZXN0ZWQgY29uZmlndXJhdGlvbiBhcnJheSBpcyBsYXJnZXIgdGhhbiAxMDAnLCAoKSA9PiB7XG4gICAgICAvLyBXSEVOXG4gICAgICBjb25zdCBzdHJ1Y3QgPSB7IGNsYXNzaWZpY2F0aW9uOiBDbGFzc2lmaWNhdGlvbi5TUEFSSyB9O1xuICAgICAgbGV0IGFwcENvbmZpZzogQXBwbGljYXRpb25Db25maWd1cmF0aW9uW10gPSBuZXcgQXJyYXkoMTAxKS5maWxsKHN0cnVjdCk7XG5cbiAgICAgIGNvbnN0IG5lc3RlZENvbmZpZ1N0cnVjdCA9IHsgY2xhc3NpZmljYXRpb246IENsYXNzaWZpY2F0aW9uLlNQQVJLLCBuZXN0ZWRDb25maWc6IGFwcENvbmZpZyB9O1xuICAgICAgYXBwQ29uZmlnWzBdID0gbmVzdGVkQ29uZmlnU3RydWN0O1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnVGFzaycsIHtcbiAgICAgICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICAgICAgYXBwbGljYXRpb25Db25maWc6IGFwcENvbmZpZyxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KGBBcHBsaWNhdGlvbiBjb25maWd1cmF0aW9uIGFycmF5IG11c3QgaGF2ZSAxMDAgb3IgZmV3ZXIgZW50cmllcy4gUmVjZWl2ZWQgJHthcHBDb25maWcubGVuZ3RofWApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnQXBwbGljYXRpb24gQ29uZmlndXJhdGlvbiBwcm9wZXJ0aWVzIGlzIGxhcmdlciB0aGFuIDEwMCBlbnRyaWVzJywgKCkgPT4ge1xuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgcHJvcGVydGllczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHt9O1xuICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8PSAxMDA7IGluZGV4KyspIHtcbiAgICAgICAgcHJvcGVydGllc1tpbmRleC50b1N0cmluZygpXSA9ICd2YWx1ZSc7XG4gICAgICB9XG4gICAgICBjb25zdCBhcHBDb25maWc6IEFwcGxpY2F0aW9uQ29uZmlndXJhdGlvbiA9IHsgY2xhc3NpZmljYXRpb246IENsYXNzaWZpY2F0aW9uLlNQQVJLLCBwcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzIH07XG5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdUYXNrJywge1xuICAgICAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgICAgICBhcHBsaWNhdGlvbkNvbmZpZzogW2FwcENvbmZpZ10sXG4gICAgICAgIH0pO1xuICAgICAgfSkudG9UaHJvdyhgQXBwbGljYXRpb24gY29uZmlndXJhdGlvbiBwcm9wZXJ0aWVzIG11c3QgaGF2ZSAxMDAgb3IgZmV3ZXIgZW50cmllcy4gUmVjZWl2ZWQgJHtPYmplY3Qua2V5cyhwcm9wZXJ0aWVzKS5sZW5ndGh9YCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdBcHBsaWNhdGlvbiBDb25maWd1cmF0aW9uIHByb3BlcnRpZXMgaXMgdW5kZWZpbmVkIGFuZCBuZXN0ZWQgY29uZmlndXJhdGlvbiBhcnJheSBpcyB1bmRlZmluZWQnLCAoKSA9PiB7XG4gICAgICAvLyBXSEVOXG4gICAgICBjb25zdCBzdHJ1Y3QgPSB7IGNsYXNzaWZpY2F0aW9uOiBDbGFzc2lmaWNhdGlvbi5TUEFSSyB9O1xuICAgICAgbGV0IGFwcENvbmZpZzogQXBwbGljYXRpb25Db25maWd1cmF0aW9uW10gPSBuZXcgQXJyYXkoMSkuZmlsbChzdHJ1Y3QpO1xuXG4gICAgICAvLyBUSEVOXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnVGFzaycsIHtcbiAgICAgICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICAgICAgYXBwbGljYXRpb25Db25maWc6IGFwcENvbmZpZyxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KCdBcHBsaWNhdGlvbiBjb25maWd1cmF0aW9uIG11c3QgaGF2ZSBlaXRoZXIgcHJvcGVydGllcyBvciBuZXN0ZWQgYXBwIGNvbmZpZ3VyYXRpb25zIGRlZmluZWQuJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdFbnRyeSBQb2ludCBpcyBub3QgYmV0d2VlbiAxIHRvIDI1NiBjaGFyYWN0ZXJzIGluIGxlbmd0aCcsICgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IGVudHJ5UG9pbnRTdHJpbmcgPSAneCcucmVwZWF0KDI1Nyk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdTdGFydCBKb2IgUnVuIFRhc2snLCB7XG4gICAgICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgICAgIGpvYkRyaXZlcjoge1xuICAgICAgICAgICAgc3BhcmtTdWJtaXRKb2JEcml2ZXI6IHtcbiAgICAgICAgICAgICAgZW50cnlQb2ludDogc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dChlbnRyeVBvaW50U3RyaW5nKSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KGBFbnRyeSBwb2ludCBtdXN0IGJlIGJldHdlZW4gMSBhbmQgMjU2IGNoYXJhY3RlcnMgaW4gbGVuZ3RoLiBSZWNlaXZlZCAke2VudHJ5UG9pbnRTdHJpbmcubGVuZ3RofS5gKTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ1Rhc2snLCB7XG4gICAgICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgICAgIGpvYkRyaXZlcjoge1xuICAgICAgICAgICAgc3BhcmtTdWJtaXRKb2JEcml2ZXI6IHtcbiAgICAgICAgICAgICAgZW50cnlQb2ludDogc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dCgnJyksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSkudG9UaHJvdygnRW50cnkgcG9pbnQgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDI1NiBjaGFyYWN0ZXJzIGluIGxlbmd0aC4gUmVjZWl2ZWQgMC4nKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ0VudHJ5IFBvaW50IEFyZ3VtZW50cyBpcyBub3QgYSBzdHJpbmcgYXJyYXkgdGhhdCBpcyBiZXR3ZWVuIDEgYW5kIDEwMjgwIGVudHJpZXMgaW4gbGVuZ3RoJywgKCkgPT4ge1xuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgZW50cnlQb2ludEFyZ3MgPSBzZm4uVGFza0lucHV0LmZyb21PYmplY3QobmV3IEFycmF5KDEwMjgxKS5maWxsKCd4JywgMTAyODEpKTtcbiAgICAgIGNvbnN0IGVudHJ5UG9pbnRBcmdzTm9uZSA9IHNmbi5UYXNrSW5wdXQuZnJvbU9iamVjdChbXSk7XG4gICAgICBjb25zdCBlbnRyeVBvaW50TnVtYmVycyA9IHNmbi5UYXNrSW5wdXQuZnJvbU9iamVjdChuZXcgQXJyYXkoMSkuZmlsbCgxKSk7XG4gICAgICBjb25zdCBlbnRyeVBvaW50SnNvbiA9IHNmbi5UYXNrSW5wdXQuZnJvbVRleHQoJ3gnKTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ1N0cmluZyBhcnJheSBlcnJvciBUYXNrJywge1xuICAgICAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgICAgICBqb2JEcml2ZXI6IHtcbiAgICAgICAgICAgIHNwYXJrU3VibWl0Sm9iRHJpdmVyOiB7XG4gICAgICAgICAgICAgIGVudHJ5UG9pbnQ6IHNmbi5UYXNrSW5wdXQuZnJvbVRleHQoJ2pvYi1sb2NhdGlvbicpLFxuICAgICAgICAgICAgICBlbnRyeVBvaW50QXJndW1lbnRzOiBlbnRyeVBvaW50TnVtYmVycyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KCdFbnRyeSBwb2ludCBhcmd1bWVudHMgbXVzdCBiZSBhIHN0cmluZyBhcnJheSBvciBhbiBlbmNvZGVkIEpTT04gcGF0aCBidXQgcmVjZWl2ZWQgb2JqZWN0Jyk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdKU09OIFBhdGggZXJyb3IgVGFzaycsIHtcbiAgICAgICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICAgICAgam9iRHJpdmVyOiB7XG4gICAgICAgICAgICBzcGFya1N1Ym1pdEpvYkRyaXZlcjoge1xuICAgICAgICAgICAgICBlbnRyeVBvaW50OiBzZm4uVGFza0lucHV0LmZyb21UZXh0KCdqb2ItbG9jYXRpb24nKSxcbiAgICAgICAgICAgICAgZW50cnlQb2ludEFyZ3VtZW50czogZW50cnlQb2ludEpzb24sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSkudG9UaHJvdygnRW50cnkgcG9pbnQgYXJndW1lbnRzIG11c3QgYmUgYSBzdHJpbmcgYXJyYXkgb3IgYW4gZW5jb2RlZCBKU09OIHBhdGgsIGJ1dCByZWNlaXZlZCBhIG5vbiBKU09OIHBhdGggc3RyaW5nJyk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdHcmVhdGVyIHRoYW4gMjU2IFRhc2snLCB7XG4gICAgICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgICAgIGpvYkRyaXZlcjoge1xuICAgICAgICAgICAgc3BhcmtTdWJtaXRKb2JEcml2ZXI6IHtcbiAgICAgICAgICAgICAgZW50cnlQb2ludDogc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dCgnam9iLWxvY2F0aW9uJyksXG4gICAgICAgICAgICAgIGVudHJ5UG9pbnRBcmd1bWVudHM6IGVudHJ5UG9pbnRBcmdzLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0pLnRvVGhyb3coYEVudHJ5IHBvaW50IGFyZ3VtZW50cyBtdXN0IGJlIGEgc3RyaW5nIGFycmF5IGJldHdlZW4gMSBhbmQgMTAyODAgaW4gbGVuZ3RoLiBSZWNlaXZlZCAke2VudHJ5UG9pbnRBcmdzLnZhbHVlLmxlbmd0aH0uYCk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdMZXNzIHRoYW4gMSBUYXNrJywge1xuICAgICAgICAgIC4uLmRlZmF1bHRQcm9wcyxcbiAgICAgICAgICBqb2JEcml2ZXI6IHtcbiAgICAgICAgICAgIHNwYXJrU3VibWl0Sm9iRHJpdmVyOiB7XG4gICAgICAgICAgICAgIGVudHJ5UG9pbnQ6IHNmbi5UYXNrSW5wdXQuZnJvbVRleHQoJ2pvYi1sb2NhdGlvbicpLFxuICAgICAgICAgICAgICBlbnRyeVBvaW50QXJndW1lbnRzOiBlbnRyeVBvaW50QXJnc05vbmUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSkudG9UaHJvdyhgRW50cnkgcG9pbnQgYXJndW1lbnRzIG11c3QgYmUgYSBzdHJpbmcgYXJyYXkgYmV0d2VlbiAxIGFuZCAxMDI4MCBpbiBsZW5ndGguIFJlY2VpdmVkICR7ZW50cnlQb2ludEFyZ3NOb25lLnZhbHVlLmxlbmd0aH0uYCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdTcGFyayBTdWJtaXQgUGFyYW1ldGVycyBpcyBOT1QgYmV0d2VlbiAxIGNoYXJhY3RlcnMgYW5kIDEwMjQwMCBjaGFyYWN0ZXJzIGluIGxlbmd0aCcsICgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IHNwYXJrU3VibWl0UGFyYW0gPSAneCcucmVwZWF0KDEwMjQwMSk7XG5cbiAgICAgIC8vIFRIRU5cbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdTcGFyayBTdWJtaXQgUGFyYW1ldGVyIFRhc2snLCB7XG4gICAgICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgICAgIGpvYkRyaXZlcjoge1xuICAgICAgICAgICAgc3BhcmtTdWJtaXRKb2JEcml2ZXI6IHtcbiAgICAgICAgICAgICAgZW50cnlQb2ludDogc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dCgnam9iLWxvY2F0aW9uJyksXG4gICAgICAgICAgICAgIHNwYXJrU3VibWl0UGFyYW1ldGVyczogc3BhcmtTdWJtaXRQYXJhbSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9KS50b1Rocm93KGBTcGFyayBzdWJtaXQgcGFyYW1ldGVycyBtdXN0IGJlIGJldHdlZW4gMSBhbmQgMTAyNDAwIGNoYXJhY3RlcnMgaW4gbGVuZ3RoLiBSZWNlaXZlZCAke3NwYXJrU3VibWl0UGFyYW0ubGVuZ3RofS5gKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ2FuIGV4ZWN1dGlvbiByb2xlIGlzIHVuZGVmaW5lZCBhbmQgdGhlIHZpcnR1YWwgY2x1c3RlciBJRCBpcyBub3QgYSBjb25jcmV0ZSB2YWx1ZScsICgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IGpzb25QYXRoID0gJyQuQ2x1c3RlcklkJztcblxuICAgICAgLy8gVEhFTlxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ1Rhc2snLCB7XG4gICAgICAgICAgLi4uZGVmYXVsdFByb3BzLFxuICAgICAgICAgIHZpcnR1YWxDbHVzdGVyOiBWaXJ0dWFsQ2x1c3RlcklucHV0LmZyb21UYXNrSW5wdXQoc2ZuLlRhc2tJbnB1dC5mcm9tSnNvblBhdGhBdChqc29uUGF0aCkpLFxuICAgICAgICB9KTtcbiAgICAgIH0pLnRvVGhyb3coJ0V4ZWN1dGlvbiByb2xlIGNhbm5vdCBiZSB1bmRlZmluZWQgd2hlbiB0aGUgdmlydHVhbCBjbHVzdGVyIElEIGlzIG5vdCBhIGNvbmNyZXRlIHZhbHVlLiBQcm92aWRlIGFuIGV4ZWN1dGlvbiByb2xlIHdpdGggdGhlIGNvcnJlY3QgdHJ1c3QgcG9saWN5Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Blcm1pdHRlZCByb2xlIGFjdGlvbnMgYW5kIHJlc291cmNlcyB3aXRoIFN0YXJ0IEpvYiBSdW4gZm9yIFNZTkMgaW50ZWdyYXRpb24gcGF0dGVybicsICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdFTVIgQ29udGFpbmVycyBTdGFydCBKb2IgUnVuJywgZGVmYXVsdFByb3BzKTtcblxuICAgIG5ldyBzZm4uU3RhdGVNYWNoaW5lKHN0YWNrLCAnU00nLCB7XG4gICAgICBkZWZpbml0aW9uOiB0YXNrLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgUG9saWN5RG9jdW1lbnQ6IHtcbiAgICAgICAgU3RhdGVtZW50OiBbe1xuICAgICAgICAgIEFjdGlvbjogJ2Vtci1jb250YWluZXJzOlN0YXJ0Sm9iUnVuJyxcbiAgICAgICAgICBDb25kaXRpb246IHtcbiAgICAgICAgICAgIFN0cmluZ0VxdWFsczoge1xuICAgICAgICAgICAgICAnZW1yLWNvbnRhaW5lcnM6RXhlY3V0aW9uUm9sZUFybic6IHtcbiAgICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgICAgICdFTVJDb250YWluZXJzU3RhcnRKb2JSdW5Kb2JFeGVjdXRpb25Sb2xlNDBCOEREODEnLFxuICAgICAgICAgICAgICAgICAgJ0FybicsXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAnYXJuOicsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJzplbXItY29udGFpbmVyczonLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UmVnaW9uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICc6JyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OkFjY291bnRJZCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBgOi92aXJ0dWFsY2x1c3RlcnMvJHtjbHVzdGVySWR9YCxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIEFjdGlvbjogW1xuICAgICAgICAgICAgJ2Vtci1jb250YWluZXJzOkRlc2NyaWJlSm9iUnVuJyxcbiAgICAgICAgICAgICdlbXItY29udGFpbmVyczpDYW5jZWxKb2JSdW4nLFxuICAgICAgICAgIF0sXG4gICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICc6ZW1yLWNvbnRhaW5lcnM6JyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnOicsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpBY2NvdW50SWQnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYDovdmlydHVhbGNsdXN0ZXJzLyR7Y2x1c3RlcklkfS9qb2JydW5zLypgLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9XSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Blcm1pdHRlZCByb2xlIGFjdGlvbnMgYW5kIHJlc291cmNlcyB3aXRoIFN0YXJ0IEpvYiBSdW4gZnJvbSBwYXlsb2FkJywgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ1Rhc2snLCB7XG4gICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICB2aXJ0dWFsQ2x1c3RlcjogVmlydHVhbENsdXN0ZXJJbnB1dC5mcm9tVGFza0lucHV0KHNmbi5UYXNrSW5wdXQuZnJvbUpzb25QYXRoQXQoJyQuQ2x1c3RlcklkJykpLFxuICAgICAgZXhlY3V0aW9uUm9sZTogaWFtLlJvbGUuZnJvbVJvbGVBcm4oc3RhY2ssICdKb2IgUm9sZScsICdhcm46YXdzOmlhbTo6eHh4eHh4eHh4eHh4OnJvbGUvSm9iRXhlY3V0aW9uUm9sZScpLFxuICAgIH0pO1xuXG4gICAgbmV3IHNmbi5TdGF0ZU1hY2hpbmUoc3RhY2ssICdTTScsIHtcbiAgICAgIGRlZmluaXRpb246IHRhc2ssXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLCB7XG4gICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICBTdGF0ZW1lbnQ6IFt7XG4gICAgICAgICAgQWN0aW9uOiAnZW1yLWNvbnRhaW5lcnM6U3RhcnRKb2JSdW4nLFxuICAgICAgICAgIENvbmRpdGlvbjoge1xuICAgICAgICAgICAgU3RyaW5nRXF1YWxzOiB7XG4gICAgICAgICAgICAgICdlbXItY29udGFpbmVyczpFeGVjdXRpb25Sb2xlQXJuJzogJ2Fybjphd3M6aWFtOjp4eHh4eHh4eHh4eHg6cm9sZS9Kb2JFeGVjdXRpb25Sb2xlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAgICAgJycsXG4gICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAnYXJuOicsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJzplbXItY29udGFpbmVyczonLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UmVnaW9uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICc6JyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OkFjY291bnRJZCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnOi92aXJ0dWFsY2x1c3RlcnMvKicsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICdlbXItY29udGFpbmVyczpEZXNjcmliZUpvYlJ1bicsXG4gICAgICAgICAgICAnZW1yLWNvbnRhaW5lcnM6Q2FuY2VsSm9iUnVuJyxcbiAgICAgICAgICBdLFxuICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgJ0ZuOjpKb2luJzogW1xuICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgW1xuICAgICAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlBhcnRpdGlvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnOmVtci1jb250YWluZXJzOicsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpSZWdpb24nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJzonLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6QWNjb3VudElkJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICc6L3ZpcnR1YWxjbHVzdGVycy8qJyxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfV0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdQZXJtaXR0ZWQgcm9sZSBhY3Rpb25zIGZvciBTdGFydCBKb2IgUnVuIHdpdGggUkVRVUVTVC9SRVNQT05TRSBpbnRlZ3JhdGlvbiBwYXR0ZXJuJywgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ1Rhc2snLCB7XG4gICAgICAuLi5kZWZhdWx0UHJvcHMsXG4gICAgICBpbnRlZ3JhdGlvblBhdHRlcm46IHNmbi5JbnRlZ3JhdGlvblBhdHRlcm4uUkVRVUVTVF9SRVNQT05TRSxcbiAgICB9KTtcblxuICAgIG5ldyBzZm4uU3RhdGVNYWNoaW5lKHN0YWNrLCAnU00nLCB7XG4gICAgICBkZWZpbml0aW9uOiB0YXNrLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgUG9saWN5RG9jdW1lbnQ6IHtcbiAgICAgICAgU3RhdGVtZW50OiBbe1xuICAgICAgICAgIEFjdGlvbjogJ2Vtci1jb250YWluZXJzOlN0YXJ0Sm9iUnVuJyxcbiAgICAgICAgICBDb25kaXRpb246IHtcbiAgICAgICAgICAgIFN0cmluZ0VxdWFsczoge1xuICAgICAgICAgICAgICAnZW1yLWNvbnRhaW5lcnM6RXhlY3V0aW9uUm9sZUFybic6IHtcbiAgICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgICAgICdUYXNrSm9iRXhlY3V0aW9uUm9sZTVENUJCQTVBJyxcbiAgICAgICAgICAgICAgICAgICdBcm4nLFxuICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICc6ZW1yLWNvbnRhaW5lcnM6JyxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnOicsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgUmVmOiAnQVdTOjpBY2NvdW50SWQnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYDovdmlydHVhbGNsdXN0ZXJzLyR7Y2x1c3RlcklkfWAsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH1dLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnQ3VzdG9tIHJlc291cmNlIGlzIGNyZWF0ZWQgd2l0aCBFTVIgQ29udGFpbmVycyBEZXNjcmliZSBWaXJ0dWFsIENsdXN0ZXIgaW52b2NhdGlvbiBhbmQgaGFzIGNvcnJlY3QgSUFNIHBvbGljeSBwZXJtaXNzaW9ucycsICgpID0+IHtcbiAgICAvLyBXSEVOXG4gICAgY29uc3QgdGFzayA9IG5ldyBFbXJDb250YWluZXJzU3RhcnRKb2JSdW4oc3RhY2ssICdUYXNrJywgZGVmYXVsdFByb3BzKTtcblxuICAgIG5ldyBzZm4uU3RhdGVNYWNoaW5lKHN0YWNrLCAnU00nLCB7XG4gICAgICBkZWZpbml0aW9uOiB0YXNrLFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdDdXN0b206OkFXUycsIHtcbiAgICAgIFNlcnZpY2VUb2tlbjoge1xuICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAnQVdTNjc5ZjUzZmFjMDAyNDMwY2IwZGE1Yjc5ODJiZDIyODcyRDE2NEM0QycsXG4gICAgICAgICAgJ0FybicsXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgICAgQ3JlYXRlOiAne1xcXCJzZXJ2aWNlXFxcIjpcXFwiRU1SY29udGFpbmVyc1xcXCIsXFxcImFjdGlvblxcXCI6XFxcImRlc2NyaWJlVmlydHVhbENsdXN0ZXJcXFwiLFxcXCJwYXJhbWV0ZXJzXFxcIjp7XFxcImlkXFxcIjpcXFwiY2x1c3RlcklkXFxcIn0sXFxcIm91dHB1dFBhdGhzXFxcIjpbXFxcInZpcnR1YWxDbHVzdGVyLmNvbnRhaW5lclByb3ZpZGVyLmluZm8uZWtzSW5mby5uYW1lc3BhY2VcXFwiLFxcXCJ2aXJ0dWFsQ2x1c3Rlci5jb250YWluZXJQcm92aWRlci5pZFxcXCJdLFxcXCJwaHlzaWNhbFJlc291cmNlSWRcXFwiOntcXFwiaWRcXFwiOlxcXCJpZFxcXCJ9fScsXG4gICAgICBJbnN0YWxsTGF0ZXN0QXdzU2RrOiBmYWxzZSxcbiAgICB9KTtcblxuICAgIC8vIFRIRU5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICAgIFBvbGljeURvY3VtZW50OiB7XG4gICAgICAgIFN0YXRlbWVudDogW3tcbiAgICAgICAgICBBY3Rpb246ICdlbXItY29udGFpbmVyczpEZXNjcmliZVZpcnR1YWxDbHVzdGVyJyxcbiAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgUmVzb3VyY2U6ICcqJyxcbiAgICAgICAgfV0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdDdXN0b20gcmVzb3VyY2UgaXMgY3JlYXRlZCB0aGF0IGhhcyBjb3JyZWN0IEVLUyBuYW1lc3BhY2UsIGVudmlyb25tZW50LCBBV1NDTEkgbGF5ZXIsIGFuZCBJQU0gcG9saWN5IHBlcm1pc3Npb25zJywgKCkgPT4ge1xuICAgIC8vIFdIRU5cbiAgICBjb25zdCB0YXNrID0gbmV3IEVtckNvbnRhaW5lcnNTdGFydEpvYlJ1bihzdGFjaywgJ1Rhc2snLCBkZWZhdWx0UHJvcHMpO1xuXG4gICAgbmV3IHNmbi5TdGF0ZU1hY2hpbmUoc3RhY2ssICdTTScsIHtcbiAgICAgIGRlZmluaXRpb246IHRhc2ssXG4gICAgfSk7XG5cbiAgICAvLyBUSEVOXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLCB7XG4gICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICBTdGF0ZW1lbnQ6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBBY3Rpb246ICdla3M6RGVzY3JpYmVDbHVzdGVyJyxcbiAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgICAgICAgICAnJyxcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAnYXJuOicsXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAnOmVrczonLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OlJlZ2lvbicsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgJzonLFxuICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBSZWY6ICdBV1M6OkFjY291bnRJZCcsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgJzpjbHVzdGVyLycsXG4gICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICdGbjo6R2V0QXR0JzogW1xuICAgICAgICAgICAgICAgICAgICAgICdUYXNrR2V0RWtzQ2x1c3RlckluZm8yRjE1Njk4NScsXG4gICAgICAgICAgICAgICAgICAgICAgJ3ZpcnR1YWxDbHVzdGVyLmNvbnRhaW5lclByb3ZpZGVyLmlkJyxcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBBY3Rpb246IFtcbiAgICAgICAgICAgICAgJ2lhbTpHZXRSb2xlJyxcbiAgICAgICAgICAgICAgJ2lhbTpVcGRhdGVBc3N1bWVSb2xlUG9saWN5JyxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgICAnRm46OkdldEF0dCc6IFtcbiAgICAgICAgICAgICAgICAnVGFza0pvYkV4ZWN1dGlvblJvbGU1RDVCQkE1QScsXG4gICAgICAgICAgICAgICAgJ0FybicsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gVEhFTlxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCB7XG4gICAgICBIYW5kbGVyOiAnaW5kZXguaGFuZGxlcicsXG4gICAgICBMYXllcnM6IFtcbiAgICAgICAge1xuICAgICAgICAgIFJlZjogJ1Rhc2thd3NjbGlsYXllckIxQTExNzQwJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBNZW1vcnlTaXplOiAyNTYsXG4gICAgICBSdW50aW1lOiAncHl0aG9uMy45JyxcbiAgICAgIFRpbWVvdXQ6IDMwLFxuICAgIH0pO1xuICB9KTtcbn0pO1xuXG50ZXN0KCdUYXNrIHRocm93cyBpZiBXQUlUX0ZPUl9UQVNLX1RPS0VOIGlzIHN1cHBsaWVkIGFzIHNlcnZpY2UgaW50ZWdyYXRpb24gcGF0dGVybicsICgpID0+IHtcbiAgZXhwZWN0KCgpID0+IHtcbiAgICBuZXcgRW1yQ29udGFpbmVyc1N0YXJ0Sm9iUnVuKHN0YWNrLCAnVGFzaycsIHtcbiAgICAgIHZpcnR1YWxDbHVzdGVyOiBWaXJ0dWFsQ2x1c3RlcklucHV0LmZyb21UYXNrSW5wdXQoc2ZuLlRhc2tJbnB1dC5mcm9tVGV4dChjbHVzdGVySWQpKSxcbiAgICAgIHJlbGVhc2VMYWJlbDogUmVsZWFzZUxhYmVsLkVNUl82XzJfMCxcbiAgICAgIGpvYkRyaXZlcjoge1xuICAgICAgICBzcGFya1N1Ym1pdEpvYkRyaXZlcjoge1xuICAgICAgICAgIGVudHJ5UG9pbnQ6IHNmbi5UYXNrSW5wdXQuZnJvbVRleHQoJ2pvYi1sb2NhdGlvbicpLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGludGVncmF0aW9uUGF0dGVybjogc2ZuLkludGVncmF0aW9uUGF0dGVybi5XQUlUX0ZPUl9UQVNLX1RPS0VOLFxuICAgIH0pO1xuICB9KS50b1Rocm93KC9VbnN1cHBvcnRlZCBzZXJ2aWNlIGludGVncmF0aW9uIHBhdHRlcm4uIFN1cHBvcnRlZCBQYXR0ZXJuczogUkVRVUVTVF9SRVNQT05TRSxSVU5fSk9CLiBSZWNlaXZlZDogV0FJVF9GT1JfVEFTS19UT0tFTi8pO1xufSk7XG4iXX0=