"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ec2 = require("../../../aws-ec2");
const kms = require("../../../aws-kms");
const sfn = require("../../../aws-stepfunctions");
const cdk = require("../../../core");
const tasks = require("../../lib");
let stack;
beforeEach(() => {
    // GIVEN
    stack = new cdk.Stack();
});
test('create basic endpoint config', () => {
    // WHEN
    const task = new tasks.SageMakerCreateEndpointConfig(stack, 'SagemakerEndpointConfig', {
        endpointConfigName: 'MyEndpointConfig',
        productionVariants: [{
                initialInstanceCount: 2,
                instanceType: ec2.InstanceType.of(ec2.InstanceClass.M5, ec2.InstanceSize.XLARGE),
                modelName: 'MyModel',
                variantName: 'awesome-variant',
            }],
    });
    // THEN
    expect(stack.resolve(task.toStateJson())).toEqual({
        Type: 'Task',
        Resource: {
            'Fn::Join': [
                '',
                [
                    'arn:',
                    {
                        Ref: 'AWS::Partition',
                    },
                    ':states:::sagemaker:createEndpointConfig',
                ],
            ],
        },
        End: true,
        Parameters: {
            EndpointConfigName: 'MyEndpointConfig',
            ProductionVariants: [{
                    InitialInstanceCount: 2,
                    InstanceType: 'ml.m5.xlarge',
                    ModelName: 'MyModel',
                    VariantName: 'awesome-variant',
                }],
        },
    });
});
test('create complex endpoint config', () => {
    // WHEN
    const key = new kms.Key(stack, 'Key');
    const task = new tasks.SageMakerCreateEndpointConfig(stack, 'SagemakerEndpointConfig', {
        endpointConfigName: sfn.JsonPath.stringAt('$.Endpoint.EndpointConfig'),
        kmsKey: key,
        productionVariants: [{
                initialInstanceCount: 1,
                initialVariantWeight: 0.8,
                instanceType: ec2.InstanceType.of(ec2.InstanceClass.M5, ec2.InstanceSize.XLARGE),
                modelName: 'MyModel',
                variantName: 'awesome-variant',
            },
            {
                initialInstanceCount: 1,
                initialVariantWeight: 0.2,
                instanceType: new ec2.InstanceType(sfn.JsonPath.stringAt('$.Endpoint.InstanceType')),
                modelName: sfn.JsonPath.stringAt('$.Endpoint.Model'),
                variantName: 'awesome-variant-2',
            }],
        tags: sfn.TaskInput.fromObject([{
                Key: 'Project',
                Value: 'ML',
            }]),
    });
    // THEN
    expect(stack.resolve(task.toStateJson())).toEqual({
        Type: 'Task',
        Resource: {
            'Fn::Join': [
                '',
                [
                    'arn:',
                    {
                        Ref: 'AWS::Partition',
                    },
                    ':states:::sagemaker:createEndpointConfig',
                ],
            ],
        },
        End: true,
        Parameters: {
            'EndpointConfigName.$': '$.Endpoint.EndpointConfig',
            'KmsKeyId': {
                Ref: 'Key961B73FD',
            },
            'ProductionVariants': [{
                    InitialInstanceCount: 1,
                    InitialVariantWeight: 0.8,
                    InstanceType: 'ml.m5.xlarge',
                    ModelName: 'MyModel',
                    VariantName: 'awesome-variant',
                },
                {
                    'InitialInstanceCount': 1,
                    'InitialVariantWeight': 0.2,
                    'InstanceType.$': '$.Endpoint.InstanceType',
                    'ModelName.$': '$.Endpoint.Model',
                    'VariantName': 'awesome-variant-2',
                }],
            'Tags': [
                {
                    Key: 'Project',
                    Value: 'ML',
                },
            ],
        },
    });
});
test('Cannot create a SageMaker create enpoint config task with empty production variant', () => {
    expect(() => new tasks.SageMakerCreateEndpointConfig(stack, 'EndpointConfig', {
        endpointConfigName: 'MyEndpointConfig',
        productionVariants: [],
    }))
        .toThrowError(/Must specify from 1 to 10 production variants per endpoint configuration/);
});
test('Task throws if WAIT_FOR_TASK_TOKEN is supplied as service integration pattern', () => {
    expect(() => new tasks.SageMakerCreateEndpointConfig(stack, 'EndpointConfig', {
        endpointConfigName: 'MyEndpointConfig',
        integrationPattern: sfn.IntegrationPattern.WAIT_FOR_TASK_TOKEN,
        productionVariants: [{
                initialInstanceCount: 2,
                instanceType: ec2.InstanceType.of(ec2.InstanceClass.M5, ec2.InstanceSize.XLARGE),
                modelName: 'MyModel',
                variantName: 'awesome-variant',
            }],
    }))
        .toThrowError(/Unsupported service integration pattern. Supported Patterns: REQUEST_RESPONSE. Received: WAIT_FOR_TASK_TOKEN/i);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLWVuZHBvaW50LWNvbmZpZy50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3JlYXRlLWVuZHBvaW50LWNvbmZpZy50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsd0NBQXdDO0FBQ3hDLHdDQUF3QztBQUN4QyxrREFBa0Q7QUFDbEQscUNBQXFDO0FBQ3JDLG1DQUFtQztBQUVuQyxJQUFJLEtBQWdCLENBQUM7QUFFckIsVUFBVSxDQUFDLEdBQUcsRUFBRTtJQUNkLFFBQVE7SUFDUixLQUFLLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDMUIsQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO0lBQ3hDLE9BQU87SUFDUCxNQUFNLElBQUksR0FBRyxJQUFJLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxLQUFLLEVBQUUseUJBQXlCLEVBQUU7UUFDckYsa0JBQWtCLEVBQUUsa0JBQWtCO1FBQ3RDLGtCQUFrQixFQUFFLENBQUM7Z0JBQ25CLG9CQUFvQixFQUFFLENBQUM7Z0JBQ3ZCLFlBQVksRUFBRSxHQUFHLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQztnQkFDaEYsU0FBUyxFQUFFLFNBQVM7Z0JBQ3BCLFdBQVcsRUFBRSxpQkFBaUI7YUFDL0IsQ0FBQztLQUNILENBQUMsQ0FBQztJQUVILE9BQU87SUFDUCxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztRQUNoRCxJQUFJLEVBQUUsTUFBTTtRQUNaLFFBQVEsRUFBRTtZQUNSLFVBQVUsRUFBRTtnQkFDVixFQUFFO2dCQUNGO29CQUNFLE1BQU07b0JBQ047d0JBQ0UsR0FBRyxFQUFFLGdCQUFnQjtxQkFDdEI7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WjthQUNGO1NBQ0Y7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQyxvRkFBb0YsRUFBRSxHQUFHLEVBQUU7SUFDOUYsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksS0FBSyxDQUFDLDZCQUE2QixDQUFDLEtBQUssRUFBRSxnQkFBZ0IsRUFBRTtRQUM1RSxrQkFBa0IsRUFBRSxrQkFBa0I7UUFDdEMsa0JBQWtCLEVBQUUsRUFBRTtLQUN2QixDQUFDLENBQUM7U0FDQSxZQUFZLENBQUMsMEVBQTBFLENBQUMsQ0FBQztBQUM5RixDQUFDLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQywrRUFBK0UsRUFBRSxHQUFHLEVBQUU7SUFDekYsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksS0FBSyxDQUFDLDZCQUE2QixDQUFDLEtBQUssRUFBRSxnQkFBZ0IsRUFBRTtRQUM1RSxrQkFBa0IsRUFBRSxrQkFBa0I7UUFDdEMsa0JBQWtCLEVBQUUsR0FBRyxDQUFDLGtCQUFrQixDQUFDLG1CQUFtQjtRQUM5RCxrQkFBa0IsRUFBRSxDQUFDO2dCQUNuQixvQkFBb0IsRUFBRSxDQUFDO2dCQUN2QixZQUFZLEVBQUUsR0FBRyxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsR0FBRyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUM7Z0JBQ2hGLFNBQVMsRUFBRSxTQUFTO2dCQUNwQixXQUFXLEVBQUUsaUJBQWlCO2FBQy9CLENBQUM7S0FDSCxDQUFDLENBQUM7U0FDQSxZQUFZLENBQUMsK0dBQStHLENBQUMsQ0FBQztBQUNuSSxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGVjMiBmcm9tICcuLi8uLi8uLi9hd3MtZWMyJztcbmltcG9ydCAqIGFzIGttcyBmcm9tICcuLi8uLi8uLi9hd3Mta21zJztcbmltcG9ydCAqIGFzIHNmbiBmcm9tICcuLi8uLi8uLi9hd3Mtc3RlcGZ1bmN0aW9ucyc7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnLi4vLi4vLi4vY29yZSc7XG5pbXBvcnQgKiBhcyB0YXNrcyBmcm9tICcuLi8uLi9saWInO1xuXG5sZXQgc3RhY2s6IGNkay5TdGFjaztcblxuYmVmb3JlRWFjaCgoKSA9PiB7XG4gIC8vIEdJVkVOXG4gIHN0YWNrID0gbmV3IGNkay5TdGFjaygpO1xufSk7XG5cbnRlc3QoJ2NyZWF0ZSBiYXNpYyBlbmRwb2ludCBjb25maWcnLCAoKSA9PiB7XG4gIC8vIFdIRU5cbiAgY29uc3QgdGFzayA9IG5ldyB0YXNrcy5TYWdlTWFrZXJDcmVhdGVFbmRwb2ludENvbmZpZyhzdGFjaywgJ1NhZ2VtYWtlckVuZHBvaW50Q29uZmlnJywge1xuICAgIGVuZHBvaW50Q29uZmlnTmFtZTogJ015RW5kcG9pbnRDb25maWcnLFxuICAgIHByb2R1Y3Rpb25WYXJpYW50czogW3tcbiAgICAgIGluaXRpYWxJbnN0YW5jZUNvdW50OiAyLFxuICAgICAgaW5zdGFuY2VUeXBlOiBlYzIuSW5zdGFuY2VUeXBlLm9mKGVjMi5JbnN0YW5jZUNsYXNzLk01LCBlYzIuSW5zdGFuY2VTaXplLlhMQVJHRSksXG4gICAgICBtb2RlbE5hbWU6ICdNeU1vZGVsJyxcbiAgICAgIHZhcmlhbnROYW1lOiAnYXdlc29tZS12YXJpYW50JyxcbiAgICB9XSxcbiAgfSk7XG5cbiAgLy8gVEhFTlxuICBleHBlY3Qoc3RhY2sucmVzb2x2ZSh0YXNrLnRvU3RhdGVKc29uKCkpKS50b0VxdWFsKHtcbiAgICBUeXBlOiAnVGFzaycsXG4gICAgUmVzb3VyY2U6IHtcbiAgICAgICdGbjo6Sm9pbic6IFtcbiAgICAgICAgJycsXG4gICAgICAgIFtcbiAgICAgICAgICAnYXJuOicsXG4gICAgICAgICAge1xuICAgICAgICAgICAgUmVmOiAnQVdTOjpQYXJ0aXRpb24nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgJzpzdGF0ZXM6OjpzYWdlbWFrZXI6Y3JlYXRlRW5kcG9pbnRDb25maWcnLFxuICAgICAgICBdLFxuICAgICAgXSxcbiAgICB9LFxuICAgIEVuZDogdHJ1ZSxcbiAgICBQYXJhbWV0ZXJzOiB7XG4gICAgICBFbmRwb2ludENvbmZpZ05hbWU6ICdNeUVuZHBvaW50Q29uZmlnJyxcbiAgICAgIFByb2R1Y3Rpb25WYXJpYW50czogW3tcbiAgICAgICAgSW5pdGlhbEluc3RhbmNlQ291bnQ6IDIsXG4gICAgICAgIEluc3RhbmNlVHlwZTogJ21sLm01LnhsYXJnZScsXG4gICAgICAgIE1vZGVsTmFtZTogJ015TW9kZWwnLFxuICAgICAgICBWYXJpYW50TmFtZTogJ2F3ZXNvbWUtdmFyaWFudCcsXG4gICAgICB9XSxcbiAgICB9LFxuICB9KTtcbn0pO1xuXG50ZXN0KCdjcmVhdGUgY29tcGxleCBlbmRwb2ludCBjb25maWcnLCAoKSA9PiB7XG4gIC8vIFdIRU5cbiAgY29uc3Qga2V5ID0gbmV3IGttcy5LZXkoc3RhY2ssICdLZXknKTtcblxuICBjb25zdCB0YXNrID0gbmV3IHRhc2tzLlNhZ2VNYWtlckNyZWF0ZUVuZHBvaW50Q29uZmlnKHN0YWNrLCAnU2FnZW1ha2VyRW5kcG9pbnRDb25maWcnLCB7XG4gICAgZW5kcG9pbnRDb25maWdOYW1lOiBzZm4uSnNvblBhdGguc3RyaW5nQXQoJyQuRW5kcG9pbnQuRW5kcG9pbnRDb25maWcnKSxcbiAgICBrbXNLZXk6IGtleSxcbiAgICBwcm9kdWN0aW9uVmFyaWFudHM6IFt7XG4gICAgICBpbml0aWFsSW5zdGFuY2VDb3VudDogMSxcbiAgICAgIGluaXRpYWxWYXJpYW50V2VpZ2h0OiAwLjgsXG4gICAgICBpbnN0YW5jZVR5cGU6IGVjMi5JbnN0YW5jZVR5cGUub2YoZWMyLkluc3RhbmNlQ2xhc3MuTTUsIGVjMi5JbnN0YW5jZVNpemUuWExBUkdFKSxcbiAgICAgIG1vZGVsTmFtZTogJ015TW9kZWwnLFxuICAgICAgdmFyaWFudE5hbWU6ICdhd2Vzb21lLXZhcmlhbnQnLFxuICAgIH0sXG4gICAge1xuICAgICAgaW5pdGlhbEluc3RhbmNlQ291bnQ6IDEsXG4gICAgICBpbml0aWFsVmFyaWFudFdlaWdodDogMC4yLFxuICAgICAgaW5zdGFuY2VUeXBlOiBuZXcgZWMyLkluc3RhbmNlVHlwZShzZm4uSnNvblBhdGguc3RyaW5nQXQoJyQuRW5kcG9pbnQuSW5zdGFuY2VUeXBlJykpLFxuICAgICAgbW9kZWxOYW1lOiBzZm4uSnNvblBhdGguc3RyaW5nQXQoJyQuRW5kcG9pbnQuTW9kZWwnKSxcbiAgICAgIHZhcmlhbnROYW1lOiAnYXdlc29tZS12YXJpYW50LTInLFxuICAgIH1dLFxuICAgIHRhZ3M6IHNmbi5UYXNrSW5wdXQuZnJvbU9iamVjdChbe1xuICAgICAgS2V5OiAnUHJvamVjdCcsXG4gICAgICBWYWx1ZTogJ01MJyxcbiAgICB9XSksXG4gIH0pO1xuXG4gIC8vIFRIRU5cbiAgZXhwZWN0KHN0YWNrLnJlc29sdmUodGFzay50b1N0YXRlSnNvbigpKSkudG9FcXVhbCh7XG4gICAgVHlwZTogJ1Rhc2snLFxuICAgIFJlc291cmNlOiB7XG4gICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICcnLFxuICAgICAgICBbXG4gICAgICAgICAgJ2FybjonLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFJlZjogJ0FXUzo6UGFydGl0aW9uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgICc6c3RhdGVzOjo6c2FnZW1ha2VyOmNyZWF0ZUVuZHBvaW50Q29uZmlnJyxcbiAgICAgICAgXSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICBFbmQ6IHRydWUsXG4gICAgUGFyYW1ldGVyczoge1xuICAgICAgJ0VuZHBvaW50Q29uZmlnTmFtZS4kJzogJyQuRW5kcG9pbnQuRW5kcG9pbnRDb25maWcnLFxuICAgICAgJ0ttc0tleUlkJzoge1xuICAgICAgICBSZWY6ICdLZXk5NjFCNzNGRCcsXG4gICAgICB9LFxuICAgICAgJ1Byb2R1Y3Rpb25WYXJpYW50cyc6IFt7XG4gICAgICAgIEluaXRpYWxJbnN0YW5jZUNvdW50OiAxLFxuICAgICAgICBJbml0aWFsVmFyaWFudFdlaWdodDogMC44LFxuICAgICAgICBJbnN0YW5jZVR5cGU6ICdtbC5tNS54bGFyZ2UnLFxuICAgICAgICBNb2RlbE5hbWU6ICdNeU1vZGVsJyxcbiAgICAgICAgVmFyaWFudE5hbWU6ICdhd2Vzb21lLXZhcmlhbnQnLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJ0luaXRpYWxJbnN0YW5jZUNvdW50JzogMSxcbiAgICAgICAgJ0luaXRpYWxWYXJpYW50V2VpZ2h0JzogMC4yLFxuICAgICAgICAnSW5zdGFuY2VUeXBlLiQnOiAnJC5FbmRwb2ludC5JbnN0YW5jZVR5cGUnLFxuICAgICAgICAnTW9kZWxOYW1lLiQnOiAnJC5FbmRwb2ludC5Nb2RlbCcsXG4gICAgICAgICdWYXJpYW50TmFtZSc6ICdhd2Vzb21lLXZhcmlhbnQtMicsXG4gICAgICB9XSxcbiAgICAgICdUYWdzJzogW1xuICAgICAgICB7XG4gICAgICAgICAgS2V5OiAnUHJvamVjdCcsXG4gICAgICAgICAgVmFsdWU6ICdNTCcsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gIH0pO1xufSk7XG5cbnRlc3QoJ0Nhbm5vdCBjcmVhdGUgYSBTYWdlTWFrZXIgY3JlYXRlIGVucG9pbnQgY29uZmlnIHRhc2sgd2l0aCBlbXB0eSBwcm9kdWN0aW9uIHZhcmlhbnQnLCAoKSA9PiB7XG4gIGV4cGVjdCgoKSA9PiBuZXcgdGFza3MuU2FnZU1ha2VyQ3JlYXRlRW5kcG9pbnRDb25maWcoc3RhY2ssICdFbmRwb2ludENvbmZpZycsIHtcbiAgICBlbmRwb2ludENvbmZpZ05hbWU6ICdNeUVuZHBvaW50Q29uZmlnJyxcbiAgICBwcm9kdWN0aW9uVmFyaWFudHM6IFtdLFxuICB9KSlcbiAgICAudG9UaHJvd0Vycm9yKC9NdXN0IHNwZWNpZnkgZnJvbSAxIHRvIDEwIHByb2R1Y3Rpb24gdmFyaWFudHMgcGVyIGVuZHBvaW50IGNvbmZpZ3VyYXRpb24vKTtcbn0pO1xuXG50ZXN0KCdUYXNrIHRocm93cyBpZiBXQUlUX0ZPUl9UQVNLX1RPS0VOIGlzIHN1cHBsaWVkIGFzIHNlcnZpY2UgaW50ZWdyYXRpb24gcGF0dGVybicsICgpID0+IHtcbiAgZXhwZWN0KCgpID0+IG5ldyB0YXNrcy5TYWdlTWFrZXJDcmVhdGVFbmRwb2ludENvbmZpZyhzdGFjaywgJ0VuZHBvaW50Q29uZmlnJywge1xuICAgIGVuZHBvaW50Q29uZmlnTmFtZTogJ015RW5kcG9pbnRDb25maWcnLFxuICAgIGludGVncmF0aW9uUGF0dGVybjogc2ZuLkludGVncmF0aW9uUGF0dGVybi5XQUlUX0ZPUl9UQVNLX1RPS0VOLFxuICAgIHByb2R1Y3Rpb25WYXJpYW50czogW3tcbiAgICAgIGluaXRpYWxJbnN0YW5jZUNvdW50OiAyLFxuICAgICAgaW5zdGFuY2VUeXBlOiBlYzIuSW5zdGFuY2VUeXBlLm9mKGVjMi5JbnN0YW5jZUNsYXNzLk01LCBlYzIuSW5zdGFuY2VTaXplLlhMQVJHRSksXG4gICAgICBtb2RlbE5hbWU6ICdNeU1vZGVsJyxcbiAgICAgIHZhcmlhbnROYW1lOiAnYXdlc29tZS12YXJpYW50JyxcbiAgICB9XSxcbiAgfSkpXG4gICAgLnRvVGhyb3dFcnJvcigvVW5zdXBwb3J0ZWQgc2VydmljZSBpbnRlZ3JhdGlvbiBwYXR0ZXJuLiBTdXBwb3J0ZWQgUGF0dGVybnM6IFJFUVVFU1RfUkVTUE9OU0UuIFJlY2VpdmVkOiBXQUlUX0ZPUl9UQVNLX1RPS0VOL2kpO1xufSk7XG5cblxuIl19