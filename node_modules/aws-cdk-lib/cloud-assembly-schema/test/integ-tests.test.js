"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const os = require("os");
const path = require("path");
const lib_1 = require("../lib");
describe('Integration test', () => {
    test('valid input', () => {
        expect(() => {
            validate({
                version: lib_1.Manifest.version(),
                testCases: {
                    testCase1: {
                        stacks: ['stack1', 'stack2'],
                        stackUpdateWorkflow: true,
                        cdkCommandOptions: {
                            deploy: {
                                enabled: true,
                                expectError: false,
                                expectedMessage: 'some message',
                                args: {
                                    exclusively: true,
                                    toolkitStackName: 'Stack',
                                    reuseAssets: ['asset1', 'asset2'],
                                    changeSetName: 'changeset',
                                    force: true,
                                    rollback: false,
                                    notificationArns: ['arn1', 'arn2'],
                                    execute: true,
                                    parameters: {
                                        'MYPARAM': 'Value',
                                        'Stack1:OtherParam': 'OtherValue',
                                    },
                                    usePreviousParameters: true,
                                    outputsFile: 'outputs.json',
                                    ci: true,
                                    requireApproval: 'never',
                                    app: 'node bin/my-app.js',
                                    roleArn: 'roleArn',
                                    context: {
                                        KEY: 'value',
                                    },
                                    trace: true,
                                    strict: true,
                                    lookups: true,
                                    ignoreErrors: true,
                                    json: true,
                                    verbose: true,
                                    debug: true,
                                    profile: 'profile',
                                    proxy: 'https://proxy',
                                    caBundlePath: 'path/to/bundle',
                                    ec2Creds: true,
                                    versionReporting: false,
                                    pathMetadata: false,
                                    assetMetadata: true,
                                    staging: false,
                                    output: true,
                                    notices: true,
                                    color: false,
                                },
                            },
                            synth: {
                                enabled: true,
                                expectError: false,
                                expectedMessage: 'some message',
                                args: {
                                    quiet: true,
                                    exclusively: true,
                                    validation: true,
                                },
                            },
                            destroy: {
                                enabled: true,
                                expectError: false,
                                expectedMessage: 'some message',
                                args: {
                                    force: true,
                                    exclusively: true,
                                },
                            },
                        },
                        hooks: {
                            preDeploy: ['yarn test'],
                            postDeploy: ['some other command'],
                            preDestroy: ['command1', 'command2'],
                            postDestroy: ['command3', 'command4'],
                        },
                        diffAssets: true,
                        allowDestroy: ['AWS::IAM::Role'],
                        region: ['us-east-1', 'us-east-2'],
                    },
                },
            });
        });
    });
    test('invalid input', () => {
        expect(() => {
            validate({
                version: lib_1.Manifest.version(),
                testCases: {
                    stacks: true,
                },
            });
        }).toThrow(/instance\.testCases\.stacks is not of a type\(s\) object/);
    });
    test('without command options', () => {
        expect(() => {
            validate({
                version: lib_1.Manifest.version(),
                testCases: {
                    testCase1: {
                        stacks: ['stack1', 'stack2'],
                        stackUpdateWorkflow: true,
                        hooks: {
                            preDeploy: ['yarn test'],
                        },
                        diffAssets: true,
                    },
                },
            });
        });
    });
});
function validate(manifest) {
    const dir = fs.mkdtempSync(path.join(os.tmpdir(), 'integ.test.'));
    const filePath = path.join(dir, 'manifest.json');
    fs.writeFileSync(filePath, JSON.stringify(manifest, undefined, 2));
    try {
        lib_1.Manifest.loadIntegManifest(filePath);
    }
    finally {
        fs.unlinkSync(filePath);
        fs.rmdirSync(dir);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWctdGVzdHMudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLXRlc3RzLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx5QkFBeUI7QUFDekIseUJBQXlCO0FBQ3pCLDZCQUE2QjtBQUM3QixnQ0FBa0M7QUFFbEMsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLENBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUN2QixNQUFNLENBQUMsR0FBRyxFQUFFO1lBQ1YsUUFBUSxDQUFDO2dCQUNQLE9BQU8sRUFBRSxjQUFRLENBQUMsT0FBTyxFQUFFO2dCQUMzQixTQUFTLEVBQUU7b0JBQ1QsU0FBUyxFQUFFO3dCQUNULE1BQU0sRUFBRSxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUM7d0JBQzVCLG1CQUFtQixFQUFFLElBQUk7d0JBQ3pCLGlCQUFpQixFQUFFOzRCQUNqQixNQUFNLEVBQUU7Z0NBQ04sT0FBTyxFQUFFLElBQUk7Z0NBQ2IsV0FBVyxFQUFFLEtBQUs7Z0NBQ2xCLGVBQWUsRUFBRSxjQUFjO2dDQUMvQixJQUFJLEVBQUU7b0NBQ0osV0FBVyxFQUFFLElBQUk7b0NBQ2pCLGdCQUFnQixFQUFFLE9BQU87b0NBQ3pCLFdBQVcsRUFBRSxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUM7b0NBQ2pDLGFBQWEsRUFBRSxXQUFXO29DQUMxQixLQUFLLEVBQUUsSUFBSTtvQ0FDWCxRQUFRLEVBQUUsS0FBSztvQ0FDZixnQkFBZ0IsRUFBRSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUM7b0NBQ2xDLE9BQU8sRUFBRSxJQUFJO29DQUNiLFVBQVUsRUFBRTt3Q0FDVixTQUFTLEVBQUUsT0FBTzt3Q0FDbEIsbUJBQW1CLEVBQUUsWUFBWTtxQ0FDbEM7b0NBQ0QscUJBQXFCLEVBQUUsSUFBSTtvQ0FDM0IsV0FBVyxFQUFFLGNBQWM7b0NBQzNCLEVBQUUsRUFBRSxJQUFJO29DQUNSLGVBQWUsRUFB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QyxRQUFhO0lBQzdCLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxFQUFFLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQztJQUNsRSxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxlQUFlLENBQUMsQ0FBQztJQUNqRCxFQUFFLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNuRSxJQUFJO1FBQ0YsY0FBUSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0tBQ3RDO1lBQVM7UUFDUixFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3hCLEVBQUUsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7S0FDbkI7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IE1hbmlmZXN0IH0gZnJvbSAnLi4vbGliJztcblxuZGVzY3JpYmUoJ0ludGVncmF0aW9uIHRlc3QnLCAoKSA9PiB7XG4gIHRlc3QoJ3ZhbGlkIGlucHV0JywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHZlcnNpb246IE1hbmlmZXN0LnZlcnNpb24oKSxcbiAgICAgICAgdGVzdENhc2VzOiB7XG4gICAgICAgICAgdGVzdENhc2UxOiB7XG4gICAgICAgICAgICBzdGFja3M6IFsnc3RhY2sxJywgJ3N0YWNrMiddLFxuICAgICAgICAgICAgc3RhY2tVcGRhdGVXb3JrZmxvdzogdHJ1ZSxcbiAgICAgICAgICAgIGNka0NvbW1hbmRPcHRpb25zOiB7XG4gICAgICAgICAgICAgIGRlcGxveToge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgZXhwZWN0RXJyb3I6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkTWVzc2FnZTogJ3NvbWUgbWVzc2FnZScsXG4gICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgZXhjbHVzaXZlbHk6IHRydWUsXG4gICAgICAgICAgICAgICAgICB0b29sa2l0U3RhY2tOYW1lOiAnU3RhY2snLFxuICAgICAgICAgICAgICAgICAgcmV1c2VBc3NldHM6IFsnYXNzZXQxJywgJ2Fzc2V0MiddLFxuICAgICAgICAgICAgICAgICAgY2hhbmdlU2V0TmFtZTogJ2NoYW5nZXNldCcsXG4gICAgICAgICAgICAgICAgICBmb3JjZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHJvbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbkFybnM6IFsnYXJuMScsICdhcm4yJ10sXG4gICAgICAgICAgICAgICAgICBleGVjdXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgICAgICAgICAgICAnTVlQQVJBTSc6ICdWYWx1ZScsXG4gICAgICAgICAgICAgICAgICAgICdTdGFjazE6T3RoZXJQYXJhbSc6ICdPdGhlclZhbHVlJyxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB1c2VQcmV2aW91c1BhcmFtZXRlcnM6IHRydWUsXG4gICAgICAgICAgICAgICAgICBvdXRwdXRzRmlsZTogJ291dHB1dHMuanNvbicsXG4gICAgICAgICAgICAgICAgICBjaTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVBcHByb3ZhbDogJ25ldmVyJyxcbiAgICAgICAgICAgICAgICAgIGFwcDogJ25vZGUgYmluL215LWFwcC5qcycsXG4gICAgICAgICAgICAgICAgICByb2xlQXJuOiAncm9sZUFybicsXG4gICAgICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgIEtFWTogJ3ZhbHVlJyxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICB0cmFjZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHN0cmljdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGxvb2t1cHM6IHRydWUsXG4gICAgICAgICAgICAgICAgICBpZ25vcmVFcnJvcnM6IHRydWUsXG4gICAgICAgICAgICAgICAgICBqc29uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgdmVyYm9zZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGRlYnVnOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgcHJvZmlsZTogJ3Byb2ZpbGUnLFxuICAgICAgICAgICAgICAgICAgcHJveHk6ICdodHRwczovL3Byb3h5JyxcbiAgICAgICAgICAgICAgICAgIGNhQnVuZGxlUGF0aDogJ3BhdGgvdG8vYnVuZGxlJyxcbiAgICAgICAgICAgICAgICAgIGVjMkNyZWRzOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgdmVyc2lvblJlcG9ydGluZzogZmFsc2UsXG4gICAgICAgICAgICAgICAgICBwYXRoTWV0YWRhdGE6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgYXNzZXRNZXRhZGF0YTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHN0YWdpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgb3V0cHV0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgbm90aWNlczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIGNvbG9yOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzeW50aDoge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgZXhwZWN0RXJyb3I6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkTWVzc2FnZTogJ3NvbWUgbWVzc2FnZScsXG4gICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgcXVpZXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICBleGNsdXNpdmVseTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGVzdHJveToge1xuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgZXhwZWN0RXJyb3I6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGV4cGVjdGVkTWVzc2FnZTogJ3NvbWUgbWVzc2FnZScsXG4gICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgZm9yY2U6IHRydWUsXG4gICAgICAgICAgICAgICAgICBleGNsdXNpdmVseTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvb2tzOiB7XG4gICAgICAgICAgICAgIHByZURlcGxveTogWyd5YXJuIHRlc3QnXSxcbiAgICAgICAgICAgICAgcG9zdERlcGxveTogWydzb21lIG90aGVyIGNvbW1hbmQnXSxcbiAgICAgICAgICAgICAgcHJlRGVzdHJveTogWydjb21tYW5kMScsICdjb21tYW5kMiddLFxuICAgICAgICAgICAgICBwb3N0RGVzdHJveTogWydjb21tYW5kMycsICdjb21tYW5kNCddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRpZmZBc3NldHM6IHRydWUsXG4gICAgICAgICAgICBhbGxvd0Rlc3Ryb3k6IFsnQVdTOjpJQU06OlJvbGUnXSxcbiAgICAgICAgICAgIHJlZ2lvbjogWyd1cy1lYXN0LTEnLCAndXMtZWFzdC0yJ10sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdpbnZhbGlkIGlucHV0JywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHZlcnNpb246IE1hbmlmZXN0LnZlcnNpb24oKSxcbiAgICAgICAgdGVzdENhc2VzOiB7XG4gICAgICAgICAgc3RhY2tzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSkudG9UaHJvdygvaW5zdGFuY2VcXC50ZXN0Q2FzZXNcXC5zdGFja3MgaXMgbm90IG9mIGEgdHlwZVxcKHNcXCkgb2JqZWN0Lyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3dpdGhvdXQgY29tbWFuZCBvcHRpb25zJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICB2YWxpZGF0ZSh7XG4gICAgICAgIHZlcnNpb246IE1hbmlmZXN0LnZlcnNpb24oKSxcbiAgICAgICAgdGVzdENhc2VzOiB7XG4gICAgICAgICAgdGVzdENhc2UxOiB7XG4gICAgICAgICAgICBzdGFja3M6IFsnc3RhY2sxJywgJ3N0YWNrMiddLFxuICAgICAgICAgICAgc3RhY2tVcGRhdGVXb3JrZmxvdzogdHJ1ZSxcbiAgICAgICAgICAgIGhvb2tzOiB7XG4gICAgICAgICAgICAgIHByZURlcGxveTogWyd5YXJuIHRlc3QnXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkaWZmQXNzZXRzOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZnVuY3Rpb24gdmFsaWRhdGUobWFuaWZlc3Q6IGFueSkge1xuICBjb25zdCBkaXIgPSBmcy5ta2R0ZW1wU3luYyhwYXRoLmpvaW4ob3MudG1wZGlyKCksICdpbnRlZy50ZXN0LicpKTtcbiAgY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4oZGlyLCAnbWFuaWZlc3QuanNvbicpO1xuICBmcy53cml0ZUZpbGVTeW5jKGZpbGVQYXRoLCBKU09OLnN0cmluZ2lmeShtYW5pZmVzdCwgdW5kZWZpbmVkLCAyKSk7XG4gIHRyeSB7XG4gICAgTWFuaWZlc3QubG9hZEludGVnTWFuaWZlc3QoZmlsZVBhdGgpO1xuICB9IGZpbmFsbHkge1xuICAgIGZzLnVubGlua1N5bmMoZmlsZVBhdGgpO1xuICAgIGZzLnJtZGlyU3luYyhkaXIpO1xuICB9XG59XG4iXX0=