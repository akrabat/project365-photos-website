"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const assertions_1 = require("../../assertions");
const iam = require("../../aws-iam");
const s3 = require("../../aws-s3");
const core = require("../../core");
const inc = require("../lib");
const futils = require("../lib/file-utils");
/* eslint-disable quote-props */
/* eslint-disable quotes */
describe('CDK Include', () => {
    let stack;
    beforeEach(() => {
        stack = new core.Stack();
    });
    test('can ingest a template with only an empty S3 Bucket, and output it unchanged', () => {
        includeTestTemplate(stack, 'only-empty-bucket.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('only-empty-bucket.json'));
    });
    test('throws an exception if asked for resource with a logical ID not present in the template', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-empty-bucket.json');
        expect(() => {
            cfnTemplate.getResource('LogicalIdThatDoesNotExist');
        }).toThrow(/Resource with logical ID 'LogicalIdThatDoesNotExist' was not found in the template/);
    });
    test('can ingest a template with only an empty S3 Bucket, and change its property', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-empty-bucket.json');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        cfnBucket.bucketName = 'my-bucket-name';
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": "my-bucket-name",
                    },
                },
            },
        });
    });
    test('can ingest a template with only an S3 Bucket with complex properties, and output it unchanged', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-bucket-complex-props.json');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        expect(cfnBucket.corsConfiguration.corsRules).toHaveLength(1);
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('only-bucket-complex-props.json'));
    });
    test('allows referring to a bucket defined in the template in your CDK code', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-empty-bucket.json');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        const role = new iam.Role(stack, 'Role', {
            assumedBy: new iam.AnyPrincipal(),
        });
        role.addToPolicy(new iam.PolicyStatement({
            actions: ['s3:*'],
            resources: [cfnBucket.attrArn],
        }));
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::IAM::Policy', {
            "PolicyDocument": {
                "Statement": [
                    {
                        "Action": "s3:*",
                        "Resource": {
                            "Fn::GetAtt": [
                                "Bucket",
                                "Arn",
                            ],
                        },
                    },
                ],
            },
        });
    });
    test('can ingest a template with a Bucket Ref-erencing a KMS Key, and output it unchanged', () => {
        includeTestTemplate(stack, 'bucket-with-encryption-key.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('bucket-with-encryption-key.json'));
    });
    test('accepts strings for properties with type number', () => {
        includeTestTemplate(stack, 'string-for-number.json');
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::S3::Bucket', {
            "CorsConfiguration": {
                "CorsRules": [
                    {
                        "MaxAge": 10,
                    },
                ],
            },
        });
    });
    test('accepts numbers for properties with type string', () => {
        includeTestTemplate(stack, 'number-for-string.json');
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::S3::Bucket', {
            "WebsiteConfiguration": {
                "RoutingRules": [
                    {
                        "RedirectRule": {
                            "HttpRedirectCode": "403",
                        },
                    },
                ],
            },
        });
    });
    test('accepts booleans for properties with type string', () => {
        includeTestTemplate(stack, 'boolean-for-string.json');
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::S3::Bucket', {
            "AccessControl": "true",
        });
    });
    test('correctly changes the logical IDs, including references, if imported with preserveLogicalIds=false', () => {
        const cfnTemplate = includeTestTemplate(stack, 'bucket-with-encryption-key.json', {
            preserveLogicalIds: false,
        });
        // even though the logical IDs in the resulting template are different than in the input template,
        // the L1s can still be retrieved using their original logical IDs from the template file,
        // and any modifications to them will be reflected in the resulting template
        const cfnBucket = cfnTemplate.getResource('Bucket');
        cfnBucket.bucketName = 'my-bucket-name';
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "MyScopeKey7673692F": {
                    "Type": "AWS::KMS::Key",
                    "Properties": {
                        "KeyPolicy": {
                            "Statement": [
                                {
                                    "Action": [
                                        "kms:*",
                                    ],
                                    "Effect": "Allow",
                                    "Principal": {
                                        "AWS": {
                                            "Fn::Join": ["", [
                                                    "arn:",
                                                    { "Ref": "AWS::Partition" },
                                                    ":iam::",
                                                    { "Ref": "AWS::AccountId" },
                                                    ":root",
                                                ]],
                                        },
                                    },
                                    "Resource": "*",
                                },
                            ],
                            "Version": "2012-10-17",
                        },
                    },
                    "DeletionPolicy": "Delete",
                    "UpdateReplacePolicy": "Delete",
                },
                "MyScopeBucket02C1313B": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": "my-bucket-name",
                        "BucketEncryption": {
                            "ServerSideEncryptionConfiguration": [
                                {
                                    "ServerSideEncryptionByDefault": {
                                        "KMSMasterKeyID": {
                                            "Fn::GetAtt": [
                                                "MyScopeKey7673692F",
                                                "Arn",
                                            ],
                                        },
                                        "SSEAlgorithm": "aws:kms",
                                    },
                                },
                            ],
                        },
                    },
                    "Metadata": {
                        "Object1": "Location1",
                        "KeyRef": { "Ref": "MyScopeKey7673692F" },
                        "KeyArn": { "Fn::GetAtt": ["MyScopeKey7673692F", "Arn"] },
                    },
                    "DeletionPolicy": "Retain",
                    "UpdateReplacePolicy": "Retain",
                },
            },
        });
    });
    test('can ingest a template with an Fn::If expression for simple values, and output it unchanged', () => {
        includeTestTemplate(stack, 'if-simple-property.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('if-simple-property.json'));
    });
    test('can ingest a template with an Fn::If expression for complex values, and output it unchanged', () => {
        includeTestTemplate(stack, 'if-complex-property.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('if-complex-property.json'));
    });
    test('can ingest a template using Fn::If in Tags, and output it unchanged', () => {
        includeTestTemplate(stack, 'if-in-tags.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('if-in-tags.json'));
    });
    test('can ingest a UserData script, and output it unchanged', () => {
        includeTestTemplate(stack, 'user-data.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('user-data.json'));
    });
    test('can correctly ingest a resource with a property of type: Map of Lists of primitive types', () => {
        const cfnTemplate = includeTestTemplate(stack, 'ssm-association.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('ssm-association.json'));
        const association = cfnTemplate.getResource('Association');
        expect(Object.keys(association.parameters)).toHaveLength(2);
    });
    test('can ingest a template with intrinsic functions and conditions, and output it unchanged', () => {
        includeTestTemplate(stack, 'functions-and-conditions.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('functions-and-conditions.json'));
    });
    test('can ingest a JSON template with string-form Fn::GetAtt, and output it unchanged', () => {
        includeTestTemplate(stack, 'get-att-string-form.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('get-att-string-form.json'));
    });
    test('can ingest a template with Fn::Sub in string form with escaped and unescaped references and output it unchanged', () => {
        includeTestTemplate(stack, 'fn-sub-string.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-string.json'));
    });
    test('can parse the string argument Fn::Sub with escaped references that contain whitespace', () => {
        includeTestTemplate(stack, 'fn-sub-escaping.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-escaping.json'));
    });
    test('can ingest a template with Fn::Sub using dotted attributes in map form and output it unchanged', () => {
        includeTestTemplate(stack, 'fn-sub-map-dotted-attributes.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-map-dotted-attributes.json'));
    });
    test('preserves an empty map passed to Fn::Sub', () => {
        includeTestTemplate(stack, 'fn-sub-map-empty.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-map-empty.json'));
    });
    test('can ingest a template with Fn::Sub shadowing a logical ID from the template and output it unchanged', () => {
        includeTestTemplate(stack, 'fn-sub-shadow.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-shadow.json'));
    });
    test('can ingest a template with Fn::Sub attribute expression shadowing a logical ID from the template, and output it unchanged', () => {
        includeTestTemplate(stack, 'fn-sub-shadow-attribute.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-shadow-attribute.json'));
    });
    test('can modify resources used in Fn::Sub in map form references and see the changes in the template', () => {
        const cfnTemplate = includeTestTemplate(stack, 'fn-sub-shadow.json');
        cfnTemplate.getResource('AnotherBucket').overrideLogicalId('NewBucket');
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::S3::Bucket', {
            "BucketName": {
                "Fn::Sub": [
                    "${AnotherBucket}",
                    {
                        "AnotherBucket": { "Ref": "NewBucket" },
                    },
                ],
            },
        });
    });
    test('can modify resources used in Fn::Sub in string form and see the changes in the template', () => {
        const cfnTemplate = includeTestTemplate(stack, 'fn-sub-override.json');
        cfnTemplate.getResource('Bucket').overrideLogicalId('NewBucket');
        assertions_1.Template.fromStack(stack).hasResourceProperties('AWS::S3::Bucket', {
            "BucketName": {
                "Fn::Sub": "${NewBucket}-${!Bucket}-${NewBucket.DomainName}",
            },
        });
    });
    test('can ingest a template with Fn::Sub with brace edge cases and output it unchanged', () => {
        includeTestTemplate(stack, 'fn-sub-brace-edges.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-sub-brace-edges.json'));
    });
    test('when a parameter in an Fn::Sub expression is substituted with a deploy-time value, it adds a new key to the Fn::Sub map', () => {
        const parameter = new core.CfnParameter(stack, 'AnotherParam');
        includeTestTemplate(stack, 'fn-sub-parameters.json', {
            parameters: {
                'MyParam': `it's_a_${parameter.valueAsString}_concatenation`,
            },
        });
        assertions_1.Template.fromStack(stack).templateMatches({
            "Parameters": {
                "AnotherParam": {
                    "Type": "String",
                },
            },
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Fn::Sub": [
                                "${MyParam}",
                                {
                                    "MyParam": {
                                        "Fn::Join": ["", [
                                                "it's_a_",
                                                { "Ref": "AnotherParam" },
                                                "_concatenation",
                                            ]],
                                    },
                                },
                            ],
                        },
                    },
                },
            },
        });
    });
    test('can ingest a template with a Ref expression for an array value, and output it unchanged', () => {
        includeTestTemplate(stack, 'ref-array-property.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('ref-array-property.json'));
    });
    test('renders non-Resources sections unchanged', () => {
        includeTestTemplate(stack, 'only-empty-bucket-with-parameters.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('only-empty-bucket-with-parameters.json'));
    });
    test('resolves DependsOn with a single String value to the actual L1 class instance', () => {
        const cfnTemplate = includeTestTemplate(stack, 'resource-attribute-depends-on.json');
        const cfnBucket2 = cfnTemplate.getResource('Bucket2');
        expect(cfnBucket2.node.dependencies).toHaveLength(1);
        // we always render dependsOn as an array, even if it's a single string
        assertions_1.Template.fromStack(stack).hasResource('AWS::S3::Bucket', {
            "Properties": {
                "BucketName": "bucket2",
            },
            "DependsOn": [
                "Bucket1",
            ],
        });
    });
    test('resolves DependsOn with an array of String values to the actual L1 class instances', () => {
        const cfnTemplate = includeTestTemplate(stack, 'resource-attribute-depends-on-array.json');
        const cfnBucket2 = cfnTemplate.getResource('Bucket2');
        expect(cfnBucket2.node.dependencies).toHaveLength(2);
        assertions_1.Template.fromStack(stack).hasResource('AWS::S3::Bucket', {
            "Properties": {
                "BucketName": "bucket2",
            },
            "DependsOn": [
                "Bucket0",
                "Bucket1",
            ],
        });
    });
    test('correctly parses Conditions and the Condition resource attribute', () => {
        const cfnTemplate = includeTestTemplate(stack, 'resource-attribute-condition.json');
        const alwaysFalseCondition = cfnTemplate.getCondition('AlwaysFalseCond');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        expect(cfnBucket.cfnOptions.condition).toBe(alwaysFalseCondition);
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('resource-attribute-condition.json'));
    });
    test('allows Conditions to reference Mappings', () => {
        includeTestTemplate(stack, 'condition-using-mapping.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('condition-using-mapping.json'));
    });
    test('correctly change references to Conditions when renaming them', () => {
        const cfnTemplate = includeTestTemplate(stack, 'condition-same-name-as-resource.json');
        const alwaysFalse = cfnTemplate.getCondition('AlwaysFalse');
        alwaysFalse.overrideLogicalId('TotallyFalse');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Parameters": {
                "Param": {
                    "Type": "String",
                },
            },
            "Conditions": {
                "AlwaysTrue": {
                    "Fn::Not": [{ "Condition": "TotallyFalse" }],
                },
                "TotallyFalse": {
                    "Fn::Equals": [{ "Ref": "Param" }, 2],
                },
            },
            "Resources": {
                "AlwaysTrue": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Fn::If": ["TotallyFalse",
                                { "Ref": "Param" },
                                { "Ref": "AWS::NoValue" }],
                        },
                    },
                },
            },
        });
    });
    test('correctly parses templates with parameters', () => {
        const cfnTemplate = includeTestTemplate(stack, 'bucket-with-parameters.json');
        const param = cfnTemplate.getParameter('BucketName');
        new s3.CfnBucket(stack, 'NewBucket', {
            bucketName: param.valueAsString,
        });
        const originalTemplate = loadTestFileToJsObject('bucket-with-parameters.json');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                ...originalTemplate.Resources,
                "NewBucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Ref": "BucketName",
                        },
                    },
                },
            },
            "Parameters": {
                ...originalTemplate.Parameters,
            },
        });
    });
    test('getParameter() throws an exception if asked for a Parameter with a name that is not present in the template', () => {
        const cfnTemplate = includeTestTemplate(stack, 'bucket-with-parameters.json');
        expect(() => {
            cfnTemplate.getParameter('FakeBucketNameThatDoesNotExist');
        }).toThrow(/Parameter with name 'FakeBucketNameThatDoesNotExist' was not found in the template/);
    });
    test('reflects changes to a retrieved CfnParameter object in the resulting template', () => {
        const cfnTemplate = includeTestTemplate(stack, 'bucket-with-parameters.json');
        const stringParam = cfnTemplate.getParameter('BucketName');
        const numberParam = cfnTemplate.getParameter('CorsMaxAge');
        stringParam.default = 'MyDefault';
        stringParam.allowedPattern = '[0-9]*$';
        stringParam.allowedValues = ['123123', '456789'];
        stringParam.constraintDescription = 'MyNewConstraint';
        stringParam.description = 'a string of numeric characters';
        stringParam.maxLength = 6;
        stringParam.minLength = 2;
        numberParam.maxValue = 100;
        numberParam.minValue = 4;
        numberParam.noEcho = false;
        numberParam.type = "NewType";
        const originalTemplate = loadTestFileToJsObject('bucket-with-parameters.json');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                ...originalTemplate.Resources,
            },
            "Parameters": {
                ...originalTemplate.Parameters,
                "BucketName": {
                    ...originalTemplate.Parameters.BucketName,
                    "Default": "MyDefault",
                    "AllowedPattern": "[0-9]*$",
                    "AllowedValues": ["123123", "456789"],
                    "ConstraintDescription": "MyNewConstraint",
                    "Description": "a string of numeric characters",
                    "MaxLength": 6,
                    "MinLength": 2,
                },
                "CorsMaxAge": {
                    ...originalTemplate.Parameters.CorsMaxAge,
                    "MaxValue": 100,
                    "MinValue": 4,
                    "NoEcho": false,
                    "Type": "NewType",
                },
            },
        });
    });
    test('reflects changes to a retrieved CfnCondition object in the resulting template', () => {
        const cfnTemplate = includeTestTemplate(stack, 'resource-attribute-condition.json');
        const alwaysFalseCondition = cfnTemplate.getCondition('AlwaysFalseCond');
        alwaysFalseCondition.expression = core.Fn.conditionEquals(1, 2);
        assertions_1.Template.fromStack(stack).templateMatches({
            "Conditions": {
                "AlwaysFalseCond": {
                    "Fn::Equals": [1, 2],
                },
            },
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Condition": "AlwaysFalseCond",
                },
            },
        });
    });
    test('correctly handles the CreationPolicy resource attribute', () => {
        const cfnTemplate = includeTestTemplate(stack, 'resource-attribute-creation-policy.json');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        expect(cfnBucket.cfnOptions.creationPolicy).toBeDefined();
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('resource-attribute-creation-policy.json'));
    });
    test('correctly handles the UpdatePolicy resource attribute', () => {
        const cfnTemplate = includeTestTemplate(stack, 'resource-attribute-update-policy.json');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        expect(cfnBucket.cfnOptions.updatePolicy).toBeDefined();
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('resource-attribute-update-policy.json'));
    });
    test('preserves unknown resource attributes', () => {
        includeTestTemplate(stack, 'non-existent-resource-attribute.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('non-existent-resource-attribute.json'));
    });
    test("correctly handles referencing the ingested template's resources across Stacks", () => {
        // for cross-stack sharing to work, we need an App
        const app = new core.App();
        stack = new core.Stack(app, 'MyStack');
        const cfnTemplate = includeTestTemplate(stack, 'only-empty-bucket.json');
        const cfnBucket = cfnTemplate.getResource('Bucket');
        const otherStack = new core.Stack(app, 'OtherStack');
        const role = new iam.Role(otherStack, 'Role', {
            assumedBy: new iam.AnyPrincipal(),
        });
        role.addToPolicy(new iam.PolicyStatement({
            actions: ['s3:*'],
            resources: [cfnBucket.attrArn],
        }));
        assertions_1.Template.fromStack(stack).templateMatches({
            ...loadTestFileToJsObject('only-empty-bucket.json'),
            "Outputs": {
                "ExportsOutputFnGetAttBucketArn436138FE": {
                    "Value": {
                        "Fn::GetAtt": ["Bucket", "Arn"],
                    },
                    "Export": {
                        "Name": "MyStack:ExportsOutputFnGetAttBucketArn436138FE",
                    },
                },
            },
        });
        assertions_1.Template.fromStack(otherStack).hasResourceProperties('AWS::IAM::Policy', {
            "PolicyDocument": {
                "Statement": [
                    {
                        "Action": "s3:*",
                        "Resource": {
                            "Fn::ImportValue": "MyStack:ExportsOutputFnGetAttBucketArn436138FE",
                        },
                    },
                ],
            },
        });
    });
    test('correctly re-names references to resources in the template if their logical IDs have been changed', () => {
        const cfnTemplate = includeTestTemplate(stack, 'bucket-with-encryption-key.json');
        const cfnKey = cfnTemplate.getResource('Key');
        cfnKey.overrideLogicalId('TotallyDifferentKey');
        const originalTemplate = loadTestFileToJsObject('bucket-with-encryption-key.json');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketEncryption": {
                            "ServerSideEncryptionConfiguration": [
                                {
                                    "ServerSideEncryptionByDefault": {
                                        "KMSMasterKeyID": {
                                            "Fn::GetAtt": ["TotallyDifferentKey", "Arn"],
                                        },
                                        "SSEAlgorithm": "aws:kms",
                                    },
                                },
                            ],
                        },
                    },
                    "Metadata": {
                        "Object1": "Location1",
                        "KeyRef": { "Ref": "TotallyDifferentKey" },
                        "KeyArn": { "Fn::GetAtt": ["TotallyDifferentKey", "Arn"] },
                    },
                    "DeletionPolicy": "Retain",
                    "UpdateReplacePolicy": "Retain",
                },
                "TotallyDifferentKey": originalTemplate.Resources.Key,
            },
        });
    });
    test('can include a template with a custom resource that uses attributes', () => {
        const cfnTemplate = includeTestTemplate(stack, 'custom-resource-with-attributes.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('custom-resource-with-attributes.json'));
        const alwaysFalseCondition = cfnTemplate.getCondition('AlwaysFalseCond');
        expect(cfnTemplate.getResource('CustomBucket').cfnOptions.condition).toBe(alwaysFalseCondition);
    });
    test("throws an exception when a custom resource uses a Condition attribute that doesn't exist in the template", () => {
        expect(() => {
            includeTestTemplate(stack, 'custom-resource-with-bad-condition.json');
        }).toThrow(/Resource 'CustomResource' uses Condition 'AlwaysFalseCond' that doesn't exist/);
    });
    test('can ingest a template that contains outputs and modify them', () => {
        const cfnTemplate = includeTestTemplate(stack, 'outputs-with-references.json');
        const output = cfnTemplate.getOutput('Output1');
        output.value = 'a mutated value';
        output.description = undefined;
        output.exportName = 'an export';
        output.condition = new core.CfnCondition(stack, 'MyCondition', {
            expression: core.Fn.conditionIf('AlwaysFalseCond', core.Aws.NO_VALUE, true),
        });
        const originalTemplate = loadTestFileToJsObject('outputs-with-references.json');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Conditions": {
                ...originalTemplate.Conditions,
                "MyCondition": {
                    "Fn::If": [
                        "AlwaysFalseCond",
                        { "Ref": "AWS::NoValue" },
                        true,
                    ],
                },
            },
            "Parameters": {
                ...originalTemplate.Parameters,
            },
            "Resources": {
                ...originalTemplate.Resources,
            },
            "Outputs": {
                "Output1": {
                    "Value": "a mutated value",
                    "Export": {
                        "Name": "an export",
                    },
                    "Condition": "MyCondition",
                },
                "OutputWithNoCondition": {
                    "Value": "some-value",
                },
            },
        });
    });
    test('can ingest a template that contains outputs and get those outputs', () => {
        const cfnTemplate = includeTestTemplate(stack, 'outputs-with-references.json');
        const output = cfnTemplate.getOutput('Output1');
        expect(output.condition).toBe(cfnTemplate.getCondition('AlwaysFalseCond'));
        expect(output.description).toBeDefined();
        expect(output.value).toBeDefined();
        expect(output.exportName).toBeDefined();
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('outputs-with-references.json'));
    });
    test("throws an exception when attempting to retrieve an Output that doesn't exist", () => {
        const cfnTemplate = includeTestTemplate(stack, 'outputs-with-references.json');
        expect(() => {
            cfnTemplate.getOutput('FakeOutput');
        }).toThrow(/Output with logical ID 'FakeOutput' was not found in the template/);
    });
    test('can ingest a template that contains Mappings, and retrieve those Mappings', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-mapping-and-bucket.json');
        const someMapping = cfnTemplate.getMapping('SomeMapping');
        someMapping.setValue('region', 'key2', 'value2');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Mappings": {
                "SomeMapping": {
                    "region": {
                        "key1": "value1",
                        "key2": "value2",
                    },
                },
            },
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Fn::FindInMap": [
                                "SomeMapping",
                                { "Ref": "AWS::Region" },
                                "key1",
                            ],
                        },
                    },
                },
            },
        });
    });
    test("throws an exception when attempting to retrieve a Mapping that doesn't exist in the template", () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-mapping-and-bucket.json');
        expect(() => {
            cfnTemplate.getMapping('NonExistentMapping');
        }).toThrow(/Mapping with name 'NonExistentMapping' was not found in the template/);
    });
    test('can ingest a template that uses Fn::FindInMap with the first argument being a dynamic reference', () => {
        includeTestTemplate(stack, 'find-in-map-with-dynamic-mapping.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('find-in-map-with-dynamic-mapping.json'));
    });
    test('handles renaming Mapping references', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-mapping-and-bucket.json');
        const someMapping = cfnTemplate.getMapping('SomeMapping');
        someMapping.overrideLogicalId('DifferentMapping');
        assertions_1.Template.fromStack(stack).templateMatches({
            "Mappings": {
                "DifferentMapping": {
                    "region": {
                        "key1": "value1",
                    },
                },
            },
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Fn::FindInMap": [
                                "DifferentMapping",
                                { "Ref": "AWS::Region" },
                                "key1",
                            ],
                        },
                    },
                },
            },
        });
    });
    test('can ingest a template that uses Fn::FindInMap for the value of a boolean property', () => {
        includeTestTemplate(stack, 'find-in-map-for-boolean-property.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('find-in-map-for-boolean-property.json'));
    });
    test('can ingest a template that contains Rules, and allows retrieving those Rules', () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-parameters-and-rule.json');
        const rule = cfnTemplate.getRule('TestVpcRule');
        expect(rule).toBeDefined();
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('only-parameters-and-rule.json'));
    });
    test('fails when trying to replace Parameters referenced in Fn::ValueOf expressions with user-provided values', () => {
        expect(() => {
            includeTestTemplate(stack, 'only-parameters-and-rule.json', {
                parameters: {
                    'Subnets': ['subnet-1234abcd'],
                },
            });
        }).toThrow(/Cannot substitute parameter 'Subnets' used in Fn::ValueOf expression with attribute 'VpcId'/);
    });
    test("throws an exception when attempting to retrieve a Rule that doesn't exist in the template", () => {
        const cfnTemplate = includeTestTemplate(stack, 'only-parameters-and-rule.json');
        expect(() => {
            cfnTemplate.getRule('DoesNotExist');
        }).toThrow(/Rule with name 'DoesNotExist' was not found in the template/);
    });
    test('can ingest a template that contains Hooks, and allows retrieving those Hooks', () => {
        const cfnTemplate = includeTestTemplate(stack, 'hook-code-deploy-blue-green-ecs.json');
        const hook = cfnTemplate.getHook('EcsBlueGreenCodeDeployHook');
        expect(hook).toBeDefined();
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('hook-code-deploy-blue-green-ecs.json'));
    });
    test("throws an exception when attempting to retrieve a Hook that doesn't exist in the template", () => {
        const cfnTemplate = includeTestTemplate(stack, 'hook-code-deploy-blue-green-ecs.json');
        expect(() => {
            cfnTemplate.getHook('DoesNotExist');
        }).toThrow(/Hook with logical ID 'DoesNotExist' was not found in the template/);
    });
    test('replaces references to parameters with the user-specified values in Resources, Conditions, Metadata, and Options sections', () => {
        includeTestTemplate(stack, 'parameter-references.json', {
            parameters: {
                'MyParam': 'my-s3-bucket',
            },
        });
        assertions_1.Template.fromStack(stack).templateMatches({
            "Transform": {
                "Name": "AWS::Include",
                "Parameters": {
                    "Location": "my-s3-bucket",
                },
            },
            "Metadata": {
                "Field": {
                    "Fn::If": [
                        "AlwaysFalse",
                        "AWS::NoValue",
                        "my-s3-bucket",
                    ],
                },
            },
            "Conditions": {
                "AlwaysFalse": {
                    "Fn::Equals": ["my-s3-bucket", "Invalid?BucketName"],
                },
            },
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Metadata": {
                        "Field": "my-s3-bucket",
                    },
                    "Properties": {
                        "BucketName": "my-s3-bucket",
                    },
                },
            },
            "Outputs": {
                "MyOutput": {
                    "Value": "my-s3-bucket",
                },
            },
        });
    });
    test('replaces parameters with falsey values in Ref expressions', () => {
        includeTestTemplate(stack, 'resource-attribute-creation-policy.json', {
            parameters: {
                'CountParameter': 0,
            },
        });
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "CreationPolicy": {
                        "AutoScalingCreationPolicy": {
                            "MinSuccessfulInstancesPercent": 50,
                        },
                        "ResourceSignal": {
                            "Count": 0,
                            "Timeout": "PT5H4M3S",
                        },
                    },
                },
            },
        });
    });
    test('replaces parameters in Fn::Sub expressions', () => {
        includeTestTemplate(stack, 'fn-sub-parameters.json', {
            parameters: {
                'MyParam': 'my-s3-bucket',
            },
        });
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Fn::Sub": "my-s3-bucket",
                        },
                    },
                },
            },
        });
    });
    test('does not modify Fn::Sub variables shadowing a replaced parameter', () => {
        includeTestTemplate(stack, 'fn-sub-shadow-parameter.json', {
            parameters: {
                'MyParam': 'MyValue',
            },
        });
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": {
                            "Fn::Sub": [
                                "${MyParam}",
                                {
                                    "MyParam": "MyValue",
                                },
                            ],
                        },
                    },
                },
            },
        });
    });
    test('replaces parameters with falsey values in Fn::Sub expressions', () => {
        includeTestTemplate(stack, 'fn-sub-parameters.json', {
            parameters: {
                'MyParam': '',
            },
        });
        assertions_1.Template.fromStack(stack).templateMatches({
            "Resources": {
                "Bucket": {
                    "Type": "AWS::S3::Bucket",
                    "Properties": {
                        "BucketName": { "Fn::Sub": "" },
                    },
                },
            },
        });
    });
    test('throws an exception when parameters are passed a resource name', () => {
        expect(() => {
            includeTestTemplate(stack, 'bucket-with-parameters.json', {
                parameters: {
                    'Bucket': 'noChange',
                },
            });
        }).toThrow(/Parameter with logical ID 'Bucket' was not found in the template/);
    });
    test('throws an exception when provided a parameter to replace that is not in the template with parameters', () => {
        expect(() => {
            includeTestTemplate(stack, 'bucket-with-parameters.json', {
                parameters: {
                    'FakeParameter': 'DoesNotExist',
                },
            });
        }).toThrow(/Parameter with logical ID 'FakeParameter' was not found in the template/);
    });
    test('throws an exception when provided a parameter to replace in a template with no parameters', () => {
        expect(() => {
            includeTestTemplate(stack, 'only-empty-bucket.json', {
                parameters: {
                    'FakeParameter': 'DoesNotExist',
                },
            });
        }).toThrow(/Parameter with logical ID 'FakeParameter' was not found in the template/);
    });
    test('can ingest a template that contains properties not in the current CFN spec, and output it unchanged', () => {
        includeTestTemplate(stack, 'properties-not-in-cfn-spec.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('properties-not-in-cfn-spec.json'));
    });
    test('roundtrip a fn-select with a fn-if/ref-novalue in it', () => {
        includeTestTemplate(stack, 'fn-select-with-novalue.json');
        assertions_1.Template.fromStack(stack).templateMatches(loadTestFileToJsObject('fn-select-with-novalue.json'));
    });
});
function includeTestTemplate(scope, testTemplate, props = {}) {
    return new inc.CfnInclude(scope, 'MyScope', {
        templateFile: _testTemplateFilePath(testTemplate),
        parameters: props.parameters,
        preserveLogicalIds: props.preserveLogicalIds,
    });
}
function loadTestFileToJsObject(testTemplate) {
    return futils.readJsonSync(_testTemplateFilePath(testTemplate));
}
function _testTemplateFilePath(testTemplate) {
    return path.join(__dirname, 'test-templates', testTemplate);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWQtdGVtcGxhdGVzLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2YWxpZC10ZW1wbGF0ZXMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDZCQUE2QjtBQUM3QixpREFBNEM7QUFDNUMscUNBQXFDO0FBQ3JDLG1DQUFtQztBQUVuQyxtQ0FBbUM7QUFFbkMsOEJBQThCO0FBQzlCLDRDQUE0QztBQUU1QyxnQ0FBZ0M7QUFDaEMsMkJBQTJCO0FBRTNCLFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO0lBQzNCLElBQUksS0FBaUIsQ0FBQztJQUV0QixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQzNCLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxDQUFDLDZFQUE2RSxFQUFFLEdBQUcsRUFBRTtRQUN2RixtQkFBbUIsQ0FBQyxLQUFLLEVBQUUsd0JBQXdCLENBQUMsQ0FBQztRQUVyRCxxQkFBUSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxlQUFlLENBQ3ZDLHNCQUFzQixDQUFDLHdCQUF3QixDQUFDLENBQ2pELENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyx5RkFBeUYsRUFBRSxHQUFHLEVBQUU7UUFDbkcsTUFBTSxXQUFXLEdBQUcsbUJBQW1CLENBQUMsS0FBSyxFQUFFLHdCQUF3QixDQUFDLENBQUM7UUFFekUsTUFBTSxDQUFDLEdBQUcsRUFBRTtZQUNWLFdBQVcsQ0FBQyxXQUFXLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUN2RCxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsb0ZBQW9GLENBQUMsQ0FBQztJQUNuRyxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyw2RUFBNkUsRUFBRSxHQUFHLEVBQUU7UUFDdkYsTUFBTSxXQUFXLEdBQUcsbUJBQW1CLENBQUMsS0FBSyxFQUFFLHdCQUF3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SyxDQUFDLENBQUMsZUFBZSxDQUN2QyxzQkFBc0IsQ0FBQyw2QkFBNkIsQ0FBQyxDQUN0RCxDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQVVILFNBQVMsbUJBQW1CLENBQUMsS0FBMkIsRUFBRSxZQUFvQixFQUFFLFFBQWtDLEVBQUU7SUFDbEgsT0FBTyxJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLFNBQVMsRUFBRTtRQUMxQyxZQUFZLEVBQUUscUJBQXFCLENBQUMsWUFBWSxDQUFDO1FBQ2pELFVBQVUsRUFBRSxLQUFLLENBQUMsVUFBVTtRQUM1QixrQkFBa0IsRUFBRSxLQUFLLENBQUMsa0JBQWtCO0tBQzdDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRCxTQUFTLHNCQUFzQixDQUFDLFlBQW9CO0lBQ2xELE9BQU8sTUFBTSxDQUFDLFlBQVksQ0FBQyxxQkFBcUIsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO0FBQ2xFLENBQUM7QUFFRCxTQUFTLHFCQUFxQixDQUFDLFlBQW9CO0lBQ2pELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsZ0JBQWdCLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDOUQsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBUZW1wbGF0ZSB9IGZyb20gJy4uLy4uL2Fzc2VydGlvbnMnO1xuaW1wb3J0ICogYXMgaWFtIGZyb20gJy4uLy4uL2F3cy1pYW0nO1xuaW1wb3J0ICogYXMgczMgZnJvbSAnLi4vLi4vYXdzLXMzJztcbmltcG9ydCAqIGFzIHNzbSBmcm9tICcuLi8uLi9hd3Mtc3NtJztcbmltcG9ydCAqIGFzIGNvcmUgZnJvbSAnLi4vLi4vY29yZSc7XG5pbXBvcnQgKiBhcyBjb25zdHJ1Y3RzIGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0ICogYXMgaW5jIGZyb20gJy4uL2xpYic7XG5pbXBvcnQgKiBhcyBmdXRpbHMgZnJvbSAnLi4vbGliL2ZpbGUtdXRpbHMnO1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBxdW90ZS1wcm9wcyAqL1xuLyogZXNsaW50LWRpc2FibGUgcXVvdGVzICovXG5cbmRlc2NyaWJlKCdDREsgSW5jbHVkZScsICgpID0+IHtcbiAgbGV0IHN0YWNrOiBjb3JlLlN0YWNrO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHN0YWNrID0gbmV3IGNvcmUuU3RhY2soKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGluZ2VzdCBhIHRlbXBsYXRlIHdpdGggb25seSBhbiBlbXB0eSBTMyBCdWNrZXQsIGFuZCBvdXRwdXQgaXQgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdvbmx5LWVtcHR5LWJ1Y2tldC5qc29uJyk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ29ubHktZW1wdHktYnVja2V0Lmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCd0aHJvd3MgYW4gZXhjZXB0aW9uIGlmIGFza2VkIGZvciByZXNvdXJjZSB3aXRoIGEgbG9naWNhbCBJRCBub3QgcHJlc2VudCBpbiB0aGUgdGVtcGxhdGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1lbXB0eS1idWNrZXQuanNvbicpO1xuXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIGNmblRlbXBsYXRlLmdldFJlc291cmNlKCdMb2dpY2FsSWRUaGF0RG9lc05vdEV4aXN0Jyk7XG4gICAgfSkudG9UaHJvdygvUmVzb3VyY2Ugd2l0aCBsb2dpY2FsIElEICdMb2dpY2FsSWRUaGF0RG9lc05vdEV4aXN0JyB3YXMgbm90IGZvdW5kIGluIHRoZSB0ZW1wbGF0ZS8pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgd2l0aCBvbmx5IGFuIGVtcHR5IFMzIEJ1Y2tldCwgYW5kIGNoYW5nZSBpdHMgcHJvcGVydHknLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1lbXB0eS1idWNrZXQuanNvbicpO1xuXG4gICAgY29uc3QgY2ZuQnVja2V0ID0gY2ZuVGVtcGxhdGUuZ2V0UmVzb3VyY2UoJ0J1Y2tldCcpIGFzIHMzLkNmbkJ1Y2tldDtcbiAgICBjZm5CdWNrZXQuYnVja2V0TmFtZSA9ICdteS1idWNrZXQtbmFtZSc7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIFwiQnVja2V0XCI6IHtcbiAgICAgICAgICBcIlR5cGVcIjogXCJBV1M6OlMzOjpCdWNrZXRcIixcbiAgICAgICAgICBcIlByb3BlcnRpZXNcIjoge1xuICAgICAgICAgICAgXCJCdWNrZXROYW1lXCI6IFwibXktYnVja2V0LW5hbWVcIixcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGluZ2VzdCBhIHRlbXBsYXRlIHdpdGggb25seSBhbiBTMyBCdWNrZXQgd2l0aCBjb21wbGV4IHByb3BlcnRpZXMsIGFuZCBvdXRwdXQgaXQgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ29ubHktYnVja2V0LWNvbXBsZXgtcHJvcHMuanNvbicpO1xuICAgIGNvbnN0IGNmbkJ1Y2tldCA9IGNmblRlbXBsYXRlLmdldFJlc291cmNlKCdCdWNrZXQnKSBhcyBzMy5DZm5CdWNrZXQ7XG5cbiAgICBleHBlY3QoKGNmbkJ1Y2tldC5jb3JzQ29uZmlndXJhdGlvbiBhcyBhbnkpLmNvcnNSdWxlcykudG9IYXZlTGVuZ3RoKDEpO1xuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgnb25seS1idWNrZXQtY29tcGxleC1wcm9wcy5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnYWxsb3dzIHJlZmVycmluZyB0byBhIGJ1Y2tldCBkZWZpbmVkIGluIHRoZSB0ZW1wbGF0ZSBpbiB5b3VyIENESyBjb2RlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ29ubHktZW1wdHktYnVja2V0Lmpzb24nKTtcbiAgICBjb25zdCBjZm5CdWNrZXQgPSBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQnVja2V0JykgYXMgczMuQ2ZuQnVja2V0O1xuXG4gICAgY29uc3Qgcm9sZSA9IG5ldyBpYW0uUm9sZShzdGFjaywgJ1JvbGUnLCB7XG4gICAgICBhc3N1bWVkQnk6IG5ldyBpYW0uQW55UHJpbmNpcGFsKCksXG4gICAgfSk7XG4gICAgcm9sZS5hZGRUb1BvbGljeShuZXcgaWFtLlBvbGljeVN0YXRlbWVudCh7XG4gICAgICBhY3Rpb25zOiBbJ3MzOionXSxcbiAgICAgIHJlc291cmNlczogW2NmbkJ1Y2tldC5hdHRyQXJuXSxcbiAgICB9KSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsIHtcbiAgICAgIFwiUG9saWN5RG9jdW1lbnRcIjoge1xuICAgICAgICBcIlN0YXRlbWVudFwiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJBY3Rpb25cIjogXCJzMzoqXCIsXG4gICAgICAgICAgICBcIlJlc291cmNlXCI6IHtcbiAgICAgICAgICAgICAgXCJGbjo6R2V0QXR0XCI6IFtcbiAgICAgICAgICAgICAgICBcIkJ1Y2tldFwiLFxuICAgICAgICAgICAgICAgIFwiQXJuXCIsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgd2l0aCBhIEJ1Y2tldCBSZWYtZXJlbmNpbmcgYSBLTVMgS2V5LCBhbmQgb3V0cHV0IGl0IHVuY2hhbmdlZCcsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnYnVja2V0LXdpdGgtZW5jcnlwdGlvbi1rZXkuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdidWNrZXQtd2l0aC1lbmNyeXB0aW9uLWtleS5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnYWNjZXB0cyBzdHJpbmdzIGZvciBwcm9wZXJ0aWVzIHdpdGggdHlwZSBudW1iZXInLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ3N0cmluZy1mb3ItbnVtYmVyLmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XG4gICAgICBcIkNvcnNDb25maWd1cmF0aW9uXCI6IHtcbiAgICAgICAgXCJDb3JzUnVsZXNcIjogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwiTWF4QWdlXCI6IDEwLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdhY2NlcHRzIG51bWJlcnMgZm9yIHByb3BlcnRpZXMgd2l0aCB0eXBlIHN0cmluZycsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnbnVtYmVyLWZvci1zdHJpbmcuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6UzM6OkJ1Y2tldCcsIHtcbiAgICAgIFwiV2Vic2l0ZUNvbmZpZ3VyYXRpb25cIjoge1xuICAgICAgICBcIlJvdXRpbmdSdWxlc1wiOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgXCJSZWRpcmVjdFJ1bGVcIjoge1xuICAgICAgICAgICAgICBcIkh0dHBSZWRpcmVjdENvZGVcIjogXCI0MDNcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FjY2VwdHMgYm9vbGVhbnMgZm9yIHByb3BlcnRpZXMgd2l0aCB0eXBlIHN0cmluZycsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnYm9vbGVhbi1mb3Itc3RyaW5nLmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XG4gICAgICBcIkFjY2Vzc0NvbnRyb2xcIjogXCJ0cnVlXCIsXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NvcnJlY3RseSBjaGFuZ2VzIHRoZSBsb2dpY2FsIElEcywgaW5jbHVkaW5nIHJlZmVyZW5jZXMsIGlmIGltcG9ydGVkIHdpdGggcHJlc2VydmVMb2dpY2FsSWRzPWZhbHNlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2J1Y2tldC13aXRoLWVuY3J5cHRpb24ta2V5Lmpzb24nLCB7XG4gICAgICBwcmVzZXJ2ZUxvZ2ljYWxJZHM6IGZhbHNlLFxuICAgIH0pO1xuXG4gICAgLy8gZXZlbiB0aG91Z2ggdGhlIGxvZ2ljYWwgSURzIGluIHRoZSByZXN1bHRpbmcgdGVtcGxhdGUgYXJlIGRpZmZlcmVudCB0aGFuIGluIHRoZSBpbnB1dCB0ZW1wbGF0ZSxcbiAgICAvLyB0aGUgTDFzIGNhbiBzdGlsbCBiZSByZXRyaWV2ZWQgdXNpbmcgdGhlaXIgb3JpZ2luYWwgbG9naWNhbCBJRHMgZnJvbSB0aGUgdGVtcGxhdGUgZmlsZSxcbiAgICAvLyBhbmQgYW55IG1vZGlmaWNhdGlvbnMgdG8gdGhlbSB3aWxsIGJlIHJlZmxlY3RlZCBpbiB0aGUgcmVzdWx0aW5nIHRlbXBsYXRlXG4gICAgY29uc3QgY2ZuQnVja2V0ID0gY2ZuVGVtcGxhdGUuZ2V0UmVzb3VyY2UoJ0J1Y2tldCcpIGFzIHMzLkNmbkJ1Y2tldDtcbiAgICBjZm5CdWNrZXQuYnVja2V0TmFtZSA9ICdteS1idWNrZXQtbmFtZSc7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIFwiTXlTY29wZUtleTc2NzM2OTJGXCI6IHtcbiAgICAgICAgICBcIlR5cGVcIjogXCJBV1M6OktNUzo6S2V5XCIsXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiS2V5UG9saWN5XCI6IHtcbiAgICAgICAgICAgICAgXCJTdGF0ZW1lbnRcIjogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFwiQWN0aW9uXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgXCJrbXM6KlwiLFxuICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgIFwiRWZmZWN0XCI6IFwiQWxsb3dcIixcbiAgICAgICAgICAgICAgICAgIFwiUHJpbmNpcGFsXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJBV1NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgIFwiRm46OkpvaW5cIjogW1wiXCIsIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXJuOlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBcIlJlZlwiOiBcIkFXUzo6UGFydGl0aW9uXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiOmlhbTo6XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB7IFwiUmVmXCI6IFwiQVdTOjpBY2NvdW50SWRcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCI6cm9vdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIF1dLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIFwiUmVzb3VyY2VcIjogXCIqXCIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgXCJWZXJzaW9uXCI6IFwiMjAxMi0xMC0xN1wiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiRGVsZXRpb25Qb2xpY3lcIjogXCJEZWxldGVcIixcbiAgICAgICAgICBcIlVwZGF0ZVJlcGxhY2VQb2xpY3lcIjogXCJEZWxldGVcIixcbiAgICAgICAgfSxcbiAgICAgICAgXCJNeVNjb3BlQnVja2V0MDJDMTMxM0JcIjoge1xuICAgICAgICAgIFwiVHlwZVwiOiBcIkFXUzo6UzM6OkJ1Y2tldFwiLFxuICAgICAgICAgIFwiUHJvcGVydGllc1wiOiB7XG4gICAgICAgICAgICBcIkJ1Y2tldE5hbWVcIjogXCJteS1idWNrZXQtbmFtZVwiLFxuICAgICAgICAgICAgXCJCdWNrZXRFbmNyeXB0aW9uXCI6IHtcbiAgICAgICAgICAgICAgXCJTZXJ2ZXJTaWRlRW5jcnlwdGlvbkNvbmZpZ3VyYXRpb25cIjogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIFwiU2VydmVyU2lkZUVuY3J5cHRpb25CeURlZmF1bHRcIjoge1xuICAgICAgICAgICAgICAgICAgICBcIktNU01hc3RlcktleUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICBcIkZuOjpHZXRBdHRcIjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJNeVNjb3BlS2V5NzY3MzY5MkZcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiQXJuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXCJTU0VBbGdvcml0aG1cIjogXCJhd3M6a21zXCIsXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJNZXRhZGF0YVwiOiB7XG4gICAgICAgICAgICBcIk9iamVjdDFcIjogXCJMb2NhdGlvbjFcIixcbiAgICAgICAgICAgIFwiS2V5UmVmXCI6IHsgXCJSZWZcIjogXCJNeVNjb3BlS2V5NzY3MzY5MkZcIiB9LFxuICAgICAgICAgICAgXCJLZXlBcm5cIjogeyBcIkZuOjpHZXRBdHRcIjogW1wiTXlTY29wZUtleTc2NzM2OTJGXCIsIFwiQXJuXCJdIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkRlbGV0aW9uUG9saWN5XCI6IFwiUmV0YWluXCIsXG4gICAgICAgICAgXCJVcGRhdGVSZXBsYWNlUG9saWN5XCI6IFwiUmV0YWluXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgd2l0aCBhbiBGbjo6SWYgZXhwcmVzc2lvbiBmb3Igc2ltcGxlIHZhbHVlcywgYW5kIG91dHB1dCBpdCB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2lmLXNpbXBsZS1wcm9wZXJ0eS5qc29uJyk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ2lmLXNpbXBsZS1wcm9wZXJ0eS5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGluZ2VzdCBhIHRlbXBsYXRlIHdpdGggYW4gRm46OklmIGV4cHJlc3Npb24gZm9yIGNvbXBsZXggdmFsdWVzLCBhbmQgb3V0cHV0IGl0IHVuY2hhbmdlZCcsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnaWYtY29tcGxleC1wcm9wZXJ0eS5qc29uJyk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ2lmLWNvbXBsZXgtcHJvcGVydHkuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB1c2luZyBGbjo6SWYgaW4gVGFncywgYW5kIG91dHB1dCBpdCB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2lmLWluLXRhZ3MuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdpZi1pbi10YWdzLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgVXNlckRhdGEgc2NyaXB0LCBhbmQgb3V0cHV0IGl0IHVuY2hhbmdlZCcsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAndXNlci1kYXRhLmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgndXNlci1kYXRhLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gY29ycmVjdGx5IGluZ2VzdCBhIHJlc291cmNlIHdpdGggYSBwcm9wZXJ0eSBvZiB0eXBlOiBNYXAgb2YgTGlzdHMgb2YgcHJpbWl0aXZlIHR5cGVzJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ3NzbS1hc3NvY2lhdGlvbi5qc29uJyk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ3NzbS1hc3NvY2lhdGlvbi5qc29uJyksXG4gICAgKTtcbiAgICBjb25zdCBhc3NvY2lhdGlvbiA9IGNmblRlbXBsYXRlLmdldFJlc291cmNlKCdBc3NvY2lhdGlvbicpIGFzIHNzbS5DZm5Bc3NvY2lhdGlvbjtcbiAgICBleHBlY3QoT2JqZWN0LmtleXMoYXNzb2NpYXRpb24ucGFyYW1ldGVycyBhcyBhbnkpKS50b0hhdmVMZW5ndGgoMik7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB3aXRoIGludHJpbnNpYyBmdW5jdGlvbnMgYW5kIGNvbmRpdGlvbnMsIGFuZCBvdXRwdXQgaXQgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdmdW5jdGlvbnMtYW5kLWNvbmRpdGlvbnMuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmdW5jdGlvbnMtYW5kLWNvbmRpdGlvbnMuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSBKU09OIHRlbXBsYXRlIHdpdGggc3RyaW5nLWZvcm0gRm46OkdldEF0dCwgYW5kIG91dHB1dCBpdCB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2dldC1hdHQtc3RyaW5nLWZvcm0uanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdnZXQtYXR0LXN0cmluZy1mb3JtLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgd2l0aCBGbjo6U3ViIGluIHN0cmluZyBmb3JtIHdpdGggZXNjYXBlZCBhbmQgdW5lc2NhcGVkIHJlZmVyZW5jZXMgYW5kIG91dHB1dCBpdCB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2ZuLXN1Yi1zdHJpbmcuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmbi1zdWItc3RyaW5nLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gcGFyc2UgdGhlIHN0cmluZyBhcmd1bWVudCBGbjo6U3ViIHdpdGggZXNjYXBlZCByZWZlcmVuY2VzIHRoYXQgY29udGFpbiB3aGl0ZXNwYWNlJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdmbi1zdWItZXNjYXBpbmcuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmbi1zdWItZXNjYXBpbmcuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB3aXRoIEZuOjpTdWIgdXNpbmcgZG90dGVkIGF0dHJpYnV0ZXMgaW4gbWFwIGZvcm0gYW5kIG91dHB1dCBpdCB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2ZuLXN1Yi1tYXAtZG90dGVkLWF0dHJpYnV0ZXMuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmbi1zdWItbWFwLWRvdHRlZC1hdHRyaWJ1dGVzLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdwcmVzZXJ2ZXMgYW4gZW1wdHkgbWFwIHBhc3NlZCB0byBGbjo6U3ViJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdmbi1zdWItbWFwLWVtcHR5Lmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgnZm4tc3ViLW1hcC1lbXB0eS5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGluZ2VzdCBhIHRlbXBsYXRlIHdpdGggRm46OlN1YiBzaGFkb3dpbmcgYSBsb2dpY2FsIElEIGZyb20gdGhlIHRlbXBsYXRlIGFuZCBvdXRwdXQgaXQgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdmbi1zdWItc2hhZG93Lmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgnZm4tc3ViLXNoYWRvdy5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGluZ2VzdCBhIHRlbXBsYXRlIHdpdGggRm46OlN1YiBhdHRyaWJ1dGUgZXhwcmVzc2lvbiBzaGFkb3dpbmcgYSBsb2dpY2FsIElEIGZyb20gdGhlIHRlbXBsYXRlLCBhbmQgb3V0cHV0IGl0IHVuY2hhbmdlZCcsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnZm4tc3ViLXNoYWRvdy1hdHRyaWJ1dGUuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmbi1zdWItc2hhZG93LWF0dHJpYnV0ZS5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIG1vZGlmeSByZXNvdXJjZXMgdXNlZCBpbiBGbjo6U3ViIGluIG1hcCBmb3JtIHJlZmVyZW5jZXMgYW5kIHNlZSB0aGUgY2hhbmdlcyBpbiB0aGUgdGVtcGxhdGUnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnZm4tc3ViLXNoYWRvdy5qc29uJyk7XG5cbiAgICBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQW5vdGhlckJ1Y2tldCcpLm92ZXJyaWRlTG9naWNhbElkKCdOZXdCdWNrZXQnKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XG4gICAgICBcIkJ1Y2tldE5hbWVcIjoge1xuICAgICAgICBcIkZuOjpTdWJcIjogW1xuICAgICAgICAgIFwiJHtBbm90aGVyQnVja2V0fVwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIFwiQW5vdGhlckJ1Y2tldFwiOiB7IFwiUmVmXCI6IFwiTmV3QnVja2V0XCIgfSxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIG1vZGlmeSByZXNvdXJjZXMgdXNlZCBpbiBGbjo6U3ViIGluIHN0cmluZyBmb3JtIGFuZCBzZWUgdGhlIGNoYW5nZXMgaW4gdGhlIHRlbXBsYXRlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2ZuLXN1Yi1vdmVycmlkZS5qc29uJyk7XG5cbiAgICBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQnVja2V0Jykub3ZlcnJpZGVMb2dpY2FsSWQoJ05ld0J1Y2tldCcpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6UzM6OkJ1Y2tldCcsIHtcbiAgICAgIFwiQnVja2V0TmFtZVwiOiB7XG4gICAgICAgIFwiRm46OlN1YlwiOiBcIiR7TmV3QnVja2V0fS0keyFCdWNrZXR9LSR7TmV3QnVja2V0LkRvbWFpbk5hbWV9XCIsXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgd2l0aCBGbjo6U3ViIHdpdGggYnJhY2UgZWRnZSBjYXNlcyBhbmQgb3V0cHV0IGl0IHVuY2hhbmdlZCcsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnZm4tc3ViLWJyYWNlLWVkZ2VzLmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgnZm4tc3ViLWJyYWNlLWVkZ2VzLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCd3aGVuIGEgcGFyYW1ldGVyIGluIGFuIEZuOjpTdWIgZXhwcmVzc2lvbiBpcyBzdWJzdGl0dXRlZCB3aXRoIGEgZGVwbG95LXRpbWUgdmFsdWUsIGl0IGFkZHMgYSBuZXcga2V5IHRvIHRoZSBGbjo6U3ViIG1hcCcsICgpID0+IHtcbiAgICBjb25zdCBwYXJhbWV0ZXIgPSBuZXcgY29yZS5DZm5QYXJhbWV0ZXIoc3RhY2ssICdBbm90aGVyUGFyYW0nKTtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnZm4tc3ViLXBhcmFtZXRlcnMuanNvbicsIHtcbiAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgJ015UGFyYW0nOiBgaXQnc19hXyR7cGFyYW1ldGVyLnZhbHVlQXNTdHJpbmd9X2NvbmNhdGVuYXRpb25gLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFwiUGFyYW1ldGVyc1wiOiB7XG4gICAgICAgIFwiQW5vdGhlclBhcmFtXCI6IHtcbiAgICAgICAgICBcIlR5cGVcIjogXCJTdHJpbmdcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIFwiQnVja2V0XCI6IHtcbiAgICAgICAgICBcIlR5cGVcIjogXCJBV1M6OlMzOjpCdWNrZXRcIixcbiAgICAgICAgICBcIlByb3BlcnRpZXNcIjoge1xuICAgICAgICAgICAgXCJCdWNrZXROYW1lXCI6IHtcbiAgICAgICAgICAgICAgXCJGbjo6U3ViXCI6IFtcbiAgICAgICAgICAgICAgICBcIiR7TXlQYXJhbX1cIixcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBcIk15UGFyYW1cIjoge1xuICAgICAgICAgICAgICAgICAgICBcIkZuOjpKb2luXCI6IFtcIlwiLCBbXG4gICAgICAgICAgICAgICAgICAgICAgXCJpdCdzX2FfXCIsXG4gICAgICAgICAgICAgICAgICAgICAgeyBcIlJlZlwiOiBcIkFub3RoZXJQYXJhbVwiIH0sXG4gICAgICAgICAgICAgICAgICAgICAgXCJfY29uY2F0ZW5hdGlvblwiLFxuICAgICAgICAgICAgICAgICAgICBdXSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB3aXRoIGEgUmVmIGV4cHJlc3Npb24gZm9yIGFuIGFycmF5IHZhbHVlLCBhbmQgb3V0cHV0IGl0IHVuY2hhbmdlZCcsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAncmVmLWFycmF5LXByb3BlcnR5Lmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgncmVmLWFycmF5LXByb3BlcnR5Lmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdyZW5kZXJzIG5vbi1SZXNvdXJjZXMgc2VjdGlvbnMgdW5jaGFuZ2VkJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdvbmx5LWVtcHR5LWJ1Y2tldC13aXRoLXBhcmFtZXRlcnMuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdvbmx5LWVtcHR5LWJ1Y2tldC13aXRoLXBhcmFtZXRlcnMuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Jlc29sdmVzIERlcGVuZHNPbiB3aXRoIGEgc2luZ2xlIFN0cmluZyB2YWx1ZSB0byB0aGUgYWN0dWFsIEwxIGNsYXNzIGluc3RhbmNlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ3Jlc291cmNlLWF0dHJpYnV0ZS1kZXBlbmRzLW9uLmpzb24nKTtcbiAgICBjb25zdCBjZm5CdWNrZXQyID0gY2ZuVGVtcGxhdGUuZ2V0UmVzb3VyY2UoJ0J1Y2tldDInKTtcblxuICAgIGV4cGVjdChjZm5CdWNrZXQyLm5vZGUuZGVwZW5kZW5jaWVzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgLy8gd2UgYWx3YXlzIHJlbmRlciBkZXBlbmRzT24gYXMgYW4gYXJyYXksIGV2ZW4gaWYgaXQncyBhIHNpbmdsZSBzdHJpbmdcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlKCdBV1M6OlMzOjpCdWNrZXQnLCB7XG4gICAgICBcIlByb3BlcnRpZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldE5hbWVcIjogXCJidWNrZXQyXCIsXG4gICAgICB9LFxuICAgICAgXCJEZXBlbmRzT25cIjogW1xuICAgICAgICBcIkJ1Y2tldDFcIixcbiAgICAgIF0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Jlc29sdmVzIERlcGVuZHNPbiB3aXRoIGFuIGFycmF5IG9mIFN0cmluZyB2YWx1ZXMgdG8gdGhlIGFjdHVhbCBMMSBjbGFzcyBpbnN0YW5jZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAncmVzb3VyY2UtYXR0cmlidXRlLWRlcGVuZHMtb24tYXJyYXkuanNvbicpO1xuICAgIGNvbnN0IGNmbkJ1Y2tldDIgPSBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQnVja2V0MicpO1xuXG4gICAgZXhwZWN0KGNmbkJ1Y2tldDIubm9kZS5kZXBlbmRlbmNpZXMpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLmhhc1Jlc291cmNlKCdBV1M6OlMzOjpCdWNrZXQnLCB7XG4gICAgICBcIlByb3BlcnRpZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldE5hbWVcIjogXCJidWNrZXQyXCIsXG4gICAgICB9LFxuICAgICAgXCJEZXBlbmRzT25cIjogW1xuICAgICAgICBcIkJ1Y2tldDBcIixcbiAgICAgICAgXCJCdWNrZXQxXCIsXG4gICAgICBdLFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjb3JyZWN0bHkgcGFyc2VzIENvbmRpdGlvbnMgYW5kIHRoZSBDb25kaXRpb24gcmVzb3VyY2UgYXR0cmlidXRlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ3Jlc291cmNlLWF0dHJpYnV0ZS1jb25kaXRpb24uanNvbicpO1xuICAgIGNvbnN0IGFsd2F5c0ZhbHNlQ29uZGl0aW9uID0gY2ZuVGVtcGxhdGUuZ2V0Q29uZGl0aW9uKCdBbHdheXNGYWxzZUNvbmQnKTtcbiAgICBjb25zdCBjZm5CdWNrZXQgPSBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQnVja2V0Jyk7XG5cbiAgICBleHBlY3QoY2ZuQnVja2V0LmNmbk9wdGlvbnMuY29uZGl0aW9uKS50b0JlKGFsd2F5c0ZhbHNlQ29uZGl0aW9uKTtcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ3Jlc291cmNlLWF0dHJpYnV0ZS1jb25kaXRpb24uanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2FsbG93cyBDb25kaXRpb25zIHRvIHJlZmVyZW5jZSBNYXBwaW5ncycsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnY29uZGl0aW9uLXVzaW5nLW1hcHBpbmcuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdjb25kaXRpb24tdXNpbmctbWFwcGluZy5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnY29ycmVjdGx5IGNoYW5nZSByZWZlcmVuY2VzIHRvIENvbmRpdGlvbnMgd2hlbiByZW5hbWluZyB0aGVtJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2NvbmRpdGlvbi1zYW1lLW5hbWUtYXMtcmVzb3VyY2UuanNvbicpO1xuICAgIGNvbnN0IGFsd2F5c0ZhbHNlID0gY2ZuVGVtcGxhdGUuZ2V0Q29uZGl0aW9uKCdBbHdheXNGYWxzZScpO1xuICAgIGFsd2F5c0ZhbHNlLm92ZXJyaWRlTG9naWNhbElkKCdUb3RhbGx5RmFsc2UnKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFwiUGFyYW1ldGVyc1wiOiB7XG4gICAgICAgIFwiUGFyYW1cIjoge1xuICAgICAgICAgIFwiVHlwZVwiOiBcIlN0cmluZ1wiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiQ29uZGl0aW9uc1wiOiB7XG4gICAgICAgIFwiQWx3YXlzVHJ1ZVwiOiB7XG4gICAgICAgICAgXCJGbjo6Tm90XCI6IFt7IFwiQ29uZGl0aW9uXCI6IFwiVG90YWxseUZhbHNlXCIgfV0sXG4gICAgICAgIH0sXG4gICAgICAgIFwiVG90YWxseUZhbHNlXCI6IHtcbiAgICAgICAgICBcIkZuOjpFcXVhbHNcIjogW3sgXCJSZWZcIjogXCJQYXJhbVwiIH0sIDJdLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiUmVzb3VyY2VzXCI6IHtcbiAgICAgICAgXCJBbHdheXNUcnVlXCI6IHtcbiAgICAgICAgICBcIlR5cGVcIjogXCJBV1M6OlMzOjpCdWNrZXRcIixcbiAgICAgICAgICBcIlByb3BlcnRpZXNcIjoge1xuICAgICAgICAgICAgXCJCdWNrZXROYW1lXCI6IHtcbiAgICAgICAgICAgICAgXCJGbjo6SWZcIjogW1wiVG90YWxseUZhbHNlXCIsXG4gICAgICAgICAgICAgICAgeyBcIlJlZlwiOiBcIlBhcmFtXCIgfSxcbiAgICAgICAgICAgICAgICB7IFwiUmVmXCI6IFwiQVdTOjpOb1ZhbHVlXCIgfV0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjb3JyZWN0bHkgcGFyc2VzIHRlbXBsYXRlcyB3aXRoIHBhcmFtZXRlcnMnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnYnVja2V0LXdpdGgtcGFyYW1ldGVycy5qc29uJyk7XG4gICAgY29uc3QgcGFyYW0gPSBjZm5UZW1wbGF0ZS5nZXRQYXJhbWV0ZXIoJ0J1Y2tldE5hbWUnKTtcbiAgICBuZXcgczMuQ2ZuQnVja2V0KHN0YWNrLCAnTmV3QnVja2V0Jywge1xuICAgICAgYnVja2V0TmFtZTogcGFyYW0udmFsdWVBc1N0cmluZyxcbiAgICB9KTtcblxuICAgIGNvbnN0IG9yaWdpbmFsVGVtcGxhdGUgPSBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdidWNrZXQtd2l0aC1wYXJhbWV0ZXJzLmpzb24nKTtcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUmVzb3VyY2VzLFxuICAgICAgICBcIk5ld0J1Y2tldFwiOiB7XG4gICAgICAgICAgXCJUeXBlXCI6IFwiQVdTOjpTMzo6QnVja2V0XCIsXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiQnVja2V0TmFtZVwiOiB7XG4gICAgICAgICAgICAgIFwiUmVmXCI6IFwiQnVja2V0TmFtZVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiUGFyYW1ldGVyc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUGFyYW1ldGVycyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2dldFBhcmFtZXRlcigpIHRocm93cyBhbiBleGNlcHRpb24gaWYgYXNrZWQgZm9yIGEgUGFyYW1ldGVyIHdpdGggYSBuYW1lIHRoYXQgaXMgbm90IHByZXNlbnQgaW4gdGhlIHRlbXBsYXRlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2J1Y2tldC13aXRoLXBhcmFtZXRlcnMuanNvbicpO1xuXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIGNmblRlbXBsYXRlLmdldFBhcmFtZXRlcignRmFrZUJ1Y2tldE5hbWVUaGF0RG9lc05vdEV4aXN0Jyk7XG4gICAgfSkudG9UaHJvdygvUGFyYW1ldGVyIHdpdGggbmFtZSAnRmFrZUJ1Y2tldE5hbWVUaGF0RG9lc05vdEV4aXN0JyB3YXMgbm90IGZvdW5kIGluIHRoZSB0ZW1wbGF0ZS8pO1xuICB9KTtcblxuICB0ZXN0KCdyZWZsZWN0cyBjaGFuZ2VzIHRvIGEgcmV0cmlldmVkIENmblBhcmFtZXRlciBvYmplY3QgaW4gdGhlIHJlc3VsdGluZyB0ZW1wbGF0ZScsICgpID0+IHtcbiAgICBjb25zdCBjZm5UZW1wbGF0ZSA9IGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdidWNrZXQtd2l0aC1wYXJhbWV0ZXJzLmpzb24nKTtcbiAgICBjb25zdCBzdHJpbmdQYXJhbSA9IGNmblRlbXBsYXRlLmdldFBhcmFtZXRlcignQnVja2V0TmFtZScpO1xuICAgIGNvbnN0IG51bWJlclBhcmFtID0gY2ZuVGVtcGxhdGUuZ2V0UGFyYW1ldGVyKCdDb3JzTWF4QWdlJyk7XG5cbiAgICBzdHJpbmdQYXJhbS5kZWZhdWx0ID0gJ015RGVmYXVsdCc7XG4gICAgc3RyaW5nUGFyYW0uYWxsb3dlZFBhdHRlcm4gPSAnWzAtOV0qJCc7XG4gICAgc3RyaW5nUGFyYW0uYWxsb3dlZFZhbHVlcyA9IFsnMTIzMTIzJywgJzQ1Njc4OSddO1xuICAgIHN0cmluZ1BhcmFtLmNvbnN0cmFpbnREZXNjcmlwdGlvbiA9ICdNeU5ld0NvbnN0cmFpbnQnO1xuICAgIHN0cmluZ1BhcmFtLmRlc2NyaXB0aW9uID0gJ2Egc3RyaW5nIG9mIG51bWVyaWMgY2hhcmFjdGVycyc7XG4gICAgc3RyaW5nUGFyYW0ubWF4TGVuZ3RoID0gNjtcbiAgICBzdHJpbmdQYXJhbS5taW5MZW5ndGggPSAyO1xuXG4gICAgbnVtYmVyUGFyYW0ubWF4VmFsdWUgPSAxMDA7XG4gICAgbnVtYmVyUGFyYW0ubWluVmFsdWUgPSA0O1xuICAgIG51bWJlclBhcmFtLm5vRWNobyA9IGZhbHNlO1xuICAgIG51bWJlclBhcmFtLnR5cGUgPSBcIk5ld1R5cGVcIjtcbiAgICBjb25zdCBvcmlnaW5hbFRlbXBsYXRlID0gbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgnYnVja2V0LXdpdGgtcGFyYW1ldGVycy5qc29uJyk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUmVzb3VyY2VzLFxuICAgICAgfSxcbiAgICAgIFwiUGFyYW1ldGVyc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUGFyYW1ldGVycyxcbiAgICAgICAgXCJCdWNrZXROYW1lXCI6IHtcbiAgICAgICAgICAuLi5vcmlnaW5hbFRlbXBsYXRlLlBhcmFtZXRlcnMuQnVja2V0TmFtZSxcbiAgICAgICAgICBcIkRlZmF1bHRcIjogXCJNeURlZmF1bHRcIixcbiAgICAgICAgICBcIkFsbG93ZWRQYXR0ZXJuXCI6IFwiWzAtOV0qJFwiLFxuICAgICAgICAgIFwiQWxsb3dlZFZhbHVlc1wiOiBbXCIxMjMxMjNcIiwgXCI0NTY3ODlcIl0sXG4gICAgICAgICAgXCJDb25zdHJhaW50RGVzY3JpcHRpb25cIjogXCJNeU5ld0NvbnN0cmFpbnRcIixcbiAgICAgICAgICBcIkRlc2NyaXB0aW9uXCI6IFwiYSBzdHJpbmcgb2YgbnVtZXJpYyBjaGFyYWN0ZXJzXCIsXG4gICAgICAgICAgXCJNYXhMZW5ndGhcIjogNixcbiAgICAgICAgICBcIk1pbkxlbmd0aFwiOiAyLFxuICAgICAgICB9LFxuICAgICAgICBcIkNvcnNNYXhBZ2VcIjoge1xuICAgICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUGFyYW1ldGVycy5Db3JzTWF4QWdlLFxuICAgICAgICAgIFwiTWF4VmFsdWVcIjogMTAwLFxuICAgICAgICAgIFwiTWluVmFsdWVcIjogNCxcbiAgICAgICAgICBcIk5vRWNob1wiOiBmYWxzZSxcbiAgICAgICAgICBcIlR5cGVcIjogXCJOZXdUeXBlXCIsXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdyZWZsZWN0cyBjaGFuZ2VzIHRvIGEgcmV0cmlldmVkIENmbkNvbmRpdGlvbiBvYmplY3QgaW4gdGhlIHJlc3VsdGluZyB0ZW1wbGF0ZScsICgpID0+IHtcbiAgICBjb25zdCBjZm5UZW1wbGF0ZSA9IGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdyZXNvdXJjZS1hdHRyaWJ1dGUtY29uZGl0aW9uLmpzb24nKTtcbiAgICBjb25zdCBhbHdheXNGYWxzZUNvbmRpdGlvbiA9IGNmblRlbXBsYXRlLmdldENvbmRpdGlvbignQWx3YXlzRmFsc2VDb25kJyk7XG5cbiAgICBhbHdheXNGYWxzZUNvbmRpdGlvbi5leHByZXNzaW9uID0gY29yZS5Gbi5jb25kaXRpb25FcXVhbHMoMSwgMik7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIkNvbmRpdGlvbnNcIjoge1xuICAgICAgICBcIkFsd2F5c0ZhbHNlQ29uZFwiOiB7XG4gICAgICAgICAgXCJGbjo6RXF1YWxzXCI6IFsxLCAyXSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIFwiQnVja2V0XCI6IHtcbiAgICAgICAgICBcIlR5cGVcIjogXCJBV1M6OlMzOjpCdWNrZXRcIixcbiAgICAgICAgICBcIkNvbmRpdGlvblwiOiBcIkFsd2F5c0ZhbHNlQ29uZFwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnY29ycmVjdGx5IGhhbmRsZXMgdGhlIENyZWF0aW9uUG9saWN5IHJlc291cmNlIGF0dHJpYnV0ZScsICgpID0+IHtcbiAgICBjb25zdCBjZm5UZW1wbGF0ZSA9IGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdyZXNvdXJjZS1hdHRyaWJ1dGUtY3JlYXRpb24tcG9saWN5Lmpzb24nKTtcbiAgICBjb25zdCBjZm5CdWNrZXQgPSBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQnVja2V0Jyk7XG5cbiAgICBleHBlY3QoY2ZuQnVja2V0LmNmbk9wdGlvbnMuY3JlYXRpb25Qb2xpY3kpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ3Jlc291cmNlLWF0dHJpYnV0ZS1jcmVhdGlvbi1wb2xpY3kuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NvcnJlY3RseSBoYW5kbGVzIHRoZSBVcGRhdGVQb2xpY3kgcmVzb3VyY2UgYXR0cmlidXRlJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ3Jlc291cmNlLWF0dHJpYnV0ZS11cGRhdGUtcG9saWN5Lmpzb24nKTtcbiAgICBjb25zdCBjZm5CdWNrZXQgPSBjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQnVja2V0Jyk7XG5cbiAgICBleHBlY3QoY2ZuQnVja2V0LmNmbk9wdGlvbnMudXBkYXRlUG9saWN5KS50b0JlRGVmaW5lZCgpO1xuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgncmVzb3VyY2UtYXR0cmlidXRlLXVwZGF0ZS1wb2xpY3kuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3ByZXNlcnZlcyB1bmtub3duIHJlc291cmNlIGF0dHJpYnV0ZXMnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ25vbi1leGlzdGVudC1yZXNvdXJjZS1hdHRyaWJ1dGUuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdub24tZXhpc3RlbnQtcmVzb3VyY2UtYXR0cmlidXRlLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KFwiY29ycmVjdGx5IGhhbmRsZXMgcmVmZXJlbmNpbmcgdGhlIGluZ2VzdGVkIHRlbXBsYXRlJ3MgcmVzb3VyY2VzIGFjcm9zcyBTdGFja3NcIiwgKCkgPT4ge1xuICAgIC8vIGZvciBjcm9zcy1zdGFjayBzaGFyaW5nIHRvIHdvcmssIHdlIG5lZWQgYW4gQXBwXG4gICAgY29uc3QgYXBwID0gbmV3IGNvcmUuQXBwKCk7XG4gICAgc3RhY2sgPSBuZXcgY29yZS5TdGFjayhhcHAsICdNeVN0YWNrJyk7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1lbXB0eS1idWNrZXQuanNvbicpO1xuICAgIGNvbnN0IGNmbkJ1Y2tldCA9IGNmblRlbXBsYXRlLmdldFJlc291cmNlKCdCdWNrZXQnKSBhcyBzMy5DZm5CdWNrZXQ7XG5cbiAgICBjb25zdCBvdGhlclN0YWNrID0gbmV3IGNvcmUuU3RhY2soYXBwLCAnT3RoZXJTdGFjaycpO1xuICAgIGNvbnN0IHJvbGUgPSBuZXcgaWFtLlJvbGUob3RoZXJTdGFjaywgJ1JvbGUnLCB7XG4gICAgICBhc3N1bWVkQnk6IG5ldyBpYW0uQW55UHJpbmNpcGFsKCksXG4gICAgfSk7XG4gICAgcm9sZS5hZGRUb1BvbGljeShuZXcgaWFtLlBvbGljeVN0YXRlbWVudCh7XG4gICAgICBhY3Rpb25zOiBbJ3MzOionXSxcbiAgICAgIHJlc291cmNlczogW2NmbkJ1Y2tldC5hdHRyQXJuXSxcbiAgICB9KSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICAuLi5sb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdvbmx5LWVtcHR5LWJ1Y2tldC5qc29uJyksXG4gICAgICBcIk91dHB1dHNcIjoge1xuICAgICAgICBcIkV4cG9ydHNPdXRwdXRGbkdldEF0dEJ1Y2tldEFybjQzNjEzOEZFXCI6IHtcbiAgICAgICAgICBcIlZhbHVlXCI6IHtcbiAgICAgICAgICAgIFwiRm46OkdldEF0dFwiOiBbXCJCdWNrZXRcIiwgXCJBcm5cIl0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkV4cG9ydFwiOiB7XG4gICAgICAgICAgICBcIk5hbWVcIjogXCJNeVN0YWNrOkV4cG9ydHNPdXRwdXRGbkdldEF0dEJ1Y2tldEFybjQzNjEzOEZFXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2sob3RoZXJTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgXCJQb2xpY3lEb2N1bWVudFwiOiB7XG4gICAgICAgIFwiU3RhdGVtZW50XCI6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBcIkFjdGlvblwiOiBcInMzOipcIixcbiAgICAgICAgICAgIFwiUmVzb3VyY2VcIjoge1xuICAgICAgICAgICAgICBcIkZuOjpJbXBvcnRWYWx1ZVwiOiBcIk15U3RhY2s6RXhwb3J0c091dHB1dEZuR2V0QXR0QnVja2V0QXJuNDM2MTM4RkVcIixcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NvcnJlY3RseSByZS1uYW1lcyByZWZlcmVuY2VzIHRvIHJlc291cmNlcyBpbiB0aGUgdGVtcGxhdGUgaWYgdGhlaXIgbG9naWNhbCBJRHMgaGF2ZSBiZWVuIGNoYW5nZWQnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnYnVja2V0LXdpdGgtZW5jcnlwdGlvbi1rZXkuanNvbicpO1xuICAgIGNvbnN0IGNmbktleSA9IGNmblRlbXBsYXRlLmdldFJlc291cmNlKCdLZXknKTtcbiAgICBjZm5LZXkub3ZlcnJpZGVMb2dpY2FsSWQoJ1RvdGFsbHlEaWZmZXJlbnRLZXknKTtcblxuICAgIGNvbnN0IG9yaWdpbmFsVGVtcGxhdGUgPSBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdidWNrZXQtd2l0aC1lbmNyeXB0aW9uLWtleS5qc29uJyk7XG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoe1xuICAgICAgXCJSZXNvdXJjZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldFwiOiB7XG4gICAgICAgICAgXCJUeXBlXCI6IFwiQVdTOjpTMzo6QnVja2V0XCIsXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiQnVja2V0RW5jcnlwdGlvblwiOiB7XG4gICAgICAgICAgICAgIFwiU2VydmVyU2lkZUVuY3J5cHRpb25Db25maWd1cmF0aW9uXCI6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBcIlNlcnZlclNpZGVFbmNyeXB0aW9uQnlEZWZhdWx0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJLTVNNYXN0ZXJLZXlJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgXCJGbjo6R2V0QXR0XCI6IFtcIlRvdGFsbHlEaWZmZXJlbnRLZXlcIiwgXCJBcm5cIl0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiU1NFQWxnb3JpdGhtXCI6IFwiYXdzOmttc1wiLFxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiTWV0YWRhdGFcIjoge1xuICAgICAgICAgICAgXCJPYmplY3QxXCI6IFwiTG9jYXRpb24xXCIsXG4gICAgICAgICAgICBcIktleVJlZlwiOiB7IFwiUmVmXCI6IFwiVG90YWxseURpZmZlcmVudEtleVwiIH0sXG4gICAgICAgICAgICBcIktleUFyblwiOiB7IFwiRm46OkdldEF0dFwiOiBbXCJUb3RhbGx5RGlmZmVyZW50S2V5XCIsIFwiQXJuXCJdIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkRlbGV0aW9uUG9saWN5XCI6IFwiUmV0YWluXCIsXG4gICAgICAgICAgXCJVcGRhdGVSZXBsYWNlUG9saWN5XCI6IFwiUmV0YWluXCIsXG4gICAgICAgIH0sXG4gICAgICAgIFwiVG90YWxseURpZmZlcmVudEtleVwiOiBvcmlnaW5hbFRlbXBsYXRlLlJlc291cmNlcy5LZXksXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5jbHVkZSBhIHRlbXBsYXRlIHdpdGggYSBjdXN0b20gcmVzb3VyY2UgdGhhdCB1c2VzIGF0dHJpYnV0ZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnY3VzdG9tLXJlc291cmNlLXdpdGgtYXR0cmlidXRlcy5qc29uJyk7XG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdjdXN0b20tcmVzb3VyY2Utd2l0aC1hdHRyaWJ1dGVzLmpzb24nKSxcbiAgICApO1xuXG4gICAgY29uc3QgYWx3YXlzRmFsc2VDb25kaXRpb24gPSBjZm5UZW1wbGF0ZS5nZXRDb25kaXRpb24oJ0Fsd2F5c0ZhbHNlQ29uZCcpO1xuICAgIGV4cGVjdChjZm5UZW1wbGF0ZS5nZXRSZXNvdXJjZSgnQ3VzdG9tQnVja2V0JykuY2ZuT3B0aW9ucy5jb25kaXRpb24pLnRvQmUoYWx3YXlzRmFsc2VDb25kaXRpb24pO1xuICB9KTtcblxuICB0ZXN0KFwidGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGEgY3VzdG9tIHJlc291cmNlIHVzZXMgYSBDb25kaXRpb24gYXR0cmlidXRlIHRoYXQgZG9lc24ndCBleGlzdCBpbiB0aGUgdGVtcGxhdGVcIiwgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnY3VzdG9tLXJlc291cmNlLXdpdGgtYmFkLWNvbmRpdGlvbi5qc29uJyk7XG4gICAgfSkudG9UaHJvdygvUmVzb3VyY2UgJ0N1c3RvbVJlc291cmNlJyB1c2VzIENvbmRpdGlvbiAnQWx3YXlzRmFsc2VDb25kJyB0aGF0IGRvZXNuJ3QgZXhpc3QvKTtcbiAgfSk7XG5cbiAgdGVzdCgnY2FuIGluZ2VzdCBhIHRlbXBsYXRlIHRoYXQgY29udGFpbnMgb3V0cHV0cyBhbmQgbW9kaWZ5IHRoZW0nLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb3V0cHV0cy13aXRoLXJlZmVyZW5jZXMuanNvbicpO1xuXG4gICAgY29uc3Qgb3V0cHV0ID0gY2ZuVGVtcGxhdGUuZ2V0T3V0cHV0KCdPdXRwdXQxJyk7XG4gICAgb3V0cHV0LnZhbHVlID0gJ2EgbXV0YXRlZCB2YWx1ZSc7XG4gICAgb3V0cHV0LmRlc2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgIG91dHB1dC5leHBvcnROYW1lID0gJ2FuIGV4cG9ydCc7XG4gICAgb3V0cHV0LmNvbmRpdGlvbiA9IG5ldyBjb3JlLkNmbkNvbmRpdGlvbihzdGFjaywgJ015Q29uZGl0aW9uJywge1xuICAgICAgZXhwcmVzc2lvbjogY29yZS5Gbi5jb25kaXRpb25JZignQWx3YXlzRmFsc2VDb25kJywgY29yZS5Bd3MuTk9fVkFMVUUsIHRydWUpLFxuICAgIH0pO1xuXG4gICAgY29uc3Qgb3JpZ2luYWxUZW1wbGF0ZSA9IGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ291dHB1dHMtd2l0aC1yZWZlcmVuY2VzLmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFwiQ29uZGl0aW9uc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuQ29uZGl0aW9ucyxcbiAgICAgICAgXCJNeUNvbmRpdGlvblwiOiB7XG4gICAgICAgICAgXCJGbjo6SWZcIjogW1xuICAgICAgICAgICAgXCJBbHdheXNGYWxzZUNvbmRcIixcbiAgICAgICAgICAgIHsgXCJSZWZcIjogXCJBV1M6Ok5vVmFsdWVcIiB9LFxuICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiUGFyYW1ldGVyc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUGFyYW1ldGVycyxcbiAgICAgIH0sXG4gICAgICBcIlJlc291cmNlc1wiOiB7XG4gICAgICAgIC4uLm9yaWdpbmFsVGVtcGxhdGUuUmVzb3VyY2VzLFxuICAgICAgfSxcbiAgICAgIFwiT3V0cHV0c1wiOiB7XG4gICAgICAgIFwiT3V0cHV0MVwiOiB7XG4gICAgICAgICAgXCJWYWx1ZVwiOiBcImEgbXV0YXRlZCB2YWx1ZVwiLFxuICAgICAgICAgIFwiRXhwb3J0XCI6IHtcbiAgICAgICAgICAgIFwiTmFtZVwiOiBcImFuIGV4cG9ydFwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJDb25kaXRpb25cIjogXCJNeUNvbmRpdGlvblwiLFxuICAgICAgICB9LFxuICAgICAgICBcIk91dHB1dFdpdGhOb0NvbmRpdGlvblwiOiB7XG4gICAgICAgICAgXCJWYWx1ZVwiOiBcInNvbWUtdmFsdWVcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB0aGF0IGNvbnRhaW5zIG91dHB1dHMgYW5kIGdldCB0aG9zZSBvdXRwdXRzJywgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ291dHB1dHMtd2l0aC1yZWZlcmVuY2VzLmpzb24nKTtcbiAgICBjb25zdCBvdXRwdXQgPSBjZm5UZW1wbGF0ZS5nZXRPdXRwdXQoJ091dHB1dDEnKTtcblxuICAgIGV4cGVjdChvdXRwdXQuY29uZGl0aW9uKS50b0JlKGNmblRlbXBsYXRlLmdldENvbmRpdGlvbignQWx3YXlzRmFsc2VDb25kJykpO1xuICAgIGV4cGVjdChvdXRwdXQuZGVzY3JpcHRpb24pLnRvQmVEZWZpbmVkKCk7XG4gICAgZXhwZWN0KG91dHB1dC52YWx1ZSkudG9CZURlZmluZWQoKTtcbiAgICBleHBlY3Qob3V0cHV0LmV4cG9ydE5hbWUpLnRvQmVEZWZpbmVkKCk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ291dHB1dHMtd2l0aC1yZWZlcmVuY2VzLmpzb24nKSxcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KFwidGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGF0dGVtcHRpbmcgdG8gcmV0cmlldmUgYW4gT3V0cHV0IHRoYXQgZG9lc24ndCBleGlzdFwiLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb3V0cHV0cy13aXRoLXJlZmVyZW5jZXMuanNvbicpO1xuXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIGNmblRlbXBsYXRlLmdldE91dHB1dCgnRmFrZU91dHB1dCcpO1xuICAgIH0pLnRvVGhyb3coL091dHB1dCB3aXRoIGxvZ2ljYWwgSUQgJ0Zha2VPdXRwdXQnIHdhcyBub3QgZm91bmQgaW4gdGhlIHRlbXBsYXRlLyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB0aGF0IGNvbnRhaW5zIE1hcHBpbmdzLCBhbmQgcmV0cmlldmUgdGhvc2UgTWFwcGluZ3MnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1tYXBwaW5nLWFuZC1idWNrZXQuanNvbicpO1xuICAgIGNvbnN0IHNvbWVNYXBwaW5nID0gY2ZuVGVtcGxhdGUuZ2V0TWFwcGluZygnU29tZU1hcHBpbmcnKTtcblxuICAgIHNvbWVNYXBwaW5nLnNldFZhbHVlKCdyZWdpb24nLCAna2V5MicsICd2YWx1ZTInKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFwiTWFwcGluZ3NcIjoge1xuICAgICAgICBcIlNvbWVNYXBwaW5nXCI6IHtcbiAgICAgICAgICBcInJlZ2lvblwiOiB7XG4gICAgICAgICAgICBcImtleTFcIjogXCJ2YWx1ZTFcIixcbiAgICAgICAgICAgIFwia2V5MlwiOiBcInZhbHVlMlwiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCJSZXNvdXJjZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldFwiOiB7XG4gICAgICAgICAgXCJUeXBlXCI6IFwiQVdTOjpTMzo6QnVja2V0XCIsXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiQnVja2V0TmFtZVwiOiB7XG4gICAgICAgICAgICAgIFwiRm46OkZpbmRJbk1hcFwiOiBbXG4gICAgICAgICAgICAgICAgXCJTb21lTWFwcGluZ1wiLFxuICAgICAgICAgICAgICAgIHsgXCJSZWZcIjogXCJBV1M6OlJlZ2lvblwiIH0sXG4gICAgICAgICAgICAgICAgXCJrZXkxXCIsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KFwidGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIGF0dGVtcHRpbmcgdG8gcmV0cmlldmUgYSBNYXBwaW5nIHRoYXQgZG9lc24ndCBleGlzdCBpbiB0aGUgdGVtcGxhdGVcIiwgKCkgPT4ge1xuICAgIGNvbnN0IGNmblRlbXBsYXRlID0gaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ29ubHktbWFwcGluZy1hbmQtYnVja2V0Lmpzb24nKTtcblxuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICBjZm5UZW1wbGF0ZS5nZXRNYXBwaW5nKCdOb25FeGlzdGVudE1hcHBpbmcnKTtcbiAgICB9KS50b1Rocm93KC9NYXBwaW5nIHdpdGggbmFtZSAnTm9uRXhpc3RlbnRNYXBwaW5nJyB3YXMgbm90IGZvdW5kIGluIHRoZSB0ZW1wbGF0ZS8pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgdGhhdCB1c2VzIEZuOjpGaW5kSW5NYXAgd2l0aCB0aGUgZmlyc3QgYXJndW1lbnQgYmVpbmcgYSBkeW5hbWljIHJlZmVyZW5jZScsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnZmluZC1pbi1tYXAtd2l0aC1keW5hbWljLW1hcHBpbmcuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmaW5kLWluLW1hcC13aXRoLWR5bmFtaWMtbWFwcGluZy5qc29uJyksXG4gICAgKTtcbiAgfSk7XG5cbiAgdGVzdCgnaGFuZGxlcyByZW5hbWluZyBNYXBwaW5nIHJlZmVyZW5jZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1tYXBwaW5nLWFuZC1idWNrZXQuanNvbicpO1xuICAgIGNvbnN0IHNvbWVNYXBwaW5nID0gY2ZuVGVtcGxhdGUuZ2V0TWFwcGluZygnU29tZU1hcHBpbmcnKTtcblxuICAgIHNvbWVNYXBwaW5nLm92ZXJyaWRlTG9naWNhbElkKCdEaWZmZXJlbnRNYXBwaW5nJyk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIk1hcHBpbmdzXCI6IHtcbiAgICAgICAgXCJEaWZmZXJlbnRNYXBwaW5nXCI6IHtcbiAgICAgICAgICBcInJlZ2lvblwiOiB7XG4gICAgICAgICAgICBcImtleTFcIjogXCJ2YWx1ZTFcIixcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiUmVzb3VyY2VzXCI6IHtcbiAgICAgICAgXCJCdWNrZXRcIjoge1xuICAgICAgICAgIFwiVHlwZVwiOiBcIkFXUzo6UzM6OkJ1Y2tldFwiLFxuICAgICAgICAgIFwiUHJvcGVydGllc1wiOiB7XG4gICAgICAgICAgICBcIkJ1Y2tldE5hbWVcIjoge1xuICAgICAgICAgICAgICBcIkZuOjpGaW5kSW5NYXBcIjogW1xuICAgICAgICAgICAgICAgIFwiRGlmZmVyZW50TWFwcGluZ1wiLFxuICAgICAgICAgICAgICAgIHsgXCJSZWZcIjogXCJBV1M6OlJlZ2lvblwiIH0sXG4gICAgICAgICAgICAgICAgXCJrZXkxXCIsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgdGhhdCB1c2VzIEZuOjpGaW5kSW5NYXAgZm9yIHRoZSB2YWx1ZSBvZiBhIGJvb2xlYW4gcHJvcGVydHknLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2ZpbmQtaW4tbWFwLWZvci1ib29sZWFuLXByb3BlcnR5Lmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgnZmluZC1pbi1tYXAtZm9yLWJvb2xlYW4tcHJvcGVydHkuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB0aGF0IGNvbnRhaW5zIFJ1bGVzLCBhbmQgYWxsb3dzIHJldHJpZXZpbmcgdGhvc2UgUnVsZXMnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1wYXJhbWV0ZXJzLWFuZC1ydWxlLmpzb24nKTtcbiAgICBjb25zdCBydWxlID0gY2ZuVGVtcGxhdGUuZ2V0UnVsZSgnVGVzdFZwY1J1bGUnKTtcblxuICAgIGV4cGVjdChydWxlKS50b0JlRGVmaW5lZCgpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdvbmx5LXBhcmFtZXRlcnMtYW5kLXJ1bGUuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ2ZhaWxzIHdoZW4gdHJ5aW5nIHRvIHJlcGxhY2UgUGFyYW1ldGVycyByZWZlcmVuY2VkIGluIEZuOjpWYWx1ZU9mIGV4cHJlc3Npb25zIHdpdGggdXNlci1wcm92aWRlZCB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdvbmx5LXBhcmFtZXRlcnMtYW5kLXJ1bGUuanNvbicsIHtcbiAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgICdTdWJuZXRzJzogWydzdWJuZXQtMTIzNGFiY2QnXSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pLnRvVGhyb3coL0Nhbm5vdCBzdWJzdGl0dXRlIHBhcmFtZXRlciAnU3VibmV0cycgdXNlZCBpbiBGbjo6VmFsdWVPZiBleHByZXNzaW9uIHdpdGggYXR0cmlidXRlICdWcGNJZCcvKTtcbiAgfSk7XG5cbiAgdGVzdChcInRocm93cyBhbiBleGNlcHRpb24gd2hlbiBhdHRlbXB0aW5nIHRvIHJldHJpZXZlIGEgUnVsZSB0aGF0IGRvZXNuJ3QgZXhpc3QgaW4gdGhlIHRlbXBsYXRlXCIsICgpID0+IHtcbiAgICBjb25zdCBjZm5UZW1wbGF0ZSA9IGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdvbmx5LXBhcmFtZXRlcnMtYW5kLXJ1bGUuanNvbicpO1xuXG4gICAgZXhwZWN0KCgpID0+IHtcbiAgICAgIGNmblRlbXBsYXRlLmdldFJ1bGUoJ0RvZXNOb3RFeGlzdCcpO1xuICAgIH0pLnRvVGhyb3coL1J1bGUgd2l0aCBuYW1lICdEb2VzTm90RXhpc3QnIHdhcyBub3QgZm91bmQgaW4gdGhlIHRlbXBsYXRlLyk7XG4gIH0pO1xuXG4gIHRlc3QoJ2NhbiBpbmdlc3QgYSB0ZW1wbGF0ZSB0aGF0IGNvbnRhaW5zIEhvb2tzLCBhbmQgYWxsb3dzIHJldHJpZXZpbmcgdGhvc2UgSG9va3MnLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnaG9vay1jb2RlLWRlcGxveS1ibHVlLWdyZWVuLWVjcy5qc29uJyk7XG4gICAgY29uc3QgaG9vayA9IGNmblRlbXBsYXRlLmdldEhvb2soJ0Vjc0JsdWVHcmVlbkNvZGVEZXBsb3lIb29rJyk7XG5cbiAgICBleHBlY3QoaG9vaykudG9CZURlZmluZWQoKTtcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyhcbiAgICAgIGxvYWRUZXN0RmlsZVRvSnNPYmplY3QoJ2hvb2stY29kZS1kZXBsb3ktYmx1ZS1ncmVlbi1lY3MuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoXCJ0aHJvd3MgYW4gZXhjZXB0aW9uIHdoZW4gYXR0ZW1wdGluZyB0byByZXRyaWV2ZSBhIEhvb2sgdGhhdCBkb2Vzbid0IGV4aXN0IGluIHRoZSB0ZW1wbGF0ZVwiLCAoKSA9PiB7XG4gICAgY29uc3QgY2ZuVGVtcGxhdGUgPSBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnaG9vay1jb2RlLWRlcGxveS1ibHVlLWdyZWVuLWVjcy5qc29uJyk7XG5cbiAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgY2ZuVGVtcGxhdGUuZ2V0SG9vaygnRG9lc05vdEV4aXN0Jyk7XG4gICAgfSkudG9UaHJvdygvSG9vayB3aXRoIGxvZ2ljYWwgSUQgJ0RvZXNOb3RFeGlzdCcgd2FzIG5vdCBmb3VuZCBpbiB0aGUgdGVtcGxhdGUvKTtcbiAgfSk7XG5cbiAgdGVzdCgncmVwbGFjZXMgcmVmZXJlbmNlcyB0byBwYXJhbWV0ZXJzIHdpdGggdGhlIHVzZXItc3BlY2lmaWVkIHZhbHVlcyBpbiBSZXNvdXJjZXMsIENvbmRpdGlvbnMsIE1ldGFkYXRhLCBhbmQgT3B0aW9ucyBzZWN0aW9ucycsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAncGFyYW1ldGVyLXJlZmVyZW5jZXMuanNvbicsIHtcbiAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgJ015UGFyYW0nOiAnbXktczMtYnVja2V0JyxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spLnRlbXBsYXRlTWF0Y2hlcyh7XG4gICAgICBcIlRyYW5zZm9ybVwiOiB7XG4gICAgICAgIFwiTmFtZVwiOiBcIkFXUzo6SW5jbHVkZVwiLFxuICAgICAgICBcIlBhcmFtZXRlcnNcIjoge1xuICAgICAgICAgIFwiTG9jYXRpb25cIjogXCJteS1zMy1idWNrZXRcIixcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIk1ldGFkYXRhXCI6IHtcbiAgICAgICAgXCJGaWVsZFwiOiB7XG4gICAgICAgICAgXCJGbjo6SWZcIjogW1xuICAgICAgICAgICAgXCJBbHdheXNGYWxzZVwiLFxuICAgICAgICAgICAgXCJBV1M6Ok5vVmFsdWVcIixcbiAgICAgICAgICAgIFwibXktczMtYnVja2V0XCIsXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBcIkNvbmRpdGlvbnNcIjoge1xuICAgICAgICBcIkFsd2F5c0ZhbHNlXCI6IHtcbiAgICAgICAgICBcIkZuOjpFcXVhbHNcIjogW1wibXktczMtYnVja2V0XCIsIFwiSW52YWxpZD9CdWNrZXROYW1lXCJdLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiUmVzb3VyY2VzXCI6IHtcbiAgICAgICAgXCJCdWNrZXRcIjoge1xuICAgICAgICAgIFwiVHlwZVwiOiBcIkFXUzo6UzM6OkJ1Y2tldFwiLFxuICAgICAgICAgIFwiTWV0YWRhdGFcIjoge1xuICAgICAgICAgICAgXCJGaWVsZFwiOiBcIm15LXMzLWJ1Y2tldFwiLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiQnVja2V0TmFtZVwiOiBcIm15LXMzLWJ1Y2tldFwiLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCJPdXRwdXRzXCI6IHtcbiAgICAgICAgXCJNeU91dHB1dFwiOiB7XG4gICAgICAgICAgXCJWYWx1ZVwiOiBcIm15LXMzLWJ1Y2tldFwiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgncmVwbGFjZXMgcGFyYW1ldGVycyB3aXRoIGZhbHNleSB2YWx1ZXMgaW4gUmVmIGV4cHJlc3Npb25zJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdyZXNvdXJjZS1hdHRyaWJ1dGUtY3JlYXRpb24tcG9saWN5Lmpzb24nLCB7XG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICdDb3VudFBhcmFtZXRlcic6IDAsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoe1xuICAgICAgXCJSZXNvdXJjZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldFwiOiB7XG4gICAgICAgICAgXCJUeXBlXCI6IFwiQVdTOjpTMzo6QnVja2V0XCIsXG4gICAgICAgICAgXCJDcmVhdGlvblBvbGljeVwiOiB7XG4gICAgICAgICAgICBcIkF1dG9TY2FsaW5nQ3JlYXRpb25Qb2xpY3lcIjoge1xuICAgICAgICAgICAgICBcIk1pblN1Y2Nlc3NmdWxJbnN0YW5jZXNQZXJjZW50XCI6IDUwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwiUmVzb3VyY2VTaWduYWxcIjoge1xuICAgICAgICAgICAgICBcIkNvdW50XCI6IDAsXG4gICAgICAgICAgICAgIFwiVGltZW91dFwiOiBcIlBUNUg0TTNTXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdyZXBsYWNlcyBwYXJhbWV0ZXJzIGluIEZuOjpTdWIgZXhwcmVzc2lvbnMnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2ZuLXN1Yi1wYXJhbWV0ZXJzLmpzb24nLCB7XG4gICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICdNeVBhcmFtJzogJ215LXMzLWJ1Y2tldCcsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoe1xuICAgICAgXCJSZXNvdXJjZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldFwiOiB7XG4gICAgICAgICAgXCJUeXBlXCI6IFwiQVdTOjpTMzo6QnVja2V0XCIsXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiQnVja2V0TmFtZVwiOiB7XG4gICAgICAgICAgICAgIFwiRm46OlN1YlwiOiBcIm15LXMzLWJ1Y2tldFwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnZG9lcyBub3QgbW9kaWZ5IEZuOjpTdWIgdmFyaWFibGVzIHNoYWRvd2luZyBhIHJlcGxhY2VkIHBhcmFtZXRlcicsICgpID0+IHtcbiAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnZm4tc3ViLXNoYWRvdy1wYXJhbWV0ZXIuanNvbicsIHtcbiAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgJ015UGFyYW0nOiAnTXlWYWx1ZScsXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoe1xuICAgICAgXCJSZXNvdXJjZXNcIjoge1xuICAgICAgICBcIkJ1Y2tldFwiOiB7XG4gICAgICAgICAgXCJUeXBlXCI6IFwiQVdTOjpTMzo6QnVja2V0XCIsXG4gICAgICAgICAgXCJQcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgICAgIFwiQnVja2V0TmFtZVwiOiB7XG4gICAgICAgICAgICAgIFwiRm46OlN1YlwiOiBbXG4gICAgICAgICAgICAgICAgXCIke015UGFyYW19XCIsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgXCJNeVBhcmFtXCI6IFwiTXlWYWx1ZVwiLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdyZXBsYWNlcyBwYXJhbWV0ZXJzIHdpdGggZmFsc2V5IHZhbHVlcyBpbiBGbjo6U3ViIGV4cHJlc3Npb25zJywgKCkgPT4ge1xuICAgIGluY2x1ZGVUZXN0VGVtcGxhdGUoc3RhY2ssICdmbi1zdWItcGFyYW1ldGVycy5qc29uJywge1xuICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAnTXlQYXJhbSc6ICcnLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKHtcbiAgICAgIFwiUmVzb3VyY2VzXCI6IHtcbiAgICAgICAgXCJCdWNrZXRcIjoge1xuICAgICAgICAgIFwiVHlwZVwiOiBcIkFXUzo6UzM6OkJ1Y2tldFwiLFxuICAgICAgICAgIFwiUHJvcGVydGllc1wiOiB7XG4gICAgICAgICAgICBcIkJ1Y2tldE5hbWVcIjogeyBcIkZuOjpTdWJcIjogXCJcIiB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCd0aHJvd3MgYW4gZXhjZXB0aW9uIHdoZW4gcGFyYW1ldGVycyBhcmUgcGFzc2VkIGEgcmVzb3VyY2UgbmFtZScsICgpID0+IHtcbiAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2J1Y2tldC13aXRoLXBhcmFtZXRlcnMuanNvbicsIHtcbiAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgICdCdWNrZXQnOiAnbm9DaGFuZ2UnLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSkudG9UaHJvdygvUGFyYW1ldGVyIHdpdGggbG9naWNhbCBJRCAnQnVja2V0JyB3YXMgbm90IGZvdW5kIGluIHRoZSB0ZW1wbGF0ZS8pO1xuICB9KTtcblxuICB0ZXN0KCd0aHJvd3MgYW4gZXhjZXB0aW9uIHdoZW4gcHJvdmlkZWQgYSBwYXJhbWV0ZXIgdG8gcmVwbGFjZSB0aGF0IGlzIG5vdCBpbiB0aGUgdGVtcGxhdGUgd2l0aCBwYXJhbWV0ZXJzJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnYnVja2V0LXdpdGgtcGFyYW1ldGVycy5qc29uJywge1xuICAgICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgJ0Zha2VQYXJhbWV0ZXInOiAnRG9lc05vdEV4aXN0JyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pLnRvVGhyb3coL1BhcmFtZXRlciB3aXRoIGxvZ2ljYWwgSUQgJ0Zha2VQYXJhbWV0ZXInIHdhcyBub3QgZm91bmQgaW4gdGhlIHRlbXBsYXRlLyk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Rocm93cyBhbiBleGNlcHRpb24gd2hlbiBwcm92aWRlZCBhIHBhcmFtZXRlciB0byByZXBsYWNlIGluIGEgdGVtcGxhdGUgd2l0aCBubyBwYXJhbWV0ZXJzJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICBpbmNsdWRlVGVzdFRlbXBsYXRlKHN0YWNrLCAnb25seS1lbXB0eS1idWNrZXQuanNvbicsIHtcbiAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgICdGYWtlUGFyYW1ldGVyJzogJ0RvZXNOb3RFeGlzdCcsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9KS50b1Rocm93KC9QYXJhbWV0ZXIgd2l0aCBsb2dpY2FsIElEICdGYWtlUGFyYW1ldGVyJyB3YXMgbm90IGZvdW5kIGluIHRoZSB0ZW1wbGF0ZS8pO1xuICB9KTtcblxuICB0ZXN0KCdjYW4gaW5nZXN0IGEgdGVtcGxhdGUgdGhhdCBjb250YWlucyBwcm9wZXJ0aWVzIG5vdCBpbiB0aGUgY3VycmVudCBDRk4gc3BlYywgYW5kIG91dHB1dCBpdCB1bmNoYW5nZWQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ3Byb3BlcnRpZXMtbm90LWluLWNmbi1zcGVjLmpzb24nKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhzdGFjaykudGVtcGxhdGVNYXRjaGVzKFxuICAgICAgbG9hZFRlc3RGaWxlVG9Kc09iamVjdCgncHJvcGVydGllcy1ub3QtaW4tY2ZuLXNwZWMuanNvbicpLFxuICAgICk7XG4gIH0pO1xuXG4gIHRlc3QoJ3JvdW5kdHJpcCBhIGZuLXNlbGVjdCB3aXRoIGEgZm4taWYvcmVmLW5vdmFsdWUgaW4gaXQnLCAoKSA9PiB7XG4gICAgaW5jbHVkZVRlc3RUZW1wbGF0ZShzdGFjaywgJ2ZuLXNlbGVjdC13aXRoLW5vdmFsdWUuanNvbicpO1xuXG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKS50ZW1wbGF0ZU1hdGNoZXMoXG4gICAgICBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KCdmbi1zZWxlY3Qtd2l0aC1ub3ZhbHVlLmpzb24nKSxcbiAgICApO1xuICB9KTtcbn0pO1xuXG5pbnRlcmZhY2UgSW5jbHVkZVRlc3RUZW1wbGF0ZVByb3BzIHtcbiAgLyoqIEBkZWZhdWx0IHRydWUgKi9cbiAgcmVhZG9ubHkgcHJlc2VydmVMb2dpY2FsSWRzPzogYm9vbGVhbjtcblxuICAvKiogQGRlZmF1bHQge30gKi9cbiAgcmVhZG9ubHkgcGFyYW1ldGVycz86IHsgW3BhcmFtZXRlck5hbWU6IHN0cmluZ106IGFueSB9XG59XG5cbmZ1bmN0aW9uIGluY2x1ZGVUZXN0VGVtcGxhdGUoc2NvcGU6IGNvbnN0cnVjdHMuQ29uc3RydWN0LCB0ZXN0VGVtcGxhdGU6IHN0cmluZywgcHJvcHM6IEluY2x1ZGVUZXN0VGVtcGxhdGVQcm9wcyA9IHt9KTogaW5jLkNmbkluY2x1ZGUge1xuICByZXR1cm4gbmV3IGluYy5DZm5JbmNsdWRlKHNjb3BlLCAnTXlTY29wZScsIHtcbiAgICB0ZW1wbGF0ZUZpbGU6IF90ZXN0VGVtcGxhdGVGaWxlUGF0aCh0ZXN0VGVtcGxhdGUpLFxuICAgIHBhcmFtZXRlcnM6IHByb3BzLnBhcmFtZXRlcnMsXG4gICAgcHJlc2VydmVMb2dpY2FsSWRzOiBwcm9wcy5wcmVzZXJ2ZUxvZ2ljYWxJZHMsXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBsb2FkVGVzdEZpbGVUb0pzT2JqZWN0KHRlc3RUZW1wbGF0ZTogc3RyaW5nKTogYW55IHtcbiAgcmV0dXJuIGZ1dGlscy5yZWFkSnNvblN5bmMoX3Rlc3RUZW1wbGF0ZUZpbGVQYXRoKHRlc3RUZW1wbGF0ZSkpO1xufVxuXG5mdW5jdGlvbiBfdGVzdFRlbXBsYXRlRmlsZVBhdGgodGVzdFRlbXBsYXRlOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHBhdGguam9pbihfX2Rpcm5hbWUsICd0ZXN0LXRlbXBsYXRlcycsIHRlc3RUZW1wbGF0ZSk7XG59XG4iXX0=