"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.nodeNames = exports.mkGraph = void 0;
const helpers_internal_1 = require("../../../lib/helpers-internal");
class PlainNode extends helpers_internal_1.GraphNode {
}
function mkGraph(name, block) {
    const graph = new helpers_internal_1.Graph(name);
    block({
        graph(name2, deps, block2) {
            const innerG = mkGraph(name2, block2);
            innerG.dependOn(...deps);
            graph.add(innerG);
            return innerG;
        },
        node(name2, deps) {
            const innerN = new PlainNode(name2);
            innerN.dependOn(...deps ?? []);
            graph.add(innerN);
            return innerN;
        },
    });
    return graph;
}
exports.mkGraph = mkGraph;
function nodeNames(n) {
    if (n instanceof helpers_internal_1.GraphNode) {
        return n.id;
    }
    if (Array.isArray(n)) {
        return n.map(nodeNames);
    }
    throw new Error('oh no');
}
exports.nodeNames = nodeNames;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsb0VBQWlFO0FBRWpFLE1BQU0sU0FBVSxTQUFRLDRCQUFjO0NBQUk7QUFFMUMsU0FBZ0IsT0FBTyxDQUFDLElBQVksRUFBRSxLQUFnQztJQUNwRSxNQUFNLEtBQUssR0FBRyxJQUFJLHdCQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDOUIsS0FBSyxDQUFDO1FBQ0osS0FBSyxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTTtZQUN2QixNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3RDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztZQUN6QixLQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2xCLE9BQU8sTUFBTSxDQUFDO1NBQ2Y7UUFDRCxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUk7WUFDZCxNQUFNLE1BQU0sR0FBRyxJQUFJLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQy9CLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDbEIsT0FBTyxNQUFNLENBQUM7U0FDZjtLQUNGLENBQUMsQ0FBQztJQUNILE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQWpCRCwwQkFpQkM7QUFZRCxTQUFnQixTQUFTLENBQUMsQ0FBTTtJQUM5QixJQUFJLENBQUMsWUFBWSw0QkFBUyxFQUFFO1FBQUUsT0FBTyxDQUFDLENBQUMsRUFBRSxDQUFDO0tBQUU7SUFDNUMsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFO1FBQUUsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0tBQUU7SUFDbEQsTUFBTSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUMzQixDQUFDO0FBSkQsOEJBSUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHcmFwaCwgR3JhcGhOb2RlIH0gZnJvbSAnLi4vLi4vLi4vbGliL2hlbHBlcnMtaW50ZXJuYWwnO1xuXG5jbGFzcyBQbGFpbk5vZGUgZXh0ZW5kcyBHcmFwaE5vZGU8YW55PiB7IH1cblxuZXhwb3J0IGZ1bmN0aW9uIG1rR3JhcGgobmFtZTogc3RyaW5nLCBibG9jazogKGI6IEdyYXBoQnVpbGRlcikgPT4gdm9pZCkge1xuICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaChuYW1lKTtcbiAgYmxvY2soe1xuICAgIGdyYXBoKG5hbWUyLCBkZXBzLCBibG9jazIpIHtcbiAgICAgIGNvbnN0IGlubmVyRyA9IG1rR3JhcGgobmFtZTIsIGJsb2NrMik7XG4gICAgICBpbm5lckcuZGVwZW5kT24oLi4uZGVwcyk7XG4gICAgICBncmFwaC5hZGQoaW5uZXJHKTtcbiAgICAgIHJldHVybiBpbm5lckc7XG4gICAgfSxcbiAgICBub2RlKG5hbWUyLCBkZXBzKSB7XG4gICAgICBjb25zdCBpbm5lck4gPSBuZXcgUGxhaW5Ob2RlKG5hbWUyKTtcbiAgICAgIGlubmVyTi5kZXBlbmRPbiguLi5kZXBzID8/IFtdKTtcbiAgICAgIGdyYXBoLmFkZChpbm5lck4pO1xuICAgICAgcmV0dXJuIGlubmVyTjtcbiAgICB9LFxuICB9KTtcbiAgcmV0dXJuIGdyYXBoO1xufVxuXG5cbmludGVyZmFjZSBHcmFwaEJ1aWxkZXIge1xuICBncmFwaChuYW1lOiBzdHJpbmcsIGRlcHM6IEdyYXBoTm9kZTxhbnk+W10sIGJsb2NrOiAoYjogR3JhcGhCdWlsZGVyKSA9PiB2b2lkKTogR3JhcGg8YW55PjtcbiAgbm9kZShuYW1lOiBzdHJpbmcsIGRlcHM/OiBHcmFwaE5vZGU8YW55PltdKTogR3JhcGhOb2RlPGFueT47XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIG5vZGVOYW1lcyhuOiBHcmFwaE5vZGU8YW55Pik6IHN0cmluZztcbmV4cG9ydCBmdW5jdGlvbiBub2RlTmFtZXMobnM6IEdyYXBoTm9kZTxhbnk+W10pOiBzdHJpbmdbXTtcbmV4cG9ydCBmdW5jdGlvbiBub2RlTmFtZXMobnM6IEdyYXBoTm9kZTxhbnk+W11bXSk6IHN0cmluZ1tdW107XG5leHBvcnQgZnVuY3Rpb24gbm9kZU5hbWVzKG46IGFueSk6IGFueSB7XG4gIGlmIChuIGluc3RhbmNlb2YgR3JhcGhOb2RlKSB7IHJldHVybiBuLmlkOyB9XG4gIGlmIChBcnJheS5pc0FycmF5KG4pKSB7IHJldHVybiBuLm1hcChub2RlTmFtZXMpOyB9XG4gIHRocm93IG5ldyBFcnJvcignb2ggbm8nKTtcbn0iXX0=