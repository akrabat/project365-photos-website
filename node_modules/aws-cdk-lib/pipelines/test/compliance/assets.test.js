"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const path = require("path");
const assertions_1 = require("../../../assertions");
const cb = require("../../../aws-codebuild");
const ec2 = require("../../../aws-ec2");
const core_1 = require("../../../core");
const default_codebuild_image_1 = require("../../lib/private/default-codebuild-image");
const testhelpers_1 = require("../testhelpers");
const FILE_ASSET_SOURCE_HASH = '8289faf53c7da377bb2b90615999171adef5e1d8f6b88810e5fef75e6ca09ba5';
const FILE_ASSET_SOURCE_HASH2 = 'ac76997971c3f6ddf37120660003f1ced72b4fc58c498dfd99c78fa77e721e0e';
const FILE_PUBLISHING_ROLE = 'arn:${AWS::Partition}:iam::${AWS::AccountId}:role/cdk-hnb659fds-file-publishing-role-${AWS::AccountId}-${AWS::Region}';
const IMAGE_PUBLISHING_ROLE = 'arn:${AWS::Partition}:iam::${AWS::AccountId}:role/cdk-hnb659fds-image-publishing-role-${AWS::AccountId}-${AWS::Region}';
let app;
let pipelineStack;
beforeEach(() => {
    app = new testhelpers_1.TestApp();
    pipelineStack = new core_1.Stack(app, 'PipelineStack', { env: testhelpers_1.PIPELINE_ENV });
});
afterEach(() => {
    app.cleanup();
});
describe('basic pipeline', () => {
    (0, testhelpers_1.behavior)('no assets stage if the application has no assets', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addApplicationStage(new testhelpers_1.PlainStackApp(app, 'App'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addStage(new testhelpers_1.PlainStackApp(app, 'App'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            // THEN
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                Stages: assertions_1.Match.not(assertions_1.Match.arrayWith([assertions_1.Match.objectLike({
                        Name: 'Assets',
                    })])),
            });
        }
    });
    describe('asset stage placement', () => {
        (0, testhelpers_1.behavior)('assets stage comes before any user-defined stages', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App'));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App'));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                    Stages: [
                        assertions_1.Match.objectLike({ Name: 'Source' }),
                        assertions_1.Match.objectLike({ Name: 'Build' }),
                        assertions_1.Match.objectLike({ Name: 'UpdatePipeline' }),
                        assertions_1.Match.objectLike({ Name: 'Assets' }),
                        assertions_1.Match.objectLike({ Name: 'App' }),
                    ],
                });
            }
        });
        (0, testhelpers_1.behavior)('up to 50 assets fit in a single stage', (suite) => {
            suite.legacy(() => {
                // WHEN
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.MegaAssetsApp(app, 'App', { numAssets: 50 }));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addStage(new testhelpers_1.MegaAssetsApp(app, 'App', { numAssets: 50 }));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                    Stages: [
                        assertions_1.Match.objectLike({ Name: 'Source' }),
                        assertions_1.Match.objectLike({ Name: 'Build' }),
                        assertions_1.Match.objectLike({ Name: 'UpdatePipeline' }),
                        assertions_1.Match.objectLike({ Name: 'Assets' }),
                        assertions_1.Match.objectLike({ Name: 'App' }),
                    ],
                });
            }
        });
        (0, testhelpers_1.behavior)('51 assets triggers a second stage', (suite) => {
            suite.legacy(() => {
                // WHEN
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.MegaAssetsApp(app, 'App', { numAssets: 51 }));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                // WHEN
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addStage(new testhelpers_1.MegaAssetsApp(app, 'App', { numAssets: 51 }));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                    Stages: [
                        assertions_1.Match.objectLike({ Name: 'Source' }),
                        assertions_1.Match.objectLike({ Name: 'Build' }),
                        assertions_1.Match.objectLike({ Name: 'UpdatePipeline' }),
                        assertions_1.Match.objectLike({ Name: (0, testhelpers_1.stringLike)('Assets*') }),
                        assertions_1.Match.objectLike({ Name: (0, testhelpers_1.stringLike)('Assets*2') }),
                        assertions_1.Match.objectLike({ Name: 'App' }),
                    ],
                });
            }
        });
        (0, testhelpers_1.behavior)('101 assets triggers a third stage', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.MegaAssetsApp(app, 'App', { numAssets: 101 }));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addStage(new testhelpers_1.MegaAssetsApp(app, 'App', { numAssets: 101 }));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                    Stages: [
                        assertions_1.Match.objectLike({ Name: 'Source' }),
                        assertions_1.Match.objectLike({ Name: 'Build' }),
                        assertions_1.Match.objectLike({ Name: 'UpdatePipeline' }),
                        assertions_1.Match.objectLike({ Name: (0, testhelpers_1.stringLike)('Assets*') }),
                        assertions_1.Match.objectLike({ Name: (0, testhelpers_1.stringLike)('Assets*2') }),
                        assertions_1.Match.objectLike({ Name: (0, testhelpers_1.stringLike)('Assets*3') }),
                        assertions_1.Match.objectLike({ Name: 'App' }),
                    ],
                });
            }
        });
    });
    (0, testhelpers_1.behavior)('command line properly locates assets in subassembly', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Environment: {
                    Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
                },
                Source: {
                    BuildSpec: assertions_1.Match.serializedJson(assertions_1.Match.objectLike({
                        phases: {
                            build: {
                                commands: assertions_1.Match.arrayWith([`cdk-assets --path "assembly-FileAssetApp/FileAssetAppStackEADD68C5.assets.json" --verbose publish "${FILE_ASSET_SOURCE_HASH}:current_account-current_region"`]),
                            },
                        },
                    })),
                },
            });
        }
    });
    (0, testhelpers_1.behavior)('multiple assets are published in parallel', (suite) => {
        suite.legacy(() => {
            // WHEN
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addApplicationStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                Stages: assertions_1.Match.arrayWith([{
                        Name: 'Assets',
                        Actions: [
                            assertions_1.Match.objectLike({ RunOrder: 1 }),
                            assertions_1.Match.objectLike({ RunOrder: 1 }),
                        ],
                    }]),
            });
        }
    });
    (0, testhelpers_1.behavior)('assets are also published when using the lower-level addStackArtifactDeployment', (suite) => {
        suite.legacy(() => {
            // GIVEN
            const asm = new testhelpers_1.FileAssetApp(app, 'FileAssetApp').synth();
            // WHEN
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addStage('SomeStage').addStackArtifactDeployment(asm.getStackByName('FileAssetApp-Stack'));
            // THEN
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                Stages: assertions_1.Match.arrayWith([{
                        Name: 'Assets',
                        Actions: [
                            assertions_1.Match.objectLike({
                                Name: 'FileAsset1',
                                RunOrder: 1,
                            }),
                        ],
                    }]),
            });
        });
        // This function does not exist in the modern API
        suite.doesNotApply.modern();
    });
    (0, testhelpers_1.behavior)('file image asset publishers do not use privilegedmode', (suite) => {
        suite.legacy(() => {
            // WHEN
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            // WHEN
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Source: {
                    BuildSpec: assertions_1.Match.serializedJson(assertions_1.Match.objectLike({
                        phases: {
                            build: {
                                commands: assertions_1.Match.arrayWith([(0, testhelpers_1.stringLike)('cdk-assets *')]),
                            },
                        },
                    })),
                },
                Environment: assertions_1.Match.objectLike({
                    PrivilegedMode: false,
                    Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
                }),
            });
        }
    });
    (0, testhelpers_1.behavior)('docker image asset publishers use privilegedmode', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addApplicationStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk');
            pipeline.addStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Source: {
                    BuildSpec: assertions_1.Match.serializedJson(assertions_1.Match.objectLike({
                        phases: {
                            build: {
                                commands: assertions_1.Match.arrayWith([(0, testhelpers_1.stringLike)('cdk-assets *')]),
                            },
                        },
                    })),
                },
                Environment: assertions_1.Match.objectLike({
                    Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
                    PrivilegedMode: true,
                }),
            });
        }
    });
    (0, testhelpers_1.behavior)('can control fix/CLI version used in asset publishing', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                cdkCliVersion: '1.2.3',
            });
            pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(pipelineStack, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                cliVersion: '1.2.3',
            });
            pipeline.addStage(new testhelpers_1.FileAssetApp(pipelineStack, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Environment: {
                    Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
                },
                Source: {
                    BuildSpec: assertions_1.Match.serializedJson(assertions_1.Match.objectLike({
                        phases: {
                            install: {
                                commands: ['npm install -g cdk-assets@1.2.3'],
                            },
                        },
                    })),
                },
            });
        }
    });
    describe('asset roles and policies', () => {
        (0, testhelpers_1.behavior)('includes file publishing assets role for apps with file assets', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                    // Expectation expects to see KMS key policy permissions
                    crossAccountKeys: true,
                });
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Role', {
                    AssumeRolePolicyDocument: {
                        Statement: [
                            {
                                Action: 'sts:AssumeRole',
                                Effect: 'Allow',
                                Principal: {
                                    Service: 'codebuild.amazonaws.com',
                                },
                            },
                            {
                                Action: 'sts:AssumeRole',
                                Effect: 'Allow',
                                Principal: {
                                    AWS: {
                                        'Fn::Join': ['', [
                                                'arn:', { Ref: 'AWS::Partition' }, `:iam::${testhelpers_1.PIPELINE_ENV.account}:root`,
                                            ]],
                                    },
                                },
                            },
                        ],
                    },
                });
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', expectedAssetRolePolicy(FILE_PUBLISHING_ROLE, 'CdkAssetsFileRole6BE17A07'));
            }
        });
        (0, testhelpers_1.behavior)('publishing assets role may assume roles from multiple environments', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App2', {
                    env: {
                        account: '0123456789012',
                        region: 'eu-west-1',
                    },
                }));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                    // Expectation expects to see KMS key policy permissions
                    crossAccountKeys: true,
                });
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App2', {
                    env: {
                        account: '0123456789012',
                        region: 'eu-west-1',
                    },
                }));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', expectedAssetRolePolicy([FILE_PUBLISHING_ROLE, 'arn:${AWS::Partition}:iam::0123456789012:role/cdk-hnb659fds-file-publishing-role-0123456789012-eu-west-1'], 'CdkAssetsFileRole6BE17A07'));
            }
        });
        (0, testhelpers_1.behavior)('publishing assets role de-dupes assumed roles', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App2'));
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App3'));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                    // Expectation expects to see KMS key policy permissions
                    crossAccountKeys: true,
                });
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App2'));
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App3'));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', expectedAssetRolePolicy(FILE_PUBLISHING_ROLE, 'CdkAssetsFileRole6BE17A07'));
            }
        });
        (0, testhelpers_1.behavior)('includes image publishing assets role for apps with Docker assets', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.DockerAssetApp(app, 'App1'));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                    // Expectation expects to see KMS key policy permissions
                    crossAccountKeys: true,
                });
                pipeline.addStage(new testhelpers_1.DockerAssetApp(app, 'App1'));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Role', {
                    AssumeRolePolicyDocument: {
                        Statement: [
                            {
                                Action: 'sts:AssumeRole',
                                Effect: 'Allow',
                                Principal: {
                                    Service: 'codebuild.amazonaws.com',
                                },
                            },
                            {
                                Action: 'sts:AssumeRole',
                                Effect: 'Allow',
                                Principal: {
                                    AWS: {
                                        'Fn::Join': ['', [
                                                'arn:', { Ref: 'AWS::Partition' }, `:iam::${testhelpers_1.PIPELINE_ENV.account}:root`,
                                            ]],
                                    },
                                },
                            },
                        ],
                    },
                });
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', expectedAssetRolePolicy(IMAGE_PUBLISHING_ROLE, 'CdkAssetsDockerRole484B6DD3'));
            }
        });
        (0, testhelpers_1.behavior)('includes both roles for apps with both file and Docker assets', (suite) => {
            suite.legacy(() => {
                const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk');
                pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                pipeline.addApplicationStage(new testhelpers_1.DockerAssetApp(app, 'App2'));
                THEN_codePipelineExpectation();
            });
            suite.modern(() => {
                const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                    // Expectation expects to see KMS key policy permissions
                    crossAccountKeys: true,
                });
                pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'App1'));
                pipeline.addStage(new testhelpers_1.DockerAssetApp(app, 'App2'));
                THEN_codePipelineExpectation();
            });
            function THEN_codePipelineExpectation() {
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', expectedAssetRolePolicy(FILE_PUBLISHING_ROLE, 'CdkAssetsFileRole6BE17A07'));
                assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', expectedAssetRolePolicy(IMAGE_PUBLISHING_ROLE, 'CdkAssetsDockerRole484B6DD3'));
            }
        });
    });
});
(0, testhelpers_1.behavior)('can supply pre-install scripts to asset upload', (suite) => {
    suite.legacy(() => {
        const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
            assetPreInstallCommands: [
                'npm config set registry https://registry.com',
            ],
        });
        pipeline.addApplicationStage(new testhelpers_1.FileAssetApp(app, 'FileAssetApp'));
        THEN_codePipelineExpectation();
    });
    suite.modern(() => {
        const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
            assetPublishingCodeBuildDefaults: {
                partialBuildSpec: cb.BuildSpec.fromObject({
                    version: '0.2',
                    phases: {
                        install: {
                            commands: [
                                'npm config set registry https://registry.com',
                            ],
                        },
                    },
                }),
            },
        });
        pipeline.addStage(new testhelpers_1.FileAssetApp(app, 'FileAssetApp'));
        THEN_codePipelineExpectation();
    });
    function THEN_codePipelineExpectation() {
        assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
            Environment: {
                Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
            },
            Source: {
                BuildSpec: assertions_1.Match.serializedJson(assertions_1.Match.objectLike({
                    phases: {
                        install: {
                            commands: ['npm config set registry https://registry.com', 'npm install -g cdk-assets@2'],
                        },
                    },
                })),
            },
        });
    }
});
describe('pipeline with VPC', () => {
    let vpc;
    beforeEach(() => {
        vpc = new ec2.Vpc(pipelineStack, 'Vpc');
    });
    (0, testhelpers_1.behavior)('asset CodeBuild Project uses VPC subnets', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                vpc,
            });
            pipeline.addApplicationStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                codeBuildDefaults: { vpc },
            });
            pipeline.addStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            // THEN
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                VpcConfig: assertions_1.Match.objectLike({
                    SecurityGroupIds: [
                        { 'Fn::GetAtt': ['CdkAssetsDockerAsset1SecurityGroup078F5C66', 'GroupId'] },
                    ],
                    Subnets: [
                        { Ref: 'VpcPrivateSubnet1Subnet536B997A' },
                        { Ref: 'VpcPrivateSubnet2Subnet3788AAA1' },
                        { Ref: 'VpcPrivateSubnet3SubnetF258B56E' },
                    ],
                    VpcId: { Ref: 'Vpc8378EB38' },
                }),
            });
        }
    });
    (0, testhelpers_1.behavior)('Pipeline-generated CodeBuild Projects have appropriate execution role permissions', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                vpc,
            });
            pipeline.addApplicationStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                codeBuildDefaults: { vpc },
            });
            pipeline.addStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            // Assets Project
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', {
                Roles: [
                    { Ref: 'CdkAssetsDockerRole484B6DD3' },
                ],
                PolicyDocument: {
                    Statement: assertions_1.Match.arrayWith([{
                            Action: assertions_1.Match.arrayWith(['ec2:DescribeSecurityGroups']),
                            Effect: 'Allow',
                            Resource: '*',
                        }]),
                },
            });
        }
    });
    (0, testhelpers_1.behavior)('Asset publishing CodeBuild Projects have correct VPC permissions', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                vpc,
            });
            pipeline.addApplicationStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                codeBuildDefaults: { vpc },
            });
            pipeline.addStage(new testhelpers_1.DockerAssetApp(app, 'DockerAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            // Assets Project
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', {
                PolicyDocument: {
                    Statement: [
                        assertions_1.Match.objectLike({
                            Resource: '*',
                            Action: [
                                'ec2:CreateNetworkInterface',
                                'ec2:DescribeNetworkInterfaces',
                                'ec2:DeleteNetworkInterface',
                                'ec2:DescribeSubnets',
                                'ec2:DescribeSecurityGroups',
                                'ec2:DescribeDhcpOptions',
                                'ec2:DescribeVpcs',
                            ],
                        }),
                    ],
                },
                Roles: [{ Ref: 'CdkAssetsDockerRole484B6DD3' }],
            });
            assertions_1.Template.fromStack(pipelineStack).hasResource('AWS::CodeBuild::Project', {
                Properties: {
                    ServiceRole: { 'Fn::GetAtt': ['CdkAssetsDockerRole484B6DD3', 'Arn'] },
                },
                DependsOn: [
                    'CdkAssetsDockerAsset1PolicyDocument8DA96A22',
                ],
            });
        }
    });
});
describe('pipeline with single asset publisher', () => {
    (0, testhelpers_1.behavior)('multiple assets are using the same job in singlePublisherMode', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                singlePublisherPerType: true,
            });
            pipeline.addApplicationStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                publishAssetsInParallel: false,
            });
            pipeline.addStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            // THEN
            const buildSpecName = new assertions_1.Capture((0, testhelpers_1.stringLike)('buildspec-*.yaml'));
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                Stages: assertions_1.Match.arrayWith([{
                        Name: 'Assets',
                        Actions: [
                            // Only one file asset action
                            assertions_1.Match.objectLike({ RunOrder: 1, Name: 'FileAsset' }),
                        ],
                    }]),
            });
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Environment: {
                    Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
                },
                Source: {
                    BuildSpec: buildSpecName,
                },
            });
            const assembly = synthesize(pipelineStack);
            const actualFileName = buildSpecName.asString();
            const buildSpec = JSON.parse(fs.readFileSync(path.join(assembly.directory, actualFileName), { encoding: 'utf-8' }));
            expect(buildSpec.phases.build.commands).toContain(`cdk-assets --path "assembly-FileAssetApp/FileAssetAppStackEADD68C5.assets.json" --verbose publish "${FILE_ASSET_SOURCE_HASH}:current_account-current_region"`);
            expect(buildSpec.phases.build.commands).toContain(`cdk-assets --path "assembly-FileAssetApp/FileAssetAppStackEADD68C5.assets.json" --verbose publish "${FILE_ASSET_SOURCE_HASH2}:current_account-current_region"`);
        }
    });
    (0, testhelpers_1.behavior)('other pipeline writes to separate assets build spec file', (suite) => {
        suite.legacy(() => {
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                singlePublisherPerType: true,
            });
            pipeline.addApplicationStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            const pipelineStack2 = new core_1.Stack(app, 'PipelineStack2', { env: testhelpers_1.PIPELINE_ENV });
            const otherPipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack2, 'Cdk', {
                singlePublisherPerType: true,
            });
            otherPipeline.addApplicationStage(new testhelpers_1.TwoFileAssetsApp(app, 'OtherFileAssetApp'));
            THEN_codePipelineExpectation(pipelineStack2);
        });
        suite.modern(() => {
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                publishAssetsInParallel: false,
            });
            pipeline.addStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            const pipelineStack2 = new core_1.Stack(app, 'PipelineStack2', { env: testhelpers_1.PIPELINE_ENV });
            const otherPipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack2, 'Cdk', {
                publishAssetsInParallel: false,
            });
            otherPipeline.addStage(new testhelpers_1.TwoFileAssetsApp(app, 'OtherFileAssetApp'));
            THEN_codePipelineExpectation(pipelineStack2);
        });
        function THEN_codePipelineExpectation(pipelineStack2) {
            // THEN
            const buildSpecName1 = new assertions_1.Capture((0, testhelpers_1.stringLike)('buildspec-*.yaml'));
            const buildSpecName2 = new assertions_1.Capture((0, testhelpers_1.stringLike)('buildspec-*.yaml'));
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Source: {
                    BuildSpec: buildSpecName1,
                },
            });
            assertions_1.Template.fromStack(pipelineStack2).hasResourceProperties('AWS::CodeBuild::Project', {
                Source: {
                    BuildSpec: buildSpecName2,
                },
            });
            expect(buildSpecName1.asString()).not.toEqual(buildSpecName2.asString());
        }
    });
});
describe('pipeline with custom asset publisher BuildSpec', () => {
    (0, testhelpers_1.behavior)('custom buildspec is merged correctly', (suite) => {
        suite.legacy(() => {
            // WHEN
            const pipeline = new testhelpers_1.LegacyTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                singlePublisherPerType: true,
                assetBuildSpec: cb.BuildSpec.fromObject({
                    phases: {
                        pre_install: {
                            commands: 'preinstall',
                        },
                    },
                    cache: {
                        paths: 'node_modules',
                    },
                }),
            });
            pipeline.addApplicationStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        suite.modern(() => {
            // WHEN
            const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Cdk', {
                publishAssetsInParallel: false,
                assetPublishingCodeBuildDefaults: {
                    partialBuildSpec: cb.BuildSpec.fromObject({
                        phases: {
                            pre_install: {
                                commands: 'preinstall',
                            },
                        },
                        cache: {
                            paths: 'node_modules',
                        },
                    }),
                },
            });
            pipeline.addStage(new testhelpers_1.TwoFileAssetsApp(app, 'FileAssetApp'));
            THEN_codePipelineExpectation();
        });
        function THEN_codePipelineExpectation() {
            const buildSpecName = new assertions_1.Capture((0, testhelpers_1.stringLike)('buildspec-*'));
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodePipeline::Pipeline', {
                Stages: assertions_1.Match.arrayWith([{
                        Name: 'Assets',
                        Actions: [
                            // Only one file asset action
                            assertions_1.Match.objectLike({ RunOrder: 1, Name: 'FileAsset' }),
                        ],
                    }]),
            });
            assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::CodeBuild::Project', {
                Environment: {
                    Image: default_codebuild_image_1.CDKP_DEFAULT_CODEBUILD_IMAGE.imageId,
                },
                Source: {
                    BuildSpec: buildSpecName,
                },
            });
            const assembly = synthesize(pipelineStack);
            const buildSpec = JSON.parse(fs.readFileSync(path.join(assembly.directory, buildSpecName.asString())).toString());
            expect(buildSpec.phases.build.commands).toContain(`cdk-assets --path "assembly-FileAssetApp/FileAssetAppStackEADD68C5.assets.json" --verbose publish "${FILE_ASSET_SOURCE_HASH}:current_account-current_region"`);
            expect(buildSpec.phases.build.commands).toContain(`cdk-assets --path "assembly-FileAssetApp/FileAssetAppStackEADD68C5.assets.json" --verbose publish "${FILE_ASSET_SOURCE_HASH2}:current_account-current_region"`);
            expect(buildSpec.phases.pre_install.commands).toContain('preinstall');
            expect(buildSpec.cache.paths).toContain('node_modules');
        }
    });
});
function expectedAssetRolePolicy(assumeRolePattern, attachedRole) {
    if (typeof assumeRolePattern === 'string') {
        assumeRolePattern = [assumeRolePattern];
    }
    return {
        PolicyDocument: {
            Statement: [{
                    Action: ['logs:CreateLogGroup', 'logs:CreateLogStream', 'logs:PutLogEvents'],
                    Effect: 'Allow',
                    Resource: {
                        'Fn::Join': ['', [
                                'arn:',
                                { Ref: 'AWS::Partition' },
                                `:logs:${testhelpers_1.PIPELINE_ENV.region}:${testhelpers_1.PIPELINE_ENV.account}:log-group:/aws/codebuild/*`,
                            ]],
                    },
                },
                {
                    Action: ['codebuild:CreateReportGroup', 'codebuild:CreateReport', 'codebuild:UpdateReport', 'codebuild:BatchPutTestCases', 'codebuild:BatchPutCodeCoverages'],
                    Effect: 'Allow',
                    Resource: {
                        'Fn::Join': ['', [
                                'arn:',
                                { Ref: 'AWS::Partition' },
                                `:codebuild:${testhelpers_1.PIPELINE_ENV.region}:${testhelpers_1.PIPELINE_ENV.account}:report-group/*`,
                            ]],
                    },
                },
                {
                    Action: ['codebuild:BatchGetBuilds', 'codebuild:StartBuild', 'codebuild:StopBuild'],
                    Effect: 'Allow',
                    Resource: '*',
                },
                {
                    Action: 'sts:AssumeRole',
                    Effect: 'Allow',
                    Resource: unsingleton(assumeRolePattern.map(arn => { return { 'Fn::Sub': arn }; })),
                },
                {
                    Action: ['s3:GetObject*', 's3:GetBucket*', 's3:List*'],
                    Effect: 'Allow',
                    Resource: [
                        { 'Fn::GetAtt': ['CdkPipelineArtifactsBucket7B46C7BF', 'Arn'] },
                        { 'Fn::Join': ['', [{ 'Fn::GetAtt': ['CdkPipelineArtifactsBucket7B46C7BF', 'Arn'] }, '/*']] },
                    ],
                },
                {
                    Action: ['kms:Decrypt', 'kms:DescribeKey'],
                    Effect: 'Allow',
                    Resource: { 'Fn::GetAtt': ['CdkPipelineArtifactsBucketEncryptionKeyDDD3258C', 'Arn'] },
                }],
        },
        Roles: [{ Ref: attachedRole }],
    };
}
(0, testhelpers_1.behavior)('necessary secrets manager permissions get added to asset roles', suite => {
    // Not possible to configure this for legacy pipelines
    suite.doesNotApply.legacy();
    suite.modern(() => {
        const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Pipeline', {
            assetPublishingCodeBuildDefaults: {
                buildEnvironment: {
                    environmentVariables: {
                        FOOBAR: {
                            value: 'FoobarSecret',
                            type: cb.BuildEnvironmentVariableType.SECRETS_MANAGER,
                        },
                    },
                },
            },
        });
        pipeline.addStage(new testhelpers_1.FileAssetApp(pipelineStack, 'MyApp'));
        THEN_codePipelineExpectation();
    });
    function THEN_codePipelineExpectation() {
        assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: assertions_1.Match.arrayWith([{
                        Action: 'secretsmanager:GetSecretValue',
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': [
                                '',
                                [
                                    'arn:',
                                    { Ref: 'AWS::Partition' },
                                    ':secretsmanager:us-pipeline:123pipeline:secret:FoobarSecret-??????',
                                ],
                            ],
                        },
                    }]),
            },
            Roles: [
                { Ref: 'PipelineAssetsFileRole59943A77' },
            ],
        });
    }
});
(0, testhelpers_1.behavior)('adding environment variable to assets job adds SecretsManager permissions', suite => {
    // No way to manipulate buildEnvironment in legacy API
    suite.doesNotApply.legacy();
    suite.modern(() => {
        const pipeline = new testhelpers_1.ModernTestGitHubNpmPipeline(pipelineStack, 'Pipeline', {
            assetPublishingCodeBuildDefaults: {
                buildEnvironment: {
                    environmentVariables: {
                        FOOBAR: {
                            value: 'FoobarSecret',
                            type: cb.BuildEnvironmentVariableType.SECRETS_MANAGER,
                        },
                    },
                },
            },
        });
        pipeline.addStage(new testhelpers_1.FileAssetApp(pipelineStack, 'MyApp'));
        assertions_1.Template.fromStack(pipelineStack).hasResourceProperties('AWS::IAM::Policy', {
            PolicyDocument: {
                Statement: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        Action: 'secretsmanager:GetSecretValue',
                        Effect: 'Allow',
                        Resource: {
                            'Fn::Join': ['', [
                                    'arn:',
                                    { Ref: 'AWS::Partition' },
                                    ':secretsmanager:us-pipeline:123pipeline:secret:FoobarSecret-??????',
                                ]],
                        },
                    }),
                ]),
            },
        });
    });
});
function synthesize(stack) {
    const root = stack.node.root;
    if (!core_1.Stage.isStage(root)) {
        throw new Error('unexpected: all stacks must be part of a Stage');
    }
    return root.synth({ skipValidation: true });
}
function unsingleton(xs) {
    if (xs.length === 1) {
        return xs[0];
    }
    return xs;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZXRzLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJhc3NldHMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0Isb0RBQStEO0FBQy9ELDZDQUE2QztBQUM3Qyx3Q0FBd0M7QUFDeEMsd0NBQTZDO0FBQzdDLHVGQUF5RjtBQUN6RixnREFBcU47QUFFck4sTUFBTSxzQkFBc0IsR0FBRyxrRUFBa0UsQ0FBQztBQUNsRyxNQUFNLHVCQUF1QixHQUFHLGtFQUFrRSxDQUFDO0FBRW5HLE1BQU0sb0JBQW9CLEdBQUcsdUhBQXVILENBQUM7QUFDckosTUFBTSxxQkFBcUIsR0FBRyx3SEFBd0gsQ0FBQztBQUV2SixJQUFJLEdBQVksQ0FBQztBQUNqQixJQUFJLGFBQW9CLENBQUM7QUFFekIsVUFBVSxDQUFDLEdBQUcsRUFBRTtJQUNkLEdBQUcsR0FBRyxJQUFJLHFCQUFPLEVBQUUsQ0FBQztJQUNwQixhQUFhLEdBQUcsSUFBSSxZQUFLLENBQUMsR0FBRyxFQUFFLGVBQWUsRUFBRSxFQUFFLEdBQUcsRUFBRSwwQkFBWSxFQUFFLENBQUMsQ0FBQztBQUN6RSxDQUFDLENBQUMsQ0FBQztBQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7SUFDYixHQUFHLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDaEIsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFO0lBQzlCLElBQUEsc0JBQVEsRUFBQyxrREFBa0QsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1FBQ3JFLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFO1lBQ2hCLE1BQU0sUUFBUSxHQUFHLElBQUkseUNBQTJCLENBQUMsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ3ZFLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLDJCQUFhLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDLENB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SSxFQUFPO0lBQzdCLElBQUksRUFBRSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7UUFDbkIsT0FBTyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDZDtJQUNELE9BQU8sRUFBRSxDQUFDO0FBQ1osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBDYXB0dXJlLCBNYXRjaCwgVGVtcGxhdGUgfSBmcm9tICcuLi8uLi8uLi9hc3NlcnRpb25zJztcbmltcG9ydCAqIGFzIGNiIGZyb20gJy4uLy4uLy4uL2F3cy1jb2RlYnVpbGQnO1xuaW1wb3J0ICogYXMgZWMyIGZyb20gJy4uLy4uLy4uL2F3cy1lYzInO1xuaW1wb3J0IHsgU3RhY2ssIFN0YWdlIH0gZnJvbSAnLi4vLi4vLi4vY29yZSc7XG5pbXBvcnQgeyBDREtQX0RFRkFVTFRfQ09ERUJVSUxEX0lNQUdFIH0gZnJvbSAnLi4vLi4vbGliL3ByaXZhdGUvZGVmYXVsdC1jb2RlYnVpbGQtaW1hZ2UnO1xuaW1wb3J0IHsgYmVoYXZpb3IsIFBJUEVMSU5FX0VOViwgVGVzdEFwcCwgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lLCBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUsIEZpbGVBc3NldEFwcCwgTWVnYUFzc2V0c0FwcCwgVHdvRmlsZUFzc2V0c0FwcCwgRG9ja2VyQXNzZXRBcHAsIFBsYWluU3RhY2tBcHAsIHN0cmluZ0xpa2UgfSBmcm9tICcuLi90ZXN0aGVscGVycyc7XG5cbmNvbnN0IEZJTEVfQVNTRVRfU09VUkNFX0hBU0ggPSAnODI4OWZhZjUzYzdkYTM3N2JiMmI5MDYxNTk5OTE3MWFkZWY1ZTFkOGY2Yjg4ODEwZTVmZWY3NWU2Y2EwOWJhNSc7XG5jb25zdCBGSUxFX0FTU0VUX1NPVVJDRV9IQVNIMiA9ICdhYzc2OTk3OTcxYzNmNmRkZjM3MTIwNjYwMDAzZjFjZWQ3MmI0ZmM1OGM0OThkZmQ5OWM3OGZhNzdlNzIxZTBlJztcblxuY29uc3QgRklMRV9QVUJMSVNISU5HX1JPTEUgPSAnYXJuOiR7QVdTOjpQYXJ0aXRpb259OmlhbTo6JHtBV1M6OkFjY291bnRJZH06cm9sZS9jZGstaG5iNjU5ZmRzLWZpbGUtcHVibGlzaGluZy1yb2xlLSR7QVdTOjpBY2NvdW50SWR9LSR7QVdTOjpSZWdpb259JztcbmNvbnN0IElNQUdFX1BVQkxJU0hJTkdfUk9MRSA9ICdhcm46JHtBV1M6OlBhcnRpdGlvbn06aWFtOjoke0FXUzo6QWNjb3VudElkfTpyb2xlL2Nkay1obmI2NTlmZHMtaW1hZ2UtcHVibGlzaGluZy1yb2xlLSR7QVdTOjpBY2NvdW50SWR9LSR7QVdTOjpSZWdpb259JztcblxubGV0IGFwcDogVGVzdEFwcDtcbmxldCBwaXBlbGluZVN0YWNrOiBTdGFjaztcblxuYmVmb3JlRWFjaCgoKSA9PiB7XG4gIGFwcCA9IG5ldyBUZXN0QXBwKCk7XG4gIHBpcGVsaW5lU3RhY2sgPSBuZXcgU3RhY2soYXBwLCAnUGlwZWxpbmVTdGFjaycsIHsgZW52OiBQSVBFTElORV9FTlYgfSk7XG59KTtcblxuYWZ0ZXJFYWNoKCgpID0+IHtcbiAgYXBwLmNsZWFudXAoKTtcbn0pO1xuXG5kZXNjcmliZSgnYmFzaWMgcGlwZWxpbmUnLCAoKSA9PiB7XG4gIGJlaGF2aW9yKCdubyBhc3NldHMgc3RhZ2UgaWYgdGhlIGFwcGxpY2F0aW9uIGhhcyBubyBhc3NldHMnLCAoc3VpdGUpID0+IHtcbiAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IFBsYWluU3RhY2tBcHAoYXBwLCAnQXBwJykpO1xuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgUGxhaW5TdGFja0FwcChhcHAsICdBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAvLyBUSEVOXG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNvZGVQaXBlbGluZTo6UGlwZWxpbmUnLCB7XG4gICAgICAgIFN0YWdlczogTWF0Y2gubm90KE1hdGNoLmFycmF5V2l0aChbTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgTmFtZTogJ0Fzc2V0cycsXG4gICAgICAgIH0pXSkpLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICBkZXNjcmliZSgnYXNzZXQgc3RhZ2UgcGxhY2VtZW50JywgKCkgPT4ge1xuICAgIGJlaGF2aW9yKCdhc3NldHMgc3RhZ2UgY29tZXMgYmVmb3JlIGFueSB1c2VyLWRlZmluZWQgc3RhZ2VzJywgKHN1aXRlKSA9PiB7XG4gICAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBMZWdhY3lUZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwJykpO1xuXG4gICAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICAgIH0pO1xuXG4gICAgICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgRmlsZUFzc2V0QXBwKGFwcCwgJ0FwcCcpKTtcblxuICAgICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlUGlwZWxpbmU6OlBpcGVsaW5lJywge1xuICAgICAgICAgIFN0YWdlczogW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdTb3VyY2UnIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdCdWlsZCcgfSksXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgTmFtZTogJ1VwZGF0ZVBpcGVsaW5lJyB9KSxcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiAnQXNzZXRzJyB9KSxcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiAnQXBwJyB9KSxcbiAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGJlaGF2aW9yKCd1cCB0byA1MCBhc3NldHMgZml0IGluIGEgc2luZ2xlIHN0YWdlJywgKHN1aXRlKSA9PiB7XG4gICAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IE1lZ2FBc3NldHNBcHAoYXBwLCAnQXBwJywgeyBudW1Bc3NldHM6IDUwIH0pKTtcblxuICAgICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgICB9KTtcblxuICAgICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTW9kZXJuVGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IE1lZ2FBc3NldHNBcHAoYXBwLCAnQXBwJywgeyBudW1Bc3NldHM6IDUwIH0pKTtcblxuICAgICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlUGlwZWxpbmU6OlBpcGVsaW5lJywge1xuICAgICAgICAgIFN0YWdlczogW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdTb3VyY2UnIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdCdWlsZCcgfSksXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgTmFtZTogJ1VwZGF0ZVBpcGVsaW5lJyB9KSxcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiAnQXNzZXRzJyB9KSxcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiAnQXBwJyB9KSxcbiAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGJlaGF2aW9yKCc1MSBhc3NldHMgdHJpZ2dlcnMgYSBzZWNvbmQgc3RhZ2UnLCAoc3VpdGUpID0+IHtcbiAgICAgIHN1aXRlLmxlZ2FjeSgoKSA9PiB7XG4gICAgICAgIC8vIFdIRU5cbiAgICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgTWVnYUFzc2V0c0FwcChhcHAsICdBcHAnLCB7IG51bUFzc2V0czogNTEgfSkpO1xuXG4gICAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICAgIH0pO1xuXG4gICAgICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgICAgICAvLyBXSEVOXG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKG5ldyBNZWdhQXNzZXRzQXBwKGFwcCwgJ0FwcCcsIHsgbnVtQXNzZXRzOiA1MSB9KSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q29kZVBpcGVsaW5lOjpQaXBlbGluZScsIHtcbiAgICAgICAgICBTdGFnZXM6IFtcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiAnU291cmNlJyB9KSxcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiAnQnVpbGQnIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdVcGRhdGVQaXBlbGluZScgfSksXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgTmFtZTogc3RyaW5nTGlrZSgnQXNzZXRzKicpIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6IHN0cmluZ0xpa2UoJ0Fzc2V0cyoyJykgfSksXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgTmFtZTogJ0FwcCcgfSksXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBiZWhhdmlvcignMTAxIGFzc2V0cyB0cmlnZ2VycyBhIHRoaXJkIHN0YWdlJywgKHN1aXRlKSA9PiB7XG4gICAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBMZWdhY3lUZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBNZWdhQXNzZXRzQXBwKGFwcCwgJ0FwcCcsIHsgbnVtQXNzZXRzOiAxMDEgfSkpO1xuXG4gICAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICAgIH0pO1xuXG4gICAgICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgTWVnYUFzc2V0c0FwcChhcHAsICdBcHAnLCB7IG51bUFzc2V0czogMTAxIH0pKTtcblxuICAgICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlUGlwZWxpbmU6OlBpcGVsaW5lJywge1xuICAgICAgICAgIFN0YWdlczogW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdTb3VyY2UnIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6ICdCdWlsZCcgfSksXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgTmFtZTogJ1VwZGF0ZVBpcGVsaW5lJyB9KSxcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiBzdHJpbmdMaWtlKCdBc3NldHMqJykgfSksIC8vICdBc3NldHMnIHZzICdBc3NldHMuMSdcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2UoeyBOYW1lOiBzdHJpbmdMaWtlKCdBc3NldHMqMicpIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IE5hbWU6IHN0cmluZ0xpa2UoJ0Fzc2V0cyozJykgfSksXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgTmFtZTogJ0FwcCcgfSksXG4gICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGJlaGF2aW9yKCdjb21tYW5kIGxpbmUgcHJvcGVybHkgbG9jYXRlcyBhc3NldHMgaW4gc3ViYXNzZW1ibHknLCAoc3VpdGUpID0+IHtcbiAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNvZGVCdWlsZDo6UHJvamVjdCcsIHtcbiAgICAgICAgRW52aXJvbm1lbnQ6IHtcbiAgICAgICAgICBJbWFnZTogQ0RLUF9ERUZBVUxUX0NPREVCVUlMRF9JTUFHRS5pbWFnZUlkLFxuICAgICAgICB9LFxuICAgICAgICBTb3VyY2U6IHtcbiAgICAgICAgICBCdWlsZFNwZWM6IE1hdGNoLnNlcmlhbGl6ZWRKc29uKE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgICAgcGhhc2VzOiB7XG4gICAgICAgICAgICAgIGJ1aWxkOiB7XG4gICAgICAgICAgICAgICAgY29tbWFuZHM6IE1hdGNoLmFycmF5V2l0aChbYGNkay1hc3NldHMgLS1wYXRoIFwiYXNzZW1ibHktRmlsZUFzc2V0QXBwL0ZpbGVBc3NldEFwcFN0YWNrRUFERDY4QzUuYXNzZXRzLmpzb25cIiAtLXZlcmJvc2UgcHVibGlzaCBcIiR7RklMRV9BU1NFVF9TT1VSQ0VfSEFTSH06Y3VycmVudF9hY2NvdW50LWN1cnJlbnRfcmVnaW9uXCJgXSksXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgYmVoYXZpb3IoJ211bHRpcGxlIGFzc2V0cyBhcmUgcHVibGlzaGVkIGluIHBhcmFsbGVsJywgKHN1aXRlKSA9PiB7XG4gICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBUd29GaWxlQXNzZXRzQXBwKGFwcCwgJ0ZpbGVBc3NldEFwcCcpKTtcblxuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgVHdvRmlsZUFzc2V0c0FwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNvZGVQaXBlbGluZTo6UGlwZWxpbmUnLCB7XG4gICAgICAgIFN0YWdlczogTWF0Y2guYXJyYXlXaXRoKFt7XG4gICAgICAgICAgTmFtZTogJ0Fzc2V0cycsXG4gICAgICAgICAgQWN0aW9uczogW1xuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IFJ1bk9yZGVyOiAxIH0pLFxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IFJ1bk9yZGVyOiAxIH0pLFxuICAgICAgICAgIF0sXG4gICAgICAgIH1dKSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgYmVoYXZpb3IoJ2Fzc2V0cyBhcmUgYWxzbyBwdWJsaXNoZWQgd2hlbiB1c2luZyB0aGUgbG93ZXItbGV2ZWwgYWRkU3RhY2tBcnRpZmFjdERlcGxveW1lbnQnLCAoc3VpdGUpID0+IHtcbiAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgLy8gR0lWRU5cbiAgICAgIGNvbnN0IGFzbSA9IG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnRmlsZUFzc2V0QXBwJykuc3ludGgoKTtcblxuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKCdTb21lU3RhZ2UnKS5hZGRTdGFja0FydGlmYWN0RGVwbG95bWVudChhc20uZ2V0U3RhY2tCeU5hbWUoJ0ZpbGVBc3NldEFwcC1TdGFjaycpKTtcblxuICAgICAgLy8gVEhFTlxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlUGlwZWxpbmU6OlBpcGVsaW5lJywge1xuICAgICAgICBTdGFnZXM6IE1hdGNoLmFycmF5V2l0aChbe1xuICAgICAgICAgIE5hbWU6ICdBc3NldHMnLFxuICAgICAgICAgIEFjdGlvbnM6IFtcbiAgICAgICAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgICAgICBOYW1lOiAnRmlsZUFzc2V0MScsXG4gICAgICAgICAgICAgIFJ1bk9yZGVyOiAxLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgXSxcbiAgICAgICAgfV0pLFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBUaGlzIGZ1bmN0aW9uIGRvZXMgbm90IGV4aXN0IGluIHRoZSBtb2Rlcm4gQVBJXG4gICAgc3VpdGUuZG9lc05vdEFwcGx5Lm1vZGVybigpO1xuICB9KTtcblxuICBiZWhhdmlvcignZmlsZSBpbWFnZSBhc3NldCBwdWJsaXNoZXJzIGRvIG5vdCB1c2UgcHJpdmlsZWdlZG1vZGUnLCAoc3VpdGUpID0+IHtcbiAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgLy8gV0hFTlxuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICAvLyBXSEVOXG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkNvZGVCdWlsZDo6UHJvamVjdCcsIHtcbiAgICAgICAgU291cmNlOiB7XG4gICAgICAgICAgQnVpbGRTcGVjOiBNYXRjaC5zZXJpYWxpemVkSnNvbihNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICAgIHBoYXNlczoge1xuICAgICAgICAgICAgICBidWlsZDoge1xuICAgICAgICAgICAgICAgIGNvbW1hbmRzOiBNYXRjaC5hcnJheVdpdGgoW3N0cmluZ0xpa2UoJ2Nkay1hc3NldHMgKicpXSksXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pKSxcbiAgICAgICAgfSxcbiAgICAgICAgRW52aXJvbm1lbnQ6IE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgIFByaXZpbGVnZWRNb2RlOiBmYWxzZSxcbiAgICAgICAgICBJbWFnZTogQ0RLUF9ERUZBVUxUX0NPREVCVUlMRF9JTUFHRS5pbWFnZUlkLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgYmVoYXZpb3IoJ2RvY2tlciBpbWFnZSBhc3NldCBwdWJsaXNoZXJzIHVzZSBwcml2aWxlZ2VkbW9kZScsIChzdWl0ZSkgPT4ge1xuICAgIHN1aXRlLmxlZ2FjeSgoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBMZWdhY3lUZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgRG9ja2VyQXNzZXRBcHAoYXBwLCAnRG9ja2VyQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycpO1xuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0RvY2tlckFzc2V0QXBwJykpO1xuXG4gICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCkge1xuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlQnVpbGQ6OlByb2plY3QnLCB7XG4gICAgICAgIFNvdXJjZToge1xuICAgICAgICAgIEJ1aWxkU3BlYzogTWF0Y2guc2VyaWFsaXplZEpzb24oTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgICBwaGFzZXM6IHtcbiAgICAgICAgICAgICAgYnVpbGQ6IHtcbiAgICAgICAgICAgICAgICBjb21tYW5kczogTWF0Y2guYXJyYXlXaXRoKFtzdHJpbmdMaWtlKCdjZGstYXNzZXRzIConKV0pLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSksXG4gICAgICAgIH0sXG4gICAgICAgIEVudmlyb25tZW50OiBNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICBJbWFnZTogQ0RLUF9ERUZBVUxUX0NPREVCVUlMRF9JTUFHRS5pbWFnZUlkLFxuICAgICAgICAgIFByaXZpbGVnZWRNb2RlOiB0cnVlLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgYmVoYXZpb3IoJ2NhbiBjb250cm9sIGZpeC9DTEkgdmVyc2lvbiB1c2VkIGluIGFzc2V0IHB1Ymxpc2hpbmcnLCAoc3VpdGUpID0+IHtcbiAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnLCB7XG4gICAgICAgIGNka0NsaVZlcnNpb246ICcxLjIuMycsXG4gICAgICB9KTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IEZpbGVBc3NldEFwcChwaXBlbGluZVN0YWNrLCAnRmlsZUFzc2V0QXBwJykpO1xuXG4gICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgfSk7XG5cbiAgICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTW9kZXJuVGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnLCB7XG4gICAgICAgIGNsaVZlcnNpb246ICcxLjIuMycsXG4gICAgICB9KTtcbiAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKG5ldyBGaWxlQXNzZXRBcHAocGlwZWxpbmVTdGFjaywgJ0ZpbGVBc3NldEFwcCcpKTtcblxuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q29kZUJ1aWxkOjpQcm9qZWN0Jywge1xuICAgICAgICBFbnZpcm9ubWVudDoge1xuICAgICAgICAgIEltYWdlOiBDREtQX0RFRkFVTFRfQ09ERUJVSUxEX0lNQUdFLmltYWdlSWQsXG4gICAgICAgIH0sXG4gICAgICAgIFNvdXJjZToge1xuICAgICAgICAgIEJ1aWxkU3BlYzogTWF0Y2guc2VyaWFsaXplZEpzb24oTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgICBwaGFzZXM6IHtcbiAgICAgICAgICAgICAgaW5zdGFsbDoge1xuICAgICAgICAgICAgICAgIGNvbW1hbmRzOiBbJ25wbSBpbnN0YWxsIC1nIGNkay1hc3NldHNAMS4yLjMnXSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSkpLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICBkZXNjcmliZSgnYXNzZXQgcm9sZXMgYW5kIHBvbGljaWVzJywgKCkgPT4ge1xuICAgIGJlaGF2aW9yKCdpbmNsdWRlcyBmaWxlIHB1Ymxpc2hpbmcgYXNzZXRzIHJvbGUgZm9yIGFwcHMgd2l0aCBmaWxlIGFzc2V0cycsIChzdWl0ZSkgPT4ge1xuICAgICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgRmlsZUFzc2V0QXBwKGFwcCwgJ0FwcDEnKSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICAgIC8vIEV4cGVjdGF0aW9uIGV4cGVjdHMgdG8gc2VlIEtNUyBrZXkgcG9saWN5IHBlcm1pc3Npb25zXG4gICAgICAgICAgY3Jvc3NBY2NvdW50S2V5czogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwMScpKTtcblxuICAgICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgICB9KTtcblxuICAgICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlJvbGUnLCB7XG4gICAgICAgICAgQXNzdW1lUm9sZVBvbGljeURvY3VtZW50OiB7XG4gICAgICAgICAgICBTdGF0ZW1lbnQ6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIEFjdGlvbjogJ3N0czpBc3N1bWVSb2xlJyxcbiAgICAgICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICAgICAgUHJpbmNpcGFsOiB7XG4gICAgICAgICAgICAgICAgICBTZXJ2aWNlOiAnY29kZWJ1aWxkLmFtYXpvbmF3cy5jb20nLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBBY3Rpb246ICdzdHM6QXNzdW1lUm9sZScsXG4gICAgICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgICAgIFByaW5jaXBhbDoge1xuICAgICAgICAgICAgICAgICAgQVdTOiB7XG4gICAgICAgICAgICAgICAgICAgICdGbjo6Sm9pbic6IFsnJywgW1xuICAgICAgICAgICAgICAgICAgICAgICdhcm46JywgeyBSZWY6ICdBV1M6OlBhcnRpdGlvbicgfSwgYDppYW06OiR7UElQRUxJTkVfRU5WLmFjY291bnR9OnJvb3RgLFxuICAgICAgICAgICAgICAgICAgICBdXSxcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLFxuICAgICAgICAgIGV4cGVjdGVkQXNzZXRSb2xlUG9saWN5KEZJTEVfUFVCTElTSElOR19ST0xFLCAnQ2RrQXNzZXRzRmlsZVJvbGU2QkUxN0EwNycpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGJlaGF2aW9yKCdwdWJsaXNoaW5nIGFzc2V0cyByb2xlIG1heSBhc3N1bWUgcm9sZXMgZnJvbSBtdWx0aXBsZSBlbnZpcm9ubWVudHMnLCAoc3VpdGUpID0+IHtcbiAgICAgIHN1aXRlLmxlZ2FjeSgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdBcHAxJykpO1xuICAgICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwMicsIHtcbiAgICAgICAgICBlbnY6IHtcbiAgICAgICAgICAgIGFjY291bnQ6ICcwMTIzNDU2Nzg5MDEyJyxcbiAgICAgICAgICAgIHJlZ2lvbjogJ2V1LXdlc3QtMScsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICAgIH0pO1xuXG4gICAgICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycsIHtcbiAgICAgICAgICAvLyBFeHBlY3RhdGlvbiBleHBlY3RzIHRvIHNlZSBLTVMga2V5IHBvbGljeSBwZXJtaXNzaW9uc1xuICAgICAgICAgIGNyb3NzQWNjb3VudEtleXM6IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwMScpKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdBcHAyJywge1xuICAgICAgICAgIGVudjoge1xuICAgICAgICAgICAgYWNjb3VudDogJzAxMjM0NTY3ODkwMTInLFxuICAgICAgICAgICAgcmVnaW9uOiAnZXUtd2VzdC0xJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLFxuICAgICAgICAgIGV4cGVjdGVkQXNzZXRSb2xlUG9saWN5KFtGSUxFX1BVQkxJU0hJTkdfUk9MRSwgJ2Fybjoke0FXUzo6UGFydGl0aW9ufTppYW06OjAxMjM0NTY3ODkwMTI6cm9sZS9jZGstaG5iNjU5ZmRzLWZpbGUtcHVibGlzaGluZy1yb2xlLTAxMjM0NTY3ODkwMTItZXUtd2VzdC0xJ10sXG4gICAgICAgICAgICAnQ2RrQXNzZXRzRmlsZVJvbGU2QkUxN0EwNycpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGJlaGF2aW9yKCdwdWJsaXNoaW5nIGFzc2V0cyByb2xlIGRlLWR1cGVzIGFzc3VtZWQgcm9sZXMnLCAoc3VpdGUpID0+IHtcbiAgICAgIHN1aXRlLmxlZ2FjeSgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJyk7XG4gICAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdBcHAxJykpO1xuICAgICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwMicpKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgRmlsZUFzc2V0QXBwKGFwcCwgJ0FwcDMnKSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICAgIC8vIEV4cGVjdGF0aW9uIGV4cGVjdHMgdG8gc2VlIEtNUyBrZXkgcG9saWN5IHBlcm1pc3Npb25zXG4gICAgICAgICAgY3Jvc3NBY2NvdW50S2V5czogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwMScpKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdBcHAyJykpO1xuICAgICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgRmlsZUFzc2V0QXBwKGFwcCwgJ0FwcDMnKSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLFxuICAgICAgICAgIGV4cGVjdGVkQXNzZXRSb2xlUG9saWN5KEZJTEVfUFVCTElTSElOR19ST0xFLCAnQ2RrQXNzZXRzRmlsZVJvbGU2QkUxN0EwNycpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGJlaGF2aW9yKCdpbmNsdWRlcyBpbWFnZSBwdWJsaXNoaW5nIGFzc2V0cyByb2xlIGZvciBhcHBzIHdpdGggRG9ja2VyIGFzc2V0cycsIChzdWl0ZSkgPT4ge1xuICAgICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgRG9ja2VyQXNzZXRBcHAoYXBwLCAnQXBwMScpKTtcblxuICAgICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgICB9KTtcblxuICAgICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTW9kZXJuVGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnLCB7XG4gICAgICAgICAgLy8gRXhwZWN0YXRpb24gZXhwZWN0cyB0byBzZWUgS01TIGtleSBwb2xpY3kgcGVybWlzc2lvbnNcbiAgICAgICAgICBjcm9zc0FjY291bnRLZXlzOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0FwcDEnKSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpSb2xlJywge1xuICAgICAgICAgIEFzc3VtZVJvbGVQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICAgICAgU3RhdGVtZW50OiBbXG4gICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBBY3Rpb246ICdzdHM6QXNzdW1lUm9sZScsXG4gICAgICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgICAgIFByaW5jaXBhbDoge1xuICAgICAgICAgICAgICAgICAgU2VydmljZTogJ2NvZGVidWlsZC5hbWF6b25hd3MuY29tJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgQWN0aW9uOiAnc3RzOkFzc3VtZVJvbGUnLFxuICAgICAgICAgICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgICAgICAgICBQcmluY2lwYWw6IHtcbiAgICAgICAgICAgICAgICAgIEFXUzoge1xuICAgICAgICAgICAgICAgICAgICAnRm46OkpvaW4nOiBbJycsIFtcbiAgICAgICAgICAgICAgICAgICAgICAnYXJuOicsIHsgUmVmOiAnQVdTOjpQYXJ0aXRpb24nIH0sIGA6aWFtOjoke1BJUEVMSU5FX0VOVi5hY2NvdW50fTpyb290YCxcbiAgICAgICAgICAgICAgICAgICAgXV0sXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5JyxcbiAgICAgICAgICBleHBlY3RlZEFzc2V0Um9sZVBvbGljeShJTUFHRV9QVUJMSVNISU5HX1JPTEUsICdDZGtBc3NldHNEb2NrZXJSb2xlNDg0QjZERDMnKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBiZWhhdmlvcignaW5jbHVkZXMgYm90aCByb2xlcyBmb3IgYXBwcyB3aXRoIGJvdGggZmlsZSBhbmQgRG9ja2VyIGFzc2V0cycsIChzdWl0ZSkgPT4ge1xuICAgICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgRmlsZUFzc2V0QXBwKGFwcCwgJ0FwcDEnKSk7XG4gICAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0FwcDInKSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICAgIC8vIEV4cGVjdGF0aW9uIGV4cGVjdHMgdG8gc2VlIEtNUyBrZXkgcG9saWN5IHBlcm1pc3Npb25zXG4gICAgICAgICAgY3Jvc3NBY2NvdW50S2V5czogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIHBpcGVsaW5lLmFkZFN0YWdlKG5ldyBGaWxlQXNzZXRBcHAoYXBwLCAnQXBwMScpKTtcbiAgICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0FwcDInKSk7XG5cbiAgICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgICAgfSk7XG5cbiAgICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLFxuICAgICAgICAgIGV4cGVjdGVkQXNzZXRSb2xlUG9saWN5KEZJTEVfUFVCTElTSElOR19ST0xFLCAnQ2RrQXNzZXRzRmlsZVJvbGU2QkUxN0EwNycpKTtcbiAgICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpJQU06OlBvbGljeScsXG4gICAgICAgICAgZXhwZWN0ZWRBc3NldFJvbGVQb2xpY3koSU1BR0VfUFVCTElTSElOR19ST0xFLCAnQ2RrQXNzZXRzRG9ja2VyUm9sZTQ4NEI2REQzJykpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5iZWhhdmlvcignY2FuIHN1cHBseSBwcmUtaW5zdGFsbCBzY3JpcHRzIHRvIGFzc2V0IHVwbG9hZCcsIChzdWl0ZSkgPT4ge1xuICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgYXNzZXRQcmVJbnN0YWxsQ29tbWFuZHM6IFtcbiAgICAgICAgJ25wbSBjb25maWcgc2V0IHJlZ2lzdHJ5IGh0dHBzOi8vcmVnaXN0cnkuY29tJyxcbiAgICAgIF0sXG4gICAgfSk7XG4gICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgRmlsZUFzc2V0QXBwKGFwcCwgJ0ZpbGVBc3NldEFwcCcpKTtcblxuICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgfSk7XG5cbiAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycsIHtcbiAgICAgIGFzc2V0UHVibGlzaGluZ0NvZGVCdWlsZERlZmF1bHRzOiB7XG4gICAgICAgIHBhcnRpYWxCdWlsZFNwZWM6IGNiLkJ1aWxkU3BlYy5mcm9tT2JqZWN0KHtcbiAgICAgICAgICB2ZXJzaW9uOiAnMC4yJyxcbiAgICAgICAgICBwaGFzZXM6IHtcbiAgICAgICAgICAgIGluc3RhbGw6IHtcbiAgICAgICAgICAgICAgY29tbWFuZHM6IFtcbiAgICAgICAgICAgICAgICAnbnBtIGNvbmZpZyBzZXQgcmVnaXN0cnkgaHR0cHM6Ly9yZWdpc3RyeS5jb20nLFxuICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IEZpbGVBc3NldEFwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlQnVpbGQ6OlByb2plY3QnLCB7XG4gICAgICBFbnZpcm9ubWVudDoge1xuICAgICAgICBJbWFnZTogQ0RLUF9ERUZBVUxUX0NPREVCVUlMRF9JTUFHRS5pbWFnZUlkLFxuICAgICAgfSxcbiAgICAgIFNvdXJjZToge1xuICAgICAgICBCdWlsZFNwZWM6IE1hdGNoLnNlcmlhbGl6ZWRKc29uKE1hdGNoLm9iamVjdExpa2Uoe1xuICAgICAgICAgIHBoYXNlczoge1xuICAgICAgICAgICAgaW5zdGFsbDoge1xuICAgICAgICAgICAgICBjb21tYW5kczogWyducG0gY29uZmlnIHNldCByZWdpc3RyeSBodHRwczovL3JlZ2lzdHJ5LmNvbScsICducG0gaW5zdGFsbCAtZyBjZGstYXNzZXRzQDInXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSkpLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxufSk7XG5cbmRlc2NyaWJlKCdwaXBlbGluZSB3aXRoIFZQQycsICgpID0+IHtcbiAgbGV0IHZwYzogZWMyLlZwYztcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgdnBjID0gbmV3IGVjMi5WcGMocGlwZWxpbmVTdGFjaywgJ1ZwYycpO1xuICB9KTtcblxuICBiZWhhdmlvcignYXNzZXQgQ29kZUJ1aWxkIFByb2plY3QgdXNlcyBWUEMgc3VibmV0cycsIChzdWl0ZSkgPT4ge1xuICAgIHN1aXRlLmxlZ2FjeSgoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBMZWdhY3lUZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycsIHtcbiAgICAgICAgdnBjLFxuICAgICAgfSk7XG4gICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBEb2NrZXJBc3NldEFwcChhcHAsICdEb2NrZXJBc3NldEFwcCcpKTtcblxuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICBjb2RlQnVpbGREZWZhdWx0czogeyB2cGMgfSxcbiAgICAgIH0pO1xuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0RvY2tlckFzc2V0QXBwJykpO1xuXG4gICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCkge1xuICAgICAgLy8gVEhFTlxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlQnVpbGQ6OlByb2plY3QnLCB7XG4gICAgICAgIFZwY0NvbmZpZzogTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgU2VjdXJpdHlHcm91cElkczogW1xuICAgICAgICAgICAgeyAnRm46OkdldEF0dCc6IFsnQ2RrQXNzZXRzRG9ja2VyQXNzZXQxU2VjdXJpdHlHcm91cDA3OEY1QzY2JywgJ0dyb3VwSWQnXSB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgU3VibmV0czogW1xuICAgICAgICAgICAgeyBSZWY6ICdWcGNQcml2YXRlU3VibmV0MVN1Ym5ldDUzNkI5OTdBJyB9LFxuICAgICAgICAgICAgeyBSZWY6ICdWcGNQcml2YXRlU3VibmV0MlN1Ym5ldDM3ODhBQUExJyB9LFxuICAgICAgICAgICAgeyBSZWY6ICdWcGNQcml2YXRlU3VibmV0M1N1Ym5ldEYyNThCNTZFJyB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgVnBjSWQ6IHsgUmVmOiAnVnBjODM3OEVCMzgnIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICBiZWhhdmlvcignUGlwZWxpbmUtZ2VuZXJhdGVkIENvZGVCdWlsZCBQcm9qZWN0cyBoYXZlIGFwcHJvcHJpYXRlIGV4ZWN1dGlvbiByb2xlIHBlcm1pc3Npb25zJywgKHN1aXRlKSA9PiB7XG4gICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICB2cGMsXG4gICAgICB9KTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0RvY2tlckFzc2V0QXBwJykpO1xuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICBjb2RlQnVpbGREZWZhdWx0czogeyB2cGMgfSxcbiAgICAgIH0pO1xuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0RvY2tlckFzc2V0QXBwJykpO1xuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgIC8vIEFzc2V0cyBQcm9qZWN0XG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgICBSb2xlczogW1xuICAgICAgICAgIHsgUmVmOiAnQ2RrQXNzZXRzRG9ja2VyUm9sZTQ4NEI2REQzJyB9LFxuICAgICAgICBdLFxuICAgICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICAgIFN0YXRlbWVudDogTWF0Y2guYXJyYXlXaXRoKFt7XG4gICAgICAgICAgICBBY3Rpb246IE1hdGNoLmFycmF5V2l0aChbJ2VjMjpEZXNjcmliZVNlY3VyaXR5R3JvdXBzJ10pLFxuICAgICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgICAgUmVzb3VyY2U6ICcqJyxcbiAgICAgICAgICB9XSksXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIGJlaGF2aW9yKCdBc3NldCBwdWJsaXNoaW5nIENvZGVCdWlsZCBQcm9qZWN0cyBoYXZlIGNvcnJlY3QgVlBDIHBlcm1pc3Npb25zJywgKHN1aXRlKSA9PiB7XG4gICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICB2cGMsXG4gICAgICB9KTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IERvY2tlckFzc2V0QXBwKGFwcCwgJ0RvY2tlckFzc2V0QXBwJykpO1xuXG4gICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgfSk7XG5cbiAgICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTW9kZXJuVGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnLCB7XG4gICAgICAgIGNvZGVCdWlsZERlZmF1bHRzOiB7IHZwYyB9LFxuICAgICAgfSk7XG4gICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgRG9ja2VyQXNzZXRBcHAoYXBwLCAnRG9ja2VyQXNzZXRBcHAnKSk7XG4gICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKCkge1xuICAgICAgLy8gQXNzZXRzIFByb2plY3RcbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLCB7XG4gICAgICAgIFBvbGljeURvY3VtZW50OiB7XG4gICAgICAgICAgU3RhdGVtZW50OiBbXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcbiAgICAgICAgICAgICAgUmVzb3VyY2U6ICcqJyxcbiAgICAgICAgICAgICAgQWN0aW9uOiBbXG4gICAgICAgICAgICAgICAgJ2VjMjpDcmVhdGVOZXR3b3JrSW50ZXJmYWNlJyxcbiAgICAgICAgICAgICAgICAnZWMyOkRlc2NyaWJlTmV0d29ya0ludGVyZmFjZXMnLFxuICAgICAgICAgICAgICAgICdlYzI6RGVsZXRlTmV0d29ya0ludGVyZmFjZScsXG4gICAgICAgICAgICAgICAgJ2VjMjpEZXNjcmliZVN1Ym5ldHMnLFxuICAgICAgICAgICAgICAgICdlYzI6RGVzY3JpYmVTZWN1cml0eUdyb3VwcycsXG4gICAgICAgICAgICAgICAgJ2VjMjpEZXNjcmliZURoY3BPcHRpb25zJyxcbiAgICAgICAgICAgICAgICAnZWMyOkRlc2NyaWJlVnBjcycsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgICBSb2xlczogW3sgUmVmOiAnQ2RrQXNzZXRzRG9ja2VyUm9sZTQ4NEI2REQzJyB9XSxcbiAgICAgIH0pO1xuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlKCdBV1M6OkNvZGVCdWlsZDo6UHJvamVjdCcsIHtcbiAgICAgICAgUHJvcGVydGllczoge1xuICAgICAgICAgIFNlcnZpY2VSb2xlOiB7ICdGbjo6R2V0QXR0JzogWydDZGtBc3NldHNEb2NrZXJSb2xlNDg0QjZERDMnLCAnQXJuJ10gfSxcbiAgICAgICAgfSxcbiAgICAgICAgRGVwZW5kc09uOiBbXG4gICAgICAgICAgJ0Nka0Fzc2V0c0RvY2tlckFzc2V0MVBvbGljeURvY3VtZW50OERBOTZBMjInLFxuICAgICAgICBdLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgncGlwZWxpbmUgd2l0aCBzaW5nbGUgYXNzZXQgcHVibGlzaGVyJywgKCkgPT4ge1xuICBiZWhhdmlvcignbXVsdGlwbGUgYXNzZXRzIGFyZSB1c2luZyB0aGUgc2FtZSBqb2IgaW4gc2luZ2xlUHVibGlzaGVyTW9kZScsIChzdWl0ZSkgPT4ge1xuICAgIHN1aXRlLmxlZ2FjeSgoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBMZWdhY3lUZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycsIHtcbiAgICAgICAgc2luZ2xlUHVibGlzaGVyUGVyVHlwZTogdHJ1ZSxcbiAgICAgIH0pO1xuICAgICAgcGlwZWxpbmUuYWRkQXBwbGljYXRpb25TdGFnZShuZXcgVHdvRmlsZUFzc2V0c0FwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycsIHtcbiAgICAgICAgcHVibGlzaEFzc2V0c0luUGFyYWxsZWw6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgVHdvRmlsZUFzc2V0c0FwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKSB7XG4gICAgICAvLyBUSEVOXG4gICAgICBjb25zdCBidWlsZFNwZWNOYW1lID0gbmV3IENhcHR1cmUoc3RyaW5nTGlrZSgnYnVpbGRzcGVjLSoueWFtbCcpKTtcbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q29kZVBpcGVsaW5lOjpQaXBlbGluZScsIHtcbiAgICAgICAgU3RhZ2VzOiBNYXRjaC5hcnJheVdpdGgoW3tcbiAgICAgICAgICBOYW1lOiAnQXNzZXRzJyxcbiAgICAgICAgICBBY3Rpb25zOiBbXG4gICAgICAgICAgICAvLyBPbmx5IG9uZSBmaWxlIGFzc2V0IGFjdGlvblxuICAgICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7IFJ1bk9yZGVyOiAxLCBOYW1lOiAnRmlsZUFzc2V0JyB9KSxcbiAgICAgICAgICBdLFxuICAgICAgICB9XSksXG4gICAgICB9KTtcbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q29kZUJ1aWxkOjpQcm9qZWN0Jywge1xuICAgICAgICBFbnZpcm9ubWVudDoge1xuICAgICAgICAgIEltYWdlOiBDREtQX0RFRkFVTFRfQ09ERUJVSUxEX0lNQUdFLmltYWdlSWQsXG4gICAgICAgIH0sXG4gICAgICAgIFNvdXJjZToge1xuICAgICAgICAgIEJ1aWxkU3BlYzogYnVpbGRTcGVjTmFtZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgYXNzZW1ibHkgPSBzeW50aGVzaXplKHBpcGVsaW5lU3RhY2spO1xuXG4gICAgICBjb25zdCBhY3R1YWxGaWxlTmFtZSA9IGJ1aWxkU3BlY05hbWUuYXNTdHJpbmcoKTtcblxuICAgICAgY29uc3QgYnVpbGRTcGVjID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGFzc2VtYmx5LmRpcmVjdG9yeSwgYWN0dWFsRmlsZU5hbWUpLCB7IGVuY29kaW5nOiAndXRmLTgnIH0pKTtcbiAgICAgIGV4cGVjdChidWlsZFNwZWMucGhhc2VzLmJ1aWxkLmNvbW1hbmRzKS50b0NvbnRhaW4oYGNkay1hc3NldHMgLS1wYXRoIFwiYXNzZW1ibHktRmlsZUFzc2V0QXBwL0ZpbGVBc3NldEFwcFN0YWNrRUFERDY4QzUuYXNzZXRzLmpzb25cIiAtLXZlcmJvc2UgcHVibGlzaCBcIiR7RklMRV9BU1NFVF9TT1VSQ0VfSEFTSH06Y3VycmVudF9hY2NvdW50LWN1cnJlbnRfcmVnaW9uXCJgKTtcbiAgICAgIGV4cGVjdChidWlsZFNwZWMucGhhc2VzLmJ1aWxkLmNvbW1hbmRzKS50b0NvbnRhaW4oYGNkay1hc3NldHMgLS1wYXRoIFwiYXNzZW1ibHktRmlsZUFzc2V0QXBwL0ZpbGVBc3NldEFwcFN0YWNrRUFERDY4QzUuYXNzZXRzLmpzb25cIiAtLXZlcmJvc2UgcHVibGlzaCBcIiR7RklMRV9BU1NFVF9TT1VSQ0VfSEFTSDJ9OmN1cnJlbnRfYWNjb3VudC1jdXJyZW50X3JlZ2lvblwiYCk7XG4gICAgfVxuICB9KTtcblxuICBiZWhhdmlvcignb3RoZXIgcGlwZWxpbmUgd3JpdGVzIHRvIHNlcGFyYXRlIGFzc2V0cyBidWlsZCBzcGVjIGZpbGUnLCAoc3VpdGUpID0+IHtcbiAgICBzdWl0ZS5sZWdhY3koKCkgPT4ge1xuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgTGVnYWN5VGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2ssICdDZGsnLCB7XG4gICAgICAgIHNpbmdsZVB1Ymxpc2hlclBlclR5cGU6IHRydWUsXG4gICAgICB9KTtcbiAgICAgIHBpcGVsaW5lLmFkZEFwcGxpY2F0aW9uU3RhZ2UobmV3IFR3b0ZpbGVBc3NldHNBcHAoYXBwLCAnRmlsZUFzc2V0QXBwJykpO1xuXG4gICAgICBjb25zdCBwaXBlbGluZVN0YWNrMiA9IG5ldyBTdGFjayhhcHAsICdQaXBlbGluZVN0YWNrMicsIHsgZW52OiBQSVBFTElORV9FTlYgfSk7XG4gICAgICBjb25zdCBvdGhlclBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrMiwgJ0NkaycsIHtcbiAgICAgICAgc2luZ2xlUHVibGlzaGVyUGVyVHlwZTogdHJ1ZSxcbiAgICAgIH0pO1xuICAgICAgb3RoZXJQaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBUd29GaWxlQXNzZXRzQXBwKGFwcCwgJ090aGVyRmlsZUFzc2V0QXBwJykpO1xuXG4gICAgICBUSEVOX2NvZGVQaXBlbGluZUV4cGVjdGF0aW9uKHBpcGVsaW5lU3RhY2syKTtcbiAgICB9KTtcblxuICAgIHN1aXRlLm1vZGVybigoKSA9PiB7XG4gICAgICBjb25zdCBwaXBlbGluZSA9IG5ldyBNb2Rlcm5UZXN0R2l0SHViTnBtUGlwZWxpbmUocGlwZWxpbmVTdGFjaywgJ0NkaycsIHtcbiAgICAgICAgcHVibGlzaEFzc2V0c0luUGFyYWxsZWw6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgVHdvRmlsZUFzc2V0c0FwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIGNvbnN0IHBpcGVsaW5lU3RhY2syID0gbmV3IFN0YWNrKGFwcCwgJ1BpcGVsaW5lU3RhY2syJywgeyBlbnY6IFBJUEVMSU5FX0VOViB9KTtcbiAgICAgIGNvbnN0IG90aGVyUGlwZWxpbmUgPSBuZXcgTW9kZXJuVGVzdEdpdEh1Yk5wbVBpcGVsaW5lKHBpcGVsaW5lU3RhY2syLCAnQ2RrJywge1xuICAgICAgICBwdWJsaXNoQXNzZXRzSW5QYXJhbGxlbDogZmFsc2UsXG4gICAgICB9KTtcbiAgICAgIG90aGVyUGlwZWxpbmUuYWRkU3RhZ2UobmV3IFR3b0ZpbGVBc3NldHNBcHAoYXBwLCAnT3RoZXJGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24ocGlwZWxpbmVTdGFjazIpO1xuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbihwaXBlbGluZVN0YWNrMjogU3RhY2spIHtcbiAgICAgIC8vIFRIRU5cbiAgICAgIGNvbnN0IGJ1aWxkU3BlY05hbWUxID0gbmV3IENhcHR1cmUoc3RyaW5nTGlrZSgnYnVpbGRzcGVjLSoueWFtbCcpKTtcbiAgICAgIGNvbnN0IGJ1aWxkU3BlY05hbWUyID0gbmV3IENhcHR1cmUoc3RyaW5nTGlrZSgnYnVpbGRzcGVjLSoueWFtbCcpKTtcbiAgICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6Q29kZUJ1aWxkOjpQcm9qZWN0Jywge1xuICAgICAgICBTb3VyY2U6IHtcbiAgICAgICAgICBCdWlsZFNwZWM6IGJ1aWxkU3BlY05hbWUxLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjazIpLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlQnVpbGQ6OlByb2plY3QnLCB7XG4gICAgICAgIFNvdXJjZToge1xuICAgICAgICAgIEJ1aWxkU3BlYzogYnVpbGRTcGVjTmFtZTIsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KGJ1aWxkU3BlY05hbWUxLmFzU3RyaW5nKCkpLm5vdC50b0VxdWFsKGJ1aWxkU3BlY05hbWUyLmFzU3RyaW5nKCkpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuXG5kZXNjcmliZSgncGlwZWxpbmUgd2l0aCBjdXN0b20gYXNzZXQgcHVibGlzaGVyIEJ1aWxkU3BlYycsICgpID0+IHtcblxuICBiZWhhdmlvcignY3VzdG9tIGJ1aWxkc3BlYyBpcyBtZXJnZWQgY29ycmVjdGx5JywgKHN1aXRlKSA9PiB7XG4gICAgc3VpdGUubGVnYWN5KCgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IExlZ2FjeVRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICBzaW5nbGVQdWJsaXNoZXJQZXJUeXBlOiB0cnVlLFxuICAgICAgICBhc3NldEJ1aWxkU3BlYzogY2IuQnVpbGRTcGVjLmZyb21PYmplY3Qoe1xuICAgICAgICAgIHBoYXNlczoge1xuICAgICAgICAgICAgcHJlX2luc3RhbGw6IHtcbiAgICAgICAgICAgICAgY29tbWFuZHM6ICdwcmVpbnN0YWxsJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYWNoZToge1xuICAgICAgICAgICAgcGF0aHM6ICdub2RlX21vZHVsZXMnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgICBwaXBlbGluZS5hZGRBcHBsaWNhdGlvblN0YWdlKG5ldyBUd29GaWxlQXNzZXRzQXBwKGFwcCwgJ0ZpbGVBc3NldEFwcCcpKTtcblxuICAgICAgVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgc3VpdGUubW9kZXJuKCgpID0+IHtcbiAgICAgIC8vIFdIRU5cbiAgICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnQ2RrJywge1xuICAgICAgICBwdWJsaXNoQXNzZXRzSW5QYXJhbGxlbDogZmFsc2UsXG4gICAgICAgIGFzc2V0UHVibGlzaGluZ0NvZGVCdWlsZERlZmF1bHRzOiB7XG4gICAgICAgICAgcGFydGlhbEJ1aWxkU3BlYzogY2IuQnVpbGRTcGVjLmZyb21PYmplY3Qoe1xuICAgICAgICAgICAgcGhhc2VzOiB7XG4gICAgICAgICAgICAgIHByZV9pbnN0YWxsOiB7XG4gICAgICAgICAgICAgICAgY29tbWFuZHM6ICdwcmVpbnN0YWxsJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYWNoZToge1xuICAgICAgICAgICAgICBwYXRoczogJ25vZGVfbW9kdWxlcycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgVHdvRmlsZUFzc2V0c0FwcChhcHAsICdGaWxlQXNzZXRBcHAnKSk7XG5cbiAgICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgICB9KTtcblxuXG4gICAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICAgIGNvbnN0IGJ1aWxkU3BlY05hbWUgPSBuZXcgQ2FwdHVyZShzdHJpbmdMaWtlKCdidWlsZHNwZWMtKicpKTtcblxuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlUGlwZWxpbmU6OlBpcGVsaW5lJywge1xuICAgICAgICBTdGFnZXM6IE1hdGNoLmFycmF5V2l0aChbe1xuICAgICAgICAgIE5hbWU6ICdBc3NldHMnLFxuICAgICAgICAgIEFjdGlvbnM6IFtcbiAgICAgICAgICAgIC8vIE9ubHkgb25lIGZpbGUgYXNzZXQgYWN0aW9uXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHsgUnVuT3JkZXI6IDEsIE5hbWU6ICdGaWxlQXNzZXQnIH0pLFxuICAgICAgICAgIF0sXG4gICAgICAgIH1dKSxcbiAgICAgIH0pO1xuICAgICAgVGVtcGxhdGUuZnJvbVN0YWNrKHBpcGVsaW5lU3RhY2spLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpDb2RlQnVpbGQ6OlByb2plY3QnLCB7XG4gICAgICAgIEVudmlyb25tZW50OiB7XG4gICAgICAgICAgSW1hZ2U6IENES1BfREVGQVVMVF9DT0RFQlVJTERfSU1BR0UuaW1hZ2VJZCxcbiAgICAgICAgfSxcbiAgICAgICAgU291cmNlOiB7XG4gICAgICAgICAgQnVpbGRTcGVjOiBidWlsZFNwZWNOYW1lLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBjb25zdCBhc3NlbWJseSA9IHN5bnRoZXNpemUocGlwZWxpbmVTdGFjayk7XG4gICAgICBjb25zdCBidWlsZFNwZWMgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oYXNzZW1ibHkuZGlyZWN0b3J5LCBidWlsZFNwZWNOYW1lLmFzU3RyaW5nKCkpKS50b1N0cmluZygpKTtcbiAgICAgIGV4cGVjdChidWlsZFNwZWMucGhhc2VzLmJ1aWxkLmNvbW1hbmRzKS50b0NvbnRhaW4oYGNkay1hc3NldHMgLS1wYXRoIFwiYXNzZW1ibHktRmlsZUFzc2V0QXBwL0ZpbGVBc3NldEFwcFN0YWNrRUFERDY4QzUuYXNzZXRzLmpzb25cIiAtLXZlcmJvc2UgcHVibGlzaCBcIiR7RklMRV9BU1NFVF9TT1VSQ0VfSEFTSH06Y3VycmVudF9hY2NvdW50LWN1cnJlbnRfcmVnaW9uXCJgKTtcbiAgICAgIGV4cGVjdChidWlsZFNwZWMucGhhc2VzLmJ1aWxkLmNvbW1hbmRzKS50b0NvbnRhaW4oYGNkay1hc3NldHMgLS1wYXRoIFwiYXNzZW1ibHktRmlsZUFzc2V0QXBwL0ZpbGVBc3NldEFwcFN0YWNrRUFERDY4QzUuYXNzZXRzLmpzb25cIiAtLXZlcmJvc2UgcHVibGlzaCBcIiR7RklMRV9BU1NFVF9TT1VSQ0VfSEFTSDJ9OmN1cnJlbnRfYWNjb3VudC1jdXJyZW50X3JlZ2lvblwiYCk7XG4gICAgICBleHBlY3QoYnVpbGRTcGVjLnBoYXNlcy5wcmVfaW5zdGFsbC5jb21tYW5kcykudG9Db250YWluKCdwcmVpbnN0YWxsJyk7XG4gICAgICBleHBlY3QoYnVpbGRTcGVjLmNhY2hlLnBhdGhzKS50b0NvbnRhaW4oJ25vZGVfbW9kdWxlcycpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuZnVuY3Rpb24gZXhwZWN0ZWRBc3NldFJvbGVQb2xpY3koYXNzdW1lUm9sZVBhdHRlcm46IHN0cmluZyB8IHN0cmluZ1tdLCBhdHRhY2hlZFJvbGU6IHN0cmluZykge1xuICBpZiAodHlwZW9mIGFzc3VtZVJvbGVQYXR0ZXJuID09PSAnc3RyaW5nJykgeyBhc3N1bWVSb2xlUGF0dGVybiA9IFthc3N1bWVSb2xlUGF0dGVybl07IH1cblxuICByZXR1cm4ge1xuICAgIFBvbGljeURvY3VtZW50OiB7XG4gICAgICBTdGF0ZW1lbnQ6IFt7XG4gICAgICAgIEFjdGlvbjogWydsb2dzOkNyZWF0ZUxvZ0dyb3VwJywgJ2xvZ3M6Q3JlYXRlTG9nU3RyZWFtJywgJ2xvZ3M6UHV0TG9nRXZlbnRzJ10sXG4gICAgICAgIEVmZmVjdDogJ0FsbG93JyxcbiAgICAgICAgUmVzb3VyY2U6IHtcbiAgICAgICAgICAnRm46OkpvaW4nOiBbJycsIFtcbiAgICAgICAgICAgICdhcm46JyxcbiAgICAgICAgICAgIHsgUmVmOiAnQVdTOjpQYXJ0aXRpb24nIH0sXG4gICAgICAgICAgICBgOmxvZ3M6JHtQSVBFTElORV9FTlYucmVnaW9ufToke1BJUEVMSU5FX0VOVi5hY2NvdW50fTpsb2ctZ3JvdXA6L2F3cy9jb2RlYnVpbGQvKmAsXG4gICAgICAgICAgXV0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBBY3Rpb246IFsnY29kZWJ1aWxkOkNyZWF0ZVJlcG9ydEdyb3VwJywgJ2NvZGVidWlsZDpDcmVhdGVSZXBvcnQnLCAnY29kZWJ1aWxkOlVwZGF0ZVJlcG9ydCcsICdjb2RlYnVpbGQ6QmF0Y2hQdXRUZXN0Q2FzZXMnLCAnY29kZWJ1aWxkOkJhdGNoUHV0Q29kZUNvdmVyYWdlcyddLFxuICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgJ0ZuOjpKb2luJzogWycnLCBbXG4gICAgICAgICAgICAnYXJuOicsXG4gICAgICAgICAgICB7IFJlZjogJ0FXUzo6UGFydGl0aW9uJyB9LFxuICAgICAgICAgICAgYDpjb2RlYnVpbGQ6JHtQSVBFTElORV9FTlYucmVnaW9ufToke1BJUEVMSU5FX0VOVi5hY2NvdW50fTpyZXBvcnQtZ3JvdXAvKmAsXG4gICAgICAgICAgXV0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBBY3Rpb246IFsnY29kZWJ1aWxkOkJhdGNoR2V0QnVpbGRzJywgJ2NvZGVidWlsZDpTdGFydEJ1aWxkJywgJ2NvZGVidWlsZDpTdG9wQnVpbGQnXSxcbiAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICBSZXNvdXJjZTogJyonLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgQWN0aW9uOiAnc3RzOkFzc3VtZVJvbGUnLFxuICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgIFJlc291cmNlOiB1bnNpbmdsZXRvbihhc3N1bWVSb2xlUGF0dGVybi5tYXAoYXJuID0+IHsgcmV0dXJuIHsgJ0ZuOjpTdWInOiBhcm4gfTsgfSkpLFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgQWN0aW9uOiBbJ3MzOkdldE9iamVjdConLCAnczM6R2V0QnVja2V0KicsICdzMzpMaXN0KiddLFxuICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgIFJlc291cmNlOiBbXG4gICAgICAgICAgeyAnRm46OkdldEF0dCc6IFsnQ2RrUGlwZWxpbmVBcnRpZmFjdHNCdWNrZXQ3QjQ2QzdCRicsICdBcm4nXSB9LFxuICAgICAgICAgIHsgJ0ZuOjpKb2luJzogWycnLCBbeyAnRm46OkdldEF0dCc6IFsnQ2RrUGlwZWxpbmVBcnRpZmFjdHNCdWNrZXQ3QjQ2QzdCRicsICdBcm4nXSB9LCAnLyonXV0gfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIEFjdGlvbjogWydrbXM6RGVjcnlwdCcsICdrbXM6RGVzY3JpYmVLZXknXSxcbiAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICBSZXNvdXJjZTogeyAnRm46OkdldEF0dCc6IFsnQ2RrUGlwZWxpbmVBcnRpZmFjdHNCdWNrZXRFbmNyeXB0aW9uS2V5REREMzI1OEMnLCAnQXJuJ10gfSxcbiAgICAgIH1dLFxuICAgIH0sXG4gICAgUm9sZXM6IFt7IFJlZjogYXR0YWNoZWRSb2xlIH1dLFxuICB9O1xufVxuXG5cbmJlaGF2aW9yKCduZWNlc3Nhcnkgc2VjcmV0cyBtYW5hZ2VyIHBlcm1pc3Npb25zIGdldCBhZGRlZCB0byBhc3NldCByb2xlcycsIHN1aXRlID0+IHtcbiAgLy8gTm90IHBvc3NpYmxlIHRvIGNvbmZpZ3VyZSB0aGlzIGZvciBsZWdhY3kgcGlwZWxpbmVzXG4gIHN1aXRlLmRvZXNOb3RBcHBseS5sZWdhY3koKTtcblxuICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnUGlwZWxpbmUnLCB7XG4gICAgICBhc3NldFB1Ymxpc2hpbmdDb2RlQnVpbGREZWZhdWx0czoge1xuICAgICAgICBidWlsZEVudmlyb25tZW50OiB7XG4gICAgICAgICAgZW52aXJvbm1lbnRWYXJpYWJsZXM6IHtcbiAgICAgICAgICAgIEZPT0JBUjoge1xuICAgICAgICAgICAgICB2YWx1ZTogJ0Zvb2JhclNlY3JldCcsXG4gICAgICAgICAgICAgIHR5cGU6IGNiLkJ1aWxkRW52aXJvbm1lbnRWYXJpYWJsZVR5cGUuU0VDUkVUU19NQU5BR0VSLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgRmlsZUFzc2V0QXBwKHBpcGVsaW5lU3RhY2ssICdNeUFwcCcpKTtcblxuICAgIFRIRU5fY29kZVBpcGVsaW5lRXhwZWN0YXRpb24oKTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gVEhFTl9jb2RlUGlwZWxpbmVFeHBlY3RhdGlvbigpIHtcbiAgICBUZW1wbGF0ZS5mcm9tU3RhY2socGlwZWxpbmVTdGFjaykuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OklBTTo6UG9saWN5Jywge1xuICAgICAgUG9saWN5RG9jdW1lbnQ6IHtcbiAgICAgICAgU3RhdGVtZW50OiBNYXRjaC5hcnJheVdpdGgoW3tcbiAgICAgICAgICBBY3Rpb246ICdzZWNyZXRzbWFuYWdlcjpHZXRTZWNyZXRWYWx1ZScsXG4gICAgICAgICAgRWZmZWN0OiAnQWxsb3cnLFxuICAgICAgICAgIFJlc291cmNlOiB7XG4gICAgICAgICAgICAnRm46OkpvaW4nOiBbXG4gICAgICAgICAgICAgICcnLFxuICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgJ2FybjonLFxuICAgICAgICAgICAgICAgIHsgUmVmOiAnQVdTOjpQYXJ0aXRpb24nIH0sXG4gICAgICAgICAgICAgICAgJzpzZWNyZXRzbWFuYWdlcjp1cy1waXBlbGluZToxMjNwaXBlbGluZTpzZWNyZXQ6Rm9vYmFyU2VjcmV0LT8/Pz8/PycsXG4gICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBdLFxuICAgICAgICAgIH0sXG4gICAgICAgIH1dKSxcbiAgICAgIH0sXG4gICAgICBSb2xlczogW1xuICAgICAgICB7IFJlZjogJ1BpcGVsaW5lQXNzZXRzRmlsZVJvbGU1OTk0M0E3NycgfSxcbiAgICAgIF0sXG4gICAgfSk7XG4gIH1cbn0pO1xuXG5iZWhhdmlvcignYWRkaW5nIGVudmlyb25tZW50IHZhcmlhYmxlIHRvIGFzc2V0cyBqb2IgYWRkcyBTZWNyZXRzTWFuYWdlciBwZXJtaXNzaW9ucycsIHN1aXRlID0+IHtcbiAgLy8gTm8gd2F5IHRvIG1hbmlwdWxhdGUgYnVpbGRFbnZpcm9ubWVudCBpbiBsZWdhY3kgQVBJXG4gIHN1aXRlLmRvZXNOb3RBcHBseS5sZWdhY3koKTtcblxuICBzdWl0ZS5tb2Rlcm4oKCkgPT4ge1xuICAgIGNvbnN0IHBpcGVsaW5lID0gbmV3IE1vZGVyblRlc3RHaXRIdWJOcG1QaXBlbGluZShwaXBlbGluZVN0YWNrLCAnUGlwZWxpbmUnLCB7XG4gICAgICBhc3NldFB1Ymxpc2hpbmdDb2RlQnVpbGREZWZhdWx0czoge1xuICAgICAgICBidWlsZEVudmlyb25tZW50OiB7XG4gICAgICAgICAgZW52aXJvbm1lbnRWYXJpYWJsZXM6IHtcbiAgICAgICAgICAgIEZPT0JBUjoge1xuICAgICAgICAgICAgICB2YWx1ZTogJ0Zvb2JhclNlY3JldCcsXG4gICAgICAgICAgICAgIHR5cGU6IGNiLkJ1aWxkRW52aXJvbm1lbnRWYXJpYWJsZVR5cGUuU0VDUkVUU19NQU5BR0VSLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBwaXBlbGluZS5hZGRTdGFnZShuZXcgRmlsZUFzc2V0QXBwKHBpcGVsaW5lU3RhY2ssICdNeUFwcCcpKTtcblxuICAgIFRlbXBsYXRlLmZyb21TdGFjayhwaXBlbGluZVN0YWNrKS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6SUFNOjpQb2xpY3knLCB7XG4gICAgICBQb2xpY3lEb2N1bWVudDoge1xuICAgICAgICBTdGF0ZW1lbnQ6IE1hdGNoLmFycmF5V2l0aChbXG4gICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XG4gICAgICAgICAgICBBY3Rpb246ICdzZWNyZXRzbWFuYWdlcjpHZXRTZWNyZXRWYWx1ZScsXG4gICAgICAgICAgICBFZmZlY3Q6ICdBbGxvdycsXG4gICAgICAgICAgICBSZXNvdXJjZToge1xuICAgICAgICAgICAgICAnRm46OkpvaW4nOiBbJycsIFtcbiAgICAgICAgICAgICAgICAnYXJuOicsXG4gICAgICAgICAgICAgICAgeyBSZWY6ICdBV1M6OlBhcnRpdGlvbicgfSxcbiAgICAgICAgICAgICAgICAnOnNlY3JldHNtYW5hZ2VyOnVzLXBpcGVsaW5lOjEyM3BpcGVsaW5lOnNlY3JldDpGb29iYXJTZWNyZXQtPz8/Pz8/JyxcbiAgICAgICAgICAgICAgXV0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0pLFxuICAgICAgICBdKSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmZ1bmN0aW9uIHN5bnRoZXNpemUoc3RhY2s6IFN0YWNrKSB7XG4gIGNvbnN0IHJvb3QgPSBzdGFjay5ub2RlLnJvb3Q7XG4gIGlmICghU3RhZ2UuaXNTdGFnZShyb290KSkge1xuICAgIHRocm93IG5ldyBFcnJvcigndW5leHBlY3RlZDogYWxsIHN0YWNrcyBtdXN0IGJlIHBhcnQgb2YgYSBTdGFnZScpO1xuICB9XG5cbiAgcmV0dXJuIHJvb3Quc3ludGgoeyBza2lwVmFsaWRhdGlvbjogdHJ1ZSB9KTtcbn1cblxuZnVuY3Rpb24gdW5zaW5nbGV0b248QT4oeHM6IEFbXSk6IEEgfCBBW10ge1xuICBpZiAoeHMubGVuZ3RoID09PSAxKSB7XG4gICAgcmV0dXJuIHhzWzBdO1xuICB9XG4gIHJldHVybiB4cztcbn0iXX0=