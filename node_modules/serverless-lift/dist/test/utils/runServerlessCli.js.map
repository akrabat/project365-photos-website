{
  "version": 3,
  "sources": ["../../../test/utils/runServerlessCli.ts"],
  "sourcesContent": ["import { spawn } from \"child_process\";\nimport { readFileSync } from \"fs\";\nimport * as path from \"path\";\n\nexport async function runServerlessCli({ command, fixture }: RunServerlessCliOptions): Promise<RunServerlessCliReturn> {\n    return new Promise((resolve, reject) => {\n        const serverlessCmd = path.join(__dirname, \"../../node_modules/.bin/serverless\");\n        const process = spawn(`${serverlessCmd} ${command}`, {\n            shell: true,\n            cwd: path.join(__dirname, \"../fixtures\", fixture),\n        });\n        let output = \"\";\n        process.stdout.on(\"data\", (data) => (output += data));\n        process.stderr.on(\"data\", (data) => (output += data));\n        process.on(\"data\", (data: RunServerlessCliReturn) => resolve(data));\n        process.on(\"error\", (err) => reject(new Error(`Exit code: ${err.message}\\n` + output)));\n        process.on(\"close\", (err) => {\n            if (err === 0) {\n                const json = readFileSync(\n                    __dirname + \"/../fixtures/variables/.serverless/cloudformation-template-update-stack.json\"\n                );\n                resolve({\n                    stdoutData: output,\n                    cfTemplate: JSON.parse(json.toString()) as {\n                        Resources: Record<string, unknown>;\n                        Outputs: Record<string, unknown>;\n                    },\n                });\n            } else {\n                reject(new Error(`Exit code: ${err}\\n` + output));\n            }\n        });\n    });\n}\n\ntype RunServerlessCliOptions = {\n    fixture: string;\n    command: string;\n};\n\ntype RunServerlessCliReturn = {\n    stdoutData: string;\n    cfTemplate: {\n        Resources: Record<string, unknown>;\n        Outputs: Record<string, unknown>;\n    };\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAAsB;AACtB,gBAA6B;AAC7B,WAAsB;AAEtB,eAAsB,iBAAiB,EAAE,SAAS,QAAQ,GAA6D;AACnH,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,UAAM,gBAAgB,KAAK,KAAK,WAAW,oCAAoC;AAC/E,UAAM,cAAU,4BAAM,GAAG,iBAAiB,WAAW;AAAA,MACjD,OAAO;AAAA,MACP,KAAK,KAAK,KAAK,WAAW,eAAe,OAAO;AAAA,IACpD,CAAC;AACD,QAAI,SAAS;AACb,YAAQ,OAAO,GAAG,QAAQ,CAAC,SAAU,UAAU,IAAK;AACpD,YAAQ,OAAO,GAAG,QAAQ,CAAC,SAAU,UAAU,IAAK;AACpD,YAAQ,GAAG,QAAQ,CAAC,SAAiC,QAAQ,IAAI,CAAC;AAClE,YAAQ,GAAG,SAAS,CAAC,QAAQ,OAAO,IAAI,MAAM,cAAc,IAAI;AAAA,IAAc,MAAM,CAAC,CAAC;AACtF,YAAQ,GAAG,SAAS,CAAC,QAAQ;AACzB,UAAI,QAAQ,GAAG;AACX,cAAM,WAAO;AAAA,UACT,YAAY;AAAA,QAChB;AACA,gBAAQ;AAAA,UACJ,YAAY;AAAA,UACZ,YAAY,KAAK,MAAM,KAAK,SAAS,CAAC;AAAA,QAI1C,CAAC;AAAA,MACL,OAAO;AACH,eAAO,IAAI,MAAM,cAAc;AAAA,IAAU,MAAM,CAAC;AAAA,MACpD;AAAA,IACJ,CAAC;AAAA,EACL,CAAC;AACL;",
  "names": []
}
